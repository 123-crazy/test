// @<COPYRIGHT>@
// ==================================================
// Copyright Siemens 2020.
// PL Diagram Foundation 1973.0.1-0
// ==================================================
// @<COPYRIGHT>@
var t,n;t=this,n=function(W,H,r){"use strict";W=W&&Object.prototype.hasOwnProperty.call(W,"default")?W.default:W,H=H&&Object.prototype.hasOwnProperty.call(H,"default")?H.default:H,r=r&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r;var n=0;function l(){W.SessionAwareObject.call(this);var t=n++;this.guid=t,s.setRawValue(this,t),this.createCb()}var t=function(t,i,n,r){(t.F5=n)&&n.tF(t),r&&r.iF(t)};l.prototype.createCb=function(){this.wM=0,W.AppSession.addObject(this)},l.prototype.setId=function(t){n<=t&&(n=t+1);var i=s.getValue(this);s.setRawValue(this,t),void 0!==i&&W.AppSession.deleteObject(this,i),W.AppSession.addObject(this)},l.prototype.getId=function(){return s.getValue(this)},l.prototype.copyFrom=function(t,i){this.getSession();var n=this.getType(),r=W.Property.get(n);if(r)for(var s in r){var h,u,o=r[s],e=o.getValue(t);null!=e?(h=!1,u=e,((s=o.getFlags())&W.PropertyFlags.SupportsShallowCopy)===W.PropertyFlags.SupportsShallowCopy?(h=!0,(s&W.PropertyFlags.IsCollection
)===W.PropertyFlags.IsCollection&&((u=o.getValue(this))?u.copyFrom(e,!1):u=e.clone(!1))):(s&W.PropertyFlags.SupportsDeepCopy)===W.PropertyFlags.SupportsDeepCopy&&(h=!0,u=o.getValue(this),(s&W.PropertyFlags.IsCollection)===W.PropertyFlags.IsCollection?u?u.copyFrom(e,!0,i):u=e.clone(!0,i):(s=!0,(s=u&&u.getType&&e&&e.getType?u.getType()!==e.getType():s)?u=e.clone(i):(u.copyFrom(e,i),e.getId&&i.put(e.guid,u)))),h&&o.setRawValue(this,u)):o.setRawValue(this,e)}},l.prototype.TI=function(t){var i,n=0,r="",s=this.guid;if(t.containsKey(s)?(i=t.get(s))===this?n=1:(n=2,r="Duplicate Guid Found: guid="+s.toString()+", oldType="+i.getTypeName()+", newType="+this.getTypeName()):t.put(s,this),0===n){var s=this.getType(),h=W.Property.get(s);if(h)for(var u in h){var o=h[u],e=o.getValue(this);if(null!=e){u=o.getValueType(),o="Map"===u?!0:"List"===u?!0:!1,u=!1;if(e.getId&&(u=!0),o||u){e=e.TI(t);if(e&&2===e.status){n=e.status,r=e.message;break}}}}}return{status:n,message:r}},l.prototype.clone=function(t){
t=t||new W.Map;var i=this.getType(),n=null,r=this.guid;return t.containsKey(r)?n=t.get(r):(n=H.ReflectionUtils.createObject(i),t.put(r,n)),n.copyFrom(this,t),n},l.prototype.XE=function(t){var i=this.getType(),n=W.Property.get(i);if(n)for(var r in n){var s,h,u=n[r],o=u.getValue(this);null!=o&&(h=null,((s=u.getFlags())&W.PropertyFlags.SupportsShallowCopy)===W.PropertyFlags.SupportsShallowCopy?(s&W.PropertyFlags.IsCollection)===W.PropertyFlags.IsCollection?o.XE(!1,t):o.getType&&o.getId&&(r=o.guid,t.containsKey(r)&&(h=t.get(r))):(s&W.PropertyFlags.SupportsDeepCopy)===W.PropertyFlags.SupportsDeepCopy&&((s&W.PropertyFlags.IsCollection)===W.PropertyFlags.IsCollection?o.XE(!0,t):o.XE&&o.XE(t)),h&&u.setRawValue(this,h))}},l.prototype.PL=function(){this.remove()},l.prototype.remove=function(){var t;W.AppSession.deleteObject(this,this.getId())&&(this.GI=[],(t=this.getSession())&&((t=t.CM())&&!t.FI()&&t.BM(new W.messages.PropertyChangedMessage(this,null,null,null,W.ChangeType.Remove)),
0==this.wM?this.wM=-1:this.wM=1),W.SessionAwareObject.prototype.remove.call(this))},l.prototype.getDefinition=function(){return"not implenment"},l.prototype.setOwner=function(t){h.setValue(this,t)},l.prototype.getOwner=function(){return this.F5},l.prototype.tF=function(t){},l.prototype.iF=function(t){},l.prototype.jA=function(){return!1},l.prototype.setTemporary=function(t){u.setValue(this,t)},l.prototype.getTemporary=function(){return u.getValue(this)},l.prototype.nF=function(t){};var i=function(t,i,n,r){t.nF(n)};W.SessionAwareObject.inheritedBy(l);var s=W.Property.define(l,"m_id",Number,W.PropertyFlags.Identifier),h=W.Property.define(l,"m_owner","BaseObject",W.PropertyFlags.None|W.PropertyFlags.SupportsShallowCopy,t,t),u=W.Property.define(l,"m_temporary",Array,W.PropertyFlags.Persistent|W.PropertyFlags.SupportsDeepCopy,i,i);function o(){l.call(this)}function e(){}o.prototype.evaluate=function(){W.common.ExceptionHelper.throwNotImplemented()},l.inheritedBy(o),
e.prototype.evaluate=function(t,i,n,r,s){if(s&&!(r&&s&H.ConnectionLabelAutoHideOption.AlwaysShowOneOccurrence))if(s&H.ConnectionLabelAutoHideOption.HideIfOverhang){var h=i.getLocation();if(h&&h.rF){var u=h.rF();if(u&&2==u.length){r=u[0],s=u[1],h=i.getWidthValue(),u=i.getAnchor();if(0==H.MathUtil.doubleCompare(r.x,s.x)){var i=n.y-h*(1-u.x),o=n.y-h*u.x;if(i<Math.min(r.y,s.y)||o>Math.max(r.y,s.y))return!1}else if(0==H.MathUtil.doubleCompare(r.y,s.y)){o=n.x-h*u.x,u=n.x-h*(1-u.x);if(o<Math.min(r.x,s.x)||u>Math.max(r.x,s.x))return!1}}}}else H.ConnectionLabelAutoHideOption.HideIfOverlap;return!0};var f=void 0;function c(){l.call(this)}function a(t,i){l.call(this),this.sF=!1,this.KC=t||0,this.JC=i||0,M.setRawValue(this,t||0),S.setRawValue(this,i||0),w.setRawValue(this,!0),this.hF=!1,this.uF=!1}e.getInstance=function(){return f=f||new e},c.prototype.getEvaluatedPoint=function(t,i,n,r){return new H.Point(n,r)},c.prototype.getEvaluatedRotation=function(t,i,n){return n},l.inheritedBy(c)
;var v=function(t,i,n,r){t.uF||n||(t.oF=!0,g.setValue(t,t.KC),p.setValue(t,t.JC),_.setValue(t,0),y.setValue(t,0),t.oF=void 0),r&&r!==n&&r.removeReferencingLocation(t),n&&n.addReferencingLocation(t)},m=function(t,i,n,r){t.oF||(this.uF=!0,void 0!==r&&void 0!==n&&w.getValue(t)&&0===H.MathUtil.doubleCompare(r,n)||t.setUpToDate(!1))};a.prototype.updateInputValue=function(t,i){var n=b.getValue(this);if(n){var r=this.getOwner();if(r&&r.getPlacementRule){var s=r.getPlacementRule();if(s){var h=s.getDefaultPosition(r);if(h){var u=t-h.x,o=i-h.y;return g.setValue(this,u),p.setValue(this,o),h.callback&&h.callback(r,s),void(this.eF=!0)}}}r=new H.Rect(0,0,0,0);n.getBBox&&(r=n.getBBox());var e,f,s=this.getLocationRule();(r=s&&s.n8?s.n8(n):r)&&(void 0!==t&&(e=_.getValue(this)||0,f=g.getValue(this)||0,f=t-(r.x+r.width*e),g.setValue(this,f)),void 0!==i&&(e=y.getValue(this)||0,f=p.getValue(this)||0,f=i-(r.y+r.height*e),p.setValue(this,f)))}else void 0!==t&&g.setValue(this,t),void 0!==i&&p.setValue(this,i)
,_.setValue(this,0),y.setValue(this,0)},a.prototype.fF=function(){var t,i;this.isUpToDate()||(t=g.getValue(this)||0,i=p.getValue(this)||0,this.KC=t,this.JC=i,M.setValue(this,t),S.setValue(this,i),this.setUpToDate(!0))},a.prototype.cF=function(){var t=this.getOwner(),i=this.getReference();if(!i||!t)return!1;var n=t.getLocationCoordinateMode()===H.ElementCoordinateMode.Device,r=t.getSizeCoordinateMode()===H.ElementCoordinateMode.Device,t=i.getLocationCoordinateMode()===H.ElementCoordinateMode.Device,i=i.getSizeCoordinateMode()===H.ElementCoordinateMode.Device;return n&&r&&!t&&!i||!n&&!r&&t&&i},a.prototype.aF=function(t){var i=this.cF(),n=_.getValue(this)||0,r=y.getValue(this)||0,s=g.getValue(this)||0,h=p.getValue(this)||0,u=new H.Rect(0,0,0,0);t.getBBox&&(u=t.getBBox());var o,e,f,c,a=this.getLocationRule();return a&&a.n8&&(u=a.n8(t)),{x:this.isLockX()?this.KC:i?(e=u.x+u.width*n,f=u.y+u.height*r,c=d(t,new H.Point(e,f)),(o=o||((o=this.getSession().getSheetConfigurationData().viewData.vF()
)||this.getSession().getSheetConfigurationData().viewData.getSheetToViewXform())).transformPoint(c).x+s):u.x+u.width*n+s,y:this.isLockY()?this.JC:i?(e=u.x+u.width*n,f=u.y+u.height*r,c=d(t,new H.Point(e,f)),(o=o||((o=this.getSession().getSheetConfigurationData().viewData.vF())||this.getSession().getSheetConfigurationData().viewData.getSheetToViewXform())).transformPoint(c).y+h):u.y+u.height*r+h}},a.prototype.evaluate=function(){if(!(this.hF||w.getValue(this)&&(this.KC||this.JC))){var t=b.getValue(this);if(t){var i=this.getOwner();if(i&&i.getPlacementRule){var n=i.getPlacementRule();if(n){var r=n.evaluate(i);if(r)return this.KC=r.x,this.JC=r.y,M.setValue(this,this.KC),S.setValue(this,this.JC),r.callback&&r.callback(i,n),void(0!==i.getWidthValue()&&this.setUpToDate(!0))}}r=this.aF(t),n=r.x,i=r.y;(this.isLockX()||this.isLockY())&&this.setEvaluatedLocation(n,i);t=this.KC,r=this.JC;0!==H.MathUtil.doubleCompare(t,n)&&(this.KC=n,M.setValue(this,n)),0!==H.MathUtil.doubleCompare(r,i)&&(this.JC=i
,S.setValue(this,i)),this.setUpToDate(!0)}else this.fF()}},a.prototype.setUpToDate=function(t){w.setValue(this,t),t?this.uF=!1:this.sF&&this.getOwner()&&this.getOwner().setUpToDate(!1)},a.prototype.isUpToDate=function(){return w.getValue(this)},a.prototype.setReference=function(t,i){t?b.getValue(this)!==t&&(b.setValue(this,t),i?this.setUpToDate(!1):(t=this.getSession())&&t.isInUpdateProcess()||(i=this.KC,t=this.JC,this.updateInputValue(i,t),this.setUpToDate(!0))):b.setValue(this,void 0)},a.prototype.getReference=function(){return b.getValue(this)},a.prototype.setInput=function(t,i,n){(t==H.CoordinateMode.ABSOLUTE?i==H.Axis.X?g:p:i==H.Axis.X?_:y).setValue(this,n)},a.prototype.getInput=function(t,i){return(t==H.CoordinateMode.ABSOLUTE?i==H.Axis.X?g:p:i==H.Axis.X?_:y).getValue(this)},a.prototype.setInputPercentX=function(t){_.setValue(this,t)},a.prototype.getInputPercentX=function(){return _.getValue(this)},a.prototype.setInputPercentY=function(t){y.setValue(this,t)},
a.prototype.getInputPercentY=function(){return y.getValue(this)},a.prototype.setInputValueX=function(t){g.setValue(this,t)},a.prototype.getInputValueX=function(){return g.getValue(this)},a.prototype.setInputValueY=function(t){p.setValue(this,t)},a.prototype.getInputValueY=function(){return p.getValue(this)},a.prototype.setEvaluatedX=function(t){M.setValue(this,t)},a.prototype.getEvaluatedX=function(){var t=this.getResolvedEvaluatedLocation();if(t)return t.x},a.prototype.setEvaluatedY=function(t){S.setValue(this,t)},a.prototype.getEvaluatedY=function(){var t=this.getResolvedEvaluatedLocation();if(t)return t.y},a.prototype.setLockX=function(t){N.setValue(this,t)},a.prototype.isLockX=function(){return N.getValue(this)},a.prototype.setLockY=function(t){L.setValue(this,t)},a.prototype.isLockY=function(){return L.getValue(this)},a.prototype.setEvaluatedLocation=function(t,i,n){(n=void 0===n?!0:n)&&(this.eF=!1,this.updateInputValue(t,i),this.eF)||(void 0!==t&&(this.KC=t,M.setValue(this,t)),
void 0!==i&&(this.JC=i,S.setValue(this,i)),this.setUpToDate(!0))},a.prototype.getEvaluatedLocation=function(){this.evaluate();var t=this.getLocationRule();return t?t.getEvaluatedPoint(this.getOwner(),this,this.KC,this.JC):new H.Point(this.KC,this.JC)},a.prototype.e8=function(t){var i=this.getLocationRule();return i?i.getEvaluatedRotation(this.getOwner(),this,t):t};var d=function(t,i){var n=i.clone(),i=t.getRenderingPosition();return i&&(t=t.getXform(),n.x-=i.x,n.y-=i.y,(n=t.transformPoint(n)).x+=i.x,n.y+=i.y),n};a.prototype.getResolvedEvaluatedLocation=function(){this.evaluate();var t,i=new H.Point(this.KC,this.JC);return this.cF()||(t=this.getReference())&&(i=d(t,i)),M.setValue(this,i.x),S.setValue(this,i.y),i},a.prototype.setLocationRule=function(t){O.setValue(this,t),t&&this.getSession().OA(t)},a.prototype.getLocationRule=function(){return O.getValue(this)},a.prototype.remove=function(){var t=b.getValue(this);t&&(t.removeReferencingLocation(this),b.setValue(this,null)),
this.setLocationRule(void 0),l.prototype.remove.call(this)},a.prototype.tk=function(){var t={isLockX:!1,isLockY:!1};return this.isLockX()&&(t.isLockX=!0),this.isLockY()&&(t.isLockY=!0),t},l.inheritedBy(a);var w=W.Property.define(a,"m_upToDate",Boolean,W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.SupportsShallowCopy),b=W.Property.define(a,"m_reference","SheetElement",W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.SupportsShallowCopy,v,v),_=W.Property.define(a,"m_inputPercentX",Number,W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.SupportsShallowCopy,m,m),y=W.Property.define(a,"m_inputPercentY",Number,W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.SupportsShallowCopy,m,m),g=W.Property.define(a,"m_inputValueX",Number,W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.SupportsShallowCopy,m,m),p=W.Property.define(a,"m_inputValueY",Number,
W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.SupportsShallowCopy,m,m),M=W.Property.define(a,"m_evaluatedX",Number,W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.SupportsShallowCopy),S=W.Property.define(a,"m_evaluatedY",Number,W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.SupportsShallowCopy),N=W.Property.define(a,"m_lockX",Boolean,W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.SupportsShallowCopy),L=W.Property.define(a,"m_lockY",Boolean,W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.SupportsShallowCopy),O=W.Property.define(a,"m_locationRule",c,W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.SupportsShallowCopy);function T(){l.call(this),k.setRawValue(this,H.Color.Black),E.setRawValue(this,1),this.lF=null}T.prototype.getStrokeAttributes=function(){return k.getValue(this)},T.prototype.setStrokeColor=function(t){k.setValue(this,t),
null!=this.lF&&this.lF.bindNewValues("getStrokeColor")},T.prototype.getFillColor=function(){return B.getValue(this)},T.prototype.getFillAttributes=function(){return B.getValue(this)},T.prototype.setFillColor=function(t){B.setValue(this,t),null!=this.lF&&this.lF.bindNewValues("getFillColor")},T.prototype.getStrokeColor=function(){return k.getValue(this)},T.prototype.setStrokeAttributes=function(t){W.common.ExceptionHelper.throwIfInvalidArray(t,"host stroke color array");t=this.mF(t);k.setValue(this,t)},T.prototype.setFillAttributes=function(t){W.common.ExceptionHelper.throwIfInvalidArray(t,"host fill color array");t=this.mF(t);B.setValue(this,t)},T.prototype.getStrokeDashArray=function(){var t=x.getValue(this),i=[];return i=t?t.toArray():i},T.prototype.setStrokeDashArray=function(t){t=new W.List(t);x.setValue(this,t)},T.prototype.getStrokeWidth=function(){return E.getValue(this)},T.prototype.setStrokeWidth=function(t){W.common.ExceptionHelper.throwIfNegative(t,"stroke width"),
E.setValue(this,t)},T.prototype.getStrokeWidthAttr=function(){return E.getValue(this)},T.prototype.setStrokeWidthAttr=function(t){W.common.ExceptionHelper.throwIfNegative(t,"stroke width"),E.setValue(this,t)},T.prototype.setStyleClass=function(t){C.setValue(this,t)},T.prototype.getStyleClass=function(){return C.getValue(this)},T.prototype.setLinearGradient=function(t,i,n,r){this.setGradientAttributes([t,i,n,r]),this.setGradientType("linear")},T.prototype.setRadialGradient=function(t,i,n,r,s,h){this.setGradientAttributes([t,i,n,r,s,h]),this.setGradientType("radial")},T.prototype.addGradientStop=function(t,i){void 0!==t&&void 0!==i||W.common.ExceptionHelper.throwException("offset and color are both required for each gradient stop"),(t<0||1<t)&&W.common.ExceptionHelper.throwException("the offset of gradient stop must be from 0 to 1"),W.common.ExceptionHelper.throwIfInvalidArray(i,"host stop color array");i=this.mF(i),i=i.toString(),t=(R.getValue(this)||[]).concat([t])
;this.setGradientStopOffsets(t);i=(F.getValue(this)||[]).concat([i]);this.setGradientStopColors(i)},T.prototype.setGradientAttributes=function(t){D.setValue(this,t)},T.prototype.getGradientAttributes=function(){return D.getValue(this)},T.prototype.setGradientStopOffsets=function(t){W.common.ExceptionHelper.throwIfInvalidArray(t,"host stop offset array"),R.setValue(this,t)},T.prototype.getGradientStopOffsets=function(){return R.getValue(this)},T.prototype.setGradientStopColors=function(t){W.common.ExceptionHelper.throwIfInvalidArray(t,"host stop color array"),F.setValue(this,t)},T.prototype.getGradientStopColors=function(){return F.getValue(this)},T.prototype.setGradientTarget=function(t){"stroke"===t||"fill"===t?I.setValue(this,t):W.common.ExceptionHelper.throwException("invalid target")},T.prototype.getGradientTarget=function(){var t=I.getValue(this);return t||"stroke"},T.prototype.setGradientType=function(t){j.setValue(this,t)},T.prototype.getGradientType=function(){var t=j.getValue(
this);return t||"linear"},T.prototype.toRenderStyle=function(t){var i;t?i=t:((i=new H.RenderStyle).renderReason=0,i.renderReason=i.renderReason|H.RenderReason.Create),i.styleClass=this.getStyleClass();var n=this.getStrokeAttributes(),r=!1;(n&&!t||t&&!n||t&&!n.equal(i.strokeColor))&&(i.strokeColor=n,r=!0);var s=this.getFillAttributes();(s&&!t||t&&!s||t&&!s.equal(i.fillColor))&&(i.fillColor=s,r=!0);var h=this.getStrokeDashArray();h&&(u=T.dashArrayToString(h),t&&u===i.lineDashArray||(i.lineDashArray=u,r=!0));n=this.getStrokeWidth();t&&n===i.lineWidth||(i.lineWidth=this.getStrokeWidth(),r=!0);var u,s=this.getGradientAttributes();return s&&s.length&&(h=this.getGradientType(),u=this.dF(s,h),n=i.renderGradient.gradientAttr,t&&n&&n.location&&JSON.stringify(u)==JSON.stringify(n.location)||(i.renderGradient.gradientAttr=n||{},"linear"===h?(i.renderGradient.gradientAttr.location=u,i.renderGradient.gradientAttr.type=h,i.renderGradient.target=this.getGradientTarget(),
i.renderGradient.id=H.Constants.DOM_PREFIX+H.Constants.DOM_LINEAR_GRADIENT+this.guid.toString(),r=!0):"radial"===h&&(i.renderGradient.gradientAttr.location=u,i.renderGradient.gradientAttr.type=h,i.renderGradient.target=this.getGradientTarget(),i.renderGradient.id=H.Constants.DOM_PREFIX+H.Constants.DOM_RADIAL_GRADIENT+this.guid.toString(),r=!0)),s=i.renderGradient.gradientAttr.stopOffsets,n=i.renderGradient.gradientAttr.stopColors,u=this.getGradientStopOffsets(),h=this.getGradientStopColors(),!(u&&0<u.length&&h&&0<h.length)||t&&n&&s&&u.toString()==s.toString()&&h.toString()==n.toString()||(i.renderGradient.gradientAttr.stopOffsets=u,i.renderGradient.gradientAttr.stopColors=h,r=!0)),r&&t&&(i.renderReason=i.renderReason|H.RenderReason.RenderingPropertiesChange),i.vectorEffect=this.getSession().getSheetConfigurationData().vectorEffectOption,i},T.prototype.wF=function(t){if(t){var i=t.toRenderStyle(),n=this.toRenderStyle(),t=new H.RenderStyle;return t.styleClass=i.styleClass||n.styleClass,
t.strokeColor=i.strokeColor||n.strokeColor,t.fillColor=i.fillColor||n.fillColor,t.lineDashArray=i.lineDashArray||n.lineDashArray,t.lineWidth=i.lineWidth||n.lineWidth,t.renderGradient=i.renderGradient||n.renderGradient,t.renderReason=0,t.renderReason=t.renderReason|H.RenderReason.Create,t}return this.toRenderStyle()},T.prototype.getAttributes=function(){var t={};return t.class=this.getStyleClass(),t.fill=this.getFillAttributes(),t};var A=null,P=null;T.prototype.getReferencings=function(){var t=[];if(null!==A&&null!==P||(A=W.common.ObjectHelper.rootNamespace.Models.Symbol,P=W.common.ObjectHelper.rootNamespace.Models.SymbolOccurrence),this.BI&&0<this.BI.length){var i=this.BI[0];if(i instanceof A){if(i.BI)for(var n=i.BI.length,r=0;r<n;++r){var s=i.BI[r];s instanceof P?t.push(s.getOwner()):t.push(s)}}else i instanceof P?t.push(i.getOwner()):t=this.BI}return t},T.dashArrayToString=function(t){var i=null;return i=t&&0!==t.length?(i=t.toString()).replace(/,/gi," "):i},
T.prototype.clearGradientStops=function(){var t=[];this.setGradientStopOffsets(t),this.setGradientStopColors(t)},T.prototype.mF=function(t){var i=new H.Color,n=t.length;return n<3?W.common.ExceptionHelper.throwException(W.common.ExceptionTypes.InvalidColor.id):4===n?(i.red=t[0],i.green=t[1],i.blue=t[2],i.alpha=t[3]):(i.red=t[0],i.green=t[1],i.blue=t[2]),i},T.prototype.dF=function(t,i){var n={};return"linear"===i?(n.x1=t[0],n.y1=t[1],n.x2=t[2],n.y2=t[3]):"radial"===i&&(n.cx=t[0],n.cy=t[1],n.r=t[2],n.fx=t[3],n.fy=t[4],n.fr=t[5]),n},l.inheritedBy(T);var C=W.Property.define(T,"m_styleClass",String,W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.AffectRender|W.PropertyFlags.SupportsShallowCopy),k=W.Property.define(T,"m_strokeAttributes","Color",W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.AffectRender|W.PropertyFlags.SupportsDeepCopy),B=W.Property.define(T,"m_fillAttributes","Color",
W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.AffectRender|W.PropertyFlags.SupportsDeepCopy),x=W.Property.define(T,"m_strokeDashArray","List",W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.AffectRender|W.PropertyFlags.SupportsDeepCopy|W.PropertyFlags.IsCollection),E=W.Property.define(T,"m_strokeWidthAttr",Number,W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.AffectRender|W.PropertyFlags.SupportsShallowCopy),D=W.Property.define(T,"m_gradientAttributes",Array,W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.AffectRender|W.PropertyFlags.SupportsDeepCopy),R=W.Property.define(T,"m_gradientStopOffsets ",Array,W.PropertyFlags.Persistent|W.PropertyFlags.SupportsDeepCopy),F=W.Property.define(T,"m_gradientStopColors ",Array,W.PropertyFlags.Persistent|W.PropertyFlags.SupportsDeepCopy),I=W.Property.define(T,"m_gradientTarget",String,
W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.AffectRender|W.PropertyFlags.SupportsShallowCopy),j=W.Property.define(T,"m_gradientType",String,W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.AffectRender|W.PropertyFlags.SupportsShallowCopy);function z(){l.call(this)}function V(){l.call(this)}z.prototype.getDefaultPosition=function(t){W.common.ExceptionHelper.throwNotImplemented()},z.prototype.evaluate=function(t){W.common.ExceptionHelper.throwNotImplemented()},z.prototype.startPreview=function(t){},z.prototype.resetPosition=function(){var t=this.getReferencings(),i=t.length;if(0<i)for(var n=0;n<i;n++){var r=t[n];!r||(r=r.getLocation())&&(r.setInputValueX(0),r.setInputValueY(0))}},l.inheritedBy(z),V.prototype.getName=function(){return U.getValue(this)},V.prototype.setName=function(t){U.setValue(this,t)},V.prototype.isCached=function(){var t=G.getValue(this);return void 0===t||t},V.prototype.setCached=function(t){G.setValue(this,t)},
V.prototype.setAnchorX=function(t){J.setValue(this,t)},V.prototype.setAnchorY=function(t){q.setValue(this,t)},V.prototype.getAnchor=function(){return{anchorX:J.getValue(this),anchorY:q.getValue(this)}};var Y=null;V.prototype.getReferencings=function(){var t=[];if(Y=Y||W.common.ObjectHelper.rootNamespace.Models.SymbolOccurrence,this.BI)for(var i=0;i<this.BI.length;++i){var n=this.BI[i];t.push(n),n instanceof Y&&t.push(n.getOwner())}return t},V.prototype.getDefaultRenderingProperties=function(){return this.getSession().PA.symbolRenderProperties},V.prototype.remove=function(){var t=this.getSession();!t||(t=t.getSymbolCache())&&t.removeSymbol(this),l.prototype.remove.call(this)},V.prototype.bF=function(){return!1},V.prototype.ik=function(t,i){},V.prototype.render=function(t,i,n){t.createSymbolRenderStyle(i)},V.prototype.updateRender=function(t,i,n){t.updateSymbolRenderStyle(i)},V.prototype.renderPreview=function(t,i,n){this.render(t,i,n)},V.prototype.setSizeOutOfDate=function(){},
V.prototype.onRenderingPropertiesChanged=function(t,i,n){},V.prototype._F=function(t){},V.prototype.select=function(t,i,n,r,s,h,u){return!!u&&u(t,this,i,n,r,s,h)},V.prototype.yF=function(){return!1},V.prototype.jL=function(){return!1},V.prototype.hA=function(){return!0};var X=function(t,i,n,r){if(null!=n&&n!=r){var s=t.getReferencings(),h=s.length;if(0<h)for(var u=0;u<h;u++){var o=s[u];o&&o.updateAnchor&&o.updateAnchor()}}};l.inheritedBy(V);var G=W.Property.define(V,"m_cached",Boolean,W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.SupportsShallowCopy),U=W.Property.define(V,"m_name",String,W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.SupportsShallowCopy),J=W.Property.define(V,"m_anchorX",Number,W.PropertyFlags.Persistent|W.PropertyFlags.SupportsShallowCopy,X,X),q=W.Property.define(V,"m_anchorY",Number,W.PropertyFlags.Persistent|W.PropertyFlags.SupportsShallowCopy,X,X);function Z(){V.call(this)}function K(t){Z.call(this),$.setRawValue(
this,t),tt.setRawValue(this,H.LineDisplayOption.Polyline)}V.inheritedBy(Z),K.prototype.setPoints=function(t){W.common.ExceptionHelper.throwIfInvalidArray(t,"Symbol array");t=new W.List(t);$.setValue(this,t),this.polylineChanged()},K.prototype.getPoints=function(){var t=[],i=$.getValue(this);return t=i?i.toArray():t},K.prototype.setLineDisplayOption=function(t){tt.setValue(this,t)},K.prototype.getLineDisplayOption=function(){return tt.getValue(this)},K.prototype.addPoint=function(t){var i=$.getValue(this);i||(i=new W.List,$.setValue(this,i)),this.getLastPoint()&&t.equal(this.getLastPoint())||(i.add(t),this.polylineChanged())},K.prototype.removeLastPoint=function(){var t=$.getValue(this);t&&0<t.size()&&t.removeAt(t.size()-1),this.polylineChanged()},K.prototype.getLastPoint=function(){var t=$.getValue(this);return t&&0<t.size()?t.get(t.size()-1):null},K.prototype.getNextToLastPoint=function(){var t=$.getValue(this);return t&&1<t.size()?t.get(t.size()-2):null},K.prototype.render=function(t
,i){t.renderPolyline(this.getPoints(),i)},K.prototype.updateRender=function(t,i,n){t.updateRenderPolyline(this.getPoints(),i,n)},K.prototype.addPolylineChangedListener=function(t){t&&(this.gF||(this.gF=[]),this.gF.push(t))},K.prototype.removePolylineChangedListener=function(t){t&&this.gF&&(0<=(t=this.gF.indexOf(t))&&this.gF.splice(t,1))},K.prototype.polylineChanged=function(){if(this.gF)for(var t=this.gF.length,i=0;i<t;i++){var n=this.gF[i];n.polylineChanged&&n.polylineChanged(this)}};function Q(t,i){var n=t;return i===H.LineDisplayOption.CubicCurve?n=function(t){for(var i=[],n=[],r=0,s=t.length;r<s;r++){var h,u,o=t[r].clone();r<=2?i.push(o):(r!==s-1&&r%2==1&&(h=(t[r-1].x+t[r].x)/2,u=(t[r-1].y+t[r].y)/2,i.push(new H.Point(h,u)),i.push(new H.Point(h,u))),i.push(o))}for(r=0,s=i.length;r<s;r++){var e=Math.floor(r/4);n[e]||(n[e]=[]),n[e].push(i[r])}return n}(t):i===H.LineDisplayOption.QuadraticCurve&&(n=function(t){for(var i=[],n=[],r=0,s=t.length;r<s;r++){var h,u,o=t[r].clone()
;r<=1?i.push(o):(r!==s-1&&(h=(t[r-1].x+t[r].x)/2,u=(t[r-1].y+t[r].y)/2,i.push(new H.Point(h,u)),i.push(new H.Point(h,u))),i.push(o))}for(r=0,s=i.length;r<s;r++){var e=Math.floor(r/3);n[e]||(n[e]=[]),n[e].push(i[r])}return n}(t)),n}K.prototype.select=function(t,i,n,r,s,h,u){for(var o=[],e=this.getPoints(),f=0,c=e.length;f<c;f++){var a=e[f].clone();a.x+=i,a.y+=n,o.push(a)}var v=this.getLineDisplayOption();return v===H.LineDisplayOption.QuadraticCurve||v===H.LineDisplayOption.CubicCurve?K.dk(t.point,o,v,t.tolerance):h===H.SelectionRegionType.Outline?H.MathUtil.isPointOnPolyline(t.point,o,t.tolerance):H.MathUtil.isPointOnPolyline(t.point,o.concat(o[0]),t.tolerance)||H.MathUtil.isPointInsidePolygon(t.point,o,t.tolerance)},K.prototype.yF=function(){return!0},K.prototype.intersectWithSegment=function(t,i,n,r,s,h){for(var u=this.getPoints(),o=[],e=new H.Line(s,h),f=0,c=u.length;f<c-1;f++){var a=u[f],v=u[f+1],v=new H.Line(new H.Point(a.x+t,a.y+i),new H.Point(v.x+t,v.y+i)),
v=H.Intersection.getIntersectionOfLines(v,e);v&&o.push(v)}return o},K.prototype.isPointInside=function(t,i,n,r,s,h){for(var u=[],o=this.getPoints(),e=0,f=o.length;e<f;e++){var c=o[e].clone();c.x+=t,c.y+=i,u.push(c)}return H.MathUtil.isPointInsidePolygon(s,u,h)};t=function(t,i,n,r){n!==H.LineDisplayOption.QuadraticCurve&&n!==H.LineDisplayOption.CubicCurve||(n=t.getSession())&&(n.l_=!0),t.polylineChanged()};Z.inheritedBy(K);var $=W.Property.define(K,"m_points","List",W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.AffectRender|W.PropertyFlags.SupportsDeepCopy|W.PropertyFlags.IsCollection),tt=W.Property.define(K,"m_lineDisplayOption",Number,W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.AffectRender|W.PropertyFlags.SupportsShallowCopy,t,t);function it(){nt.setRawValue(this,H.RepeatStartPositionOption.CENTER),rt.setRawValue(this,100),l.call(this)}K.dk=function(t,i,n,r){return function(t,i,n){for(var r=0,s=i.length;r<s;r++){var h=i[r];if(
H.MathUtil.isPointOnBezier(t,h,n))return!0}return!1}(t,Q(i,n),r)},K.pF=function(t,i,n,r){r=function(t,i,n){for(var r=null,s=0,h=0,u=i.length;h<u;h++){var o=i[h];s+=(u=o.length)-2;var e=null;if(!(s<n))if(n!==s||new H.Line(o[u-2],o[u-1]).isPointOnLine(t)){for(var f=0,c=0,a=0;a<u-1;a++){var v=new H.Line(o[a],o[a+1]);v.isPointOnLine(t)&&(f=o[a].distanceToPoint(t),f+=c),c+=v.getLength()}if(null!==(e=f/c)){r=H.MathUtil.getPointOnBezier(o,e);break}}}return r}(n,Q(t,i),r);if(r)return new H.Point(r.x,r.y)},K.MF=function(t,i,n,r){i=Q(t,i),i=r?i[i.length-1]:i[0];return H.MathUtil.getPointOnBezierByDistance(i,n,r,.1)},K.SF=function(t,i,n,r){var s=Q(t,i);if(1===s.length){var h=0;n&&(h=K.MF(t,i,n.getWidthValue(),!1).t);var u=1;r&&(u=K.MF(t,i,r.getWidthValue(),!0).t);for(var o=[],e=0,f=(d=H.MathUtil.splitBezier(s[0],h,u)).length;e<f;e++)o.push(new H.Point(d[e].x,d[e].y));return[o]}var c=[],a=[],v=[];if(n)for(var l=s[0],m=K.MF(t,i,n.getWidthValue(),!1),e=0,f=(d=H.MathUtil.splitBezier(l,m.t,1)
).length;e<f;e++)c.push(new H.Point(d[e].x,d[e].y));if(r)for(var d,l=s[s.length-1],m=K.MF(t,i,r.getWidthValue(),!0),e=0,f=(d=H.MathUtil.splitBezier(l,0,m.t)).length;e<f;e++)a.push(new H.Point(d[e].x,d[e].y));v.push(0<c.length?c:s[0]);for(e=1,f=s.length;e<f-1;e++)v.push(s[e]);return v.push(0<a.length?a:s[s.length-1]),v},it.prototype.setStartPosition=function(t){nt.setValue(this,t)},it.prototype.getStartPosition=function(){return nt.getValue(this)},it.prototype.setSpacedDistance=function(t){rt.setValue(this,t)},it.prototype.getSpacedDistance=function(){return rt.getValue(this)},it.prototype.setSpacedPercent=function(t){st.setValue(this,t)},it.prototype.getSpacedPercent=function(){return st.getValue(this)},it.prototype.setRepeatNumber=function(t){ht.setValue(this,t)},it.prototype.getRepeatNumber=function(){return ht.getValue(this)},it.prototype.setDefalutValue=function(t,i,n){nt.setRawValue(this,t),rt.setRawValue(this,i),st.setRawValue(this,n)},l.inheritedBy(it);var nt=W.Property.define(
it,"m_startPosition",Number,W.PropertyFlags.AffectRender|W.PropertyFlags.SupportsShallowCopy),rt=W.Property.define(it,"m_spacedDistance",Number,W.PropertyFlags.AffectRender|W.PropertyFlags.SupportsShallowCopy),st=W.Property.define(it,"m_spacedPercent",Number,W.PropertyFlags.AffectRender|W.PropertyFlags.SupportsShallowCopy),ht=W.Property.define(it,"m_repeatNumber",Number,W.PropertyFlags.AffectRender|W.PropertyFlags.SupportsShallowCopy);function ut(){z.call(this),et.setValue(this,H.ConnectionLabelPositionOption.NONE),at.setValue(this,H.ConnectionLabelOffsetUpdateMode.RESET_AFTER_CONNECTION_CHANGE)}it.getDefaultSetting=function(){var t=W.AppSession.workSheetSession;if(!t)return null;var i=t.lA;return i||(i=new it,t.lA=i),i},ut.prototype.setPlacementPosition=function(t){et.setValue(this,t)},ut.prototype.getPlacementPosition=function(){return et.getValue(this)},ut.prototype.setRepeat=function(t){ft.setValue(this,t)},ut.prototype.getRepeat=function(){return ft.getValue(this)},
ut.prototype.setRotationMode=function(t){ct.setValue(this,t)},ut.prototype.getRotationMode=function(){return ct.getValue(this)},ut.prototype.NF=function(t){var i=this.getRotationMode();return i=null==i&&null==(i=t.getOwningSheet().getPreferences().getConnectionLabelRotation())?H.ConnectionLabelRotationMode.RightReading:i},ut.prototype.setUserOffsetUpdateMode=function(t){at.setValue(this,t)},ut.prototype.getUserOffsetUpdateMode=function(){return at.getValue(this)};function ot(t){var i;"AuxDisplayLine"==t.getTypeName()?i=t.points:(a=t.getGeometry())&&(v=a.getPoints(),i=t.trimPathToNodes(v),t.Fk(i));var n=i.length;if(i&&0<n){for(var r=[],s=0,h=0;h<n-1;h++)s+=u=i[h+1].distanceToPoint(i[h]),r.push(u);for(var u,o=s/2,e=0,f=0,c=0,h=0;h<n-1;h++){if(o<e+(u=r[h])){f=h,c=o-e;break}e+=u}var a=i[f],v=i[f+1],t=0==H.MathUtil.doubleCompare(r[f],0)?0:c/r[f];return{x:a.x+(v.x-a.x)*t,y:a.y+(v.y-a.y)*t,segmentStartPoint:a,segmentEndPoint:v,segmentIdentifier:f}}}ut.prototype.getRepeatPoints=function(t,i,n,
r,s,h,u){var o=h,e=s,f=new H.Point(0,0);if(t)for(var c=0,a=0;c<t;){a==n.length-1&&(e=h);for(var v=1;a<n.length;++v){var l={},m=(b=(w=n[a]).getAngle())*Math.PI/180,d=w.start;if(l.x=d.x+v*i*Math.cos(m),l.y=d.y-v*i*Math.sin(m),f.x=l.x,f.y=l.y,w.isPointOnLine(f,o,e))u&&(l.angle=b,this.getRotationMode()===H.ConnectionLabelRotationMode.HFlipRightRotate&&(l.xFlip=!0),this.getRotationMode()===H.ConnectionLabelRotationMode.VFlipRightRotate&&(l.yFlip=!0),this.getRotationMode()===H.ConnectionLabelRotationMode.RightReading&&(l.rightReading=!0)),r.push(l),++c;else{if(w.isPointOnLine(f))continue;++a,v=0}if(t<=c)break;o=s}if(a>=n.length)break}else for(a=0;a<n.length;++a){a==n.length-1&&(e=h);for(var w,b,m=(b=(w=n[a]).getAngle())*Math.PI/180,d=w.start,v=1;;++v)if((l={}).x=d.x+v*i*Math.cos(m),l.y=d.y-v*i*Math.sin(m),f.x=l.x,f.y=l.y,w.isPointOnLine(new H.Point(l.x,l.y),o,e))u&&(l.angle=b,this.getRotationMode()===H.ConnectionLabelRotationMode.HFlipRightRotate&&(l.xFlip=!0),this.getRotationMode(
)===H.ConnectionLabelRotationMode.VFlipRightRotate&&(l.yFlip=!0),this.getRotationMode()===H.ConnectionLabelRotationMode.RightReading&&(l.rightReading=!0)),r.push(l);else if(!w.isPointOnLine(f))break;o=s}},ut.prototype.getDefaultPosition=function(t,i){var n=i||this.getConnection(t),r=this.getPlacementPosition();if(r){var s=void 0;if(n){if(r&H.ConnectionLabelPositionOption.REPEAT){var h,u=ft.getValue(this);if(!u)return;this.getRotationMode()!==H.ConnectionLabelRotationMode.NONE&&(h=!0);var o=[],e=u.getStartPosition(),f=u.getRepeatNumber(),c=u.getSpacedDistance(),a=u.getSpacedPercent(),i=t.getWidthValue(),u=t.getHeightValue(),u=.5*Math.max(i,u),v=u,l=u,m=this.getSession().getSheetConfigurationData().minSegmentLength+u,d=c+(a=a||0)*function(t){var i,n,r=0;"AuxDisplayLine"==t.getTypeName()?n=t.points:(i=t.getGeometry())&&(i=i.getPoints(),n=t.trimPathToNodes(i),t.Fk(n));var s=n.length;if(n&&0<s)for(var h=0;h<s-1;h++)r+=n[h+1].distanceToPoint(n[h]);return r}(n);if(!d)return o
;var w=new H.Point(0,0);if(e===H.RepeatStartPositionOption.CENTER){var b=n.nA(),_=ot(n),y=_.segmentIdentifier,c=_.x,a=_.y;if(f){for(var g=Math.round(.5*f),p=0,M=y;p<g;){for(;M<b.length;++M){var S=b[M],N=0;M!==y&&(_=S.start.clone(),N=1);for(var L=(O=S.getAngle())*Math.PI/180;p<g;++N)if((T={}).x=_.x+N*d*Math.cos(L),T.y=_.y-N*d*Math.sin(L),M==b.length-1&&(l=m),w.x=T.x,w.y=T.y,S.isPointOnLine(w,v,l))h&&(T.angle=O,this.getRotationMode()===H.ConnectionLabelRotationMode.HFlipRightRotate&&(T.xFlip=!0),this.getRotationMode()===H.ConnectionLabelRotationMode.VFlipRightRotate&&(T.yFlip=!0),this.getRotationMode()===H.ConnectionLabelRotationMode.RightReading&&(T.rightReading=!0)),o.push(T),++p;else if(!S.isPointOnLine(w))break;if(g<=p)break}if(M>=b.length)break}l=u,g=f-g,_.x=c,_.y=a;for(p=0,M=y;p<g;){for(;0<=M;--M){S=b[M];M!==y&&(_=S.end.clone());for(L=(O=S.getAngle())*Math.PI/180,N=1;p<g;++N)if((T={}).x=_.x-N*d*Math.cos(L),T.y=_.y+N*d*Math.sin(L),w.x=T.x,w.y=T.y,0==M&&(v=m),S.isPointOnLine(
new H.Point(T.x,T.y),v,l))h&&(T.angle=O,this.getRotationMode()===H.ConnectionLabelRotationMode.HFlipRightRotate&&(T.xFlip=!0),this.getRotationMode()===H.ConnectionLabelRotationMode.VFlipRightRotate&&(T.yFlip=!0),this.getRotationMode()===H.ConnectionLabelRotationMode.RightReading&&(T.rightReading=!0)),o.push(T),++p;else if(!S.isPointOnLine(w))break;if(g<=p)break}if(M<=0)break}v=u}else{for(M=y;M<b.length;++M){S=b[M],N=0;M!==y&&(_=S.start.clone(),N=1);for(L=(O=S.getAngle())*Math.PI/180;;++N)if((T={}).x=_.x+N*d*Math.cos(L),T.y=_.y-N*d*Math.sin(L),w.x=T.x,w.y=T.y,M==b.length-1&&(l=m),S.isPointOnLine(w,v,l))h&&(T.angle=O,this.getRotationMode()===H.ConnectionLabelRotationMode.HFlipRightRotate&&(T.xFlip=!0),this.getRotationMode()===H.ConnectionLabelRotationMode.VFlipRightRotate&&(T.yFlip=!0),this.getRotationMode()===H.ConnectionLabelRotationMode.RightReading&&(T.rightReading=!0)),o.push(T);else if(!S.isPointOnLine(w))break}l=u,_.x=c,_.y=a;for(M=y;0<=M;--M){S=b[M];M!==y&&(_=S.end.clone());for(
var O,T,L=(O=S.getAngle())*Math.PI/180,N=1;;++N)if((T={}).x=_.x-N*d*Math.cos(L),T.y=_.y+N*d*Math.sin(L),w.x=T.x,w.y=T.y,S.isPointOnLine(w,v=0==M?m:v,l))h&&(T.angle=O,this.getRotationMode()===H.ConnectionLabelRotationMode.HFlipRightRotate&&(T.xFlip=!0),this.getRotationMode()===H.ConnectionLabelRotationMode.VFlipRightRotate&&(T.yFlip=!0),this.getRotationMode()===H.ConnectionLabelRotationMode.RightReading&&(T.rightReading=!0)),o.push(T);else if(!S.isPointOnLine(w))break}v=u}}else if(e==H.RepeatStartPositionOption.START){if(!(b=n.nA())||b.length<1)return;this.getRepeatPoints(f,d,b,o,v,m,h)}else if(e==H.RepeatStartPositionOption.END){if(!(b=n.getReversedLines())||b.length<1)return;this.getRepeatPoints(f,d,b,o,v,m,h)}return o}if(r==H.ConnectionLabelPositionOption.START?s=function(t){var i;"AuxDisplayLine"==t.getTypeName()?r=t.points:(i=t.getGeometry())&&(n=i.getPoints(),r=t.trimPathToNodes(n));t=r.length;if(r&&0<t){var n=r[0],r=1==t?r[0]:r[1];return{x:n.x,y:n.y,segmentStartPoint:n,
segmentEndPoint:r,segmentIdentifier:0}}}(n):r===H.ConnectionLabelPositionOption.CENTER?s=ot(n):r===H.ConnectionLabelPositionOption.END?s=function(t){var i;"AuxDisplayLine"==t.getTypeName()?r=t.points:(i=t.getGeometry())&&(n=i.getPoints(),r=t.trimPathToNodes(n));t=r.length;if(r&&0<t){var n=r[t-1],r=1==t?r[t-1]:r[t-2];return{x:n.x,y:n.y,segmentStartPoint:r,segmentEndPoint:n,segmentIdentifier:t-2}}}(n):r!==H.ConnectionLabelPositionOption.CENTER_OF_LONGEST_SEGMENT&&r!==H.ConnectionLabelPositionOption.CENTER_OF_LONGEST_SEGMENT_HORIZONTAL&&r!==H.ConnectionLabelPositionOption.CENTER_OF_LONGEST_SEGMENT_VERTICAL||(s=function(t,i){var n=t.getGeometry();if(n){var n=n.getPoints(),r=t.trimPathToNodes(n);t.Fk(r);r.length;var s=r.length;if(0<s){var h=0,u=void 0,o=void 0;if(1==s)r[0].x,r[0].y,u=r[0],o=r[0];else for(var u=r[0],o=r[1],e=r[1].distanceToPoint(r[0]),f=1;f<s-1;f++){var c=r[f+1].distanceToPoint(r[f]);e<c?(e=c,u=r[h=f],o=r[f+1]):0===H.MathUtil.doubleCompare(c,e)&&(
i===H.ConnectionLabelPositionOption.CENTER_OF_LONGEST_SEGMENT_HORIZONTAL&&u.x===o.x&&r[f].y===r[f+1].y&&(e=c,u=r[h=f],o=r[f+1]),i===H.ConnectionLabelPositionOption.CENTER_OF_LONGEST_SEGMENT_VERTICAL&&u.y===o.y&&r[f].x===r[f+1].x&&(e=c,u=r[h=f],o=r[f+1]))}return{x:(u.x+o.x)/2,y:(u.y+o.y)/2,segmentStartPoint:u,segmentEndPoint:o,segmentIdentifier:h}}}}(n,r)),r&&(s.isHorizontal=s.segmentStartPoint.y===s.segmentEndPoint.y,(A=t.getLocation())&&A.getSegmentIdentifier()!==s.segmentIdentifier&&A.setSegmentIdentifier(s.segmentIdentifier)),n.vk()){var A=n.getConnectionRender().getPointsAfterTrim();if(2===A.length&&A[0].equal(A[1]))return s;n=n.getConnectionDisplayOption(),n=K.pF(A,n,new H.Point(s.x,s.y),s.segmentIdentifier);n&&(s.x=n.x,s.y=n.y)}}return s}},ut.prototype.rotationLabel=function(t,i,n){var r=this.NF(n);r==H.ConnectionLabelRotationMode.RightReading?0===H.MathUtil.doubleCompare(t.segmentStartPoint.y,t.segmentEndPoint.y)?n.setRotation(0):n.setRotation(-90
):r==H.ConnectionLabelRotationMode.AlongWithSegment&&(0===H.MathUtil.doubleCompare(t.segmentStartPoint.y,t.segmentEndPoint.y)?n.setRotation(0):t.segmentStartPoint.y>t.segmentEndPoint.y?n.setRotation(-90):n.setRotation(90))},ut.prototype.getConnection=function(t){if(t){var i=t.getOwner(),n=i.getTypeName();if("Connection"==n||"AuxDisplayLine"==n)return i;t=t.getLocation();return t?t.getReference():void 0}},ut.prototype.evaluate=function(t){var i=this.getDefaultPosition(t);if(this.getPlacementPosition()&H.ConnectionLabelPositionOption.REPEAT)return i;var n,r=t.getLocation();return i&&r&&(this.rotationLabel(i,r,t),n=r.getInputValueX(),t=r.getInputValueY(),i.isHorizontal||(r=n,n=t,t=r),i.x+=n||0,i.y+=t||0),i},ut.prototype.setDefaultValue=function(t,i,n,r){void 0!==t&&et.setRawValue(this,t),void 0!==i&&ft.setRawValue(this,i),void 0!==n&&ct.setRawValue(this,n),void 0!==r&&at.setRawValue(this,r)},ut.prototype.remove=function(){var t=ft.getValue(this);t&&(this.getSession().RA(t)||t.remove(),
this.setRepeat(void 0)),z.prototype.remove.call(this)};i=function(t,i,n,r){n&&t&&t.getOwner&&((t=t.getOwner(t))&&n&H.ConnectionLabelPositionOption.REPEAT&&(t.LF=!0))};z.inheritedBy(ut);var et=W.Property.define(ut,"m_placementPosition",Number,W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.AffectRender|W.PropertyFlags.SupportsShallowCopy,i,i),ft=W.Property.define(ut,"m_repeat","RepeatModeSetting",W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.AffectRender|W.PropertyFlags.SupportsShallowCopy),ct=W.Property.define(ut,"m_rotationMode",Number,W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.AffectRender|W.PropertyFlags.SupportsShallowCopy),at=W.Property.define(ut,"m_userOffsetUpdateMode",Number,W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.AffectRender|W.PropertyFlags.SupportsShallowCopy);function vt(t,i){a.call(this,t,i),mt.setRawValue(this,0),lt.setRawValue(this,0)}ut.getDefaultRule=function(
){var t=W.AppSession.workSheetSession;if(!t)return null;var i=t.fA;return i||(i=new ut,t.fA=i,ft.setRawValue(i,it.getDefaultSetting())),i},vt.prototype.updateInputValue=function(t,i){var n,r,s,h,u=this.getReference();if(u){var o=this.getOwner();if(this.getPlacementPosition()){var e=o.getPlacementRule();(e=e||ut.getDefaultRule())&&(d=e.getDefaultPosition(o));var f=this.KC,c=this.JC,a=0,v=0,l=this.getLocationRule();(l=l||o.getDefaultConnectionLocationRule())&&(a=(m=l.getEvaluatedPoint(this.getOwner(),this,f,c)).x-f,v=m.y-c);var o=(o=this.getInputValueX())||0,e=(e=this.getInputValueY())||0,l=0,m=0,m=d?(l=t-a-d.x,i-v-d.y):(l=t-a-f+o,i-v-c+e);return d&&!d.isHorizontal?(this.setInputValueX(m),this.setInputValueY(l)):(this.setInputValueX(l),this.setInputValueY(m)),void 0!==t&&(this.KC=t-a),void(void 0!==i&&(this.JC=i-v))}e=u.OF(this);if(!e||2!==e.length)return;var d=e[0],l=e[1],m=d.distanceToPoint(l),a=d.distanceToPoint(l),v=(l.y-d.y)/a,e=(l.x-d.x)/a;0<=v&&0<e?n=Math.asin(v
):0<v&&e<=0?n=Math.acos(e):v<=0&&e<0?n=Math.PI-Math.asin(v):v<0&&0<=e&&(n=Math.asin(v)),this.setRotation(180*n/Math.PI)}m&&(void 0!==t&&(l=this.getInput(H.CoordinateMode.PERCENT,H.Axis.X)||0,s=this.getInput(H.CoordinateMode.ABSOLUTE,H.Axis.X)||0,0<=v&&0<e?r=d.x+((t-d.x)*Math.cos(n)+(i-d.y)*Math.sin(n)):0<v&&e<=0?r=d.x-((t-d.x)*Math.cos(Math.PI-n)-(i-d.y)*Math.sin(Math.PI-n)):v<=0&&e<0?r=d.x-((t-d.x)*Math.cos(n-Math.PI)+(i-d.y)*Math.sin(n-Math.PI)):v<0&&0<=e&&(r=d.x+((t-d.x)*Math.cos(-n)-(i-d.y)*Math.sin(-n))),this.isLockY()?(a=(r-s-d.x)/m,this.setInputPercentX(a)):(s=r-(d.x+m*l),this.setInputValueX(s))),void 0!==i&&(this.getInput(H.CoordinateMode.PERCENT,H.Axis.Y),s=this.getInput(H.CoordinateMode.ABSOLUTE,H.Axis.Y)||0,0<=v&&0<e?h=d.y+((t-d.x)*Math.sin(n)-(i-d.y)*Math.cos(n)):0<v&&e<=0?h=d.y+((t-d.x)*Math.sin(Math.PI-n)+(i-d.y)*Math.cos(Math.PI-n)):v<=0&&e<0?h=d.y-((t-d.x)*Math.sin(n-Math.PI)-(i-d.y)*Math.cos(n-Math.PI)):v<0&&0<=e&&(h=d.y-((t-d.x)*Math.sin(-n)+(i-d.y)*Math.cos(-n))),
s=h-d.y,this.setInputValueY(s)))},vt.prototype.getSegmentIdentifier=function(){return lt.getValue(this)},vt.prototype.setSegmentIdentifier=function(t){W.common.ExceptionHelper.throwIfNegative(t,"segment Identifier"),lt.setValue(this,t),this.setUpToDate(!1)},vt.prototype.rF=function(){var t=[],i=this.getReference();if(i){var n=i.getConnectionRender();if(n){i=n.getPointsAfterTrim();if(i&&!(i.length<2)){n=this.getSegmentIdentifier();return n>i.length-2&&(n=i.length-2),t.push(i[n]),t.push(i[n+1]),t}}}};vt.prototype.setRotation=function(t){mt.setValue(this,t)},vt.prototype.getRotation=function(){return mt.getValue(this)},vt.prototype.setMarginToPoints=function(t){dt.setValue(this,t)},vt.prototype.getMarginToPoints=function(){return dt.getValue(this)},vt.prototype.getEvaluatedLocation=function(){var t=a.prototype.getEvaluatedLocation.call(this),i=this.getLocationRule(),n=this.getOwner();return(i=i||n.getDefaultConnectionLocationRule())?i.getEvaluatedPoint(this.getOwner(),this,t.x,t.y):t},
vt.prototype.setEvaluatedLocation=function(t,i,n){var r=this.getReference();if(r&&r.getConnectionRender){r=r.getConnectionRender(r);if(r){var s=r.getPointsAfterTrim();if(s&&2<=s.length)for(var h=s.length,u=new H.Point(t,i),o=0;o<h-1;o++){var e=s[o],f=s[o+1];if(f.equal(u)){H.MathUtil.doubleCompare(e.y,f.y),lt.setValue(this,o);break}if(new H.Line(e,f).isPointOnLine(u)){lt.setValue(this,o);break}}}}(n=void 0===n||n)&&this.getPlacementPosition()?this.updateInputValue(t,i):a.prototype.setEvaluatedLocation.call(this,t,i,n)},vt.prototype.aF=function(t,i){var n,r,s=i[0],h=i[1],u=new H.Vector(h.x-s.x,h.y-s.y).normalize(),o=s.distanceToPoint(h),e=this.getOwner(),f=e&&e.getLocationCoordinateMode()===H.ElementCoordinateMode.Device,c=e&&e.getSizeCoordinateMode()===H.ElementCoordinateMode.Device,a=t&&t.getLocationCoordinateMode()===H.ElementCoordinateMode.Device,v=t&&t.getSizeCoordinateMode()===H.ElementCoordinateMode.Device,i=this.getInput(H.CoordinateMode.PERCENT,H.Axis.X)||0,h=(this.getInput(
H.CoordinateMode.PERCENT,H.Axis.Y),this.getInput(H.CoordinateMode.ABSOLUTE,H.Axis.X)||0),e=this.getInput(H.CoordinateMode.ABSOLUTE,H.Axis.Y)||0,t=u.clone();f&&c&&!a&&!v?(n=H.MathUtil.getExtensionPoint(s,t,o*i),(r=((r=this.getSession().getSheetConfigurationData().viewData).vF()||r.getSheetToViewXform()).transformPoint(n).clone()).x+=h,r.y+=e):(n=H.MathUtil.getExtensionPoint(s,t,o*i+h),t.rotate(-Math.PI/2),t.round(),r=H.MathUtil.getExtensionPoint(n,t,e));e=0;return 0<o&&(e=u.angle(H.Vector.PositiveX),u.y<0&&(e=2*Math.PI-e)),{angle:e,point:r}},vt.prototype.evaluate=function(){if(this.isUpToDate())this.hF&&(this.hF=!1);else{var t=this.getSession();if(!t||!t.isInUpdateProcess()){var i=this.getReference();if(i){var n=i.OF(this);if(n&&2===n.length){if(this.hF)return this.setUpToDate(!0),void(this.hF=!1);if(i){var r=this.getOwner();if(r&&r.getPlacementRule){t=r.getPlacementRule();if(t=!t&&r.kN?ut.getDefaultRule():t){r=t.evaluate(r);if(r)return this.KC=r.x,this.JC=r.y,this.setEvaluatedX(this.KC
),this.setEvaluatedY(this.JC),void this.setUpToDate(!0)}}}i=this.aF(i,n),n=i.angle,i=i.point;this.setRotation(180*n/Math.PI),a.prototype.setEvaluatedLocation.call(this,i.x,i.y,!1),this.setUpToDate(!0)}}else this.fF()}}},vt.prototype.getPlacementPosition=function(){var t=this.getOwner();if(t&&t.getPlacementRule)return(t.getPlacementRule()||ut.getDefaultRule()).getPlacementPosition()},vt.prototype.tk=function(){return{isLockX:!1,isLockY:!1}},a.inheritedBy(vt);var lt=W.Property.define(vt,"m_segmentIdentifier",Number,W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.SupportsShallowCopy),mt=W.Property.define(vt,"m_rotation",Number,W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.SupportsShallowCopy,function(t,i,n,r){t=t.getOwner();t&&t.setTransformUpdate&&t.setTransformUpdate(!0)}),dt=W.Property.define(vt,"m_marginToPoints",Number,W.PropertyFlags.SupportsShallowCopy);function wt(t){V.call(this),kt.setRawValue(this,0),Bt.setRawValue(this,!0),
xt.setRawValue(this,!1),this.setAnchorX(0),this.setAnchorY(0),this.TF=[],this.z0=!0,this.g5=0,this.M5=0,this.AF=18,this.top=0,this.left=0,this.bottom=0,this.right=0,t&&Et.setRawValue(this,t)}wt.prototype.addAnnotaion=function(t){this.TF.indexOf(t)<=0&&this.TF.push(t)},wt.prototype.getAlignment=function(){return Tt.getValue(this)},wt.prototype.Kk=function(t){var i;return null==(i=this.getAlignment())&&(t&&t.getOwner&&null!==(i=t.getOwner().PF())||(i=H.TextAlignment.LEFT)),i},wt.prototype.setAlignment=function(t){Tt.setValue(this,t)},wt.prototype.getCase=function(){return Ct.getValue(this)},wt.prototype.setCase=function(t){Ct.setValue(this,t)},wt.prototype.getIndent=function(){return kt.getValue(this)},wt.prototype.setIndent=function(t){W.common.ExceptionHelper.throwIfNegative(t,"indent"),kt.setValue(this,t)},wt.prototype.getText=function(){return Et.getValue(this)},wt.prototype.setText=function(t){Et.setValue(this,t)},wt.prototype.getTextAttr=function(){return Et.getValue(this)},
wt.prototype.setTextAttr=function(t){this.setText(t)},wt.prototype.getRenderingString=function(){var t=Dt.getValue(this);return t||""},wt.prototype.setRenderingString=function(t){Dt.setValue(this,t)},wt.prototype.getObservers=function(){return Rt.getValue(this)},wt.prototype.setObservers=function(t){Rt.setValue(this,t)},wt.prototype.addObserver=function(t){var i;t&&((i=this.getObservers())?i.push(t):this.setObservers([t]))},wt.prototype.removeObserver=function(t){var i;t&&(!(i=Rt.getValue(this))||0<=(t=i.indexOf(t))&&i.splice(t,1))};function bt(t,i,n){var r=n&H.TextStyleType.Bold,s=n&H.TextStyleType.Italic,h=n&H.TextStyleType.Underline,u=n&H.TextStyleType.Overline,n="<text style='";return t&&(n=n+"font-family:"+t+";"),i&&(n=n+"font-size:"+i+";"),r&&(n+="font-weight:bold;"),s&&(n+="font-style:italic;"),{prefix:n+=h&&u?"text-decoration:underline overline;'>":h?"text-decoration:underline;'>":u?"text-decoration:overline;'>":"'>",suffix:"</text>"}}function _t(t){var i=t.split("\n")
;return i=1==i.length?t.split("\\n"):i}function yt(t,i,n,r){if(i=void 0===i?t.getTextAttr():i){i=function(t){var i=[];i.push({before:/a href/g,after:"a xlink:href"});var n=t;return i.forEach(function(t){n=n.replace(t.before,t.after)}),n}(i);var s=t.getIndent();i=w=(w=d=i)?d.replace(/[ ><]/g,function(t){var i=t;return" "===t?i="&nbsp;":">"===t?i="&gt;":"<"===t&&(i="&lt;"),i}):w;var h=_t(i),u=h.length,o=function(t,i){switch(t.Kk(i)){case H.TextAlignment.CENTER:case H.TextAlignment.MIDDLE:return"text-anchor='middle'";case H.TextAlignment.RIGHT:case H.TextAlignment.END:return"text-anchor='end'";default:return""}}(t,r),e="",r=t.getRenderingTextHeightFactors(),f=r.capHeightFactor/2+.5;if(1==u)e="<tspan dy='"+f+"em'"+o+" >"+i+"</tspan>";else for(var c,a=0,v=0,l=1+r.lineGapFactor,m=0;m<u;m++)""!=h[m]?(c=" dy='"+((0==m?f:l)+v*l)+"em'",s&&a<t.CF.length&&m===t.CF[a]?(a++,e+="<tspan "+o+" x='{textboxRef_indent.xPos}' INDENT = '"+s+"' "+c+">"+h[m]+"</tspan>"
):e+="<tspan "+o+" x='{textboxRef.xPos}'"+c+">"+h[m]+"</tspan>",v=0):v++;e=n.prefix+e+n.suffix,t.setRenderingString(e)}else t.setRenderingString("");var d,w}function gt(n){var r="";return["class","font-family","font-size","font-weight","font-style"].forEach(function(t){var i=n[t];i&&(r=r+t+":"+i+";")}),r}function pt(t,i,n){var r="suffix:"+t+i;return(i=St[r])?i:(n=H.CommonUtil.measureTextSize(t,n).width,St[r]=n)}function Mt(t,i,n,r,s,h){var u=r||H.CommonUtil.measureTextSize(t,n).width;return.1<(u-i)/i&&(r=Math.floor(t.length*i*1.1/u),t=t.slice(0,r-t.length),u=H.CommonUtil.measureTextSize(t,n).width),i<u&&1<t.length&&(i=u-i,0<(n=(s||pt("...",gt(n),n))/3)&&(0<(n=Math.round(i/n))&&(t=t.slice(0,0-n)))),h&&(t+=h),t}var St={};wt.prototype.kF=function(t,i,n,r){var s=this.getRenderingTruncationMode();if(!s)return t;var h="",u=0;switch(s){case H.TextTruncationMode.NoTruncation:break;case H.TextTruncationMode.AddSuffix:var h="...",o=this.getSession();u=o?o.YA(h,n).width:pt(h,gt(n),n),t=Mt(t,i-=u,
n,r,u,h);break;case H.TextTruncationMode.Trim:t=Mt(t,i,n,r,u,h)}return t},wt.prototype.getSize=function(t,i,n,r){if(!this.z0||!this.width||!this.height||0!==H.MathUtil.doubleCompare(this.width,i)){var s={};t&&(s=t.getAttributes());var h=this.getRenderingTextHeightFactors(),u=this.BF(r);u?(this.top=u.getTopValue(a,c),this.left=u.getLeftValue(a,c),this.bottom=u.getBottomValue(a,c),this.right=u.getRightValue(a,c)):(this.top=0,this.left=0,this.bottom=0,this.right=0);var o=this.vL(r),e=this.xF(r),f=[],c=0,a=0;this.CF=[];for(var v=this.getIndent(),l=this.getTextAttr(),m=_t(l=null==l?"":l),d=m.length,w=0;w<d;w++)""==m[w]&&(m[w]=" ");i||(o=H.TextBoxAutoFitType.RESIZE_OUTLINE,e=!1),this.AF=0;var b=this.getMaxWidth();if(0<b&&o&&!e&&1===d){var _=m[0],l=H.CommonUtil.measureTextSize(_,s);l.width>b?(f.push(this.kF(_,b,s,l.width)),this.g5=a=b):(this.g5=a=l.width,f=m),this.AF=l.height,this.M5=c=l.height}else if(o){i>this.left+this.right&&(i=i-this.left-this.right);var y=0;if(e){for(var g,p=0,
w=0;w<d;w++){0==(L=(N=(T=H.CommonUtil.wrapText(m[w],i,v,s)).textArray).length)?y++:(y+=L,g=T.height/L,this.AF=Math.max(this.AF,g)),c+=T.height,p=p>T.width?p:T.width,this.CF.push(f.length);for(var M=0;M<L;M++)f.push(N[M])}this.g5=a=p}else{for(w=0;w<d;w++){var S=H.CommonUtil.measureTextSize(m[w],s);this.AF=Math.max(this.AF,S.height),y++,c+=S.height,this.g5=a=a>S.width?a:S.width}f=m}c=s["font-size"]&&1<y?this.AF+(y-1)*(1+h.lineGapFactor)*parseFloat(s["font-size"]):this.AF*y,this.M5=c}else{if(!this.getSession())return;if(a=i=i>this.left+this.right?i-this.left-this.right:i,c=n=n>this.top+this.bottom?n-this.top-this.bottom:n,e){for(var N,L,y=0,w=0;w<d;w++){0<(L=(N=(T=H.CommonUtil.wrapText(m[w],i,v,s)).textArray).length)?(this.AF=Math.max(this.AF,T.height/L),y+=L):0===L&&y++,this.g5=Math.max(this.g5,T.width),this.CF.push(f.length);for(M=0;M<L;M++)f.push(N[M])}s["font-size"]?this.M5=1<y?this.AF+(y-1)*(1+h.lineGapFactor)*parseFloat(s["font-size"]):this.AF*y:this.M5=y*this.AF}else for(
var O=this.getRenderingTruncationMode(),w=this.M5=0;w<d;w++){var T,A,P=m[w];0==O?(S=H.CommonUtil.measureTextSize(m[w],s),this.AF=Math.max(this.AF,S.height),this.g5=Math.max(this.g5,S.width),this.M5+=S.height):(P=(T=H.CommonUtil.trimText(m[w],i,s)).text,this.AF=Math.max(this.AF,T.height),this.g5=Math.max(this.g5,T.width),this.M5+=T.height,2==O&&(A=P.length,P!=m[w]&&3<A&&(P=P.substr(0,A-3)+"..."))),s["font-size"]&&1<d&&(this.M5=this.AF+(d-1)*(1+h.lineGapFactor)*parseFloat(s["font-size"])),f.push(P)}}u&&(this.top=u.getTopValue(a,c),this.left=u.getLeftValue(a,c),this.bottom=u.getBottomValue(a,c),this.right=u.getRightValue(a,c));for(var C=f.length,w=0;w<C;w++)"&nbsp;"!=f[w]&&" "!=f[w]||(f[w]="");e=f.join("\n");this.EF=t,yt(this,e,(u=this.EF,t=u.getFontFamily?u.getFontFamily():"",e=u.getFontSize?u.getFontSize():"",u=u.getStyle?u.getStyle():0,bt(t,e,u)),r),this.width=this.left+a+this.right,this.height=this.top+c+this.bottom,this.z0=!0}return[this.width,this.height]},
wt.prototype.setTextString=function(t,i){if(Et.getValue(this)!==t){if(i){i=this.getSession();if(i){i=i.yA.handleTextChange(this,t,i);if(null===i)return;t=i}}return Et.setValue(this,t),!1}},wt.prototype.getTextString=function(){var t=Et.getValue(this);return t||""},wt.prototype.isModifiable=function(){return Bt.getValue(this)},wt.prototype.setIsModifiable=function(t){Bt.setValue(this,t)},wt.prototype.isShadowBox=function(){return xt.getValue(this)},wt.prototype.setShadowBox=function(t){xt.setValue(this,t)},wt.prototype.isWrappable=function(){return At.getValue(this)},wt.prototype.getAllowWrapping=function(){return At.getValue(this)},wt.prototype.xF=function(t){var i;return null==(i=this.getAllowWrapping())&&(t&&t.getOwner&&null!==(i=t.getOwner().DF())||(i=!0)),i},wt.prototype.setAllowWrapping=function(t){At.setValue(this,t)},wt.prototype.getAutoFit=function(){return Pt.getValue(this)},wt.prototype.vL=function(t){var i;return null==(i=this.getAutoFit())&&(t&&t.getOwner&&null!==(
i=t.getOwner().RF())||(i=H.TextBoxAutoFitType.RESIZE_OUTLINE)),i};function Nt(t){var i;return i=t&&0<t.length?new H.Margin(t[0],t[1],t[2],t[3]):i}wt.prototype.BF=function(t){var i=this.getMargin();return null==i&&(!t||(t=t.getOwner())&&(t=t.FF(),i=Nt(t))),i},wt.prototype.setAutoFit=function(t){Pt.setValue(this,t)},wt.prototype.getMaxWidth=function(){return Ft.getValue(this)},wt.prototype.setMaxWidth=function(t){Ft.setValue(this,t)},wt.prototype.setMargin=function(t){t=[t.top,t.left,t.bottom,t.right];Wt.setValue(this,t)},wt.prototype.getMargin=function(){var t=Wt.getValue(this);return Nt(t)},wt.prototype.getMarginArray=function(){return Wt.getValue(this)},wt.prototype.setMarginArray=function(t){Wt.setValue(this,t)},wt.prototype.setTruncationMode=function(t){It.setValue(this,t)},wt.prototype.getTruncationMode=function(){return It.getValue(this)},wt.prototype.getRenderingTruncationMode=function(){var t,i=this.getTruncationMode();return!(null==i||i<0)||(t=this.getSession())&&(
i=t.getSheetConfigurationData().truncationMode),i},wt.prototype.getRenderingTextHeightFactors=function(){var t=.2,i=.7,n=this.getSession();return n&&(t=(n=n.getSheetConfigurationData()).defaultTextBoxLineGapFactor,i=n.defaultTextCapHeightFactor),{lineGapFactor:t,capHeightFactor:i}},wt.prototype.getAnchor=function(){var t=V.prototype.getAnchor.call(this),i=this.getSession();return i&&i.NA&&(i=this.getRenderingTextHeightFactors(),t.anchorY=t.anchorY*i.capHeightFactor),t},wt.prototype.getDefaultRenderingProperties=function(){return this.getSession().PA.textRenderProperties},wt.prototype.IF=function(){for(var t=this.TF.length,i=0;i<t;i++){var n=this.TF[i];n.hL=!0,n.nL=!0,n.setUpToDate(!1)}var r=this.getObservers();if(r)for(var s=r.length,h=0;h<s;h++)r[h].evaluate()};function Lt(t){var i=t.indexOf("</tspan>")===t.lastIndexOf("</tspan>"),t=-1!==t.indexOf("text-decoration");return i&&!t}function Ot(t,i,n){t.z0||(i=i?bt(i.fontFamily,i.fontsize,i.fontStyle):{prefix:"<text>",suffix:"</text>"},
yt(t,t.getTextString(),i,n),t.z0=!0)}wt.prototype.ik=function(t,i,n){Ot(this,i,n);var r=this.getRenderingString();!Lt(r)&&t.preRenderSvgText&&(i.textLineHeight=this.AF,n=this.Kk(n),i.horizontalAlign=n||H.TextAlignment.START,i.textAnchor[0],i.textAnchor[1],i.textAnchor[0]+=this.left,i.textAnchor[1]+=this.top,i.width=i.width-this.left-this.right,i.height=i.height-this.top-this.bottom,t.preRenderSvgText(r,this,i))},wt.prototype.render=function(t,i,n){i.textLineHeight=this.AF;var r=this.Kk(n);i.horizontalAlign=r||H.TextAlignment.START,Ot(this,i,n);var s=this.getRenderingString(),h=Lt(s),r=t.isImmediateRender&&h?this.getTextAttr():s,n=i.textAnchor[0],s=i.textAnchor[1];i.textAnchor[0]+=this.left,i.textAnchor[1]+=this.top,i.width=i.width-this.left-this.right,i.height=i.height-this.top-this.bottom,t.isImmediateRender?h?(h=i.textAnchor[1],i.textAnchor[1]+=.7*i.textLineHeight,t.renderText(r,i),i.textAnchor[1]=h):t.renderSvgText(r,this,i):t.renderText(r,i),i.textAnchor[0]=n,i.textAnchor[1]=s},
wt.prototype.updateRender=function(t,i,n){i.textLineHeight=this.AF;var r=this.Kk(n);i.horizontalAlign=r||H.TextAlignment.START;var s=i.textAnchor[0],h=i.textAnchor[1];i.textAnchor[0]+=this.left,i.textAnchor[1]+=this.top,i.width=i.width-this.left-this.right,i.height=i.height-this.top-this.bottom,Ot(this,i,n);r=t.isImmediateRender?this.getTextAttr():this.getRenderingString();t.updateRenderText(r,i,n),i.textAnchor[0]=s,i.textAnchor[1]=h},wt.prototype.setSizeOutOfDate=function(){this.z0=!1,this.IF()},wt.prototype.onRenderingPropertiesChanged=function(t,i,n){this.setSizeOutOfDate()},wt.prototype.remove=function(){var t=this.getObservers();if(t)for(var i=t.length-1;0<=i;i--)t[i].remove(!0);V.prototype.remove.call(this)},wt.prototype.jL=function(){return!0},V.inheritedBy(wt);var v=function(t,i,n,r){t.setSizeOutOfDate()},Tt=W.Property.define(wt,"m_alignment",Number,W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.AffectRender|W.PropertyFlags.SupportsShallowCopy,v),
At=W.Property.define(wt,"m_allowWrapping",Boolean,W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.AffectRender|W.PropertyFlags.SupportsShallowCopy,v),Pt=W.Property.define(wt,"m_autoFit",Number,W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.AffectRender|W.PropertyFlags.SupportsShallowCopy,v),Ct=W.Property.define(wt,"m_case",String,W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.AffectRender|W.PropertyFlags.SupportsShallowCopy,v),kt=W.Property.define(wt,"m_indent",Number,W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.AffectRender|W.PropertyFlags.SupportsShallowCopy,v),Bt=W.Property.define(wt,"m_isModifiable",Boolean,W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.SupportsShallowCopy),xt=W.Property.define(wt,"m_shadowBox",Boolean,W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.AffectRender|W.PropertyFlags.SupportsShallowCopy,v),
Et=W.Property.define(wt,"m_textAttr",String,W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.AffectRender|W.PropertyFlags.SupportsShallowCopy,v,v),Dt=W.Property.define(wt,"m_renderingString",String,W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.AffectRender|W.PropertyFlags.SupportsShallowCopy),Rt=W.Property.define(wt,"m_observers",Array,W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.SupportsShallowCopy),Ft=W.Property.define(wt,"m_maxWidth",Number,W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.AffectRender|W.PropertyFlags.SupportsShallowCopy,v),It=W.Property.define(wt,"m_truncationMode",Number,W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.AffectRender|W.PropertyFlags.SupportsShallowCopy,v),Wt=W.Property.define(wt,"m_marginArray",Array,W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.AffectRender,v),Ht={None:0,Selected:1,Aligned:2,Preview:4,
Hover:8,Focused:16,NodePreview:32,SecondaryHover:64,SecondarySelect:128,ChildrenSelected:256,MovePreview:512,CopyPreview:1024,DropHighlight:2048,EntireConnectionHover:4096,ColoringHighlight:8192};function jt(t,i,n,r){l.call(this),this.WF=0,this.HF=0,this.hL=!1,this.nL=!1,this.jF=!1,this.IR=new H.Point(0,0),this.zF=H.Matrix.identity,this.QC=null,this.VF=null,this.nO=null,this.zD=!1,Qt.setRawValue(this,!0),void 0!==n&&Kt.setRawValue(this,n),i?(Ut.setValue(this,H.SizingPolicy.LENGTH),Zt.setValue(this,i),this.HF=i):Ut.setValue(this,H.SizingPolicy.INHERIT),Jt.setRawValue(this,0),t?(Gt.setValue(this,H.SizingPolicy.LENGTH),qt.setValue(this,t),this.WF=t):Gt.setValue(this,H.SizingPolicy.INHERIT),this.eventListeners={}}jt.prototype.getXform=function(){var t,i,n,r,s;return this.jF&&(s=H.Matrix.identity,0===(t=this.getRotation())||void 0===t||(i=this.getAnchor())&&(n=this.getWidthValue(),r=this.getHeightValue(),s=s.rotateAt(t,n*i.x,r*i.y)),this.zF=s,this.jF=!1),this.zF},
jt.prototype.setRotation=function(t){W.common.ExceptionHelper.throwIfNegative(t,"m_rotation"),Jt.setValue(this,t),this.jF=!0},jt.prototype.getRotation=function(){return Jt.getValue(this)},jt.prototype.getLocation=function(){return Xt.getValue(this)},jt.prototype.getAnchorPosition=function(){var t=Xt.getValue(this);if(t)return t.getEvaluatedLocation();t=this.getOwner();return t?t.getRenderingPosition():void 0},jt.prototype.getRenderingPosition=function(){var t,i,n=Xt.getValue(this);return n?i=n.getEvaluatedLocation():(t=this.getOwner())&&(i=t.getRenderingPosition()),n instanceof vt&&(t=this.WF,n=this.HF,t=i.x-t*this.IR.x,n=i.y-n*this.IR.y,i=new H.Point(t,n)),i},jt.prototype.YF=function(t,i){var n=t;return i instanceof vt&&(t=this.WF,i=this.HF,t=n.x-t*this.IR.x,i=n.y-i*this.IR.y,n=new H.Point(t,i)),n},jt.prototype.setLocation=function(t){Xt.setValue(this,t),t&&t.setOwner&&t.setOwner(this)},jt.prototype.setWidthPolicy=function(t){W.common.ExceptionHelper.throwIfNegative(t,"m_widthPolicy")
,Gt.setValue(this,t),this.hL=!0,this.jF=!0},jt.prototype.getWidthPolicy=function(){return Gt.getValue(this)},jt.prototype.setHeightPolicy=function(t){W.common.ExceptionHelper.throwIfNegative(t,"m_heightPolicy"),Ut.setValue(this,t),this.nL=!0,this.jF=!0},jt.prototype.getHeightPolicy=function(){return Ut.getValue(this)};function zt(t){var i;t.XF?t.XF.evaluate():(i=qt.getValue(t),i=H.CommonUtil.evaluateSize(t,H.Axis.X,i),t.WF=i,t.hL=!1,t.jF=!0)}function Vt(t){var i;t.XF?t.XF.evaluate():(i=Zt.getValue(t),i=H.CommonUtil.evaluateSize(t,H.Axis.Y,i),t.HF=i,t.nL=!1,t.jF=!0)}jt.prototype.setWidth=function(t){this.XF||(W.common.ExceptionHelper.throwIfNegative(t,"m_width"),qt.setValue(this,t),this.hL=!0,this.jF=!0)},jt.prototype.getWidth=function(){return qt.getValue(this)},jt.prototype.setHeight=function(t){this.XF||(W.common.ExceptionHelper.throwIfNegative(t,"m_height"),Zt.setValue(this,t),this.nL=!0,this.jF=!0)},jt.prototype.getHeight=function(){return Zt.getValue(this)},
jt.prototype.setWidthValue=function(t){W.common.ExceptionHelper.throwIfNegative(t,"m_width"),qt.setValue(this,t);t=H.CommonUtil.evaluateSize(this,H.Axis.X,t);this.WF=t,this.jF=!0},jt.prototype.getWidthValue=function(){return this.hL&&zt(this),this.WF},jt.prototype.setHeightValue=function(t){W.common.ExceptionHelper.throwIfNegative(t,"m_height"),Zt.setValue(this,t);t=H.CommonUtil.evaluateSize(this,H.Axis.Y,t);this.HF=t,this.jF=!0},jt.prototype.getHeightValue=function(){return this.nL&&Vt(this),this.HF},jt.prototype.setSymbol=function(t){Kt.setValue(this,t);t=this.getOwner();t&&t.updateAnchor&&t.updateAnchor()},jt.prototype.getSymbol=function(){return Kt.getValue(this)},jt.prototype.setVisible=function(t){Qt.setValue(this,t)},jt.prototype.isVisible=function(){return Qt.getValue(this)},jt.prototype.setPlacementRule=function(t){ii.setValue(this,t),t&&this.getSession().DA(t)},jt.prototype.getPlacementRule=function(){return ii.getValue(this)},jt.prototype.setOwner=function(t){
var i=this.getOwner();i&&t&&i.guid===t.guid||(l.prototype.setOwner.call(this,t),this.hL=!0,this.nL=!0,this.jF=!0)},jt.prototype.getRenderingProperties=function(){var t=$t.getValue(this);if(t)return t;t=new T;return $t.setValue(this,t),t},jt.prototype.containRenderingProperties=function(){return!!$t.getValue(this)},jt.prototype.Jk=function(){var t=$t.getValue(this);if(t)return t;t=this.getOwner();if(t&&t.getDefaultRenderingProperties){var i=t.getDefaultRenderingProperties();if(i)return i}i=Kt.getValue(this);return i?i.getDefaultRenderingProperties():this.getSession().PA.symbolRenderProperties},jt.prototype.setRenderingProperties=function(t){$t.setValue(this,t)};jt.prototype.getDefaultConnectionLocationRule=function(){return null},jt.prototype.getSymbolSize=function(){this.hL&&zt(this),this.nL&&Vt(this);var t,i=void 0,n=this.getSymbol();return n&&n.getSize&&(t=this.Jk(),i=n.getSize(t,this.WF,this.HF,this)),i},jt.prototype.getSize=function(){this.hL&&zt(this),this.nL&&Vt(this)
;var t=this.getSymbolSize();return t&&(this.WF=t[0],this.HF=t[1]),[this.WF,this.HF]},jt.prototype.setSize=function(t,i){this.setWidthValue(t),this.setHeightValue(i)},jt.prototype.getRenderingBBox=function(t,i){var n=Xt.getValue(this);n?(s=n.getEvaluatedLocation(),!n.getReference()&&t&&(s.x=s.x+t.x,s.y=s.y+t.y)):s=t?new H.Point(t.x,t.y):new H.Point(0,0),this.hL&&zt(this),this.nL&&Vt(this);var r=this.WF,n=this.HF,s=new H.Rect(s.x,s.y,r,n),r=this.getXform(),n=new H.Rect(0,0,s.width,s.height),n=r.transformRect(n);s.x+=n.x,s.y+=n.y,s.width=n.width,s.height=n.height;r=this.getOwner().getXform(),n=new H.Rect(s.x-t.x,s.y-t.y,s.width,s.height),n=r.transformRect(n);return s.x=n.x+t.x,s.y=n.y+t.y,s.width=n.width,s.height=n.height,i||(i=this.Jk())&&(i=i.getStrokeWidth(),s.x-=i/2+.5,s.y-=i/2+.5,s.width+=i+1,s.height+=i+1),s};function Yt(t,i,n,r){!t.isChangeColorOnSelection()||(i=i.getSelectionColor())&&(r.fillColor&&0!==r.fillColor.alpha&&(r.fillColor=i),r.strokeColor&&0!==r.strokeColor.alpha&&(
r.strokeColor=i),t.isHighlightWithThickWidth()&&(r.lineWidth=n>r.lineWidth?n:r.lineWidth+1),r.renderReason=r.renderReason|H.RenderReason.RenderingPropertiesChange)}jt.prototype.GF=function(t,i,n){this.hL&&zt(this),this.nL&&Vt(this);var r,s=this.WF,h=this.HF,u=this.getOwner(),o=this.isVisible()&&u.isVisible(),e=this.Jk();if(n?r=e.toRenderStyle():(r=this.QC)?(e.toRenderStyle(r),r.width===s&&r.height===h||(r.renderReason=r.renderReason|H.RenderReason.SizeChange),i.getM6()===r.transform.getM6()&&i.getM4()===r.transform.getM4()||(r.renderReason=r.renderReason|H.RenderReason.LocationChange),r.T5!==o&&(r.renderReason=r.renderReason|H.RenderReason.VisibilityChange)):r=this.QC=e.toRenderStyle(),r.transform=i,r.occurrenceId=this.guid,r.width=s,r.height=h,r.T5=!!o,u){n=u.XM(),e=u.inCreationContext?(n=Ht.Preview,!0):(n&Ht.Preview)==Ht.Preview;if(e&&(r.renderReason=r.renderReason|H.RenderReason.Preview),n===Ht.None)return r;var f,i=this.session.getSheetConfigurationData(),
s=i.selectionPreferencesData,h=i.visualizationPreferencesData,o=i.selectionPreferencesData.highlightThickWidth;if(n&Ht.Hover||n&Ht.SecondaryHover){if(i.contextData.isViewOnlyMode()&&(n&Ht.Selected||n&Ht.SecondarySelect))return Yt(s,h,o,r),r;s.isHighlightSelectionOnRollover()&&(f=h.getPreSelectionColor())&&(r.fillColor&&0!==r.fillColor.alpha&&(r.fillColor=f),r.strokeColor&&0!==r.strokeColor.alpha&&(r.strokeColor=f),s.isHighlightWithThickWidth()&&(r.lineWidth=o>r.lineWidth?o:r.lineWidth+1),r.renderReason=r.renderReason|H.RenderReason.RenderingPropertiesChange)}else if(e){if(!i.highlightOnPreview)return r;(f=h.getPreSelectionColor())&&(r.fillColor&&0!==r.fillColor.alpha&&(r.fillColor=f),r.strokeColor&&0!==r.strokeColor.alpha&&(r.strokeColor=f),s.isHighlightWithThickWidth()&&(r.lineWidth=o>r.lineWidth?o:r.lineWidth+1),r.renderReason=r.renderReason|H.RenderReason.RenderingPropertiesChange)}else n&Ht.Selected||n&Ht.SecondarySelect?Yt(s,h,o,r):n&Ht.DropHighlight?function(t,i,n,r){
i=i.getDropHighlightColor();i&&(r.fillColor&&0!==r.fillColor.alpha&&(r.fillColor=i),r.strokeColor&&0!==r.strokeColor.alpha&&(r.strokeColor=i),t.isHighlightWithThickWidth()&&(r.lineWidth=n>r.lineWidth?n:r.lineWidth+1),r.renderReason=r.renderReason|H.RenderReason.RenderingPropertiesChange)}(s,h,o,r):n&Ht.ColoringHighlight&&function(t,i,n){t=n.highlightData.UF(t);t&&(i.fillColor&&0!==i.fillColor.alpha&&(i.fillColor=t),i.strokeColor&&0!==i.strokeColor.alpha&&(i.strokeColor=t),i.renderReason=i.renderReason|H.RenderReason.RenderingPropertiesChange)}(u,r,i)}return r},jt.prototype.JF=function(t,i){return(i.renderReason&H.RenderReason.Create)==H.RenderReason.Create||(i.renderReason&H.RenderReason.Preview)!=H.RenderReason.Preview&&(!!t.bF()||(i.renderReason&H.RenderReason.SizeChange)==H.RenderReason.SizeChange)},jt.prototype.ik=function(t,i){var n=t.isRenderStyleUpToDate()&&this.QC?this.QC:this.GF(t,i),i=this.getSymbol();i&&i.ik(t,n,this)},jt.prototype.qF=function(t){
var i=t.createSymbolAnimator(this),t=this.nO;return t?i.setFromRenderStyle(t):i.initializeAnimationStyle(this),i.to=this.QC.clone(),i},jt.prototype.ZF=function(){var t=this.nO;this.QC&&(t=this.QC.clone()),this.nO=t},jt.prototype.KF=function(t,i){return t.isRenderStyleUpToDate()&&this.QC?this.QC:this.GF(t,i)},jt.prototype.renderLineMarker=function(t,i){this.KF(t,i),this.render(t,i)},jt.prototype.render=function(t,i){var n=this.QC,r=this.getSymbol();if(r){var s=this.JF(r,n);if(t.renderSymbolGeometry(r,n,this),s){s=this.getOwner();if(!s)return;t.pushRenderCallback(s,r,n)}n.renderReason=0}},jt.prototype.updateRender=function(t,i){var n=this.QC,r=this.getSymbol();if(r){var s=this.JF(r,n);if(t.updateRenderSymbolGeometry(r,n,this),s){s=this.getOwner();if(!s)return;t.pushRenderCallback(s,r,n)}n.renderReason=0}},jt.prototype.renderPreview=function(t,i){var n=this.GF(t,i,!0),i=this.getSymbol();i&&(i.renderPreview(t,n,this),n.renderReason=0)},jt.prototype.startPreview=function(){var t=this.QC
;t&&(this.VF={originalWidth:t.width,originalHeight:t.height,originalMatrix:t.transform})},jt.prototype.VE=function(){var t,i=this.QC;!i||(t=this.VF)&&(i.width=t.originalWidth,i.height=t.originalHeight,i.transform=t.originalMatrix,this.VF=null)},jt.prototype.remove=function(t){var i=Xt.getValue(this);i&&i.remove();i=$t.getValue(this);i&&i.remove(),t||(n=this.getOwner())&&n.QF(this);var n=Kt.getValue(this);n&&(Kt.setValue(this,null),(!n.BI||n.BI.length<1)&&n.remove()),l.prototype.remove.call(this)},jt.prototype.select=function(t){if(this.getSymbol()){var i=this.getOwner();if(i){i=i.getRenderingPosition();if(i){i=this.getRenderingBBox(i);if(i&&i.isPointInside(t.point,t.tolerance))return!0}}}return!1},jt.prototype.a_=function(t,i,n){var r=this.getSymbol();if(r){var s=this.getOwner();if(s){s=s.getRenderingPosition(),s=this.getRenderingBBox(s);return r.select(t,s.x,s.y,s.width,s.height,i,n)}}return!1},jt.prototype.yF=function(){var t=this.getSymbol();return t&&t.yF()},
jt.prototype.intersectWithSegment=function(t,i){var n=this.getSymbol();if(n){var r=this.getOwner();if(r){r=r.getRenderingPosition(),r=this.getRenderingBBox(r,!0);return n.intersectWithSegment(r.x,r.y,r.width,r.height,t,i)}}return null},jt.prototype.isPointInside=function(t,i){var n=this.getSymbol();if(n){var r=this.getOwner();if(r){r=r.getRenderingPosition(),r=this.getRenderingBBox(r,!0);return n.isPointInside(r.x,r.y,r.width,r.height,t,i)}}return!1},jt.prototype.setSymbolType=function(t){ti.setValue(this,t)},jt.prototype.getSymbolType=function(){return ti.getValue(this)},jt.prototype.getLocationCoordinateMode=function(){return this.getOwner().getLocationCoordinateMode()},jt.prototype.getSizeCoordinateMode=function(){return this.getOwner().getSizeCoordinateMode()},jt.prototype.on=function(t,i){this.eventListeners[t]||(this.eventListeners[t]=[]),this.eventListeners[t].push(i)},jt.prototype.off=function(t,i){this.eventListeners[t]||(this.eventListeners[t]=[])
;i=this.eventListeners[t].indexOf(i);this.eventListeners[t].splice(i,1)};m=function(t,i,n,r){var s,h,u;n&&(s=(h=n.getAnchor()).anchorX,h=h.anchorY,n instanceof wt&&((u=t.getOwner())&&n.addAnnotaion(u))),void 0!==s&&void 0!==h||(u=t.getSession())&&(u=u.getSheetConfigurationData(),void 0===s&&(s=u.defaultAnchorX),void 0===h&&(h=u.defaultAnchorY)),t.IR.x=s,t.IR.y=h,r&&n&&(t.zD=!0)},X=function(t,i,n,r){n&&n.getPlacementPosition&&(n.setOwner(t),n.getPlacementPosition()&H.ConnectionLabelPositionOption.REPEAT&&(t.LF=!0))};jt.prototype.getAnchor=function(){return this.IR},jt.prototype.clone=function(t){var i=l.prototype.clone.call(this,t);i.WF=this.WF,i.HF=this.HF,i.IR.x=this.IR.x,i.IR.y=this.IR.y,i.setOwner(t.get(this.getOwner().guid));var n=t.get(this.guid),t=n.getSymbol(),n=t&&t._F(n);return n&&i.setSymbol(n),i},jt.prototype.updateAnchor=function(){var t=this.getSymbol();t&&(t=t.getAnchor(),this.IR.x=t.anchorX,this.IR.y=t.anchorY)},l.inheritedBy(jt);var Xt=W.Property.define(jt,"m_location",
"Location",W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.AffectRender|W.PropertyFlags.SupportsDeepCopy|W.PropertyFlags.TwoWayReference),Gt=W.Property.define(jt,"m_widthPolicy",Number,W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.SupportsShallowCopy),Ut=W.Property.define(jt,"m_heightPolicy",Number,W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.SupportsShallowCopy),Jt=W.Property.define(jt,"m_rotation",Number,W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.AffectRender|W.PropertyFlags.SupportsShallowCopy),qt=W.Property.define(jt,"m_width",Number,W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.SupportsShallowCopy),Zt=W.Property.define(jt,"m_height",Number,W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.SupportsShallowCopy),Kt=W.Property.define(jt,"m_symbol","Symbol",
W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.TwoWayReference|W.PropertyFlags.AffectRender|W.PropertyFlags.SupportsShallowCopy,m,m),Qt=W.Property.define(jt,"m_visible",Boolean,W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.AffectRender|W.PropertyFlags.SupportsShallowCopy),$t=W.Property.define(jt,"m_renderingProperties","RenderingProperties",W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.TwoWayReference|W.PropertyFlags.AffectRender|W.PropertyFlags.SupportsDeepCopy,function(t,i,n,r){var s=t.getSymbol();s&&s.onRenderingPropertiesChanged(t,n,r)}),ti=W.Property.define(jt,"m_symbolType",Number,W.PropertyFlags.Persistent|W.PropertyFlags.SupportsShallowCopy),ii=W.Property.define(jt,"m_placementRule","PlacementRule",W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.AffectRender|W.PropertyFlags.SupportsShallowCopy|W.PropertyFlags.TwoWayReference,X,X);function ni(){l.call(this),fi.setRawValue(this,[
"Node","Port","Connection"]),si.setRawValue(this,new W.List),this.$F=new H.GroupViewStrategy}ni.prototype.addMember=function(t){si.getValue(this).add(t);var i=this.getOwner();i&&i.t4([t],this)},ni.prototype.addMembers=function(t){W.common.ExceptionHelper.throwIfInvalidArray(t,"member array");for(var i=t.length,n=si.getValue(this),r=0;r<i;r++)n.add(t[r]);var s=this.getOwner();s&&s.t4(t,this)},ni.prototype.getMember=function(t){for(var i=this.getMembers(),n=0;n<i.length;n++)if(i[n].guid==t)return i[n]},ni.prototype.getMembers=function(){return si.getValue(this).toArray()},ni.prototype.setMembers=function(t){W.common.ExceptionHelper.throwIfInvalidArray(t,"member array");t.length;var i=si.getValue(this),n=H.ArrayUtil.sliceDuplications(i.toArray(),t);this.i4(null,n),i.removeAll(),this.addMembers(t)};ni.prototype.n4=function(t,i){var n=function(t){for(var i,n=t,r=0,s=t.length;r<s;r++)t[r].isNestedViewMode&&(t[r].isNestedViewMode()||(i=t[r].r4(!0),n=n.concat(i)));return n}(i);switch(
this.getViewMode(t)){case H.GroupViewMode.Nested:this.getMovePolicy()!==H.GroupMovePolicy.SelfOnly&&this.$F.addChildrenInNested(t||this.getOwner(),n);break;case H.GroupViewMode.Tree:this.$F.addChildrenInTree(t||this.getOwner(),n)}},ni.prototype.removeAllMembers=function(){for(var t=this.getMembers(),i=0,n=t.length;i<n;i++)this.removeMember(t[i]);return t},ni.prototype.removeMember=function(t){si.getValue(this).remove(t),t.setOwner(t.getOwningSheet())},ni.prototype.i4=function(t,i){switch(this.getViewMode(t)){case H.GroupViewMode.Nested:this.$F.removeChildrenInNested(t||this.getOwner(),i);break;case H.GroupViewMode.Tree:this.$F.removeChildrenInTree(t||this.getOwner(),i)}var n=t||this.getOwner();if(n){var r=n.s4();if(r&H.VisibleMask.HIDDENBYNESTEDNODE||!n.isExpanded())for(var s=0,h=i.length;s<h;s++)i[s].setVisibleByNestedNode(!0);if(r&H.VisibleMask.HIDDENBYPARENT||!1===n.isPrimitiveVisible())for(s=0,h=i.length;s<h;s++)i[s].setVisibleByParent(!0)}},
ni.prototype.getNestedNodePadding=function(){return hi.getValue(this)},ni.prototype.setNestedNodePadding=function(t){hi.setValue(this,t)},ni.prototype.getNodePaddings=function(){return hi.getValue(this)},ni.prototype.setNodePaddings=function(t){hi.setValue(this,t)},ni.prototype.getViewMode=function(t){var i=ui.getValue(this);return void 0!==i||(t=t||this.getOwner())&&(i=t.getOwningSheet().getGroupViewMode(),ui.setValue(this,i)),i},ni.prototype.setViewMode=function(t,i){var n=ui.getValue(this);if(ui.setValue(this,t),n!=t){var r=i||this.getOwner();if(r)switch(t){case H.GroupViewMode.Nested:this.$F.changeToNested(r);break;case H.GroupViewMode.Tree:this.$F.changeToTree(r)}}},ni.prototype.setMovePolicy=function(t){var i=oi.getValue(this);oi.setValue(this,t),i==t||(i=this.getOwner())&&(t===H.GroupMovePolicy.SelfOnly?this.$F.removeRelativeLocations(i,this.getMembers()):(H.GroupMovePolicy.SelfAndContent,this.$F.addRelativeLocations(i,this.getMembers())))},ni.prototype.getMovePolicy=function(){
return oi.getValue(this)},ni.prototype.setResizePolicy=function(t){ei.setValue(this,t)},ni.prototype.getResizePolicy=function(){return ei.getValue(this)},ni.prototype.setFitToContentTypes=function(t){fi.setValue(this,t)},ni.prototype.getFitToContentTypes=function(){return fi.getValue(this)},ni.prototype.getMemberDisplayStrategy=function(){return ci.getValue(this)},ni.prototype.setMemberDisplayStrategy=function(t){ci.setValue(this,t)},ni.prototype.copyFrom=function(t,i,n){var r=si.getValue(this),s=t.getMembers(),h=new W.List;W.common.ExceptionHelper.throwIfInvalidArray(s,"source array");for(var u=0;u<s.length;u++)h.add(s[u]);r.copyFrom(h,i,n)},ni.prototype.clone=function(t,i){var n=new ni;return n.copyFrom(this,t,i),n},ni.prototype.XE=function(t,i){si.getValue(this).XE(t,i)},ni.prototype.remove=function(){var t=si.getValue(this);if(t)for(var i=t.size(),n=t.toArray(),r=0;r<i;r++)n[r].remove();l.prototype.remove.call(this)},l.inheritedBy(ni);var ri,si=W.Property.define(ni,"m_members",
"List",W.PropertyFlags.Persistent|W.PropertyFlags.TwoWayReference),hi=W.Property.define(ni,"m_nestedNodePadding",Array,W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.SupportsDeepCopy),ui=W.Property.define(ni,"m_viewMode",Number,W.PropertyFlags.None|W.PropertyFlags.SupportsShallowCopy),oi=W.Property.define(ni,"m_movePolicy",Number,W.PropertyFlags.None|W.PropertyFlags.SupportsShallowCopy),ei=W.Property.define(ni,"m_resizePolicy",Number,W.PropertyFlags.None|W.PropertyFlags.SupportsShallowCopy),fi=W.Property.define(ni,"m_fitToContentTypes",Array,W.PropertyFlags.None|W.PropertyFlags.SupportsShallowCopy),ci=W.Property.define(ni,"m_memberDisplayStrategy","MemberDisplayStrategy",W.PropertyFlags.None|W.PropertyFlags.SupportsShallowCopy);function ai(t,i,n,r,s,h,u){l.call(this),this.IR=new H.Point(0,0),this.zF=H.Matrix.identity,this.lF=null,this.h4=[],this.u4=[],this.AM=null,this.WF=0,this.HF=0,Ti.setRawValue(this,t),Ni.setRawValue(this,!1),ki.setRawValue(this,!0)
;var o=this.getSession();xi.setRawValue(this,o?o.gA++:0),Ei.setRawValue(this,7),Wi.setRawValue(this,0),yi.setRawValue(this,0),gi.setRawValue(this,!1),pi.setRawValue(this,!1),Fi.setRawValue(this,H.ElementType.DEFAULT),Di.setRawValue(this,H.ElementCoordinateMode.Sheet),Ri.setRawValue(this,H.ElementCoordinateMode.Sheet),Pi.setRawValue(this,new W.List),this.o4=[],this.e4=[],this.hL=!1,this.nL=!1,this.jF=!1,this.f4=null,this.postCreate(s,h,u,i,n,r),this.AE=null,this.WD=!1,this.AC=null,this.c4=null,t&&t.addSheetElement(this)}t=function(t,i,n,r){t.a4=n};ai.prototype.getResizeLocationData=function(t,i){var n=t.getSession();W.common.ExceptionHelper.throwIfInvalid(n,"SheetSession");var r,s,h=n.getSheetConfigurationData(),n=h.viewData.getScaleFactor();i&&i[t.guid]?(r=i[t.guid],u=t.getAnchor(),(s={}).x=r.x+r.width*u.x,s.y=r.y+r.height*u.y):(r=t.getBBox(),s=t.getAnchorPosition());var u=h.handleStyle.resizeHandler.size/n,t=h.handleStyle.rotateHandler.size/n,
h=h.handleStyle.rotateBarHandler.barLength/n,n=[];return n[0]=new H.Rect(r.x-u/2,r.y-u/2,u,u),n[1]=new H.Rect(r.x+r.width/2-u/2,r.y-u/2,u,u),n[2]=new H.Rect(r.x+r.width-u/2,r.y-u/2,u,u),n[3]=new H.Rect(r.x+r.width-u/2,r.y+r.height/2-u/2,u,u),n[4]=new H.Rect(r.x+r.width-u/2,r.y+r.height-u/2,u,u),n[5]=new H.Rect(r.x+r.width/2-u/2,r.y+r.height-u/2,u,u),n[6]=new H.Rect(r.x-u/2,r.y+r.height-u/2,u,u),n[7]=new H.Rect(r.x-u/2,r.y+r.height/2-u/2,u,u),n[8]=new H.Rect(s.x-t/2,r.y-t/2-h,t,t),n[9]=new H.Rect(s.x-t/2,s.y-t/2,t,t),n};i=function(t,i,n,r){if(r&&r!==n){var s=r.e4.indexOf(t);return r.e4.splice(s,1)}n&&n.e4.push(t)};ai.prototype.ck=function(){var t=H.Constants.CANVAS_ID_PREFIX_FOR_SYSTEM,i=this.getElementType(),n=H.Constants.CANVAS_ID_FOR_DEFAULT;switch(i){case H.ElementType.FEATURE:n=H.Constants.CANVAS_ID_FOR_FEATURE;break;case H.ElementType.OVERLAY:n=H.Constants.CANVAS_ID_FOR_OVERLAY;break;case H.ElementType.UI:n=H.Constants.CANVAS_ID_FOR_UI}t+=n;var r=this.getSizeCoordinateMode(),
i=H.Constants.CANVAS_ID_FOR_SIZE_ON_SHEET;return t+=i=r===H.ElementCoordinateMode.Device?H.Constants.CANVAS_ID_FOR_SIZE_ON_DEVICE:i,t+=H.Constants.CANVAS_ID_SUFFIX};v=function(i,t,n,r){if(i.lF){var s,h=!1,u=["getStrokeColor","getFillColor"],o=u.concat(["isSelected"]),e={};for(s in e[Ht.Hover]=u,e[Ht.Preview]=u,e[Ht.Selected]=o,e)Object.prototype.hasOwnProperty.call(e,s)&&((r&s)==s?(n&s)!=s&&(h=!0):(n&s)==s&&(h=!0),h&&(e[s].forEach(function(t){i.updateBinding(t)}),h=!1))}},m=function(t,i,n,r){n&&(n.kN=!0),r&&(r.kN=!1)},X=function(t,i,n,r){r&&(r.sF=!1,n||r.setOwner(null)),n&&(n.sF=!0,n.setOwner(t)),t.setUpToDate(!1)};ai.prototype.isBackground=function(){return this.getElementType()===H.ElementType.FEATURE},ai.prototype.setBackground=function(t){t?this.setElementType(H.ElementType.FEATURE):this.setElementType(H.ElementType.DEFAULT)},ai.prototype.getOwningSheet=function(){return Ti.getValue(this)},ai.prototype.setUpToDate=function(t){t||(Ci.setValue(this,!0),this.v4()),Ci.setValue(this,t)}
,ai.prototype.gM=function(t){Ci.setValue(this,t)},ai.prototype.isUpToDate=function(){return Ci.getValue(this)},ai.prototype.setTransformUpdate=function(t){this.jF=t;for(var i=this.getReferencingLocations(),n=0,r=i.length;n<r;n++){var s=i[n].getOwner();s&&s!==this&&s.setTransformUpdate&&s.setTransformUpdate(t)}},ai.prototype.setVisible=function(t,i){if(ki.setValue(this,t),t||this.l4(),!1!==i&&!(t&&this.s4()&H.VisibleMask.HIDDENBYPARENT)){var n=this.M_();if(n)for(var r=0,s=n.length;r<s;r++){var h=n[r];h&&h.setVisibleByParent(t)}}},ai.prototype.m4=function(t){},ai.prototype.isVisible=function(){if(!1===this.d4)return!1;var t=this.getLayer();if(t&&t.isHidden())return!1;t=Bi.getValue(this);return void 0===t||t===H.VisibleMask.NONE},ai.prototype.isPrimitiveVisible=function(){return this.d4},ai.prototype.setX=function(t){mi.setValue(this,t),this.setUpToDate(!1)},ai.prototype.getX=function(){return mi.getValue(this)},ai.prototype.setY=function(t){di.setValue(this,t),this.setUpToDate(!1)},
ai.prototype.getY=function(){return di.getValue(this)},ai.prototype.getLocation=function(){return wi.getValue(this)},ai.prototype.setLocation=function(t){wi.setValue(this,t)},ai.prototype.w4=function(){return!0},ai.prototype.addRelativeLocation=function(t){var i,n=t.getLocation();n||(n=new a((i=t.getAnchorPosition()).x,i.y),t.setLocation(n)),n.setReference(this)},ai.prototype.removeRelativeLocation=function(t){var i,n=t.getLocation();n&&(i=n.getEvaluatedLocation(),n.setReference(void 0),n.setEvaluatedLocation(i.x,i.y),t.setUpToDate(!1))},ai.prototype.getAnchorPosition=function(){var t,i=wi.getValue(this);return i?i.getEvaluatedLocation():(t=mi.getValue(this)||0,i=di.getValue(this)||0,new H.Point(t,i))},ai.prototype.getRenderingPosition=function(){var t=this.getAnchorPosition(),t=this.b4(t),i=this.WF||this.getWidthValue(),n=this.HF||this.getHeightValue(),i=t.x-i*this.IR.x,n=t.y-n*this.IR.y;return new H.Point(i,n)},ai.prototype.b4=function(t){var i,n,r=t.clone(),s=this.getSession()
;return s&&(i=this.getLocationCoordinateMode(),t=this.getSizeCoordinateMode(),i===H.ElementCoordinateMode.Sheet?t===H.ElementCoordinateMode.Device&&(r=((n=s.getSheetConfigurationData().viewData).vF()||n.getSheetToViewXform()).transformPoint(r)):t===H.ElementCoordinateMode.Sheet&&(r=((n=s.getSheetConfigurationData().viewData).vF()||n.getSheetToViewXform()).invert().transformPoint(r))),r},ai.prototype.setRenderingPosition=function(t,i){t=void 0===t?void 0:t+this.WF*this.IR.x,i=void 0===i?void 0:i+this.HF*this.IR.y;this.setAnchorPosition(t,i)},ai.prototype.getAnchorPositionX=function(){return this.getAnchorPosition().x},ai.prototype.getAnchorPositionY=function(){return this.getAnchorPosition().y},ai.prototype.translateRenderingToAnchorPosition=function(t){var i=this.WF,n=this.HF,i=t.x+i*this.IR.x,n=t.y+n*this.IR.y;return new H.Point(i,n)},ai.prototype.setWidthPolicy=function(t){W.common.ExceptionHelper.throwIfNegative(t,"m_widthPolicy"),bi.setValue(this,t),this.hL=!0,
this.setTransformUpdate(!0)},ai.prototype.getWidthPolicy=function(){return bi.getValue(this)},ai.prototype.setHeightPolicy=function(t){W.common.ExceptionHelper.throwIfNegative(t,"m_heightPolicy"),_i.setValue(this,t),this.nL=!0,this.setTransformUpdate(!0)},ai.prototype.getHeightPolicy=function(){return _i.getValue(this)};ai.prototype.setWidth=function(t){this.XF||(W.common.ExceptionHelper.throwIfNegative(t,"m_width"),this.hL=!0,Mi.setValue(this,t),this._4(),this.setTransformUpdate(!0))},ai.prototype.getWidth=function(){return Mi.getValue(this)},ai.prototype.setHeight=function(t){this.XF||(W.common.ExceptionHelper.throwIfNegative(t,"m_height"),this.nL=!0,Si.setValue(this,t),this._4(),this.setTransformUpdate(!0))},ai.prototype.getHeight=function(){return Si.getValue(this)},ai.prototype.setWidthValue=function(t){var i=H.CommonUtil.evaluateSize(this,H.Axis.X,t),n=0!=H.MathUtil.doubleCompare(i,this.WF);this.WF=i,Mi.setValue(this,t),this.hL=!1,n&&this._4(),this.setTransformUpdate(!0)},
ai.prototype.getWidthValue=function(){var t,i;return this.hL&&((t=this).XF?t.XF.evaluate():(i=Mi.getValue(t),i=H.CommonUtil.evaluateSize(t,H.Axis.X,i),t.WF=i,t.hL=!1)),this.WF},ai.prototype.setHeightValue=function(t){var i=H.CommonUtil.evaluateSize(this,H.Axis.Y,t),n=0!==H.MathUtil.doubleCompare(i,this.HF);this.HF=i,Si.setValue(this,t),this.nL=!1,n&&this._4(),this.setTransformUpdate(!0)},ai.prototype.getHeightValue=function(){var t,i;return this.nL&&((t=this).XF?t.XF.evaluate():(i=Si.getValue(t),i=H.CommonUtil.evaluateSize(t,H.Axis.Y,i),t.HF=i,t.nL=!1)),this.HF},ai.prototype.addReferencingLocation=function(t){this.o4.push(t)},ai.prototype.getReferencingLocations=function(){return this.o4},ai.prototype.removeReferencingLocation=function(t){t=this.o4.indexOf(t);return 0<=t&&(this.o4.splice(t,1),!0)},ai.prototype.getReferencingSheetElements=function(){return this.e4},ai.prototype.addSymbol=function(t){this.y4(t),this.updateAnchor()},ai.prototype.y4=function(t){this.a4.add(t),t.setOwner(
this)},ai.prototype.getSymbols=function(){var t=this.a4;return t?t.toArray():[]},ai.prototype.removeSymbol=function(t){this.QF(t),t.remove()},ai.prototype.QF=function(t){var i=this.a4;i&&i.contains(t)&&(i.remove(t),this.h4.push(t),this.updateAnchor(),t.setOwner(void 0))},ai.prototype.setSymbols=function(t){W.common.ExceptionHelper.throwIfInvalidArray(t,"Symbol array");for(var i=this.a4,n=!1,r=(h=i.size())-1;0<=r;r--){var s=i.get(r);-1===t.indexOf(s)?this.removeSymbol(s):n=!0}n&&Pi.setValue(this,new W.List);for(var h=t.length,u=0;u<h;u++)this.y4(t[u]);this.updateAnchor()},ai.prototype.hasSymbol=function(){var t=this.a4;return!!(t&&0<t.size())},ai.prototype.g4=function(t){var i=this.getSymbols();if(i)for(var n=i.length,r=0;r<n;r++){var s=i[r];if(s.guid===t)return s}return null},ai.prototype.getDefinition=function(){return""},ai.prototype.setLayer=function(t){Li.setValue(this,t)},ai.prototype.getLayer=function(){return Li.getValue(this)},ai.prototype.setLabelPosition=function(t,i){var n,r
,s=this.getLabel();void 0!==s&&((n=s.getLocation())||(n=new a(0,0),s.setLocation(n)),t&&(r=s.getBBox(),n.setReference(this,!0),n.setInput(H.CoordinateMode.PERCENT,H.Axis.X,.5),n.setInput(H.CoordinateMode.ABSOLUTE,H.Axis.X,-r.width/2),t===H.AlignmentMode.TOP?(n.setInput(H.CoordinateMode.PERCENT,H.Axis.Y,0),n.setInput(H.CoordinateMode.ABSOLUTE,H.Axis.Y,-r.height+i)):t===H.AlignmentMode.MIDDLE?(n.setInput(H.CoordinateMode.PERCENT,H.Axis.Y,.5),n.setInput(H.CoordinateMode.ABSOLUTE,H.Axis.Y,i)):t===H.AlignmentMode.BOTTOM?(n.setInput(H.CoordinateMode.PERCENT,H.Axis.Y,1),n.setInput(H.CoordinateMode.ABSOLUTE,H.Axis.Y,-r.height+i)):t===H.AlignmentMode.HANGING&&(n.setInput(H.CoordinateMode.PERCENT,H.Axis.Y,0),n.setInput(H.CoordinateMode.ABSOLUTE,H.Axis.Y,i))),s.setUpToDate(!1))},ai.prototype.setLabel=function(t,i,n,r,s){Oi.setValue(this,t),t&&(t.setOwner(this),this.setLabelPosition(i,n,r,s))},ai.prototype.getLabel=function(){return Oi.getValue(this)},ai.prototype.setSourceElement=function(t){
Ai.setValue(this,t)},ai.prototype.getSourceElement=function(){return Ai.getValue(this)},ai.prototype.getXform=function(t){var i,n,r,s,h,u,o,e,f;return(this.jF||t)&&(h=this.getRotation(),e=this.getAnchor(),o=t&&t[this.guid],f=H.Matrix.identity,i=this.getMirrorX(),n=this.getMirrorY(),i&&n?(f=H.Matrix.flipXY,r=o?o.width:this.getWidthValue(),s=o?o.height:this.getHeightValue(),f=f.append(new H.Matrix(1,0,0,1,2*r*e.x,2*s*e.y))):i?(f=H.Matrix.flipX,s=o?o.height:this.getHeightValue(),f=f.append(new H.Matrix(1,0,0,1,0,2*s*e.y))):n&&(f=H.Matrix.flipY,r=o?o.width:this.getWidthValue(),f=f.append(new H.Matrix(1,0,0,1,2*r*e.x,0))),0!==h&&void 0!==h&&(r=r||(o?o.width:this.getWidthValue()),s=s||(o?o.height:this.getHeightValue()),f=f.rotateAt(h,e.x*r,e.y*s)),(r=this.getOwner())&&r.getRotation&&(u=o?new H.Point(o.x,o.y):this.getRenderingPosition()),f=(e=wi.getValue(this))&&e instanceof vt?(s=this.getAnchorPosition(),h=e.getRotation(),u=u||(o?new H.Point(o.x,o.y):this.getRenderingPosition()),
e=new H.Matrix(1,0,0,1,u.x,u.y),o=new H.Matrix(1,0,0,1,-u.x,-u.y),e=e.rotateAt(h,s.x,s.y),(f=f.append(e)).append(o)):this.p4(r,f,u,t),this.zF=f,this.jF=!1),this.zF},ai.prototype.p4=function(t,i,n,r){var s=i;if(t&&t.getRotation){var h,u=t.getRotation(),o=t.getAnchor(),e=0,f=0,c=r&&r[t.guid],a=c?new H.Point(c.x,c.y):t.getRenderingPosition(),v=a?(h=n.x-a.x,n.y-a.y):h=0,a=H.Matrix.identity;return t.getMirrorX()&&t.getMirrorY()?(a=H.Matrix.flipXY,e=c?c.width:t.getWidthValue(),f=c?c.height:t.getHeightValue(),a=a.append(new H.Matrix(1,0,0,1,2*(e*o.x-h),2*(f*o.y-v)))):t.getMirrorX()?(a=H.Matrix.flipX,f=c?c.height:t.getHeightValue(),a=a.append(new H.Matrix(1,0,0,1,0,2*(f*o.y-v)))):t.getMirrorY()&&(a=H.Matrix.flipY,e=c?c.width:t.getWidthValue(),a=a.append(new H.Matrix(1,0,0,1,2*(e*o.x-h),0))),0!==u&&(e=e||(c?c.width:t.getWidthValue()),f=f||(c?c.height:t.getHeightValue()),a=a.rotateAt(u,o.x*e-h,o.y*f-v)),s=i.append(a),t.p4(t.getOwner(),s,n,r)}return s};ai.prototype.setRotation=function(t){
yi.setValue(this,t)},ai.prototype.getRotation=function(){return yi.getValue(this)},ai.prototype.setMirrorX=function(t){t!==this.getMirrorX()&&(gi.setValue(this,t),this.setUpToDate(!1),this.setTransformUpdate(!0))},ai.prototype.getMirrorX=function(){return gi.getValue(this)},ai.prototype.setMirrorY=function(t){t!==this.getMirrorY()&&(pi.setValue(this,t),this.setUpToDate(!1),this.setTransformUpdate(!0))},ai.prototype.getMirrorY=function(){return pi.getValue(this)},ai.prototype.getResizeMinimumSize=function(){var t={width:0,height:0},i=this.getSession();return!i||(i=i.getSheetConfigurationData())&&(t.width=i.resizeMinimumWidth,t.height=i.resizeMinimumHeight),t},ai.prototype.getMargins=function(){var t={left:0,top:0,right:0,bottom:0},i=this.getRenderingBBox();return i&&(t.left=i.width,t.top=i.height,t.right=i.width,t.bottom=i.height),t},ai.prototype.resize=function(t,i,n,r){var s=this.getWidthValue(),h=this.getHeightValue();s&&h&&(this.M4(),s=this.getXform(),h=this.getRenderingPosition(),
void 0!==t&&this.setWidthValue(this.getWidthValue()*t),void 0!==i&&this.setHeightValue(this.getHeightValue()*i),r=s.transformVector(new H.Vector(n=null==n?0:n,r=null==r?0:r)),h.x+=r.x,h.y+=r.y,r=this.getXform(),h.x+=s.getM6()-r.getM6(),h.y+=s.getM7()-r.getM7(),this.setRenderingPosition(h.x,h.y),this.S4(),this.N4(),(h=this.L4())&&h.O4?h.O4():this.update())},ai.prototype.setZDepth=function(t){xi.setValue(this,t)},ai.prototype.getZDepth=function(){return xi.getValue(this)},ai.prototype.setInternal=function(t){Ni.setValue(this,t)},ai.prototype.isInternal=function(){return Ni.getValue(this)},ai.prototype.T4=function(t){Bi.setValue(this,t)},ai.prototype.s4=function(){return Bi.getValue(this)},ai.prototype.A4=function(){return!1},ai.prototype.P4=function(t){return!!t.A4()},ai.prototype.C4=function(){return this.M_()},ai.prototype.k4=function(){return this.M_()},ai.prototype.M_=function(){var t=[],i=this.f4;if(i)for(var n=i.length,r=0;r<n;r++)t.push(i[r]);return t},ai.prototype.B4=function(t,i
){var n=Bi.getValue(this);void 0===n&&(n=H.VisibleMask.NONE),t?(n&i)===i&&(n^=i):n|=i,Bi.setValue(this,n),t||this.l4()},ai.prototype.setVisibleByParent=function(t){this.B4(t,H.VisibleMask.HIDDENBYPARENT);var i=this.M_();if(i)for(var n=0,r=i.length;n<r;n++){var s=i[n];s&&s.setVisibleByParent(t)}},ai.prototype.x4=function(){var t=Bi.getValue(this);return void 0!==t&&!!(t&H.VisibleMask.HIDDENBYPARENT)},ai.prototype.setVisibleByNestedNode=function(t){this.B4(t,H.VisibleMask.HIDDENBYNESTEDNODE);var i=this.C4();if(i)for(var n=0,r=i.length;n<r;n++){var s=i[n];s&&s.setVisibleByNestedNode(t)}},ai.prototype.E4=function(t){this.B4(t,H.VisibleMask.HIDDENBYCOLLAPSEOUTGOING);var i=this.k4();if(i)for(var n=0,r=i.length;n<r;n++){var s=i[n];s&&s.E4(t)}},ai.prototype.D4=function(){var t=Bi.getValue(this);return void 0!==t&&!!(t&H.VisibleMask.HIDDENBYCOLLAPSEOUTGOING)},ai.prototype.isHiddenByNestedNode=function(){var t=Bi.getValue(this);return void 0!==t&&!!(t&H.VisibleMask.HIDDENBYNESTEDNODE)},
ai.prototype.setVisibleByLayer=function(t){this.B4(t,H.VisibleMask.HIDDENBYLAYER);var i=this.M_();if(i)for(var n=0,r=i.length;n<r;n++){var s=i[n];s&&s.setVisibleByLayer(t)}},ai.prototype.setVisibleByTransientMask=function(t){var i=Bi.getValue(this);void 0===i&&(i=H.VisibleMask.NONE),t?i&H.VisibleMask.TRANSIENTHIDE&&(i^=H.VisibleMask.TRANSIENTHIDE):i|=H.VisibleMask.TRANSIENTHIDE,Bi.setValue(this,i)},ai.prototype.setOwner=function(t){l.prototype.setOwner.call(this,t),t&&t instanceof ai&&t.s4()&H.VisibleMask.HIDDENBYNESTEDNODE&&this.setVisibleByNestedNode(!1)},ai.prototype.tF=function(t){var i;t instanceof ai&&((i=this.f4)||(this.f4=i=[]),i.push(t))},ai.prototype.iF=function(t){var i=this.f4;!i||0<=(t=i.indexOf(t))&&i.splice(t,1)},ai.prototype.setAllowedTransformations=function(t){Ei.setValue(this,t)},ai.prototype.getAllowedTransformations=function(){return Ei.getValue(this)},ai.prototype.isTranslateAllowed=function(){return(this.getAllowedTransformations(
)&H.AllowedTransformations.TRANSLATION)===H.AllowedTransformations.TRANSLATION&&(this.getSession().ax&H.AllowedTransformations.TRANSLATION)===H.AllowedTransformations.TRANSLATION},ai.prototype.setAppObj=function(t){li.setValue(this,t)},ai.prototype.getAppObj=function(){return li.getValue(this)},ai.prototype.setDimensionInput=function(t){this.setWidthValue(t.m_width),this.setHeightValue(t.m_height)},ai.prototype.setAnchorPosition=function(t,i){var n=this.getLocation();n?n.setEvaluatedLocation(t,i):(void 0!==t&&mi.setValue(this,t),void 0!==i&&di.setValue(this,i)),this.setUpToDate(!1);i=this.getOwner();i&&i.setTransformUpdate&&this.setTransformUpdate(!0),this.R4()},ai.prototype.R4=function(){var t=this.L4();t&&t.O4&&(this.S4(),t.O4())},ai.prototype.setAnchorPositionX=function(t){this.setAnchorPosition(t,void 0)},ai.prototype.setAnchorPositionY=function(t){this.setAnchorPosition(void 0,t)},ai.prototype.F4=function(t,i){var n=t,r=i,s=this.getOwner();return s&&s.getXform&&(n=(i=s.getXform(
).invert().transformVector(new H.Vector(t,i))).x,r=i.y),{dx:n,dy:r}},ai.prototype.move=function(t,i){var n=this.F4(t,i),r=this.getAnchorPosition(),s=r.x+n.dx,h=r.y+n.dy,u=new H.Point(s,h),o=!1,e=this.getLocation();if(e&&(b=e.isLockX(),y=e.isLockY(),e.getSegmentIdentifier&&(o=!0)),o&&y){var f=this.getOwner().getLines(),c=0,a=f.length;if(0<a){for(var v=f[0].distanceFromPoint(u),l=1;l<a;++l){var m=f[l].distanceFromPoint(u);m<v&&(v=m,c=l)}var d,w,b,_=f[c],t=_.isVertical(),i=_.getLength(),o=e.getSegmentIdentifier();t?(d=Math.max(_.start.y,_.end.y),w=Math.min(_.start.y,_.end.y),d<h?h=d:h<w&&(h=w)):(d=Math.max(_.start.x,_.end.x),w=Math.min(_.start.x,_.end.x),d<s?s=d:s<w&&(s=w)),o!==c?(e.setSegmentIdentifier(c),t?(n.dx=_.start.x-r.x,n.dy=h-r.y,e.setInputPercentX((h-_.start.y)/i)):(n.dx=s-r.x,n.dy=_.start.y-r.y,e.setInputPercentX((s-_.start.x)/i))):(t?n.dy=h-r.y:n.dx=s-r.x,t&&(t=b,b=y,y=t),n.dx=b?0:n.dx,n.dy=y?0:n.dy)}}else(b||y)&&(n.dx=b?0:n.dx,n.dy=y?0:n.dy);var y=void 0===n.dx?r.x:r.x+n.dx,
n=void 0===n.dy?r.y:r.y+n.dy;this.setAnchorPosition(y,n)},ai.prototype.setHighlightFlags=function(t,i){void 0===i?n=t:(n=Wi.getValue(this),i?n|=t:(n&t)===t&&(n^=t)),Wi.setValue(this,n);var n=this.getSession().getSheetConfigurationData().selectionPreferencesData;n&&n.isHighlightChildrenWithElement()&&this.I4(t,i)},ai.prototype.wN=function(){var t=this.getLabel();return t?[t]:[]},ai.prototype.I4=function(t,i){var n=this.wN();if(n){var r=n.length;if(!(r<1))for(var s=t&Ht.Selected,h=t&Ht.Hover,u=0;u<r;u++)s&&n[u].setHighlightFlags(Ht.SecondarySelect,i),h&&n[u].setHighlightFlags(Ht.SecondaryHover,i)}},ai.prototype.XM=function(){return Wi.getValue(this)},ai.prototype.l4=function(){var t,i=Wi.getValue(this);i!==Ht.None&&(this.setHighlightFlags(Ht.None),(t=this.getOwningSheet())&&(t=t.getHighlightedElements(),H.CommonUtil.removeDuplicateItem(t,this)),(i&Ht.Selected)!=Ht.Selected||(i=this.getSession())&&i.yA.handleSelectionChanged(this,i))},ai.prototype.getBBox=function(){var t,i,
n=this.hL||this.nL||!this.isUpToDate(),r=Hi.getValue(this);return!n&&r||(t=this.getWidthValue(),i=this.getHeightValue(),n=this.getRenderingPosition(),r=new H.Rect(n.x,n.y,t,i),Hi.setRawValue(this,r),this.setUpToDate(!0)),r};function vi(t,i){return(i=H.Intersection.getIntersectionOfRectAndLine(this,new H.Line(t,i)))?i:[]}ai.prototype.getClipBoundary=function(){if(this.isVisible()){var t=!1;if(t=this.session?this.session.getSheetConfigurationData().enableConnectionPreciseTrim:t){var i,n=this.a4,r=null,t=this.getSelectionPolicy();if(!t||(i=t.getSelectionSymbolIndex())<0?1===n.size()&&(r=n.get(0)):r=n.get(i),r&&r.yF())return r}r=this.getTransformedBBox().clone();return r.intersectWithSegment=vi,r}},ai.prototype.getEvaluatedTransform=function(t,i,n,r){r=this.getXform(r);return n&&(n=new H.Matrix(t,0,0,i,n.x,n.y),r=r?r.append(n):n),r},ai.prototype.W4=function(){return!0},ai.prototype.M4=function(){var t=this.getSession();if(!t||!t.isInUpdateProcess()){var i=0;if(this.r4){var n=[];this.H4=n
;var r=this.r4();if(r){for(var i=r.length,s=0;s<i;s++){var h,u=r[s].getLocation();u&&(h=u.getEvaluatedLocation(),n.push({location:u,point:h}))}i=n.length}}return this.j4=i}},ai.prototype.S4=function(){var t=this.j4;if(t&&0<t)for(var i=this.H4,n=0;n<t;n++){var r,s=i[n];s&&(r=s.location,s=s.point,r.setEvaluatedLocation(s.x,s.y))}},ai.prototype.N4=function(){this.j4=0,this.H4=void 0},ai.prototype.O4=function(){var t,i,n,r,s,h,u;this.getGroupMembers&&((r=this.session)&&(r.E_||r.suppressBoundaryUpdateOnNestedNodeChanged||r.isInUpdateProcess())||((i=this.getResizePolicy())===H.GroupResizePolicy.SelfOnly||i===H.GroupResizePolicy.SelfAndContent||(n=this.getGroupMembers())&&0<n.length&&this.z4()&&(u=this.getContentBBox(),this.M4(),u&&(t=this.getNodePaddings(),i=(r=this.AE)&&r.originalBBox?r.originalBBox.clone():this.getBBox(),n=!1,(r=u.x-i.x)<t.left&&(s=t.left-r,i.x-=s,i.width+=s,n=!0),(s=u.y-i.y)<t.top&&(h=t.top-s,i.y-=h,i.height+=h,n=!0),(h=i.x+i.width-(u.x+u.width))<t.right&&(
i.width+=t.right-h,n=!0),(u=i.y+i.height-(u.y+u.height))<t.bottom&&(i.height+=t.bottom-u,n=!0),n&&(this.setWidthValue(i.width),this.setHeightValue(i.height),this.setRenderingPosition(i.x,i.y),this.S4(),this.update()),this.N4()))))},ai.prototype.getOuterNode=function(){var t=this.BI;if(t)for(var i=0,n=t.length;i<n;i++)if(t[i]instanceof ni)return t[i].getOwner();return null},ai.prototype.getRectForLayout=function(){var t,i=this.getTransformedBBox();return!this.session.layoutIncludesLabel||(t=this.getLabel())&&(t=t.getTransformedBBox(),i.union(t)),i},ai.prototype.getOverlays=function(t,i){return this.getSession().xA.getElementOverlays(this,t,i)},ai.prototype.eA=function(t){return this.getSession().xA.eA(this,t)},ai.prototype.modifyBoundingBox=function(t,i,n,r){var s=this.getSession();s&&s.E_&&this.getGroupMembers&&this.M4(),this.WF=n,Mi.setValue(this,n),this.hL=!1,this.HF=r,Si.setValue(this,r),this.nL=!1,this._4(),this.setRenderingPosition(t,i),this.setTransformUpdate(!0);r=new H.Rect(t,i
,n,r);Hi.setRawValue(this,r),this.setUpToDate(!0),this.v4(),this.S4(),this.N4()},ai.prototype.getCollapsedOwner=function(){var t=this.getOwner();return t&&t instanceof ai&&(t.getCollapsedOwner()||t.isExpanded&&!t.isExpanded()&&t)||null},ai.prototype.C_=function(){return!0},ai.prototype.V4=function(t){return!0},ai.prototype.lN=function(){var t=l.prototype.getOwner.call(this);if(t){var i,n=!0;return t instanceof ai&&((i=this.L4())&&!i.getIsContainer()?(n=!1,t=i):t.V4(this)&&(n=!1)),{isSheet:n,isLabel:!1,owningElement:t}}return{isSheet:!0,isLabel:!1,owningElement:null}},ai.prototype.Y4=function(t){if(W.DebugFlags.UseLegacyRenderZDepth)return t&&t instanceof ai?((i=t.Y4(t.getOwner())).push(this.X4),i):[this.X4];if(t&&t instanceof ai){var i=t.Y4(t.getOwner());return Array.prototype.push.apply(i,this.G4()),i}return this.G4()},ai.prototype.G4=function(){return[H.Constants.PrimaryZIndexSheetElementDefault,this.X4]},ai.prototype.U4=function(t){return this.getRenderCanvas().tD},
ai.prototype.VD=function(){var t=this.getOwner(),i=this.Y4(t),t=this.U4();return i.unshift(t),i},ai.prototype.J4=function(){return[]},ai.prototype.v4=function(t){for(var i=this.o4.length,n=0;n<i;n++){var r=this.o4[n];if(t){var s=r.getInput(H.CoordinateMode.PERCENT,H.Axis.X),h=r.getInput(H.CoordinateMode.PERCENT,H.Axis.Y);if(0===H.MathUtil.doubleCompare(s,0)&&0===H.MathUtil.doubleCompare(h,0))continue}r.setUpToDate(!1)}},ai.prototype._4=function(){for(var t=this.getSymbols(),i=t.length,n=0;n<i;++n){var r=t[n];r.hL=!0,r.nL=!0}var s=this.getSelectionPolicy();!s||(s=s.getSelectionSymbol())&&(s.hL=!0,s.nL=!0),this.v4(!0)},ai.prototype.hasOwnership=function(t){for(var i=this.getOwner();i;){if(i===t)return!0;i=i.getOwner()}return!1},ai.prototype.q4=function(t,i,n){var r;n?((r=new(n.setPath?vt:a)).setReference(n,!0),void 0!==t?r.setInput(H.CoordinateMode.ABSOLUTE,H.Axis.X,t):r.setInput(H.CoordinateMode.ABSOLUTE,H.Axis.X,50),void 0!==i?r.setInput(H.CoordinateMode.ABSOLUTE,H.Axis.Y,i
):r.setInput(H.CoordinateMode.ABSOLUTE,H.Axis.Y,50),wi.setValue(this,r),r.setOwner(this)):(void 0===i&&(i=0),mi.setValue(this,t=void 0===t?0:t),di.setValue(this,i))},ai.prototype.Z4=function(t,i,n){var r=0,s=0,h=this.session;h&&(r=(h=h.getSheetConfigurationData()).defaultNodeHeight,s=h.defaultNodeWidth),void 0!==i&&(r=i),void 0!==t&&(s=t),bi.setValue(this,H.SizingPolicy.LENGTH),_i.setValue(this,H.SizingPolicy.LENGTH),Mi.setValue(this,s),this.WF=s,Si.setValue(this,r),this.HF=r},ai.prototype.postCreate=function(t,i,n,r,s,h){Ci.setRawValue(this,!0),this.q4(t,i,n),this.Z4(r,s)},ai.prototype.vM=function(){var t,i,n=this;return n.K4||(i={getType:function(){return H.ElementIndexTree.ITEMTYPE_BBOX},getOwner:function(){return n},getBBox:function(){return n.getRenderingBBox()}},(t=[]).push(i),n.K4=t),{indexedElements:n.K4,discardedIndexedElements:[]}},ai.prototype.getRenderingBBox=function(){if(this.getBBox){var t=this.getBBox(),i=t.clone(),n=this.getXform(),r=new H.Rect(0,0,i.width,i.height),
r=n.transformRect(r);i.x+=r.x,i.y+=r.y,i.width=r.width,i.height=r.height;var s=this.a4;if(s)for(var h=new H.Point(t.x,t.y),u=s.size(),o=0;o<u;o++){var e=s.get(o).getRenderingBBox(h);i.union(e)}return i}},ai.prototype.Q4=function(t,i){var n=i;if(!t.getLocation()&&t.getWidthPolicy()===H.SizingPolicy.INHERIT&&t.getHeightPolicy()===H.SizingPolicy.INHERIT&&0===t.getRotation())return n;var r,s=t.getAnchorPosition();return s&&((r=t.getOwner())&&(r=r.getRenderingPosition(),s.x=s.x-r.x,s.y=s.y-r.y),s=new H.Matrix(1,0,0,1,s.x,s.y),t=(t=t.getXform())&&t.append(s),n=i?t.append(i):s),n},ai.prototype.t9=function(t){var i,n=this.getRenderingPosition();return(i=n?this.getEvaluatedTransform(1,1,n):i)||H.Matrix.identity},ai.prototype.i9=function(){var t=this.a4,i=[],n=this.getSelectionPolicy();if(n){var r=n.getSelectionSymbolIndex();if(r<0)i=t?t.toArray():[];else for(var s=n.getSelectionSymbolVisibility(),h=0,u=t.size();h<u;h++){var o=t.get(h)
;h===r?s===H.SelectionSymbolVisibilityType.AlwaysVisible?i.push(o):s===H.SelectionSymbolVisibilityType.AlwaysHidden||this.XM()&&i.push(o):i.push(o)}}else i=t?t.toArray():[];return i},ai.prototype.n9=function(){var t,i=this.h4,n=this.getSelectionPolicy();return!n||(t=n.getSelectionSymbol())&&((n=n.getSelectionSymbolVisibility())===H.SelectionSymbolVisibilityType.AlwaysVisible||n!==H.SelectionSymbolVisibilityType.AlwaysHidden&&this.XM()||i.push(t)),i},ai.prototype.ik=function(t){var i,n,r=this.getSession().ok();if(r.currentLod===H.LODType.IntermediateLevel?n=this.getIntermediateLevelSymbol():r.currentLod===H.LODType.OverviewLevel&&(n=this.getOverviewLevelSymbol()),i=n?[n]:this.i9()){var s=t.isRenderStyleUpToDate();if(!s)for(var h=this.t9(t),u=i.length,o=0;o<u;o++){var e=i[o],f=s?null:this.Q4(e,h);e.ik(t,f)}}},ai.prototype.r9=function(t){return!!t.LF},ai.prototype.render=function(t){var i,n,r=this.getSession().ok();if(
r.currentLod===H.LODType.IntermediateLevel?n=this.getIntermediateLevelSymbol():r.currentLod===H.LODType.OverviewLevel&&(n=this.getOverviewLevelSymbol()),i=n?[n]:this.i9())for(var s=i.length,h=0;h<s;h++){var u=i[h];this.r9(u)||t.renderSymbol(u)}},ai.prototype.updateRender=function(t){for(var i,n,r=this.n9(),s=r.length,h=0;h<s;h++)t.removeSymbol(r[h]);this.h4=[];var u,o=this.getSession().ok();if(o.currentLod===H.LODType.IntermediateLevel?n=this.getIntermediateLevelSymbol():o.currentLod===H.LODType.OverviewLevel&&(n=this.getOverviewLevelSymbol()),i=n?[n]:this.i9(),o.isChanged)switch(o.previousLod){case H.LODType.DetailLevel:for(var e=this.i9(),f=e.length,c=0;c<f;c++)t.clearSymbolByLod(e[c]);break;case H.LODType.IntermediateLevel:(u=this.getIntermediateLevelSymbol())&&t.clearSymbolByLod(u);break;case H.LODType.OverviewLevel:(u=this.getOverviewLevelSymbol())&&t.clearSymbolByLod(u)}for(s=i.length,c=0;c<s;c++){var a=i[c];this.r9(a)||t.updateRenderSymbol(a)}},
ai.prototype.renderOverview=function(t){var i=t.getStyle(),n=this.getRenderingPosition();n&&(i.transform=this.getEvaluatedTransform(1,1,n));i=this.getWidthValue(),n=this.getHeightValue();t.renderRect(new H.Rect(0,0,i,n))},ai.prototype.s9=function(){var t=this.getOwner();return t?t instanceof ai?t.s9():this:null},ai.prototype.h9=function(){var t=this.getOuterNode();return t&&t instanceof ai?t.h9():this},ai.prototype.L4=function(){var t=this.getOuterNode();return t?t.isNestedViewMode&&t.isNestedViewMode()?t:t.L4():null},ai.prototype.HE=function(t){var i=[];if(!this.getSession().getSheetConfigurationData().transformPreviewOption.nestedNodeParentPreviewEnabled)return i;var n=this.getOuterNode();return n&&(n.isGroupingAllowed()||n.getIsContainer())&&n.isVisible()&&t.indexOf(n)<0&&(((n=this.h9()).isGroupingAllowed()||n.getIsContainer())&&i.push(n)),i},ai.prototype.LE=function(t){var i,n=[],r=this.getSession().getSheetConfigurationData().transformPreviewOption;if(!r.labelPreviewEnabled||(
i=this.getLabel())&&i.isVisible()&&t.indexOf(i)<0&&n.push(i),r.referencingElementsPreviewEnabled)for(var s=this.getReferencingLocations(),h=0,u=s.length;h<u;h++){var o=s[h].getOwner();o!==this&&o instanceof ai&&o.isVisible()&&t.indexOf(o)<0&&!o.kN&&(n.push(o),n=n.concat(o.LE(t)))}return n},ai.prototype.renderPreview=function(t,i,n){for(var r,s,h=this.getEvaluatedTransform(1,1,this.getRenderingPosition()),u=this.getSession(),o=u.ok(),e=u.ek(o,this)?[]:(o.currentLod===H.LODType.IntermediateLevel?r=this.getIntermediateLevelSymbol():o.currentLod===H.LODType.OverviewLevel&&(r=this.getOverviewLevelSymbol()),r?[r]:this.getSymbols()),f=e.length,c=0;c<f;c++)e[c].isVisible()&&(s=this.Q4(e[c],h),t.renderOverlaySymbol(e[c],s))},ai.prototype.TE=function(t){var i=this.getBBox();t.originalBBox=i.clone(),t.originalTransformedBBox=this.getTransformedBBox(),t.originalRotation=this.getRotation(),t.originalAnchor=this.getAnchorPosition(),t.originalMargins=this.getMargins?this.getMargins():null
;i=this.getLocation();i&&(t.originalRelativeLoc.inputX=i.getInputValueX(),t.originalRelativeLoc.inputY=i.getInputValueY(),t.originalRelativeLoc.percentX=i.getInputPercentX(),t.originalRelativeLoc.percentY=i.getInputPercentY(),i.getSegmentIdentifier&&(t.originalRelativeLoc.segmentId=i.getSegmentIdentifier()))},ai.prototype.PE=function(t){var i=this.getLocation();if(i&&i.LR)return i.LR=!1,t.originalRelativeLoc.inputX=i.getInputValueX(),t.originalRelativeLoc.inputY=i.getInputValueY(),t.originalRelativeLoc.percentX=i.getInputPercentX(),void(t.originalRelativeLoc.percentY=i.getInputPercentY());this.modifyBoundingBox(t.originalBBox.x,t.originalBBox.y,t.originalBBox.width,t.originalBBox.height),i&&(i.setInputValueX(t.originalRelativeLoc.inputX),i.setInputValueY(t.originalRelativeLoc.inputY),i.setInputPercentX(t.originalRelativeLoc.percentX),i.setInputPercentY(t.originalRelativeLoc.percentY),i.setEvaluatedX(void 0),i.setEvaluatedY(void 0),i.setSegmentIdentifier&&i.setSegmentIdentifier(
t.originalRelativeLoc.segmentId)),isNaN(t.originalRotation)||this.setRotation(t.originalRotation)},ai.prototype.startPreview=function(){var t=this.getSymbols();t&&t.forEach(function(t){t.startPreview()})},ai.prototype.VE=function(){var t=this.getSymbols();t&&t.forEach(function(t){t.VE()})},ai.prototype.update=function(){this.setUpToDate(!1)},ai.prototype.jA=function(){return!0},ai.prototype.VA=function(){return 1},ai.prototype.WA=function(){},ai.prototype.u9=function(){var t=this.getOwningSheet();if(t){t=t.getPreferencesInternal();if(t)return t.o9()}return!0},ai.prototype.remove=function(){var t=wi.getValue(this);t&&t.remove();t=this.getOwner();t&&t.removeGroupMemberAfterDelete&&t.removeGroupMemberAfterDelete(this),this.getOwningSheet().removeElement(this);for(var i=this.o4.length-1;0<i;i--)this.o4[i].setReference(void 0);this.o4=[];var n=this.a4;if(n){for(i=n.size()-1;0<=i;i--){var r=n.get(i);r.remove(!0),r.setOwner(void 0)}n.clear(),Pi.setValue(this,null)}t=Oi.getValue(this);t&&(
t.remove(!0),Oi.remove(this)),Li.setValue(this,null);t=this.getMoveStrategy();t&&(t.setTarget(null),this.setMoveStrategy(null));t=this.getSelectionPolicy();t&&(this.setSelectionPolicy(null),t.remove()),this.lF=null;var s=this.M_();if(s&&this.u9())for(var h=0,u=s.length;h<u;h++){var o=s[h];o&&o.o9()&&(o.setOwner(null),o.remove(!0))}l.prototype.remove.call(this)},ai.prototype.select=function(t){var i=this.XM();if((i&Ht.Selected)==Ht.Selected||(i&Ht.Hover)==Ht.Hover){var n=this.getOverlays();if(n&&n.length){var r=n.length,s=!1;(i&Ht.EntireConnectionHover)===Ht.EntireConnectionHover&&(s=!0);for(var h=r-1;0<=h;h--){var u=n[h];if((!s||u.fk())&&(u&&u.select(t)))return t.parent=this,t.target=u,!0}}if(t.parent===this){if(!(t.target&&t.target instanceof jt)){var o=this.getSymbols();if(o)for(h=(r=o.length)-1;0<=h;h--){var e=o[h];if(e.select(t))return t.target=e,!0}}return!0}}return!1},ai.prototype.cN=function(t){var i=this.XM();if((i&Ht.Selected)==Ht.Selected||(i&Ht.Hover)==Ht.Hover){
var n=this.getOverlays();if(n&&n.length)for(var r=n.length-1;0<=r;r--){var s=n[r];if(s.select(t))return s}}return null},ai.prototype.selectSymbolOccurrence=function(t){if(t.parent===this){if(!(t.target&&t.target instanceof jt)){var i=this.getSymbols();if(i)for(var n=i.length-1;0<=n;n--){var r=i[n];if(r.select(t))return r}}return t.target}},ai.prototype.a_=function(t,i){var n=this.getSelectionPolicy();if(!n)return!0;var r=n.getSelectionRegion(),s=n.getSelectionAccuracy(),n=n.getSelectionSymbol();if(s===H.SelectionAccuracyType.RoughSelection){if(r===H.SelectionRegionType.InsideOutline)return!0;if(r===H.SelectionRegionType.Outline&&this.getTransformedBBox().isPointOnOutline(t.point,t.tolerance))return!0}else if(s===H.SelectionAccuracyType.PreciseSelection)for(var h=n?[n]:this.getSymbols(),u=h.length,o=0;o<u;o++)if(h[o].a_(t,r,i))return!0;return!1},ai.prototype.MI=function(){if(this.getOwningSheet){var t=this.getOwningSheet();if(t)return t.getSession()}return null},
ai.prototype.isSelected=function(){return(this.XM()&Ht.Selected)==Ht.Selected},ai.prototype.updateBinding=function(t){null!==this.lF&&this.lF.bindNewValues(t)},ai.prototype.removeSymbols=function(){var t=this.getSymbols();if(t){for(var i=t.length,n=0;n<i;++n)this.removeSymbol(t[n]);var r=this.a4;r&&r.clear()}},ai.prototype.getOwner=function(){return l.prototype.getOwner.call(this)||Ti.getValue(this)},ai.prototype.updateAnchor=function(){var t,i=this.a4;if(i){var n,r,s,h,u=i.size();if(1===u)(s=i.get(0).getSymbol())&&(n=(h=s.getAnchor()).anchorX,r=h.anchorY);else if(1<u)if(s=i.get(0).getSymbol()){n=(h=s.getAnchor()).anchorX,r=h.anchorY;for(var o=1;o<u;o++)if((s=i.get(o).getSymbol())&&(n!==(h=s.getAnchor()).anchorX||r!==h.anchorY)){r=n=void 0;break}}}void 0!==n&&void 0!==r||(t=this.getSession(),W.common.ExceptionHelper.throwIfInvalid(t,"SheetSession"),t=t.getSheetConfigurationData(),void 0===n&&(n=t.defaultAnchorX),void 0===r&&(r=t.defaultAnchorY)),this.IR.x===n&&this.IR.y===r||(
this.jF=!0),this.IR.x=n,this.IR.y=r},ai.prototype.getAnchor=function(){return this.IR},ai.prototype.getTransformedBBox=function(){var t=this.getBBox(),i=this.getXform(),n=new H.Rect(0,0,t.width,t.height);return(n=i.transformRect(n)).x+=t.x,n.y+=t.y,n},ai.prototype.RC=function(t){var i=this.getTransformedBBox();return t&&(i.x+=t.x,i.y+=t.y),[new H.Point(i.x,i.y),new H.Point(i.getCenterX(),i.getCenterY()),new H.Point(i.x+i.width,i.y+i.height)]},ai.prototype.DE=function(){var t,i=wi.getValue(this);return i?i.getResolvedEvaluatedLocation():(t=mi.getValue(this)||0,i=di.getValue(this)||0,new H.Point(t,i))},ai.prototype.doAlign=function(t,i,n,r,s,h){if(1!==i.length){var u,o,e,f,c,a=0===r?i[n].x:i[n].y,v=this.AC||this.RC();return a=0===n||2===n?(o=0===r?v[0].x:v[0].y,e=0===r?v[2].x:v[2].y,Math.abs(o-a)<Math.abs(e-a)?(f=v[0],c=o-a,0):(f=v[2],c=e-a,2)):(r=0===r?v[1].x:v[1].y,f=v[1],c=r-a,1),u=H.MathUtil.doubleCompare(Math.abs(c),s)<=0?{source:t,sourceLoc:i[n],target:this,targetLoc:f,
targetAlignSide:a,offsetToTarget:c}:u}},ai.prototype.ZC=function(t,i,n,r,s){var h=[],u=this.RC(i),o=Math.min(3,u.length),i=this.tk();i.isLockX&&0===n&&(r=0),i.isLockY&&1===n&&(r=0);for(var e=0;e<o;e++){h[e]=[];for(var f=0,c=t.length;f<c;f++){var a=t[f].doAlign(this,u,e,n,r,s);a&&h[e].push(a)}}return[h]},ai.prototype.getAvailableScaleHandles=function(){return Ii.getValue(this)},ai.prototype.setAvailableScaleHandles=function(t){Ii.setValue(this,t)},ai.prototype.getTransformHandles=function(){return Ii.getValue(this)},ai.prototype.setTransformHandles=function(t){Ii.setValue(this,t)},ai.prototype.clone=function(t){t=l.prototype.clone.call(this,t);return t.WF=this.WF,t.HF=this.HF,t.IR.x=this.IR.x,t.IR.y=this.IR.y,t},ai.prototype.on=function(t,i){this.eventListeners||(this.eventListeners={}),this.eventListeners[t]||(this.eventListeners[t]=[]),this.eventListeners[t].push(i)},ai.prototype.off=function(t,i){this.eventListeners&&(this.eventListeners[t]||(this.eventListeners[t]=[]),
i=this.eventListeners[t].indexOf(i),this.eventListeners[t].splice(i,1))},ai.prototype.setMinNodeSize=function(t){ji.setValue(this,t)},ai.prototype.getMinNodeSize=function(){return ji.getValue(this)},ai.prototype.getSVGDom=function(t,i,n){var r=!0;if(null==t&&null==i&&(n||(r=!1)),!r)return this.E5||void 0;if(this.E5){var s=[];if(n)for(var h,u=n.length,o=0;o<u;o++)h=n[o].getId(),s.push(h);return this.getSession().EA.getSheetElementDom(this,t,i,s)}},ai.prototype.setMoveStrategy=function(t){zi.setValue(this,t)},ai.prototype.getMoveStrategy=function(){var t,i=zi.getValue(this);return i||(t=this.getLocation())&&t instanceof vt&&t.isLockY()&&(ri?ri.setTarget(this):(t=this.getSession(),ri=new t.CA.createAlongPathMoveStrategy(this)),i=ri),i},ai.prototype.setResizeOption=function(t){Vi.setValue(this,t)},ai.prototype.getResizeOption=function(){return Vi.getValue(this)},ai.prototype.setSelectionPolicy=function(t){Yi.setValue(this,t)},ai.prototype.getSelectionPolicy=function(){return Yi.getValue(
this)},ai.prototype.getPropagationTraverseOptions=function(){return Xi.getValue(this)},ai.prototype.e9=function(){var t=Xi.getValue(this);return t=void 0===t?H.PropagationOptions.All:t},ai.prototype.setPropagationTraverseOptions=function(t){Xi.setValue(this,t)},ai.prototype.f9=function(){return this.e9()&H.PropagationOptions.HoverHighlightPropagateAllowed},ai.prototype.c9=function(){return this.e9()&H.PropagationOptions.SelectHighlightPropagateAllowed},ai.prototype.o9=function(){return this.e9()&H.PropagationOptions.DeletePropagateAllowed},ai.prototype.a9=function(){return this.e9()&H.PropagationOptions.RotatePropagateAllowed},ai.prototype.v9=function(){return this.e9()&H.PropagationOptions.MovePropagateAllowed},ai.prototype.l9=function(){return this.e9()&H.PropagationOptions.VisiblePropagateAllowed},ai.prototype.m9=function(){return this.e9()&H.PropagationOptions.CollapseVisiblePropagateAllowed},ai.prototype.d9=function(){return this.e9(
)&H.PropagationOptions.LayerVisiblePropagateAllowed},ai.prototype.setSize=function(t,i){this.setWidthValue(t),this.setHeightValue(i)},ai.prototype.getSize=function(){return[this.getWidthValue(),this.getHeightValue()]},ai.prototype.notifySizeUpdateOnTextStyleChanged=function(){this.setUpToDate(!1),this.hL=!0,this.nL=!0;for(var t=this.getSymbols(),i=t.length,n=0;n<i;n++){var r=t[n].getSymbol();r&&r.setSizeOutOfDate()}},ai.prototype.getDefaultConnectionLocationRule=function(){return null},ai.prototype.visitModelChangeMessage=function(t,i){},ai.prototype.PF=function(){return null},ai.prototype.DF=function(){return null},ai.prototype.RF=function(){return null},ai.prototype.FF=function(){return null},ai.prototype.w9=function(){var t=this.getSession(),i=this.getElementType();if(i===H.ElementType.FEATURE){var n=H.Constants.CANVAS_ID_PREFIX_FOR_SYSTEM+H.Constants.CANVAS_ID_FOR_FEATURE+H.Constants.CANVAS_ID_FOR_SIZE_ON_SHEET+H.Constants.CANVAS_ID_SUFFIX;return t.lk(n)}if(
i===H.ElementType.UI||i===H.ElementType.OVERLAY){var r=this.ck();return t.lk(r)}r=this.lN().owningElement;if(r&&r instanceof ai)return r.getRenderCanvas();n=H.Constants.CANVAS_ID_PREFIX_FOR_SYSTEM+H.Constants.CANVAS_ID_FOR_DEFAULT+H.Constants.CANVAS_ID_FOR_SIZE_ON_SHEET+H.Constants.CANVAS_ID_SUFFIX;return t.lk(n)},ai.prototype.getRenderCanvas=function(){var t=this.getLayer();if(t){t=t.getRenderCanvas();if(t)return t}return this.w9()},ai.prototype.setIntermediateLevelSymbol=function(t){Gi.setValue(this,t),t.setOwner(this)},ai.prototype.getIntermediateLevelSymbol=function(){return Gi.getValue(this)},ai.prototype.setOverviewLevelSymbol=function(t){Ui.setValue(this,t),t.setOwner(this)},ai.prototype.getOverviewLevelSymbol=function(){return Ui.getValue(this)},ai.prototype.setLodVisibleOption=function(t){Ji.setValue(this,t)},ai.prototype.b9=function(){return Ji.getValue(this)},ai.prototype.getLodVisibleOption=function(){var t=this.b9();if(void 0===t&&this.getElementType()===H.ElementType.UI
)return H.LODVisibleOptions.Default;return t},ai.prototype.tk=function(t){if(t&&0<t.length){var i,n=this.findLocationReference(t);if(-1<n)if(i=t[n].getLocation())return i.tk()}else if(i=this.getLocation())return i.tk();return{isLockX:!1,isLockY:!1}},ai.prototype.findLocationReference=function(t){for(var i,n=t.indexOf(this),r=this;r&&n<0;)n=(r=(i=r.getLocation())?i.getReference():null)?t.indexOf(r):-1;return n},ai.prototype._9=function(t){return t},ai.prototype.y9=function(){return!1},ai.prototype.TN=function(t){var i=[],n=this.getSymbols();if(n.length)for(var r=0;r<n.length;r++){var s=n[r].qF(t);i.push(s)}return i},ai.prototype.ME=function(t){var i=this.getSymbols();if(i.length)for(var n=0;n<i.length;n++)i[n].ZF();this.A_(t)},ai.prototype.A_=function(t){var i,n=this.getSession().ok();n.currentLod===H.LODType.IntermediateLevel?i=this.getIntermediateLevelSymbol():n.currentLod===H.LODType.OverviewLevel&&(i=this.getOverviewLevelSymbol());var r=i?[i]:this.i9(),s=(this.getEvaluatedTransform(
1,1,this.getRenderingPosition()),r?r.length:0);if(0<s){var h=t.isRenderStyleUpToDate();if(!h)for(var u=this.t9(t),o=0;o<s;o++){var e,f=r[o];this.r9(f)||(e=h?null:this.Q4(f,u),f.GF(t,e))}}},ai.prototype.setCollection=function(t){var i;!(this.c4=t)||(i=this.getOwningSheet())&&!i.getCollection(t.getName())&&i.addCollection(t)},ai.prototype.getCollection=function(){return this.c4},ai.prototype.ID=function(){var t=this.getCollection();if(t){t=t.getInteractiveSettings();if(t)if(t.getPrintStatus()===H.PrintStatus.NEVER)return!0}return!1},ai.prototype.LD=function(){var t=this.getCollection();if(t){t=t.getInteractiveSettings();if(t)if(t.getPrintStatus()===H.PrintStatus.ALWAYS)return!0}return!1},ai.prototype.setElementType=function(t){Fi.setValue(this,t)},ai.prototype.getElementType=function(){return Fi.getValue(this)},ai.prototype.setSizeCoordinateMode=function(t){Di.setValue(this,t)},ai.prototype.getSizeCoordinateMode=function(){return Di.getValue(this)},
ai.prototype.setLocationCoordinateMode=function(t){Ri.setValue(this,t)},ai.prototype.getLocationCoordinateMode=function(){return Ri.getValue(this)},l.inheritedBy(ai);var li=W.Property.define(ai,"m_appObj","IDBEntity",W.PropertyFlags.None),mi=W.Property.define(ai,"m_x",Number,W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.SupportsShallowCopy),di=W.Property.define(ai,"m_y",Number,W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.SupportsShallowCopy),wi=W.Property.define(ai,"m_location","Location",W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.SupportsDeepCopy,X,X),bi=W.Property.define(ai,"m_widthPolicy",Number,W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.SupportsShallowCopy),_i=W.Property.define(ai,"m_heightPolicy",Number,W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.SupportsShallowCopy),yi=W.Property.define(ai,"m_rotation",Number,
W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.SupportsShallowCopy,function(t,i,n,r){t.setUpToDate(!1),t.setTransformUpdate(!0)}),gi=W.Property.define(ai,"m_mirrorX",Boolean,W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.SupportsShallowCopy),pi=W.Property.define(ai,"m_mirrorY",Boolean,W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.SupportsShallowCopy),Mi=W.Property.define(ai,"m_width",Number,W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.SupportsShallowCopy,function(t,i,n,r){Ci.setValue(t,!1),t.updateBinding("getWidthValue")}),Si=W.Property.define(ai,"m_height",Number,W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.SupportsShallowCopy,function(t,i,n,r){Ci.setValue(t,!1),t.updateBinding("getHeightValue")}),Ni=W.Property.define(ai,"m_internal",Boolean,W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.SupportsShallowCopy),Li=W.Property.define(ai
,"m_layer","Layer",W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.AffectRender|W.PropertyFlags.TwoWayReference|W.PropertyFlags.SupportsShallowCopy),Oi=W.Property.define(ai,"m_label","Annotation",W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.SupportsDeepCopy,m,m),Ti=W.Property.define(ai,"m_owningSheet","Sheet",W.PropertyFlags.SupportsShallowCopy),Ai=W.Property.define(ai,"m_sourceElement","SheetElement",W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.SupportsShallowCopy,i,i),Pi=W.Property.define(ai,"m_symbols","List",W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.AffectRender|W.PropertyFlags.TwoWayReference|W.PropertyFlags.SupportsDeepCopy|W.PropertyFlags.IsCollection,t,t),Ci=W.Property.define(ai,"m_upToDate",Boolean,
W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.AffectIndexing|W.PropertyFlags.AffectRender|W.PropertyFlags.BoundingBox|W.PropertyFlags.SupportsShallowCopy),ki=W.Property.define(ai,"m_visible",Boolean,W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.AffectRender|W.PropertyFlags.AffectOverlay|W.PropertyFlags.SupportsShallowCopy,function(t,i,n,r){t.d4=n,t.m4(n)},function(t,i,n,r){t.d4=n}),Bi=W.Property.define(ai,"m_visibleMask",Number,W.PropertyFlags.NotifyChange|W.PropertyFlags.AffectRender|W.PropertyFlags.AffectOverlay),xi=W.Property.define(ai,"m_zDepth",Number,W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.AffectRender|W.PropertyFlags.SupportsShallowCopy,function(t,i,n,r){t.X4=n,t.WD=!0},function(t,i,n,r){t.X4=n}),Ei=W.Property.define(ai,"m_allowedTransformations",Number,W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.SupportsShallowCopy),Di=W.Property.define(ai,"m_sizeCoordinateMode",
Number,W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.AffectRender|W.PropertyFlags.SupportsShallowCopy,function(t,i,n,r){var s=t.getElementType();s!==H.ElementType.DEFAULT&&s!==H.ElementType.FEATURE&&((s=t.getLayer())&&s.getRenderCanvas()||(s=t.getSession(),t=t.ck(),s&&!s.lk(t)&&(s.pA(t),s.pA(t+H.Constants.CANVAS_ID_SUFFIX_FOR_TEMPGEO))))}),Ri=W.Property.define(ai,"m_locationCoordinateMode",Number,W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.AffectRender|W.PropertyFlags.SupportsShallowCopy),Fi=W.Property.define(ai,"m_elementType",Number,W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.AffectRender|W.PropertyFlags.SupportsShallowCopy,function(t,i,n,r){var s;r!==n&&((s=t.getOwningSheet()).g9().get(r).removeByKey(t.guid),s.addElement(t)),n!==H.ElementType.DEFAULT&&n!==H.ElementType.FEATURE&&((n=t.getLayer())&&n.getRenderCanvas()||(n=t.getSession(),t=t.ck(),n&&!n.lk(t)&&(n.pA(t),n.pA(
t+H.Constants.CANVAS_ID_SUFFIX_FOR_TEMPGEO))))}),Ii=W.Property.define(ai,"m_transformHandles",Number,W.PropertyFlags.None),Wi=W.Property.define(ai,"m_highlightFlags",Number,W.PropertyFlags.NotifyChange|W.PropertyFlags.AffectRender,v,v),Hi=W.Property.define(ai,"m_boundingRect","Rect",W.PropertyFlags.NotifyChange|W.PropertyFlags.AffectIndexing|W.PropertyFlags.BoundingBox),ji=W.Property.define(ai,"m_minNodeSize",Array,W.PropertyFlags.None),zi=W.Property.define(ai,"m_moveStrategy","MoveStrategy",W.PropertyFlags.None),Vi=W.Property.define(ai,"m_resizeOption",Number,W.PropertyFlags.None),Yi=W.Property.define(ai,"m_selectionPolicy","SelectionPolicy",W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.TwoWayReference|W.PropertyFlags.SupportsDeepCopy,function(t,i,n,r){r&&r.setOwner(null),n&&n.setOwner(t)}),Xi=W.Property.define(ai,"m_propagationTraverseOptions",Number,W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.SupportsShallowCopy),
Gi=W.Property.define(ai,"m_intermediateLevelSymbol","SymbolOccurrence",W.PropertyFlags.None),Ui=W.Property.define(ai,"m_overviewLevelSymbol","SymbolOccurrence",W.PropertyFlags.None),Ji=W.Property.define(ai,"m_lodVisibleOption",Number,W.PropertyFlags.None);function qi(){c.call(this),Zi.setValue(this,H.ConnectionLabelOffsetOption.NONE),Ki.setValue(this,10)}qi.prototype.evaluate=function(){return"Needs to be implemented"},qi.prototype.setOffsetPosition=function(t){Zi.setValue(this,t)},qi.prototype.getOffsetPosition=function(){return Zi.getValue(this)},qi.prototype.setDistanceOffset=function(t){Ki.setValue(this,t)},qi.prototype.getDistanceOffset=function(){return Ki.getValue(this)},qi.prototype.getEvaluatedPoint=function(t,i,n,r){var s,h=this.getOffsetPosition(),u=this.getDistanceOffset(),o=void 0;if(i&&i.getSegmentIdentifier&&(c=i.getSegmentIdentifier(),!(s=i.getReference())||(i=s.getGeometry())&&(e=i.getPoints(),f=s.trimPathToNodes(e),s.Fk(f),1<(e=f.length)&&(a=f[c=e-2<(c=c||0)?e-2:c],
v=f[c+1],o=0===H.MathUtil.doubleCompare(a.y,v.y)))),void 0===o)return new H.Point(n,r);var e=(e=t.getRotation())||0;e=Math.round(e);var f=0===H.MathUtil.doubleCompare(e%180,0),c=0,a=0,v=t.getAnchor();t&&t.getHeightValue&&(c=(l=t.getHeightValue())*v.y,a=l*(1-v.y));var e=0,l=0;return t&&t.getWidthValue&&(e=(t=t.getWidthValue())*v.x,l=t*(1-v.x)),o?f?h==H.ConnectionLabelOffsetOption.TOP_LEFT||h==H.ConnectionLabelOffsetOption.TOP_RIGHT?r-=u+a:h!=H.ConnectionLabelOffsetOption.BOTTOM_LEFT&&h!=H.ConnectionLabelOffsetOption.BOTTOM_RIGHT||(r+=u+c):h==H.ConnectionLabelOffsetOption.TOP_LEFT||h==H.ConnectionLabelOffsetOption.TOP_RIGHT?r-=u+e:h!=H.ConnectionLabelOffsetOption.BOTTOM_LEFT&&h!=H.ConnectionLabelOffsetOption.BOTTOM_RIGHT||(r+=u+l):f?h==H.ConnectionLabelOffsetOption.TOP_LEFT||h==H.ConnectionLabelOffsetOption.BOTTOM_LEFT?n-=u+l:h!=H.ConnectionLabelOffsetOption.TOP_RIGHT&&h!=H.ConnectionLabelOffsetOption.BOTTOM_RIGHT||(n+=u+e
):h==H.ConnectionLabelOffsetOption.TOP_LEFT||h==H.ConnectionLabelOffsetOption.BOTTOM_LEFT?n-=u+a:h!=H.ConnectionLabelOffsetOption.TOP_RIGHT&&h!=H.ConnectionLabelOffsetOption.BOTTOM_RIGHT||(n+=u+c),new H.Point(n,r)},qi.prototype.setDefaultValue=function(t,i){Zi.setRawValue(this,t),Ki.setRawValue(this,i)},c.inheritedBy(qi);var Zi=W.Property.define(qi,"m_offsetPosition",Number,W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.AffectRender|W.PropertyFlags.SupportsShallowCopy),Ki=W.Property.define(qi,"m_distanceOffset",Number,W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.AffectRender|W.PropertyFlags.SupportsShallowCopy);function Qi(t,i,n,r,s){l.call(this),$i.setRawValue(this,i),tn.setRawValue(this,n),nn.setRawValue(this,r),rn.setRawValue(this,s),this.p9=H.JumperShapeType.ARC}qi.getDefaultRule=function(){var t=W.AppSession.workSheetSession;if(!t)return null;var i=t.aA;return i||(i=new qi,t.aA=i),i},Qi.prototype.getStartX=function(){
return $i.getValue(this)},Qi.prototype.setStartX=function(t){$i.setValue(this,t)},Qi.prototype.getStartY=function(){return tn.getValue(this)},Qi.prototype.setStartY=function(t){tn.setValue(this,t)},Qi.prototype.getEndX=function(){return nn.getValue(this)},Qi.prototype.setEndX=function(t){nn.setValue(this,t)},Qi.prototype.getEndY=function(){return rn.getValue(this)},Qi.prototype.setEndY=function(t){rn.setValue(this,t)},Qi.prototype.getStartPoint=function(){var t=$i.getValue(this),i=tn.getValue(this);if(void 0!==t&&void 0!==i)return new H.Point(t,i)},Qi.prototype.getEndPoint=function(){var t=nn.getValue(this),i=rn.getValue(this);if(void 0!==t&&void 0!==i)return new H.Point(t,i)},Qi.prototype.setShapeType=function(t){this.p9=t},Qi.prototype.getShapeType=function(){return this.p9},Qi.prototype.setSegmentIdentifier=function(t){sn.setValue(this,t)},Qi.prototype.getSegmentIdentifier=function(){return sn.getValue(this)},Qi.prototype.setSegmentIdentifierCrossing=function(t){hn.setValue(this,t),
this.M9=t},Qi.prototype.getSegmentIdentifierCrossing=function(){return this.M9},Qi.prototype.setCrossingConnection=function(t){un.setValue(this,t),this.S9=t},Qi.prototype.getCrossingConnection=function(){return this.S9},Qi.prototype.remove=function(){un.setRawValue(this,void 0),this.S9=void 0,l.prototype.remove.call(this)},l.inheritedBy(Qi);var $i=W.Property.define(Qi,"m_startX",Number,W.PropertyFlags.None),tn=W.Property.define(Qi,"m_startY",Number,W.PropertyFlags.None),nn=W.Property.define(Qi,"m_endX",Number,W.PropertyFlags.None),rn=W.Property.define(Qi,"m_endY",Number,W.PropertyFlags.None),sn=W.Property.define(Qi,"m_segmentIdentifier",Number,W.PropertyFlags.None),hn=W.Property.define(Qi,"m_segmentIdentifierCrossing",Number,W.PropertyFlags.None),un=W.Property.define(Qi,"m_crossingConnection","Connection",W.PropertyFlags.None),on=void 0;function en(t,i,n,r,s,h,u){var o=H.Constants.DEFAULT_PORT_SIZE,n=n||o,o=i||o;wn.setRawValue(this,new H.Vector(0,0)),bn.setRawValue(this,
H.Direction.BOTH),_n.setRawValue(this,-1),yn.setRawValue(this,!1),Nn.setRawValue(this,15),Mn.setRawValue(this,new W.List),this.uA=null,this.N9=null,ai.call(this,t,o,n,r,s,h,u)}en.prototype.postCreate=function(t,i,n,r,s,h){this.setUpToDate(!1),null!=r&&void 0!==r||null!=s&&void 0!==s?ai.prototype.postCreate.call(this,t,i,n,r,s,h):this.q4(t,i,n)},en.prototype.getResolvedConnectionDirection=function(){var t,i,n,r,s,h,u,o=wn.getValue(this),e=this.getXform().transformVector(o);return 0===H.MathUtil.doubleCompare(e.x,0)&&0!==e.x&&(e.x=0),0===H.MathUtil.doubleCompare(e.y,0)&&0!==e.y&&(e.y=0),0===e.x&&0===e.y&&(void 0!==(s=this.getOwner())&&s.getTransformedBBox?(u=s.getTransformedBBox(),h=this.getResolvedSymbolConnectionPoint(),u.isPointInside(h,H.MathUtil.doubleTolerance)?(t=Math.abs(h.x-u.x),i=Math.abs(h.x-(u.x+u.width)),n=Math.abs(h.y-u.y),r=Math.abs(h.y-(u.y+u.height)),o=Math.min(t,i,n,r),0===H.MathUtil.doubleCompare(o,i)?(e.x=1,e.y=0):0===H.MathUtil.doubleCompare(o,t)?(e.x=-1,e.y=0
):0===H.MathUtil.doubleCompare(o,r)?(e.x=0,e.y=1):(e.x=0,e.y=-1),e.distance=o,0===H.MathUtil.doubleCompare(t,i)&&(e.xVariable=!0),0===H.MathUtil.doubleCompare(n,r)&&(e.yVariable=!0)):(0<=H.MathUtil.doubleCompare(h.x,u.x+u.width)?(e.x=1,e.y=0):H.MathUtil.doubleCompare(h.x,u.x)<=0?(e.x=-1,e.y=0):H.MathUtil.doubleCompare(h.y,u.y)<=0?(e.x=0,e.y=-1):(e.x=0,e.y=1),e.distance=0)):(e.x=1,e.distance=0)),Object.prototype.hasOwnProperty.call(e,"distance")||(void 0!==(s=this.getOwner())&&s.getTransformedBBox?(h=this.getResolvedSymbolConnectionPoint(),u=s.getTransformedBBox(),1==e.x?e.distance=Math.abs(u.x+u.width-h.x):-1==e.x?e.distance=Math.abs(u.x-h.x):1==e.y?e.distance=Math.abs(u.y+u.height-h.y):e.distance=Math.abs(u.y-h.y)):e.distance=0),e},en.prototype.getConnectionDirection=function(){return wn.getValue(this)},en.prototype.setConnectionDirection=function(t){var i;W.common.ExceptionHelper.throwIfInvalidArray(t,"Connection Direction"),2<=t.length&&((i=wn.getValue(this)).x=t[0],i.y=t[1])},
en.prototype.nF=function(t){t&&1==t[0]&&(this.connectionDirectionReversible=!0)},en.prototype.C_=function(){return!!this.hasSymbol()},en.prototype.addConnection=function(t){var i=Mn.getValue(this);i.contains(t)||i.add(t)},en.prototype.removeConnection=function(t){return Mn.getValue(this).remove(t)},en.prototype.getConnections=function(){var t=Mn.getValue(this);return t?t.toArray():null},en.prototype.askLinkedConnections=function(){return this.getConnections()||[]},en.prototype.getConnectionNum=function(){var t=0,i=Mn.getValue(this);return t=i?i.size():t},en.prototype.getParentSides=function(){return Nn.getValue(this)},en.prototype.setParentSides=function(t){Nn.setValue(this,t)},en.prototype.getDirection=function(){return bn.getValue(this)},en.prototype.setDirection=function(t){bn.setValue(this,t)},en.prototype.getProxy=function(){return gn.getValue(this)},en.prototype.setProxy=function(t){gn.setValue(this,t)},en.prototype.setIsProxy=function(t){pn.setValue(this,t)},
en.prototype.isProxy=function(){return pn.getValue(this)},en.prototype.getConnectionTrimPolicy=function(){return On.getValue(this)},en.prototype.setConnectionTrimPolicy=function(t){On.setValue(this,t)},en.prototype.getTransformPolicy=function(){return Tn.getValue(this)},en.prototype.setTransformPolicy=function(t){Tn.setValue(this,t)},en.prototype.getSymbolConnectionLocation=function(){var t,i,n,r=Sn.getValue(this);return void 0===r?(r=this.getLocation())||((r=new a((n=this.getBBox()).x,n.y)).setReference(this),r.sF=!1,r.setInput(H.CoordinateMode.PERCENT,H.Axis.X,.5),r.setInput(H.CoordinateMode.ABSOLUTE,H.Axis.X,0),r.setInput(H.CoordinateMode.PERCENT,H.Axis.Y,.5),r.setInput(H.CoordinateMode.ABSOLUTE,H.Axis.Y,0),Sn.setValue(this,r),r.setOwner(this)):r.getReference()||(t=r.getEvaluatedLocation(),i=this.getAnchorPositionX(),n=this.getAnchorPositionY(),t.x+=i,t.y+=n,r.setReference(this),r.setEvaluatedLocation(t.x,t.y)),r},en.prototype.getResolvedSymbolConnectionPoint=function(){
return this.getSymbolConnectionLocation().getResolvedEvaluatedLocation()},en.prototype.setSymbolConnectionLocation=function(t){var i=Sn.getValue(this);i!=t&&(i&&i.remove(),Sn.setValue(this,t),t&&(t.sF=!1,t.setOwner(this)))},en.prototype.isPinned=function(){return yn.getValue(this)},en.prototype.setPinned=function(t){yn.setValue(this,t)},en.prototype.setNumberOfAllowedConnections=function(t){_n.setValue(this,t)},en.prototype.getNumberOfAllowedConnections=function(){return _n.getValue(this)},en.prototype.setNumberAllowedConnections=function(t){_n.setValue(this,t)},en.prototype.getNumberAllowedConnections=function(){return _n.getValue(this)},en.prototype.getCollapsedOwner=function(){var t=this.getOwner();return t&&t instanceof ai&&(t.getCollapsedOwner()||t.isExpanded&&!t.isExpanded()&&t.getPorts().indexOf(this)<0&&t)||null},en.prototype.isAllowMoreConnections=function(){var t=!0,i=this.getConnections(),n=i?i.length:0,i=this.getNumberOfAllowedConnections();return t=0<=i&&i<=n?!1:t},
en.prototype._4=function(){ai.prototype._4.call(this);var t=this.getSymbols();if(t&&0!==t.length){var i=this.getConnections();if(i)for(var n=i.length,r=0;r<n;++r)i[r].setUpToDate(!1)}},en.prototype.eC=function(){return this.getSession().xA.eC(this)},en.prototype.LE=function(t){var i=ai.prototype.LE.call(this,t);if(!this.getSession().getSheetConfigurationData().transformPreviewOption.connectionPreviewEnabled)return i;var n=this.getConnections();if(n)for(var r=0,s=n.length;r<s;r++)if(t.indexOf(n[r])<0&&n[r].isVisible()){i.push(n[r]);for(var h=n[r].LE(t),u=0,o=h.length;u<o;u++)i.push(h[u])}return i},en.prototype.TE=function(t){ai.prototype.TE.call(this,t);var i=this.getSymbolConnectionLocation();i&&(t.originalSymbolConnectLoc.inputX=i.getInputValueX(),t.originalSymbolConnectLoc.inputY=i.getInputValueY(),t.originalSymbolConnectLoc.percentX=i.getInputPercentX(),t.originalSymbolConnectLoc.percentY=i.getInputPercentY())},en.prototype.PE=function(t){ai.prototype.PE.call(this,t)
;var i=this.getSymbolConnectionLocation();i&&(i.setInputValueX(t.originalSymbolConnectLoc.inputX),i.setInputValueY(t.originalSymbolConnectLoc.inputY),i.setInputPercentX(t.originalSymbolConnectLoc.percentX),i.setInputPercentY(t.originalSymbolConnectLoc.percentY),i.setEvaluatedX(void 0),i.setEvaluatedY(void 0))},en.prototype.vM=function(){var t,i,s=this;return s.K4||(i={getType:function(){return H.ElementIndexTree.ITEMTYPE_BBOX},getOwner:function(){return s},getBBox:function(){var t,i=s.getSession().getSheetConfigurationData(),n=s.getRenderingBBox();n.width<=0&&(t=i.portIndicatorWidth,n.x-=t/2,n.width=t),n.height<=0&&(r=i.portIndicatorHeight,n.y-=r/2,n.height=r);i=s.getSymbolConnectionLocation();i.getResolvedEvaluatedLocation();var r=s.getLocation();return r&&r!==i&&r.getResolvedEvaluatedLocation(),s.getResolvedSymbolConnectionPoint(),n}},(t=[]).push(i),s.K4=t),{indexedElements:s.K4,discardedIndexedElements:[]}},en.prototype.remove=function(t){var i=Mn.getValue(this).toArray();if(i)for(
var n=i.length,r=0;r<n;r++){var s=i[r],h=this.getResolvedSymbolConnectionPoint();s.getStart()==this?(s.setStart(void 0),s.getStartLocation().setEvaluatedLocation(h.x,h.y)):s.getEnd()==this&&(s.setEnd(void 0),s.getEndLocation().setEvaluatedLocation(h.x,h.y)),s.setUpToDate(!1)}var u=Sn.getValue(this);u&&u.remove(),t||(t=this.getOwner())&&t.removePort&&t.removePort(this),ai.prototype.remove.call(this)},en.prototype.L9=function(){for(var t=this.getConnections(),i=t.length,n=0;n<i;n++)t[n].setUpToDate(!1),t[n].setTransformUpdate(!0)},en.prototype.setUpToDate=function(t){if(ai.prototype.setUpToDate.call(this,t),!this.O9&&!t){t=this.getSession();if(!t||!t.E_)if(this.isProxy())for(var i=this.getProxyMasterPorts(),n=0,r=i.length;n<r;n++)i[n].L9();else this.L9()}},en.prototype.RC=function(t){var i=[],n=this.getResolvedSymbolConnectionPoint();return t&&(n.x+=t.x,n.y+=t.y),i.push(n),i},en.prototype.doAlign=function(t,i,n,r,s,h){var u,o=-1<h.indexOf(H.AlignmentType.PortToPort),e=-1<h.indexOf(
H.AlignmentType.ConnectionEndPointToPort);if(o||e){var f,c=(this.AC||this.RC())[0],h=0===r?c.x:c.y;if(t instanceof en&&o){var a=t.getConnectionDirection(),a=t.getXform().transformVector(a);if(0!==H.MathUtil.doubleCompare(a.x,0)&&0!==H.MathUtil.doubleCompare(a.y,0)||0===r&&0!==H.MathUtil.doubleCompare(a.x,0)||1===r&&0!==H.MathUtil.doubleCompare(a.y,0))return u;a=this.getConnectionDirection(),a=this.getXform().transformVector(a);if(0!==H.MathUtil.doubleCompare(a.x,0)&&0!==H.MathUtil.doubleCompare(a.y,0)||0===r&&0!==H.MathUtil.doubleCompare(a.x,0)||1===r&&0!==H.MathUtil.doubleCompare(a.y,0))return u;a=h-(0===r?i[n].x:i[n].y);H.MathUtil.doubleCompare(Math.abs(a),s)<=0&&(u={source:t,sourceLoc:i[n],target:this,targetLoc:c,offsetToTarget:a})}else 3<i.length&&e&&(e=(n=i.slice(3))[0],i=n[1],e&&i?(n=0===r?e.x:e.y,f=0===r?i.x:i.y,f=Math.abs(h-n)<=Math.abs(h-f)?e:i):e?f=e:i&&(f=i),f&&(a=h-(0===r?f.x:f.y),H.MathUtil.doubleCompare(Math.abs(a),s)<=0&&(u={source:t,sourceLoc:f,target:this,targetLoc:c,
offsetToTarget:a,type:H.AlignmentType.ConnectionEndPointToPort})));return u}},en.prototype.isPortAllowedAtLocationByApplication=function(){return!!Ln.getValue(this)},en.prototype.registerPortLocationProviderCB=function(t){Ln.setValue(this,t)},en.prototype.portLocationProvider=function(t){var i=Ln.getValue(this);i&&(this.O9=!0,i(this,t),delete this.O9)},en.prototype.getMoveStrategy=function(){var t,i=ai.prototype.getMoveStrategy.call(this);return i||(t=this.getSession()).getSheetConfigurationData().useDefaultPortMoveStrategy&&0<this.getParentSides()&&(on?on.setTarget(this):on=t.CA.createPortMoveStrategy(this),i=on),i},en.prototype.isTranslateAllowed=function(){return!this.isPinned()&&ai.prototype.isTranslateAllowed.call(this)},en.prototype.R4=function(t){},en.prototype.getProxyMasterPorts=function(){var t,i=[],n=this.N9;for(t in n){var r=n[t];r&&r instanceof en&&i.push(r)}return i},en.prototype.FF=function(){var t=this.getOwningSheet();if(t){t=t.askPreferences()
;return t?t.getPortLabelTextMargin():null}return null},en.prototype.rx=function(t){var i=0,n=this.getOwner();if(n&&n.getBBox)for(var n=n.getBBox().clone(),r=this.getParentSides(),s=[new H.Line(new H.Point(n.x,n.y),new H.Point(n.x+n.width,n.y)),new H.Line(new H.Point(n.x+n.width,n.y),new H.Point(n.x+n.width,n.y+n.height)),new H.Line(new H.Point(n.x,n.y+n.height),new H.Point(n.x+n.width,n.y+n.height)),new H.Line(new H.Point(n.x,n.y),new H.Point(n.x,n.y+n.height))],h=[H.AllowedSides.TOP,H.AllowedSides.RIGHT,H.AllowedSides.BOTTOM,H.AllowedSides.LEFT],u=t||this.getAnchorPosition(),o=0;o<4;o++)if(r&h[o]&&s[o].isPointOnLine(u)){i=h[o];break}return i},en.prototype.move=function(t,i){var n=this.F4(t,i),r=this.getLocation(),s=this.getAnchorPosition(),h=s.x+n.dx,t=s.y+n.dy,u=new H.Point(h,t),i=this.getOwner();if(i&&i.getBBox){for(var i=i.getBBox().clone(),o=this.getParentSides(),e=[new H.Line(new H.Point(i.x,i.y),new H.Point(i.x+i.width,i.y)),new H.Line(new H.Point(i.x+i.width,i.y),new H.Point(
i.x+i.width,i.y+i.height)),new H.Line(new H.Point(i.x,i.y+i.height),new H.Point(i.x+i.width,i.y+i.height)),new H.Line(new H.Point(i.x,i.y),new H.Point(i.x,i.y+i.height))],f=[H.AllowedSides.TOP,H.AllowedSides.RIGHT,H.AllowedSides.BOTTOM,H.AllowedSides.LEFT],c=[],a=[],v=0;v<4;v++)o&f[v]&&(c.push(e[v]),a.push(f[v]));var l=c.length;if(0<l){for(var m=c[0].distanceFromPoint(u),d=a[0],v=1;v<l;v++){var w=c[v].distanceFromPoint(u);w<m&&(m=w,d=f[v])}d===H.AllowedSides.TOP?(r.setInputPercentX((h-i.x)/i.width),r.setInputPercentY(0),r.setInputValueX(0),r.setInputValueY(0)):d===H.AllowedSides.BOTTOM?(r.setInputPercentX((h-i.x)/i.width),r.setInputPercentY(1),r.setInputValueX(0),r.setInputValueY(0)):d===H.AllowedSides.LEFT?(r.setInputPercentX(0),r.setInputPercentY((t-i.y)/i.height),r.setInputValueX(0),r.setInputValueY(0)):d===H.AllowedSides.RIGHT&&(r.setInputPercentX(1),r.setInputPercentY((t-i.y)/i.height),r.setInputValueX(0),r.setInputValueY(0))}}r=void 0===n.dx?s.x:s.x+n.dx,
n=void 0===n.dy?s.y:s.y+n.dy;this.setAnchorPosition(r,n)},en.prototype.getLodVisibleOption=function(){var t=ai.prototype.getLodVisibleOption.call(this);return void 0===t?H.LODVisibleOptions.HideOnOverviewLevel:t},en.prototype.renderOverview=function(t){},ai.inheritedBy(en);function fn(t,i,n){var r=this[t];return Rn(Dn,t,r),i?Fn(i,r,n):r}function cn(t,i,n){var r=this[t];return Rn(Dn,t,null),Rn(Dn,i,null),Rn(Dn,n,null),r?this[i]:this[n]}function an(t,i){var n=this[t],r=this[i];return Rn(Dn,t,null),Rn(Dn,i,null),n[r]}function vn(t,i){var n=this.getReferencings()[0],r=n.Jk();r.lF=this;var s,h=n.QC;return"getFillColor"===t?s=h.fillColor:"getStrokeColor"===t&&(s=h.strokeColor),(n=n.getOwner())&&(n.lF||(n.lF=this),s||"getFillColor"!==t&&"getStrokeColor"!==t||(s=In(n,s))),Rn(Dn,t,s,r),i=void 0!==s?"rgba("+s.red+","+s.green+","+s.blue+","+s.alpha+")":i}function ln(t,i,n){var r="",s=this.getReferencings();if(0<s.length){var h=s[0].getOwner();h.lF=this;s=h[t]();if(void 0!==s||null!==s){if(Rn(Dn,t
,s,h),i)return Fn(i,s,n);r=s}}return r}function mn(t,i,n){var r=this.getReferencings();if(0<r.length){var s=r[0].getOwner();s.lF=this;r=s[t]();return Rn(Dn,t,r,s),r?i:n}return n}function dn(t,i,n){var r="",s=this.getReferencings();if(0<s.length){var h=s[0].getOwner();(h.lF=this).qD=!0;s=h[t]();if(void 0!==s||null!==s){if(Rn(Dn,t,s,h),i)return Fn(i,s,n);r=s}}return r}var t=function(t,i,n,r){n&&(n.sF=!1)},v=function(t,i,n,r){var s;n&&((s=(s=n.N9)||(n.N9={}))[t.guid]=t),r&&(s=r.N9)&&(s[t.guid]=null)},wn=W.Property.define(en,"m_connectionDirection","Vector",W.PropertyFlags.Persistent|W.PropertyFlags.SupportsShallowCopy),bn=W.Property.define(en,"m_direction",Number,W.PropertyFlags.Persistent|W.PropertyFlags.SupportsShallowCopy),_n=W.Property.define(en,"m_numberAllowedConnections",Number,W.PropertyFlags.Persistent|W.PropertyFlags.SupportsShallowCopy),yn=W.Property.define(en,"m_pinned",Boolean,W.PropertyFlags.Persistent|W.PropertyFlags.SupportsShallowCopy),gn=W.Property.define(en,"m_proxy",
"Port",W.PropertyFlags.Persistent|W.PropertyFlags.SupportsShallowCopy,v,v),pn=W.Property.define(en,"m_isProxy",Boolean,W.PropertyFlags.Persistent|W.PropertyFlags.SupportsShallowCopy),Mn=W.Property.define(en,"m_referencingConnections","List",W.PropertyFlags.Persistent),Sn=W.Property.define(en,"m_symbolConnectionLocation","Location",W.PropertyFlags.Persistent|W.PropertyFlags.SupportsDeepCopy,t,t),Nn=W.Property.define(en,"m_parentSides",Number,W.PropertyFlags.Persistent|W.PropertyFlags.SupportsShallowCopy),Ln=W.Property.define(en,"m_applicationPortLocationProvider",Function,W.PropertyFlags.None),On=W.Property.define(en,"m_connectionTrimPolicy",Number,W.PropertyFlags.SupportsShallowCopy),Tn=W.Property.define(en,"m_transformPolicy",Number,W.PropertyFlags.SupportsShallowCopy),An="PropertyBinding",Pn="BooleanPropertyBinding",Cn="EnumPropertyBinding",kn="SvgColorBinding",Bn="SDFPropertyBinding",xn="SDFBooleanPropertyBinding",En="SDFSizePropertyBinding",Dn=null,Rn=function(t,i,n,r){t.owner.T9(t
,i,n,r)},Fn=function(t,i,n){for(var r=t.split("."),t=r.pop(),s=window,h=r.length,u=0;u<h;u++)s=s[r[u]];return s[t](i,n)},In=function(t,i){var n=t.XM(),r=t.inCreationContext?(n=Ht.Preview,!0):(n&Ht.Preview)==Ht.Preview;if(n===Ht.None)return i;var s,h=t.session.getSheetConfigurationData(),u=h.selectionPreferencesData,o=h.visualizationPreferencesData;if(n&Ht.Hover||n&Ht.SecondaryHover){if(h.contextData.isViewOnlyMode()&&(n&Ht.Selected||n&Ht.SecondarySelect)){var e,f=u.isChangeColorOnSelection();if(f)if(e=o.getSelectionColor())return e}u.isHighlightSelectionOnRollover()&&(s=o.getPreSelectionColor())&&(i=s)}else if(r){if(!h.highlightOnPreview)return i;(s=o.getPreSelectionColor())&&(i=s)}else n&Ht.Selected||n&Ht.SecondarySelect?(f=u.isChangeColorOnSelection())&&(e=o.getSelectionColor())&&(i=e):n&Ht.DropHighlight?(o=o.getDropHighlightColor())&&(i=o):n&Ht.ColoringHighlight&&((t=h.highlightData.UF(t))&&(i=t));return i};function Wn(t,i,n){l.call(this),this.owner=t,this.boundObject=n,
this.setTemplateString(i),this.bindingFunction=null,this.ZA=[],(Dn=this).getBoundSVGString=function(t){var i;this.bindingFunction||(i=this.A9(),this.bindingFunction=i?r.template(this.getTemplateString(),i):r.template(this.getTemplateString())),t?(Dn=this,0<t.indexOf(En)?window[En]=r.bind(dn,this.owner):0<t.indexOf(xn)?window[xn]=r.bind(mn,this.owner):0<t.indexOf(Bn)?window[Bn]=r.bind(ln,this.owner):0<t.indexOf(kn)?window[kn]=r.bind(vn,this.owner):0<t.indexOf(Cn)?window[Cn]=r.bind(an,this.boundObject):0<t.indexOf(Pn)?window[Pn]=r.bind(cn,this.boundObject):0<t.indexOf(An)&&(window[An]=r.bind(fn,this.boundObject))):(n=(Dn=this).boundObject,window[An]=r.bind(fn,n),window[Pn]=r.bind(cn,n),window[Cn]=r.bind(an,n),n=this.owner,window[kn]=r.bind(vn,n),window[Bn]=r.bind(ln,n),window[xn]=r.bind(mn,n),window[En]=r.bind(dn,n));var n=this.bindingFunction(this.boundObject);return Dn=null,this.boundObject=null,this.owner=null,this.clearBindings(),n}}Wn.prototype.getTemplateString=function(){
return Hn.getValue(this)},Wn.prototype.setTemplateString=function(t){Hn.setValue(this,t)},Wn.prototype.A9=function(){var t=this.getSession();if(!t)return null;t=t.getSheetConfigurationData();return t?t.svgTemplateSettings:null},Wn.prototype.clearBindings=function(){window[An]=null,window[Pn]=null,window[Cn]=null,window[kn]=null,window[Bn]=null,window[xn]=null,window[En]=null},Wn.prototype.remove=function(){this.boundObject=null,this.bindingFunction=null,this.owner=null,this.clearBindings(),l.prototype.remove.call(this)},l.inheritedBy(Wn);var Hn=W.Property.define(Wn,"m_templateString",String,W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.AffectRender|W.PropertyFlags.SupportsShallowCopy);function jn(t,i,n){if(l.call(this),this.owner=t,void 0!==i&&void 0!==n){if(i.length!=n.length)return alert("BoundTemplateData: name and value list lengths do not match"),null;this.setPropertyNames(i),this.setPropertyValues(n)}}jn.prototype.setPropertyNames=function(t){
t=new W.List(t);zn.setValue(this,t)},jn.prototype.getPropertyNames=function(){var t=[],i=zn.getValue(this);return t=i?i.toArray():t},jn.prototype.setPropertyValues=function(t){t=new W.List(t);Vn.setValue(this,t)},jn.prototype.getPropertyValues=function(){var t=[],i=Vn.getValue(this);return t=i?i.toArray():t};v=function(t,i,n,r){if(n){var s=t.getPropertyNames();if(void 0!==s&&s.length==n.size()){for(var h=!1,u=0,o=n.size();u<o;++u)t[s[u]]!=n.get(u)&&(t[s[u]]=n.get(u),h=!0);h&&t.owner&&t.owner.updateBinding()}}},t=function(t,i,n,r){if(n){var s=t.getPropertyValues();if(void 0!==s&&s.length==n.size()){for(var h=!1,u=0,o=n.size();u<o;++u)t[n.get(u)]!=s[u]&&(t[n.get(u)]=s[u],h=!0);h&&t.owner&&t.owner.updateBinding()}}};l.inheritedBy(jn);var zn=W.Property.define(jn,"m_propertyNames","List",W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.AffectRender|W.PropertyFlags.SupportsDeepCopy,t,t),Vn=W.Property.define(jn,"m_propertyValues","List",
W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.AffectRender|W.PropertyFlags.SupportsDeepCopy,v,v);function Yn(){V.call(this),this.boundObject=null,this.XD=!1,this.qD=!1,this.P9=!1,this.C9=[],this.k9=[],this.B9={},this.x9=null}Yn.prototype.E9=function(t){this.x9=t,this.XD=!0},Yn.prototype.D9=function(){return this.x9||this.getSvgContent()},Yn.prototype.bindTemplateToObject=function(t,i){this.boundObject=i,this.setSVGTemplate(new Wn(this,t,i))},Yn.prototype.bindSvgTemplateToObject=function(t,i){this.setSVGTemplate(t),this.boundObject=i,this.updateBinding()},Yn.prototype.bindSvgTemplateDomToObject=function(t,i,n){n=this.session.UA(t,Wn,n);this.R9=n,this.boundObject=i,this.k9=[],this.$D=[],this.F9!=t&&(this.F9=t,this.B9={},this.XD=!0),this.updateBinding()},Yn.prototype.T9=function(t,i,n,r){var s=this.F9;null!=s&&(r&&(t.boundObject=r),this.session.$A(s,i,t))},Yn.prototype.updateBinding=function(){null==this.getSVGTemplate()&&null===this.boundObject||(this.P9=!0,
Un.setValue(this,!1))},Yn.prototype.setSVGTemplate=function(t){Jn.setValue(this,t)},Yn.prototype.getSVGTemplate=function(){return Jn.getValue(this)},Yn.prototype.setSvgTemplate=function(t){Jn.setValue(this,t)},Yn.prototype.getSvgTemplate=function(){return Jn.getValue(this)},Yn.prototype.setBoundTemplateData=function(t){qn.setValue(this,t)},Yn.prototype.getBoundTemplateData=function(){return qn.getValue(this)},Yn.prototype.I9=function(){var t,i=this.F9;null!=i&&(void 0===(t=this.C9[i])?((t=this.C9[i]=this.R9.cloneNode(!0)).setAttribute("id",""),this.W9=t,this.XD=!0,this.B9={},this.$D||(this.$D=[])):this.W9!==t&&(this.XD=!0,this.W9=t,this.B9={}),t=this.session.GA(i),this.$D[i]=t)};Yn.prototype.H9=function(){var t,i,n=!1;if(0<this.k9.length?i=this.k9:this.F9&&(i=(t=this.$D[this.F9]).length?t:[],n=!0),i){for(var r=this.W9,s=i.length,h=0;h<s;h++){var u=i[h];u.boundObject=this.boundObject,u.owner=this;var o=u.getBoundSVGString(u.getTemplateString()),e=u.ZA,f=e[0],c="[data-sdf-index='"+f+"']"
,u=this.B9[c];u||(u=f==r.getAttribute("data-sdf-index")?r:r.querySelector(c),this.B9[c]=u),3===e[1]||1===e[1]?u.textContent=o:"data-sdf-content"===(e=e[2])?(function(t,i){var n=null;if(i)for("string"==typeof i&&0<i.length?n=(new DOMParser).parseFromString(i,"text/xml").firstChild:i instanceof SVGElement&&(n=i);t.firstChild;)t.removeChild(t.firstChild);n&&t.appendChild(n)}(u,o),u.setAttribute(e,"")):u.setAttribute(e,o)}this.k9=[],n&&this.session.XA(this.F9,r)}else{n=this.getSVGTemplate();n&&(n.owner=this,n.boundObject=this.boundObject,o=n.getBoundSVGString(),this.E9(o))}},Yn.prototype.bindNewValues=function(t){var i;t&&(i=this.session.qA(this.F9))?(t=i[t])&&(Array.prototype.push.apply(this.k9,t),this.I9(),this.H9()):(this.k9=[],this.updateBinding())},Yn.prototype.bF=function(){return this.P9},Yn.prototype.getSvgContent=function(){return Xn.getValue(this)},Yn.prototype.setSvgContent=function(t){Xn.setValue(this,t),this.XD=!0},Yn.prototype.getSvgFilePath=function(){return Gn.getValue(this
)},Yn.prototype.setSvgFilePath=function(t){Gn.setValue(this,t)},Yn.prototype.getEvaluatedSvgContent=function(){return!1===Un.getValue(this)&&(this.I9(),this.H9()),this.W9||this.D9()},Yn.prototype.ik=function(t,i){t.preRenderSvg&&t.preRenderSvg(this,i)},Yn.prototype.render=function(t,i){t.renderSvg(this,i),this.P9=!1,Un.setRawValue(this,!0)},Yn.prototype.updateRender=function(t,i,n){t.updateRenderSvg(this,i,n),this.P9=!1,Un.setRawValue(this,!0)},Yn.prototype.renderPreview=function(t,i,n){!1===Un.getValue(this)&&this.H9(!0),t.renderSvgPreview(this,i,n),this.P9=!1,Un.setRawValue(this,!0)},Yn.prototype.remove=function(){var t,i=this.getSVGTemplate();i&&(this.setSVGTemplate(null),this.E9(null),(!(t=i.getReferencings())||t.length<1)&&i.remove());i=this.getBoundTemplateData();i&&i.remove(),this.setBoundTemplateData(null),this.F9=null,this.setSvgContent(null),this.setSvgFilePath(null),this.$D=null,this.C9=null,this.R9=null,this.boundObject=null,this.k9=null;var n=this.B9;if(n)for(var r in n
)n[r]=null;this.W9=null,V.prototype.remove.call(this)},Yn.prototype._F=function(t){var i=new Yn,t=t.getSymbol();return t&&t.boundObject&&(i.boundObject=t.boundObject,i.R9=t.R9,i.F9=t.F9,t.$D&&(i.$D=[]),i.setSVGTemplate(t.getSVGTemplate()),i.updateBinding()),i},Yn.create=function(t){var i=new Yn;return i.setSvgContent(t),i.setName("SVG:"+i.guid),i};t=function(t,i,n,r){n&&t.boundObject&&t.updateBinding()},v=function(t,i,n,r){n&&((t.boundObject=n).owner=t).getSVGTemplate()&&t.updateBinding()};V.inheritedBy(Yn);var Xn=W.Property.define(Yn,"m_svgContent",String,W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.AffectRender|W.PropertyFlags.SupportsShallowCopy),Gn=W.Property.define(Yn,"m_svgFilePath",String,W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.SupportsShallowCopy),Un=W.Property.define(Yn,"m_contentUpToDate",Boolean,W.PropertyFlags.NotifyChange|W.PropertyFlags.AffectRender|W.PropertyFlags.AffectOverlay|W.PropertyFlags.SupportsShallowCopy
),Jn=W.Property.define(Yn,"m_svgTemplate","SvgTemplate",W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.TwoWayReference|W.PropertyFlags.SupportsDeepCopy,t,t),qn=W.Property.define(Yn,"m_boundTemplateData","BoundTemplateData",W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.SupportsDeepCopy,v,v);function Zn(t){Yn.call(this),Kn.setRawValue(this,null==t?H.ArrowType.OPEN_ARROW:t),this.j9(t)}Zn.prototype.j9=function(t){this.setAnchorX(1),this.setAnchorY(.5),null!=t&&this.setSvgContent(t)},Zn.prototype.getSvgContent=function(){var t,i=this.getArrowType(),n=this.getSession().getSheetConfigurationData().vectorEffectOption;switch(i){case H.ArrowType.OPEN_ARROW:t=n?H.Constants.openArrowSvg:H.Constants.openArrowSvgNoVectorEffect;break;case H.ArrowType.FILLED_ARROW:case H.ArrowType.CLOSED_SOLID_ARROW:t=n?H.Constants.filledArrowSvg:H.Constants.filledArrowSvgNoVectorEffect;break;case H.ArrowType.LINE_END_TEE:
t=n?H.Constants.lineEndTeeArrowSvg:H.Constants.lineEndTeeArrowSvgNoVectorEffect;break;default:t=(t=Yn.prototype.getSvgContent.call(this))||i}return t},Zn.prototype.setArrowType=function(t){this.j9(t),Kn.setValue(this,t)},Zn.prototype.getArrowType=function(){return Kn.getValue(this)},Zn.prototype.z9=function(t,i){i.containRenderingProperties()||(t.lineDashArray=null);var n=i.getOwner();n.y9(i)&&(i=n.XM(),this.V9(i)&&(t.fillColor=n.QC.fillColor,t.strokeColor=n.QC.strokeColor,t.lineWidth=n.QC.lineWidth));n=this.getArrowType();if(null!=n)switch(n){case H.ArrowType.FILLED_ARROW:t.fillColor=t.strokeColor;break;case H.ArrowType.CLOSED_SOLID_ARROW:t.fillColor=H.Color.VeryLightGray.toString()}},Zn.prototype.V9=function(t){return!!(t&Ht.Hover)||(!!(t&Ht.Preview)||(!!(t&Ht.EntireConnectionHover)||!!(t&Ht.Selected)))},Zn.prototype.ik=function(t,i,n){this.z9(i,n),Yn.prototype.ik.call(this,t,i)},Zn.prototype.render=function(t,i,n){this.z9(i,n),t.renderArrowhead(this,i)}
;Zn.prototype.updateRender=function(t,i,n){this.z9(i,n),t.updateRenderSvg(this,i,n)},Yn.inheritedBy(Zn);var Kn=W.Property.define(Zn,"m_arrowType",Number,W.PropertyFlags.AffectRender|W.PropertyFlags.SupportsShallowCopy|W.PropertyFlags.NotifyChange,function(t,i,n,r){t&&(t.XD=!0)});function Qn(t,i,n,r,s,h,u){ai.call(this,t),this.iA=[],this.sA=[],this.rA=null,this.Y9=null,this.X9=null,this.sN=void 0,this.G9=void 0,this.U9=null,this.J9=null,this.nO=null,this.QC=null,this.q9=null,dr.setRawValue(this,new W.List),sr.setRawValue(this,new W.List),i?(cr.setRawValue(this,i),i.addConnection(this)):void 0!==r&&void 0!==s&&((s=new a(r,s)).sF=!1,s.setOwner(this),vr.setRawValue(this,s)),n?(hr.setRawValue(this,n),n.addConnection(this)):void 0!==h&&void 0!==u&&((u=new a(h,u)).sF=!1,u.setOwner(this),or.setRawValue(this,u)),i&&n&&this.Z9(),this.routing()}function $n(t){var i=t.getStart();i&&i.portLocationProvider(t),(i=t.getEnd())&&i.portLocationProvider(t)}Qn.prototype.getResizeLocationData=function(t){
var i=t.getSession();W.common.ExceptionHelper.throwIfInvalid(i,"SheetSession");for(var n,r,s=i.getSheetConfigurationData(),i=s.viewData.getScaleFactor(),h=[],u=s.handleStyle.connectionEndHandler.size/i,o=s.handleStyle.connectionBendingHandler.size/i,i=t.QC,e=(r=i&&0<i.path.length?(n=i.path,t.Fk(n),n):(n=t.getGeometry().getPoints(),t.trimPathToNodes(n))).length,f=0;f<e;f++){var c=0!==f&&f!==e-1?o:u;h.push(new H.Rect(r[f].x-c/2,r[f].y-c/2,c,c))}return h};function tr(t,i,n,r){t.Z9(),i&&i.addConnection(t),rr(t,i,r,n)}function ir(t,i){return t.y==i.y?t.x>i.x?1:-1:t.y>i.y?1:-1}function nr(t){var i,n,r=t.XM(),s=null;return r&Ht.SecondaryHover?(i=t.session.getSheetConfigurationData()).selectionPreferencesData.isHighlightSelectionOnRollover()&&(s=i.visualizationPreferencesData.getPreSelectionColor()):r&Ht.Selected||r&Ht.SecondarySelect?(i=t.session.getSheetConfigurationData()).selectionPreferencesData.isChangeColorOnSelection()&&(s=i.visualizationPreferencesData.getSelectionColor()
):r&Ht.EntireConnectionHover?(i=t.session.getSheetConfigurationData()).selectionPreferencesData.isHighlightSelectionOnRollover()&&(s=i.visualizationPreferencesData.getPreSelectionColor()):r&Ht.Hover&&(n=!0,!(n=t.getAllowedTransformations()!==H.AllowedTransformations.NONE&&n)||t.vk())?(i=t.session.getSheetConfigurationData(),t.vk()?t._M()&H.ConnectionHandleOption.SEGMENTS&&i.selectionPreferencesData.isHighlightSelectionOnRollover()&&(s=i.visualizationPreferencesData.getPreSelectionColor()):i.selectionPreferencesData.isHighlightSelectionOnRollover()&&(s=i.visualizationPreferencesData.getPreSelectionColor())):r&Ht.ColoringHighlight&&(s=(i=t.session.getSheetConfigurationData()).highlightData.UF(t)),s}var rr=function(t,i,n,r){var s=r.getValue(t);i?s&&(s.remove(),r.setValue(t,void 0)):s||n&&((s=new a((n=n.getResolvedSymbolConnectionPoint()).x,n.y)).sF=!1,s.setOwner(t),r.setValue(t,s))};Qn.prototype.trimPathToNodes=function(t){var i,n,r,s=this.getSession(),h=s.getSheetConfigurationData(),
u=this.getStart(),o=this.getEnd(),e=(i=u,u=o,o=h.trimMode,h=0,i&&(e=(h=i.XM())&Ht.MovePreview||h&Ht.CopyPreview?H.ConnectionTrimMode.Port:(i.getProxy()||i).getConnectionTrimPolicy(),n=i.getOwner()),null==e&&(e=o),u&&(f=(h=u.XM())&Ht.MovePreview||h&Ht.CopyPreview?H.ConnectionTrimMode.Port:(u.getProxy()||u).getConnectionTrimPolicy(),r=u.getOwner()),null==f&&(f=o),n&&r&&n!==r&&n instanceof ai&&r instanceof ai&&(n.hasOwnership(r)&&r.isNestedViewMode&&r.isNestedViewMode()?f!==H.ConnectionTrimMode.Node&&f!==H.ConnectionTrimMode.NodeAndPort||(f=H.ConnectionTrimMode.Port):r.hasOwnership(n)&&n.isNestedViewMode&&n.isNestedViewMode()&&!r.kN&&(e!==H.ConnectionTrimMode.Node&&e!==H.ConnectionTrimMode.NodeAndPort||(e=H.ConnectionTrimMode.Port))),{startTrimMode:e,endTrimMode:f}),f=e.startTrimMode,e=e.endTrimMode,s=s.getConnectionTrimmer();return s.setConfig(f,e),s.doTrim(this,t)},Qn.prototype.addJumper=function(t){var i=dr.getValue(this);i&&(i.add(t),t.setOwner(this))},
Qn.prototype.addCrossingConnection=function(t){var i=sr.getValue(this);i.contains(t)||i.add(t)},Qn.prototype.removeCrossingConnection=function(t){var i=sr.getValue(this);if(i.contains(t)){for(var n=!1,r=dr.getValue(this),s=r.size();0<s;s--){var h=r.get(s-1);h.getCrossingConnection()===t&&(r.remove(h),h.remove(),n=!0)}i.remove(t),n&&this.gM(!1)}},Qn.prototype.getCrossingConnections=function(){return sr.getValue(this).toArray()},Qn.prototype.setCrossingConnections=function(t){W.common.ExceptionHelper.throwIfInvalidArray(t,"connection array");var i=sr.getValue(this),n=i.toArray();if(i.clear(),t)for(var r=t.length,s=0;s<r;s++)i.add(t[s]);for(r=n.length,s=0;s<r;s++){var h=n[s];if(!t||t.indexOf(h)<0){for(var u=dr.getValue(this),o=u.size();0<o;o--){var e=u.get(o-1);e.getCrossingConnection()===h&&(u.remove(e),e.remove(),this.setUpToDate(!1))}h.removeCrossingConnection(this)}}},Qn.prototype.getStart=function(){return cr.getValue(this)},Qn.prototype.setStart=function(t,i){cr.setValue(this,t),
i||this.routing()},Qn.prototype.getEnd=function(){return hr.getValue(this)},Qn.prototype.setEnd=function(t,i){hr.setValue(this,t),i||this.routing()},Qn.prototype.getEndArrow=function(){return ur.getValue(this)},Qn.prototype.setEndArrow=function(t){var i=ur.getValue(this);t&&i&&t.guid===i.guid||(i&&i.remove(),t&&this.K9(t,!1),ur.setValue(this,t))},Qn.prototype.getEndLocation=function(){var t=hr.getValue(this);if(t){var i,n=t.getProxy();return(!n||(i=cr.getValue(this))&&i.getProxy()&&i.getProxy()===n?t:n).getSymbolConnectionLocation()}return or.getValue(this)},Qn.prototype.getEndPoint=function(){var t=hr.getValue(this);if(t){var i,n=t.getProxy();return(!n||(i=cr.getValue(this))&&i.getProxy()&&i.getProxy()===n?t:n).getResolvedSymbolConnectionPoint()}n=or.getValue(this);if(n)return n.getResolvedEvaluatedLocation()},Qn.prototype.setEndLocation=function(t,i){var n=or.getValue(this);n!=t&&(n&&n.remove(),or.setValue(this,t),t&&(t.sF=!1,t.setOwner(this))),i||this.routing()},
Qn.prototype.getGeometry=function(){return er.getValue(this)},Qn.prototype.setGeometry=function(t){er.setValue(this,t);var i=this.q9;i||(i=new H.RenderingConnectionContext,this.q9=i);var n=[];t&&(n=t.getPoints()),i.setPoints(n),this.v4()},Qn.prototype.K9=function(t,i){t.setWidthPolicy(H.SizingPolicy.LENGTH),t.setHeightPolicy(H.SizingPolicy.LENGTH),i&&t.setRotation(t.getRotation()+180);var n=t.getLocation();return n||(n=new vt,t.setLocation(n)),n.setSegmentIdentifier(0),n.setInput(H.CoordinateMode.ABSOLUTE,H.Axis.X,0),n.setInput(H.CoordinateMode.PERCENT,H.Axis.X,i?0:1),n.setInput(H.CoordinateMode.ABSOLUTE,H.Axis.Y,0),n.setInput(H.CoordinateMode.PERCENT,H.Axis.Y,i?0:1),n.setReference(this,!0),t.setOwner(this),n},Qn.prototype.getStartArrow=function(){return ar.getValue(this)},Qn.prototype.setStartArrow=function(t){var i=ar.getValue(this);t&&i&&t.guid===i.guid||(i&&i.remove(),t&&this.K9(t,!0),ar.setValue(this,t))},Qn.prototype.isEndReversed=function(){return fr.getValue(this)},
Qn.prototype.setReverseEnd=function(t){fr.setValue(this,t)},Qn.prototype.getAuxDisplayLines=function(){var t=yr.getValue(this);return t?t.toArray():[]},Qn.prototype.setAuxDisplayLines=function(t){W.common.ExceptionHelper.throwIfInvalidArray(t,"Aux display line array");var i=t.length,n=yr.getValue(this);if(n)for(var r=0,s=n.size();r<s;r++)this.removeAuxDisplayLine(n.get(r));for(var h=0;h<i;h++)this.addAuxDisplayLine(t[h])},Qn.prototype.addAuxDisplayLine=function(t){var i=yr.getValue(this);i||(i=new W.List,yr.setValue(this,i)),i.add(t),t.setOwner(this)},Qn.prototype.removeAuxDisplayLine=function(t){var i=yr.getValue(this);i&&(i.remove(t),this.h4.push(t))},Qn.prototype.getStartLocation=function(){var t=cr.getValue(this);if(t){var i,n=t.getProxy();return(!n||(i=hr.getValue(this))&&i.getProxy()&&i.getProxy()===n?t:n).getSymbolConnectionLocation()}return vr.getValue(this)},Qn.prototype.getStartPoint=function(){var t=cr.getValue(this);if(t){var i,n=t.getProxy();return(!n||(i=hr.getValue(this)
)&&i.getProxy()&&i.getProxy()===n?t:n).getResolvedSymbolConnectionPoint()}n=vr.getValue(this);if(n)return n.getResolvedEvaluatedLocation()},Qn.prototype.setStartLocation=function(t,i){var n=vr.getValue(this);t!=n&&(n&&n.remove(),vr.setValue(this,t),t&&(t.sF=!1,t.setOwner(this))),i||this.routing()},Qn.prototype.setInternal=function(t){ai.prototype.setInternal.call(this,t)},Qn.prototype.getLines=function(){var t=[],i=this.getGeometry();if(i){var i=i.getPoints(),n=this.trimPathToNodes(i);if(1<n.length)for(var r=n.length-1,s=0;s<r;s++){var h=n[s],u=n[s+1],u=new H.Line(h,u);t.push(u)}}return t},Qn.prototype.getReversedLines=function(){var t=[],i=this.getGeometry();if(i){var i=i.getPoints(),n=this.trimPathToNodes(i);if(1<n.length)for(var r=n.length-1;1<=r;r--){var s=n[r],h=n[r-1],h=new H.Line(s,h);t.push(h)}}return t},Qn.prototype.Q9=function(){var t=this.getSession();if(!t)return!1;t.dM().HT(this)},Qn.prototype.cE=function(){var t=this.getSession();if(!t)return!1;if(
!t||t.suppressRoutingOnConnectionChanged||t.E_&&!0===t.E_||t.isInUpdateProcess())return this.isUpToDate()||this.yM(),!1;var i,n=t.dM().WT(this),r=er.getValue(this);return n&&0<n.length?((r=r||new K).setPoints(n),this.setGeometry(r)):r||(i=this.getStartPoint(),t=this.getEndPoint(),i&&t&&((n=[]).push(i.clone()),n.push(t.clone()),(r=new K).setPoints(n),this.setGeometry(r))),this.yM(),!0},Qn.prototype.routing=function(){this.Q9()},Qn.getReversedConnectionDirection=function(t,i,n,r){var s,h,u;return t.connectionDirectionReversible?(s=r.x-n.x,h=r.y-n.y,(i.equal(H.Vector.PositiveX)&&s<0||i.equal(H.Vector.NegativeX)&&0<s||i.equal(H.Vector.PositiveY)&&h<0||i.equal(H.Vector.NegativeY)&&0<h)&&(u=i.negate())):(t=t.getConnectionDirection())&&(0!==t.x||0!==t.y)||(u=0==i.distance?i:(s=r.x-n.x,h=r.y-n.y,n=180*Math.atan(h/s)/Math.PI,45<=Math.abs(n)?0<=h?H.Vector.PositiveY:H.Vector.NegativeY:0<=s?H.Vector.PositiveX:H.Vector.NegativeX)),u},Qn.prototype.autoRouting=function(){var t=this.getStartPoint(),
i=this.getEndPoint();if(t&&i){if(0===H.MathUtil.doubleCompare(t.x,i.x)&&0===H.MathUtil.doubleCompare(t.y,i.y))return(p=[]).push(t),p.push(i),(g=er.getValue(this)||new K).setPoints(p),void this.setGeometry(g);var n=this.getStart(),r=this.getEnd(),s=t,h=i,u=[];u.push(t);var o=10,e=this.getSession();if(e){var e=e.getSheetConfigurationData(),o=e.minNodeToEdgeDist;if(e.contextData.getConnectionCreationRoutingType()==H.ConnectionBendControlOption.NonOrthogonal)return d=this,f=t,c=i,(e=er.getValue(d)||new K).setPoints([f,c]),d.setGeometry(e),void(0<sr.getValue(d).size()||0===H.MathUtil.doubleCompare(f.x,c.x)||0===H.MathUtil.doubleCompare(f.y,c.y)?d.kM():d.setUpToDate(!1))}var f=o,c=new H.Vector(1,0);n?(a=(c=n.getResolvedConnectionDirection()).distance,(v=Qn.getReversedConnectionDirection(n,c,t,i))&&(c=v),(s=new H.Point).x=t.x+(f=a+o)*c.x,s.y=t.y+f*c.y,u.push(s)):(l=this.getGeometry())&&(m=l.getPoints())&&1<m.length&&(c.x=m[1].x-m[0].x,c.y=m[1].y-m[0].y,(c=c.normalize()).x=Math.round(c.x),
c.y=Math.round(c.y));var a,v,l,m,d=new H.Vector(1,0);r?(a=(d=r.getResolvedConnectionDirection()).distance,(v=Qn.getReversedConnectionDirection(r,d,i,t))&&(d=v),(h=new H.Point).x=i.x+(f=a+o)*d.x,h.y=i.y+f*d.y):!(l=this.getGeometry())||1<(w=(m=l.getPoints()).length)&&(d.x=m[w-2].x-m[w-1].x,d.y=m[w-2].y-m[w-1].y,(d=d.normalize()).x=Math.round(d.x),d.y=Math.round(d.y));var w=n?n.getOwner():null,n=r?r.getOwner():null,r=0;w&&n&&(w.hasOwnership(n)||n.hasOwnership(w))||(w=w?w.getHeightValue():1,r=(n=n?n.getHeightValue():1)<w?w:n);for(var b=Qn.routingPath(s,c,h,d,r,f),_=b.length,y=1;y<_;y++)u.push(b[y]);u.push(i);var g,t=this.getStartRect()||new H.Rect(t.x,t.y,0,0),i=this.getEndRect()||new H.Rect(i.x,i.y,0,0),p=0===r?u:Qn.roundRect(t,i,u,o);this.Fk(p),(g=er.getValue(this)||new K).setPoints(p),this.setGeometry(g)}};Qn.prototype.tx=function(t){if(t){var i=er.getValue(this);if(i&&i.getPoints){var n=i.getPoints();if(n&&0<=function(t,i){var n=t?t.length:0;if(n!=(i?i.length:0)||n<1)return-1;for(
var r=i[0].x-t[0].x,s=i[0].y-t[0].y,h=1;h<n;h++){var u=i[h].x-t[h].x,o=i[h].y-t[h].y;if(0!==H.MathUtil.doubleCompare(r,u)||0!==H.MathUtil.doubleCompare(s,o))return-1}return 0===H.MathUtil.doubleCompare(r,0)?0:1}(n,t))return}}i=this.getLabel();!i||(n=i.getLocation())&&(i=(t=(t=i.getPlacementRule())||ut.getDefaultRule()).getPlacementPosition(),t=t.getUserOffsetUpdateMode(),i&&t&H.ConnectionLabelOffsetUpdateMode.RESET_AFTER_CONNECTION_CHANGE&&(n.setInputValueX(0),n.setInputValueY(0),n.setInputPercentX(0),n.setInputPercentY(0)))},Qn.prototype.setPath=function(t){this.setUpToDate(!1);var i,n,r=this.getSession(),s=this.getStartLocation(),h=this.getEndLocation();if(!r||r.E_||r.suppressRoutingOnConnectionChanged?t&&0<t.length&&(i=t[0].clone(),n=t[t.length-1].clone()):s&&h&&(i=this.getStartPoint(),n=this.getEndPoint()),i&&n){var u,o=er.getValue(this)||new K,e=[];if(e.push(i),e.push(n),o.setPoints(e),null!=t&&0<t.length&&(u=t.concat(),e=t.length,this.getStart()||!s||s.getReference(
)?0!==H.MathUtil.doubleCompare(i.distanceToPoint(t[0]),0)&&u.unshift(i):s.setEvaluatedLocation(t[0].x,t[0].y),e=t.length,this.getEnd()||!h||h.getReference()?0!==H.MathUtil.doubleCompare(n.distanceToPoint(t[e-1]),0)&&u.push(n):h.setEvaluatedLocation(t[e-1].x,t[e-1].y),this.Fk(u),o.setPoints(u),this.setGeometry(o)),!r||r.E_||r.isInUpdateProcess())return void $n(this);this.yM(),this.setUpToDate(!0)}$n(this)},Qn.prototype.bM=function(t){t?(delete this.tW,delete this.iW):(this.tW=this.getStartRect(),this.iW=this.getEndRect())},Qn.prototype.getStartRect=function(){if(this.tW)return this.tW;var t,i=this.getStart();return!i||(i=(i=i.getProxy()?i.getProxy():i).getOwner())&&i.getBBox&&((i=i.getBBox())&&(t=i.clone())),t},Qn.prototype.getEndRect=function(){if(this.iW)return this.iW;var t,i=this.getEnd();return!i||(i=(i=i.getProxy()?i.getProxy():i).getOwner())&&i.getBBox&&((i=i.getBBox())&&(t=i.clone())),t},Qn.prototype.nW=function(t,i){var n,r,s,h=i.concat();return this.vk()&&(
2!==i.length||i[0].equal(i[1])||(s=this.getSession().getSheetConfigurationData().minSegmentLength,n=this.getValidStartPort(),r=this.getValidEndPort(),n&&(n=n.getResolvedConnectionDirection(),n=H.MathUtil.getExtensionPoint(i[0],n,s),i[0].equal(n)||h.splice(1,0,n)),r&&(r=r.getResolvedConnectionDirection(),s=H.MathUtil.getExtensionPoint(i[1],r,s),i[1].equal(s)||h.splice(-1,0,s)),this.Fk(h))),t.setPointsAfterTrim(h),h},Qn.prototype.yM=function(){var t=er.getValue(this);if(t){var i=this.q9;i||(i=new H.RenderingConnectionContext,this.q9=i);for(var n=this.trimPathToNodes(t.getPoints()),r=(n=this.nW(i,n)).length,s=dr.getValue(this),h=s?s.clone():new W.List,u=[],o=h.size(),e=0;e<o;e++){var f,c=h.get(e);c.getCrossingConnection().isVisible()&&(f=c.getStartPoint(),c=c.getEndPoint(),f&&c&&u.push({start:f,end:c}))}for(var a=u.length,e=0;e<a;e++)for(var v=u[e],l=v.start,m=v.end,d=l.y==m.y,w=d?l.y:l.x,b=a-1;e<b;b--){var _=d?Math.min(l.x,m.x):Math.min(l.y,m.y),y=d?Math.max(l.x,m.x):Math.max(l.y,m.y),
g=u[b],p=g.start,M=g.end;if(d){if(0!=H.MathUtil.doubleCompare(p.y,M.y))continue}else if(0!=H.MathUtil.doubleCompare(p.x,M.x))continue;var S,N,L=d?p.y:p.x;0==H.MathUtil.doubleCompare(w,L)&&(g=d?p.x:p.y,L=d?M.x:M.y,(_<=g&&g<=y||_<=L&&g<=y)&&(d?(S=Math.min(l.x,p.x),N=Math.max(m.x,M.x),l.x>m.x?(l.x=N,m.x=S):(m.x=N,l.x=S)):(S=Math.min(l.y,p.y),N=Math.max(m.y,M.y),l.y>m.y?(l.y=N,m.y=S):(m.y=N,l.y=S)),u.splice(b,1),b=--a))}for(var O=[],T=0;T<r-1;T++){var A=n[T],P=n[T+1];A.skip=void 0,P.skip=void 0;var C=[];C.push(A);for(var k=1,b=(a=u.length)-1;0<=b;b--){var B=u[b].start,x=u[b].end,E=new H.Line(A,P);E.isPointOnLine(B)&&E.isPointOnLine(x)&&(C.push(B),C.push(x),u.splice(b,1),a--,k+=2)}if(1<k){C.sort(ir);for(b=0;b<k;b++)b%2==1&&(C[b].skip=!0);if(A.equal(C[0]))for(b=0;b<k;b++)O.push(C[b]);else for(b=k-1;0<=b;b--)O.push(C[b])}else O.push(A)}0<r&&O.push(n[r-1]),i.setPoints(O),this.setUpToDate(!0);t=this.getLabel();if(t){s=(t.getPlacementRule()||ut.getDefaultRule()).evaluate(t);if(s){
i=t.getLocation();if(i){i.setEvaluatedLocation(s.x,s.y,!1),i.hF=!0,t.setUpToDate(!1);i=t.getSession();if(i){i=i.iN;if(i){var D=[],R=!1,t=t.vM();if(t){for(var F=t.indexedElements,I=F.length,e=0;e<I;++e)F[e].rW&&(D.push(F[e]),R=!0);R&&i.MM(D)}}}}}}}},Qn.prototype.nA=function(){var t=[],i=this.QC;if(i&&0<i.path.length){var n=i.path;this.Fk(n);for(var r=0;r<n.length;r++){if(r===n.length-1)return t;var s=new H.Line(n[r],n[r+1]);t.push(s)}}else t=this.getLines();return t},Qn.prototype._M=function(){var t=this.getOwningSheet(),i=H.ConnectionHandleOption.ALL_HANDLES,t=t.getPreferencesInternal();return i=t?t.getConnectionHandles():i},Qn.prototype.getOverlays=function(t){return this.getSession().xA.getConnectionOverlays(this,t)},Qn.prototype.vx=function(t){this.rA=t},Qn.prototype.sx=function(t){for(var i=this.iA,n=i.length,r=0;r<n;r++)if(t===i[r]&&0!==r)return i[r-1];return null},Qn.prototype.ux=function(t){for(var i=this.iA,n=i.length,r=0;r<n;r++)if(t===i[r]&&r!==n-1)return i[r+1];return null},
Qn.prototype.nC=function(){return this.getSession().xA.nC(this)},Qn.prototype.setLabelPosition=function(t,i,n,r){var s=this.getLabel(),h=this.getConnectionRender();!h||(h=h.getPointsAfterTrim())&&h.length&&(h.length-1<n||((h=s.getLocation())&&h instanceof vt||(h&&h.remove(),h=new vt(0,0),s.setLocation(h)),null!=n&&h.setSegmentIdentifier(n),s.getWidthValue(),s.getHeightValue(),null!=r&&(h.setInput(H.CoordinateMode.PERCENT,H.Axis.X,r),h.setInput(H.CoordinateMode.PERCENT,H.Axis.Y,r)),null!=i&&(h.setInput(H.CoordinateMode.ABSOLUTE,H.Axis.X,i),h.setInput(H.CoordinateMode.ABSOLUTE,H.Axis.Y,i)),h.setReference(this,!0)))},Qn.prototype.getBBox=function(){},Qn.prototype.getCollapsedOwner=function(){var t=this.getStart(),i=this.getEnd();if(t&&i){t=t.getCollapsedOwner(),i=i.getCollapsedOwner();if(t&&i&&t===i)return t}return null},Qn.prototype.lN=function(){if(this.isInCreating)return{isSheet:!0,isLabel:!1,owningElement:null};var t=this.G9;return t||ai.prototype.lN.call(this)},
Qn.prototype.G4=function(){return[H.Constants.PrimaryZIndexConnection,this.X4]},Qn.prototype.sW=function(t){var i=t.getOwner();if(i&&i instanceof ai){t=i.isNestedViewMode?i.isNestedViewMode():null;if(null!==t)return t?i:this.sW(i)}},Qn.prototype.hW=function(){var t,i,n=this.getStart(),r=this.getEnd(),s=[];return(n||r)&&(n&&(n=n.getOwner(),t=this.sW(n)),r&&(r=r.getOwner(),i=this.sW(r)),t&&i?s=0<H.CommonUtil.compareElementsByZDepth(t,i)?t.Y4(t.getOwner()):i.Y4(i.getOwner()):t?s=t.Y4(t.getOwner()):i&&(s=i.Y4(i.getOwner()))),this.G9=ai.prototype.lN.call(this),Array.prototype.push.apply(s,this.G4()),s},Qn.prototype.uW=function(){var t=[];return this.G9=ai.prototype.lN.call(this),Array.prototype.push.apply(t,this.G4()),t},Qn.prototype.oW=function(t){var i=this.U4();return t.unshift(i),t},Qn.prototype.Y4=function(t){return W.DebugFlags.UseLegacyRenderZDepth?ai.prototype.Y4.call(this,t):this.getSession().wA?this.hW():this.uW()},Qn.prototype.eW=function(){var t=this.getStart(),i=this.getEnd(),
n=[];t&&i?(t=t.getProxy()||t,i=i.getProxy()||i,0<H.CommonUtil.compareElementsByZDepth(t,i)?(n=t.u4.concat(),this.G9={isSheet:!1,isLabel:!1,owningElement:t.getOwner()}):(n=i.u4.concat(),this.G9={isSheet:!1,isLabel:!1,owningElement:i.getOwner()})):t?(n=(t=t.getProxy()||t).VD(),this.G9={isSheet:!1,isLabel:!1,owningElement:t.getOwner()}):i?(n=(i=i.getProxy()||i).VD(),this.G9={isSheet:!1,isLabel:!1,owningElement:i.getOwner()}):(n=[this.U4()],this.G9=ai.prototype.lN.call(this)),n.push(this.getZDepth());i=this.U4();return n[0]=i,n},Qn.prototype.fW=function(t,i){var n=t.length;if(n!==i.length)this.WD=!0;else for(var r=0;r<n;r++)if(t[r]!==i[r]){this.WD=!0;break}},Qn.prototype.VD=function(){var t=[];return W.DebugFlags.UseLegacyRenderZDepth?this.eW():(t=(t=this.getSession().wA?this.hW():this.uW(),this.oW(t)),this.fW(this.u4,t),t)},Qn.prototype.move=function(t,i){var n=er.getValue(this);if(n&&n.getPoints){var r=n.getPoints();if(r){for(var s=[],h=r.length,u=0;u<h;u++){var o=new H.Point(r[u].x+t,
r[u].y+i);s.push(o)}this.setPath(s),this.setUpToDate(!1)}}},Qn.prototype.P4=function(t){if(!ai.prototype.P4.call(this,t))return!1;var i=this.getStart(),n=this.getEnd();if(i&&n){i=i.getOwner();if(i===n.getOwner()&&i===t)return!1}return!0},Qn.prototype.Z9=function(){var t,i,n,r=this.getStart(),s=this.getEnd();(r||s)&&(t=this.getOwner(),r&&s?t===(i=H.CommonUtil.findLeastCommonAncestor(r,s))?t&&this.P4(t)&&((!(n=t.getGroupMembers())||n.indexOf(this)<0)&&i.getGroupContainer().addMember(this)):(t.removeGroupMember&&t.removeGroupMember(this),i?this.P4(i)?i.addGroupMember(this):this.setOwner(i):this.setOwner(this.getOwningSheet())):t===this.getOwningSheet()&&this.setOwner(this.sW(r||s)))},Qn.prototype.m4=function(t){this.updateRenderPolyline(),this.setUpToDate(!1)},Qn.prototype.postCreate=function(){this.setUpToDate(!1)},Qn.prototype.TN=function(t){var i=[],n=t.createConnectionAnimator(this),r=this.nO;r?n.setFromRenderStyle(r):(n.initializeAnimationStyle(this),0===n.from.path.length&&(
h=this.getStartPoint(),n.from.path.push(new H.Point(h.x,h.y)))),n.to=this.QC.clone(),i.push(n);var s=this.getStyleProvider(),r=null,h=null,r=(r=s?s.getStartArrow(this):r)||this.getStartArrow(),h=(h=s?s.getEndArrow(this):h)||this.getEndArrow();r&&(r=this.cW(n,r,!1,t),i.push(r)),h&&(h=this.cW(n,h,!0,t),i.push(h));var u=yr.getValue(this);if(u)for(var o=0;o<u.size();++o){var e=u.get(o).qF(t);i.push(e)}return i},Qn.prototype.ME=function(t){this.ZF(),this.A_(t)},Qn.prototype.cW=function(t,i,n,r){var s=i.qF(r),i=null;return s.from.transform||(i=t.to.transform.clone(),r=t.from.path[0],n&&(r=t.from.path[t.from.path.length-1]),i.m[6]=r.x,i.m[7]=r.y,s.from.transform=i),s},Qn.prototype.ZF=function(){this.nO=this.QC;var t=this.getStyleProvider(),i=null,n=null,i=(i=t?t.getStartArrow(this):i)||this.getStartArrow(),n=(n=t?t.getEndArrow(this):n)||this.getEndArrow();i&&i.ZF(i),n&&n.ZF(n);var r=yr.getValue(this);if(r)for(var s=0;s<r.size();++s)r.get(s).ZF()},Qn.prototype.A_=function(t){
var i=this.getStyleProvider(),n=this.aW(i),r=nr(this);r&&n.strokeColor&&0!==n.strokeColor.alpha&&(n.strokeColor=r);var s=this.getOwningSheet(),h=s.getJumperType(),u=this.getConnectionRender();if(u){r=u.getPoints();if(r&&0!==r.length){u.setJumperType(h),u.setJumperWidth(s.getJumperWidth());h=null,s=null,h=(h=i?i.getStartArrow(this):h)||this.getStartArrow(),s=(s=i?i.getEndArrow(this):s)||this.getEndArrow();u.vW(this,n,h,s),this.QC=n,this.clearArrowhead(t,h,s);h&&(this.U9=h,this.lW(h,!1,n,!0,t,u)),s&&(this.J9=s,this.lW(s,!0,n,!0,t,u)),ai.prototype.A_.call(this,t);var o=yr.getValue(this);if(o)for(var e=0;e<o.size();++e)o.get(e).A_()}}},Qn.prototype.lW=function(t,i,n,r,s,h){var u=null,h=h.getPoints();n.T5&&(!h||2===h.length&&h[0].equal(h[1]))||(u=i?h.length-2:0,r=this.mW(t,u,i,s,n,r),t.GF(s,r))},Qn.prototype.mW=function(t,i,n,r,s,h){var u=this.dW(t,s),o=H.Constants.arrowWidth,e=H.Constants.arrowHeight,f=u.w,s=u.h,u=t.getLocation();(u=u||this.K9(t,!n)).setSegmentIdentifier(i);n=this.Q4(t,
void 0,u),i=t.getSymbol();return i.getArrowType&&((u=i.getArrowType())!==H.ArrowType.FILLED_ARROW&&u!==H.ArrowType.CLOSED_SOLID_ARROW||f===o||(u=!(i=t=1),o!==f&&(t=f/o,u=!0),e!==s&&(i=s/e,u=!0),u&&(n=new H.Matrix(t,0,0,i,0,0).append(n)))),n},Qn.prototype.wW=function(t,i,n){var r=this.getStyleProvider(),s=(s=this.QC)||this.aW(r),h=nr(this);h&&s.strokeColor&&0!==s.strokeColor.alpha&&(s.strokeColor=h);var u=this.getOwningSheet(),o=u.getJumperType();i.setJumperType(o),i.setJumperWidth(u.getJumperWidth());h=null,o=null,h=(h=r?r.getStartArrow(this):h)||this.getStartArrow(),o=(o=r?r.getEndArrow(this):o)||this.getEndArrow();i.renderPath(this,t,s,n,h,o);u=this.getSession(),r=u.ok();if(!1===u.SA(r,this,"arrowHead")?(this.bW(t,s,n,h,i),this._W(t,s,n,o,i)):(t.clearSymbolByLod(h),t.clearSymbolByLod(o)),!1===u.SA(r,this,"marker"))this.yW(t);else for(var e=this.a4,f=e.length,c=0;c<f;c++)e[c].LF&&t.clearSymbolByLod(e[c]);var a=yr.getValue(this);if(a)for(c=0;c<a.size();++c)a.get(c).render(t,n)},
Qn.prototype.aW=function(t){t=this.Jk(t).toRenderStyle();return t.transform=this.getEvaluatedTransform(),t.fillColor="none",t.path=[],t.T5=!!this.isVisible(),t},Qn.prototype.isStartPortProxy=function(){var t=this.getStart();return!(!t||!t.getProxy())},Qn.prototype.isEndPortProxy=function(){var t=this.getEnd();return!(!t||!t.getProxy())},Qn.prototype.updatePortProxyState=function(t,i){t=t||this.getStart();t&&t.isHiddenByNestedNode()&&(n=t.getCollapsedOwner(),t.setProxy(n.getDefaultProxyPort()));var n,i=i||this.getEnd();i&&i.isHiddenByNestedNode()&&(n=i.getCollapsedOwner(),i.setProxy(n.getDefaultProxyPort()))},Qn.prototype.yW=function(t){var i=this.a4;if(i)for(var n=i.size(),r=0;r<n;r++){var s=i.get(r),h=s.getPlacementRule();if(h){var u=[],o=h.evaluate(s);if(o)for(var e=0;e<o.length;++e){var f,c,a=o[e],v=new H.Point(a.x,a.y);v=(v=this.getEvaluatedTransform(1,1,v))||H.Matrix.identity,a.angle&&(a.xFlip?0!==H.MathUtil.angleCompare(a.angle,90)&&0!==H.MathUtil.angleCompare(a.angle,270)||(
f=H.Matrix.identity,f=H.Matrix.flipX,c=-a.y,v.m[7]+=c,(v=v.append(f)).m[7]-=c,v=v.rotateAt(-90,a.x,a.y)):a.yFlip?0!==H.MathUtil.angleCompare(a.angle,90)&&0!==H.MathUtil.angleCompare(a.angle,270)||(f=H.Matrix.identity,f=H.Matrix.flipY,c=-a.x,v.m[6]+=c,(v=v.append(f)).m[6]-=c,v=v.rotateAt(-90,a.x,a.y)):a.rightReading?0!==H.MathUtil.angleCompare(a.angle,90)&&0!==H.MathUtil.angleCompare(a.angle,270)||(v=v.rotateAt(-90,a.x,a.y)):v=v.rotateAt(-a.angle,a.x,a.y)),u.push(v)}t.renderMarker(s,u)}}},Qn.prototype.ik=function(t){ai.prototype.ik.call(this,t);var i,n=this.getStyleProvider(),r=null,s=null,h=[r=(r=n?n.getStartArrow(this):r)||this.getStartArrow(),s=(s=n?n.getEndArrow(this):s)||this.getEndArrow()],u=t.isRenderStyleUpToDate();u||(i=this.t9(t));for(var o=h.length,e=0;e<o;e++){var f,c=h[e];c&&(f=u?null:this.Q4(c,i),c.ik(t,f,c))}},Qn.prototype.render=function(t){ai.prototype.render.call(this,t),t.clearElement(this);var i,n=this.getConnectionRender();!n||(i=n.getPoints()
)&&0!==i.length&&this.wW(t,n)},Qn.prototype.updateRender=function(t){ai.prototype.updateRender.call(this,t),t.clearElement(this);var i=this.getConnectionRender();i&&this.wW(t,i,!0)},Qn.prototype.renderOverview=function(t){var i,n=t.getStyle(),r=n.owFillColor,s=n.owStrokeColor,h=n.owLineWidth,u=n.owLineDash;-999==this.getLineTypePriorityValue()?(n.owFillColor="#000000",n.owStrokeColor="#000000",i=1/t.getSheetToScreenTransform().getM0(),n.owLineWidth=i,n.owLineDash=[5*i,5*i]):null!=(o=this.getSession().getSheetConfigurationData()).overviewStyle.connectionStyle&&(n.owFillColor=o.overviewStyle.connectionStyle.overviewFillColor,n.owStrokeColor=o.overviewStyle.connectionStyle.overviewStrokeColor,n.owLineWidth=o.overviewStyle.connectionStyle.overviewStrokeWidth),n.transform=this.getEvaluatedTransform();var o=this.getLines();t.renderLines(o),n.owFillColor=r,n.owStrokeColor=s,n.owLineWidth=h,n.owLineDash=u},Qn.prototype.renderPreview=function(t,i,n){ai.prototype.renderPreview.call(this,t,i,n)
;var r=null;if(i.offset&&(i.offset.x||i.offset.y))for(var s=i.originalPath,h=s.length,r=[],u=0;u<h;u++){var o=s[u].clone();o.x+=i.offset.x,o.y+=i.offset.y,r.push(o)}else{var e=this.getConnectionRender();if(!e)return;if(!(r=e.getPoints())||0===r.length)return}t.renderPath(r,n,null,this.getConnectionDisplayOption())},Qn.prototype.a_=function(t,i){if(!this.vk())return!0;var n=this.getConnectionRender().getPointsAfterTrim(),r=this.getConnectionDisplayOption();return!!K.dk(t.point,n,r,t.tolerance)},Qn.prototype.TE=function(t){var i=this.getGeometry();t.originalPath=i?i.getPoints():[]},Qn.prototype.PE=function(t){this.setPath(t.originalPath)},Qn.prototype.gW=function(){var t=this.U9;t&&(t.remove(),this.U9=null),(t=this.J9)&&(t.remove(),this.J9=null)},Qn.prototype.bW=function(t,i,n,r,s){r&&(s=s.getPoints(),i.T5&&(!s||2===s.length&&s[0].equal(s[1]))||this.renderArrowhead(r,0,!1,t,i,n))},Qn.prototype._W=function(t,i,n,r,s){r&&(s=s.getPoints(),i.T5&&(!s||2===s.length&&s[0].equal(s[1])
)||this.renderArrowhead(r,s.length-2,!0,t,i,n))},Qn.prototype.dW=function(t,i){var n,r,s=t.getWidthValue(),h=t.getHeightValue();return s||(n=H.Constants.arrowWidth,r=H.Constants.arrowHeight,h=(s=n+2*(i.lineWidth-1))*r/n,t.setWidthValue(s),t.setHeightValue(h)),{w:s,h:h}},Qn.prototype.pW=function(t){var i=null;if(this.vk()){var n=this.getConnectionRender().getPointsAfterTrim();if(!n||n.length<2)return;var r=this.getSession(),s=r.ok();if(r.SA(s,this,"arrowHead"))return;s=this.dW(t?this.J9:this.U9),t=K.MF(n,this.getConnectionDisplayOption(),s.w,t),i=new H.Point(t.point.x,t.point.y)}return i},Qn.prototype.OF=function(t){var i,n=t.rF(),t=t.getOwner();return t===this.U9?(i=this.pW(!1))&&(n[1]=i):t===this.J9&&(i=this.pW(!0))&&(n[0]=i),n},Qn.prototype.SF=function(t,i,n,r){if(this.vk()&&(n||r)){var s=this.getSession(),h=s.ok();if(!(s.SA(h,this,"arrowHead")||2===t.length&&t[0].equal(t[1]))){n&&this.dW(n,i),r&&this.dW(r,i);i=this.getConnectionDisplayOption();return K.SF(t,i,n,r)}}},
Qn.prototype.isTrimToArrow=function(t){t=t.getSymbol();return t instanceof Zn&&t.getArrowType()===H.ArrowType.LINE_END_TEE},Qn.prototype.isTrimToStartArrow=function(t){var i=wr.getValue(this);return void 0===i?this.isTrimToArrow(t):i},Qn.prototype.setTrimToStartArrow=function(t){wr.setValue(this,t)},Qn.prototype.isTrimToEndArrow=function(t){var i=br.getValue(this);return void 0===i?this.isTrimToArrow(t):i},Qn.prototype.setTrimToEndArrow=function(t){br.setValue(this,t)},Qn.prototype.getStyleProvider=function(){return _r.getValue(this)},Qn.prototype.setStyleProvider=function(t){_r.setValue(this,t)},Qn.prototype.getDefaultRenderingProperties=function(){return this.Jk(this.getStyleProvider())},Qn.prototype.clearArrowhead=function(t,i,n){var r=this.U9;r&&r!=i&&t.removeSymbol(r);r=this.J9;r&&r!=n&&t.removeSymbol(r)},Qn.prototype.renderArrowhead=function(t,i,n,r,s,h){h?r.updateRenderSymbol(t):r.renderSymbol(t)},Qn.prototype.y9=function(t){return t===this.getEndArrow()||t===this.getStartArrow(
)},Qn.prototype.vM=function(){this.isUpToDate()||this.cE();var t=this,i=[];if(this.vk())this.K4&&(1===this.K4.length&&this.K4[0].getType()===H.ElementIndexTree.ITEMTYPE_BBOX||(i=this.K4,this.K4=null)),ai.prototype.vM.call(this);else{var n=t.getLines(),r=n.length,s=!1;if(s=!t.K4||r!==t.K4.length||t.K4[0].getType()!==H.ElementIndexTree.ITEMTYPE_LINESEGMENT?!0:s){var h=[];if(0<r)for(var u=0;u<r;++u){var o=n[u];h.push({line:o,identifier:u,getType:function(){return H.ElementIndexTree.ITEMTYPE_LINESEGMENT},getOwner:function(){return t},getLine:function(){return this.line}})}else h.push({line:null,identifier:-1,getType:function(){return H.ElementIndexTree.ITEMTYPE_LINESEGMENT},getOwner:function(){return t},getLine:function(){return this.line}});t.K4&&(i=t.K4),t.K4=h}else for(u=0;u<r;++u)t.K4[u].line=n[u]}return{indexedElements:t.K4,discardedIndexedElements:i}},Qn.prototype.update=function(){ai.prototype.update.apply(this),void 0!==this.routing&&(this.routing(),this.Q9())},
Qn.prototype.getRenderingBBox=function(){var t=this.getStartLocation(),i=this.getEndLocation();if(t&&i){var t=t.getEvaluatedLocation(),i=i.getEvaluatedLocation(),n=Math.min(t.x,i.x),r=Math.min(t.y,i.y),s=Math.max(t.x,i.x),h=Math.max(t.y,i.y),i=this.getConnectionRender();if(i){var u=i.getPoints();if(u)for(var o=u.length,e=0;e<o;e++){var f,c=u[e];!this.getXform||(f=this.getXform())&&(c=f.transformPoint(c)),n=Math.min(n,c.x),r=Math.min(r,c.y),s=Math.max(s,c.x),h=Math.max(h,c.y)}}return new H.Rect(n,r,s-n,h-r)}},Qn.prototype.getTransformedBBox=function(){return this.getRenderingBBox()},Qn.prototype.XE=function(t){ai.prototype.XE.call(this,t);var i=this.getStart();i&&(t.containsValue(i)||cr.setRawValue(this,void 0));i=this.getEnd();i&&(t.containsValue(i)||hr.setRawValue(this,void 0))},Qn.prototype.remove=function(){var t=cr.getValue(this);t&&(t.removeConnection(this),cr.remove(this));t=hr.getValue(this);t&&(t.removeConnection(this),hr.remove(this));t=vr.getValue(this);t&&t.remove()
;t=or.getValue(this);t&&t.remove();var i=dr.getValue(this);if(i&&0<i.size()){for(var n=r=i.size();0<n;n--)i.get(n-1).remove();i.clear()}t=sr.getValue(this);if(t){for(var r=t.size(),s=t.toArray(),n=0;n<r;n++)s[n].removeCrossingConnection(this),s[n].setUpToDate(!1);t.clear()}t=er.getValue(this);t&&t.remove();t=ar.getValue(this);t&&t.remove();t=ur.getValue(this);t&&t.remove(),this.gW(),this.setStyleProvider(null);t=this.q9;t&&t.remove&&t.remove(),this.G9=null;t=lr.getValue(this);t&&t.remove();var h=yr.getValue(this);if(h){for(n=(r=h.size())-1;0<=n;n--){var u=h.get(n);u.remove(!0),u.setOwner(void 0)}h.clear(),yr.setValue(this,null)}ai.prototype.remove.call(this)},Qn.prototype.getJumpers=function(){var t=dr.getValue(this);if(t)return t.toArray()},Qn.prototype.clearJumper=function(){var t=this.getJumpers(),i=0;if(t){for(var i=t.length,n=0;n<i;n++)t[n].remove();dr.getValue(this).clear(),sr.getValue(this).clear()}return i},Qn.prototype.removeJumper=function(t,i){var n=!1,r=dr.getValue(this)
;if(t){if(r&&0<r.size()){for(var s=[],h=r.size(),u=r.toArray(),o=0;o<h;o++){var e=(v=u[o]).getCrossingConnection();v.getSegmentIdentifierCrossing()==i&&e===t?(v.remove(),r.remove(v),n=!0):s.push(e)}var f=t.MW;if(!f)if(f=[],w=t.getJumpers())for(var c=w.length,a=0;a<c;a++)f.push(w[a].getCrossingConnection());s.indexOf(t)<0&&f.indexOf(this)<0&&(t.removeCrossingConnection(this),this.removeCrossingConnection(t))}}else if(r){for(var v,s=[],l=[],h=r.size(),u=r.toArray(),o=0;o<h;o++)(v=u[o]).getSegmentIdentifier()==i?(l.push(v.getCrossingConnection()),v.remove(),r.remove(v),n=!0):s.push(v.getCrossingConnection());s.length;for(var m=l.length,o=0;o<m;o++){var d=l[o];if(d){var w,f=[];if(w=d.getJumpers())for(c=w.length,a=0;a<c;a++)f.push(w[a].getCrossingConnection());s.indexOf(d)<0&&f.indexOf(this)<0&&(d.removeCrossingConnection(this),this.removeCrossingConnection(d))}}}return n&&(this.gM(!1),this.yM(),this.gM(!0)),n},Qn.prototype.SW=function(t,i,n,r,s){var h=this.getSession(),
u=this.getOwningSheet(),o=h.iN;if(o){var e,f,c=u.isJumperPriorityUseLineType(),a=!0,v=u.getJumperPriorityType()!==H.JumperPriority.HORIZONTAL;c&&(e=mr.getValue(this),a=!1);for(var l=0===H.MathUtil.doubleCompare(t.y,i.y),m=new H.Line(t,i),d=Math.min(t.x,i.x),w=Math.min(t.y,i.y),b=Math.max(t.x,i.x),_=Math.max(t.y,i.y),h=new H.Rect(d,w,b-d,_-w),y=o.Lx(h,H.ElementIndexTree.RETIREVIESCOPE_ALL),g=[],p=y.length,M=0;M<p;M++){var S=y[M].getOwner();y[M].getType()==H.ElementIndexTree.ITEMTYPE_LINESEGMENT&&S instanceof Qn&&S!==this&&S.NW()&&g.push(y[M])}for(var p=g.length,N=this.getStartRect(),L=this.getEndRect(),M=0;M<p;M++){var O=n,T=n,A=g[M],P=A.getOwner(),C=A.getLine(),k=C.start,B=C.end,x=v;if((0===H.MathUtil.doubleCompare(k.x,B.x)||0===H.MathUtil.doubleCompare(k.y,B.y))&&!(l&&0===H.MathUtil.doubleCompare(k.y,B.y)||!l&&0===H.MathUtil.doubleCompare(k.x,B.x)||C.isPointOnLine(t)||C.isPointOnLine(i)||m.isPointOnLine(k)||m.isPointOnLine(B))){var E=0,D=0,R=this,F=this;l?d<(E=k.x)&&E<b&&(D=t.y,c&&(
e<(f=P.getLineTypePriorityValue())?(R=P,x=!1,O=A.identifier):f<e?(F=P,x=!0,T=A.identifier):a=!0),a&&(x?(F=P,T=A.identifier):(R=P,O=A.identifier))):w<(D=k.y)&&D<_&&(E=t.x,c&&(e<(f=P.getLineTypePriorityValue())?(R=P,x=!0,O=A.identifier):f<e?(F=P,x=!1,T=A.identifier):a=!0),a&&(x?(R=P,O=A.identifier):(F=P,T=A.identifier)));var I=R.guid+"_"+O+"_"+F.guid+"_"+T;if((!s||!s[I])&&R){var W=x?E-r/2:E,C=x?D:D-r/2,B=x?E+r/2:E,k=x?D:D+r/2,A=new H.Point(W,C),E=new H.Point(B,k);if((N&&N.isPointInside(A,0)||N&&N.isPointInside(E,0)||L&&L.isPointInside(A,0)||L&&L.isPointInside(E,0))&&N&&L)if(N.isInsideRect(L)){if(N.isPointInside(A,0)||N.isPointInside(E,0))continue}else{if(!L.isInsideRect(N))continue;if(L.isPointInside(A,0)||L.isPointInside(E,0))continue}x=P.getStartRect(),D=P.getEndRect();if((x&&x.isPointInside(A,0)||x&&x.isPointInside(E,0)||D&&D.isPointInside(A,0)||D&&D.isPointInside(E,0))&&x&&D)if(x.isInsideRect(D)){if(x.isPointInside(A,0)||x.isPointInside(E,0))continue}else{if(!D.isInsideRect(x)
)continue;if(D.isPointInside(A,0)||D.isPointInside(E,0))continue}s?(E={JumperOwner:R,x1:W,y1:C,x2:B,y2:k,JumperShapType:u.getJumperType(),CrossingConnection:F,SegmentIdentifier:O,SegmentIdentifierCrossing:T},s[I]=E):((k=new Qi(0,W,C,B,k)).setShapeType(u.getJumperType()),k.setCrossingConnection(F),k.setSegmentIdentifier(O),k.setSegmentIdentifierCrossing(T),R.addJumper(k),this.addCrossingConnection(P),P.addCrossingConnection(this),R.setUpToDate(!1))}}}}},Qn.prototype.kM=function(t,i){var n=this.getOwningSheet();if(n){var r=n.isAllowJumpers();if(r||!n.pM)if(!this.vk()){var s=this.getGeometry();if(s){var h=s.getPoints(),u=this.sN?this.sN.length:0,o=h.length,e=mr.getValue(this);if(!(e<0||n.pM&&e===this.X9&&H.ArrayUtil.pointArrayEqual(this.sN,h))){var f=n.getJumperWidth(),c=[];if((p=this.getJumpers())&&o<u)for(var a=p.length,v=0;v<a;v++)c.push(p[v].getCrossingConnection());this.MW=c;for(var l=o-1;l<u-1;l++)for(var m=(b=this.getCrossingConnections()).length,d=0;d<m;d++)b[d].removeJumper(this,
l);this.MW=void 0;for(var w=o-1;w<u-1;w++)this.removeJumper(void 0,w);for(l=0;l<o-1;l++){var b,_=h[l],y=h[l+1],g=!0;if(n.pM?l<u-1&&_.equal(this.sN[l])&&y.equal(this.sN[l+1])&&n.isJumperPriorityUseLineType()&&e===this.X9&&(g=!1):g=!0,g){if(0<(m=(b=this.getCrossingConnections()).length)){var p,c=[];if(p=this.getJumpers())for(a=p.length,v=0;v<a;v++)c.push(p[v].getCrossingConnection());this.MW=c;for(var M=0;M<m;M++)b[M].removeJumper(this,l);this.MW=void 0}this.removeJumper(void 0,l),i&&0!==H.MathUtil.doubleCompare(_.y,y.y)||0!==H.MathUtil.doubleCompare(_.x,y.x)&&0!==H.MathUtil.doubleCompare(_.y,y.y)||r&&this.SW(_,y,l,f,t)}}this.sN=[];for(l=0;l<o;l++)this.sN.push(h[l].clone());this.X9=e}}}}},Qn.prototype.getConnectionRender=function(){return this.isUpToDate()||this.session&&!this.session.YT&&(this.Q9(),this.cE(),this.setUpToDate(!0)),this.q9},Qn.prototype.Fk=function(t){var i=this.session,i=i?i.getSheetConfigurationData().connectionPointsComparisonTolerance:H.MathUtil.doubleTolerance
;H.CommonUtil.removeCollinearPoints(t,i)},Qn.prototype.updateRenderPolyline=function(){var t=this.getOwningSheet();if(t&&t.isAllowJumpers()){var i=sr.getValue(this);if(i&&0<i.size()){this.isVisible()&&this.yM(),this.setUpToDate(!1);for(var n=i.size(),r=0;r<n;r++){var s=i.get(r);s.isVisible()&&(s.yM(),s.setUpToDate(!1))}}}};t=function(t,i,n,r){n&&(n.sF=!1)},v=function(t,i,n,r){r&&r.removePolylineChangedListener(t),n&&n.addPolylineChangedListener(t)};Qn.prototype.getRenderingPosition=function(){},Qn.prototype.getXform=function(){return H.Matrix.identity},Qn.prototype.Q4=function(t,i,n){var r=i,s=n||t.getLocation(),h=new H.Point(0,0),u=new H.Point(0,0);return s&&(u=t.getAnchorPosition(),h=t.YF(u,s)),(s=s||t.getOwner().getLocation())&&s.getSegmentIdentifier&&(n=new H.Matrix(1,0,0,1,h.x,h.y),(h=s.rF())&&2===h.length&&(s=s.getRotation(),n=n.rotateAt(s,u.x,u.y)),t=(t=t.getXform())&&t.append(n),r=i?t.append(i):t),r},Qn.prototype.getRenderingProperties=function(){var t=lr.getValue(this);if(t
)return t;t=new T;return lr.setValue(this,t),t},Qn.prototype.Jk=function(t){var i;return i=(i=(i=t?t.getRenderingProperties(this):i)||lr.getValue(this))||this.getSession().getSheetConfigurationData().connectionStyleProperties},Qn.prototype.setRenderingProperties=function(t){lr.setValue(this,t)},Qn.prototype.setLineTypePriorityValue=function(t){mr.setValue(this,t)},Qn.prototype.getLineTypePriorityValue=function(){return mr.getValue(this)},Qn.prototype.getSegments=function(){var t=this.getConnectionRender().getPoints();if(t&&!(t.length<2)){for(var i=t.length,n=[],r=0;r<i-1;++r){var s="id :"+r.toString()+" , point1: "+t[r].toString()+" , point2: "+t[r+1].toString();n.push(s)}return n}},Qn.prototype.VA=function(){return 2},Qn.prototype.setUpToDate=function(t){ai.prototype.setUpToDate.call(this,t);for(var i=this.o4.length,n=0;n<i;++n){var r=this.o4[n];r instanceof vt&&((r=r.getOwner())&&(r.jF=!0))}t||this.Q9()},Qn.prototype.WA=function(){this.Z9()},Qn.prototype.addInlineSymbol=function(t,i,
n,r,s,h,u){var o=this.getConnectionRender().getPointsAfterTrim();!o||o.length<i+1||(s=new jt(r,s,t),this.addSymbol(s),t=new vt,s.setLocation(t),t.setSegmentIdentifier(i),h&&t.setInput(H.CoordinateMode.ABSOLUTE,H.Axis.X,h),t.setInput(H.CoordinateMode.PERCENT,H.Axis.X,n),u&&t.setInput(H.CoordinateMode.ABSOLUTE,H.Axis.Y,u),t.setInput(H.CoordinateMode.PERCENT,H.Axis.Y,n),t.setReference(this,!0))},Qn.prototype.addInlineElement=function(t,i,n,r,s,h,u){var o=this.getConnectionRender().getPointsAfterTrim();if(o&&!(o.length<i+1)){t=new jt(null,null,t),r=new ai(this.getOwningSheet(),r,s,null,null,null,null),s=new vt;return r.setLocation(s),r.addSymbol(t),s.setSegmentIdentifier(i),h&&s.setInput(H.CoordinateMode.ABSOLUTE,H.Axis.X,h),s.setInput(H.CoordinateMode.PERCENT,H.Axis.X,n),u&&s.setInput(H.CoordinateMode.ABSOLUTE,H.Axis.Y,u),s.setInput(H.CoordinateMode.PERCENT,H.Axis.Y,n),s.setReference(this,!0),r}},Qn.prototype.getAnchorPosition=function(){var t=this.getStartLocation()
;return t?t.getEvaluatedLocation():new H.Point(0,0)},Qn.prototype.polylineChanged=function(t){this.setUpToDate(!1)},Qn.prototype.setConnectionDisplayOption=function(t){var i=this.getGeometry();i||(i=new K,this.setGeometry(i)),i.setLineDisplayOption(t)},Qn.prototype.getConnectionDisplayOption=function(){var t=H.LineDisplayOption.Polyline,i=this.getGeometry();return t=i?i.getLineDisplayOption():t},Qn.prototype.vk=function(){var t=this.getConnectionDisplayOption();return t===H.LineDisplayOption.QuadraticCurve||t===H.LineDisplayOption.CubicCurve},Qn.prototype.getValidStartPort=function(){var t,i=this.getStart();return(t=i?i.getProxy():t)||i},Qn.prototype.getValidEndPort=function(){var t,i=this.getEnd();return(t=i?i.getProxy():t)||i},Qn.prototype.getValidStartNode=function(){var t=this.getValidStartPort();if(t)return t.getOwner()},Qn.prototype.getValidEndNode=function(){var t=this.getValidEndPort();if(t)return t.getOwner()},Qn.prototype.RC=function(t){var i=ai.prototype.RC.call(this,t),
n=this.getStart(),r=this.getEnd(),n=n?null:this.getStartPoint(),r=r?null:this.getEndPoint();return n&&(t&&(n.x+=t.x,n.y+=t.y),i.push(n)),r&&(t&&(r.x+=t.x,r.y+=t.y),i.push(r)),i},Qn.prototype.LW=function(t,i,n){var r,s=t[0],h=void 0;if(0===i)for(var u=new H.Line(s,new H.Point(s.x,1)),o=0,e=(f=this.getLines()).length;o<e;o++)(a=(c=f[o]).getIntersectedPoint(u))&&c.isPointOnLine(a,n,n)&&(v=a.distanceToPoint(s),(void 0===h||H.MathUtil.doubleCompare(v,h)<=0)&&(h=v,r=a));else for(var f,c,a,v,l=new H.Line(s,new H.Point(1,s.y)),o=0,e=(f=this.getLines()).length;o<e;o++)(a=(c=f[o]).getIntersectedPoint(l))&&c.isPointOnLine(a,n,n)&&(v=a.distanceToPoint(s),(void 0===h||H.MathUtil.doubleCompare(v,h)<=0)&&(h=v,r=a));return{point:r,dis:h}},Qn.prototype.doAlign=function(t,i,n,r,s,h){var u,o=-1<h.indexOf(H.AlignmentType.PortToSegmentEndPoint),e=-1<h.indexOf(H.AlignmentType.ConnectionToConnection),f=-1<h.indexOf(H.AlignmentType.PortToConnectionEndPoint),c=-1<h.indexOf(H.AlignmentType.NodeToConnection),
a=-1<h.indexOf(H.AlignmentType.AnnotationToConnection),v=-1<h.indexOf(H.AlignmentType.PortToConnectionProjected);if(!(o||e||f||c||a||v))return u;if(t.getConnections){var l=0===r?i[n].x:i[n].y,m=this.getStart(),e=m?m.getProxy():void 0,c=this.getEnd(),a=c?c.getProxy():void 0;if(0<=t.getConnections().indexOf(this)&&o){var d,w,o=this.getGeometry().getPoints(),b=o.length;2<=b&&(d=this.getSession().getSheetConfigurationData().contextData.getConnectionCreationRoutingType()===H.ConnectionBendControlOption.Orthogonal,t===m||t===e?w=(0===r?o[0].x===o[1].x:o[0].y===o[1].y)&&d&&o[2]||o[1]:t!==c&&t!==a||(w=(0===r?o[b-1].x===o[b-2].x:o[b-1].y===o[b-2].y)&&d&&o[b-3]||o[b-2]),d=H.AlignmentType.PortToSegmentEndPoint)}else if(f||v){b=t.getConnectionDirection(),b=t.getXform().transformVector(b);if(0!==H.MathUtil.doubleCompare(b.x,0)&&0!==H.MathUtil.doubleCompare(b.y,0)||0===r&&0!==H.MathUtil.doubleCompare(b.x,0)||1===r&&0!==H.MathUtil.doubleCompare(b.y,0))return u;var _,y,g,p,b=void 0;f&&(
m=m?null:this.getStartPoint(),c=c?null:this.getEndPoint(),m&&c?(_=0===r?m.x:m.y,g=0===r?c.x:c.y,b=(y=Math.abs(_-l))<=(p=Math.abs(g-l))?(w=m,y):(w=c,p)):m?(_=0===r?m.x:m.y,w=m,b=y=Math.abs(_-l)):c&&(g=0===r?c.x:c.y,w=c,b=p=Math.abs(g-l)));v=v?this.LW(i,r,s):null;if(v&&v.point){if(!(void 0!==b&&H.MathUtil.doubleCompare(b,s)<=0))return w=v.point,d=H.AlignmentType.PortToConnectionProjected,u={source:t,sourceLoc:i[n],target:this,targetLoc:w,offsetToTarget:0,type:d};d=H.AlignmentType.PortToConnectionEndPoint}else d=H.AlignmentType.PortToConnectionEndPoint}w&&(l=(0===r?w.x:w.y)-l,H.MathUtil.doubleCompare(Math.abs(l),s)<=0&&(u={source:t,sourceLoc:i[n],target:this,targetLoc:w,offsetToTarget:l,type:d}))}else u=ai.prototype.doAlign.call(this,t,i,n,r,s,h);return u},Qn.prototype.NW=function(){return!(this.getLineTypePriorityValue()<0)&&!this.vk()},Qn.prototype.W4=function(t){var i=this.getValidStartNode(),n=this.getValidEndNode();if(i||n){var r,t=t||this.getOwner();if(t===i||t===n)return!1;if(i)if(
(r=i.XM())&Ht.MovePreview||r&Ht.CopyPreview)return!1;if(n)if((r=n.XM())&Ht.MovePreview||r&Ht.CopyPreview)return!1}return!0},Qn.prototype.PF=function(){return this.getOwningSheet().getPreferences().getConnectionTagAlignment()},Qn.prototype.DF=function(){return this.getOwningSheet().getPreferences().getConnectionTagAllowWrapping()},Qn.prototype.RF=function(){return this.getOwningSheet().getPreferences().getConnectionTagAutoFit()},Qn.prototype.FF=function(){var t=this.getOwningSheet();if(t){t=t.askPreferences();return t?t.getConnectionLabelTextMargin():null}return null},Qn.prototype.isDefaultAutoRoutingOn=function(){var t=this.getOwningSheet().askPreferences();return!t||t.isDefaultAutoRoutingOn()},Qn.prototype.DE=function(){return this.getStartPoint()},Qn.prototype.getLodVisibleOption=function(){var t=ai.prototype.getLodVisibleOption.call(this);return void 0===t?H.LODVisibleOptions.HideArrowHeadOnOverviewLevel|H.LODVisibleOptions.HideMarkerOnOverviewLevel:t},Qn.prototype._9=function(t){
var i=this.guid,n=this.getGeometry().getPoints(),r=this.getStart().getOwner().guid,s=this.getEnd().getOwner().guid,h=this.getStart().guid,u=this.getEnd().guid;t.graph.connections.push({id:i,source:r,target:s,sourcePort:h,targetPort:u,paths:n})},ai.inheritedBy(Qn);var sr=W.Property.define(Qn,"m_crossingConnections","List",W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange),hr=W.Property.define(Qn,"m_end","Port",W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.SupportsShallowCopy,function(t,i,n,r){r&&r!==n&&r.removeConnection(t),n&&n.addConnection(t),tr(t,n,or,r)}),ur=W.Property.define(Qn,"m_endArrow","SymbolOccurrence",W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.TwoWayReference|W.PropertyFlags.SupportsDeepCopy|W.PropertyFlags.AffectRender),or=W.Property.define(Qn,"m_endLocation","Location",W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.SupportsDeepCopy,t,t),er=W.Property.define(Qn,"m_geometry","Polyline",
W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.SupportsDeepCopy,v,v),fr=W.Property.define(Qn,"m_reverseEnd",Boolean,W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.SupportsShallowCopy),cr=W.Property.define(Qn,"m_start","Port",W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.SupportsShallowCopy,function(t,i,n,r){r&&r!==n&&r.removeConnection(t),n&&n.addConnection(t),tr(t,n,vr,r)}),ar=W.Property.define(Qn,"m_startArrow","SymbolOccurrence",W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.TwoWayReference|W.PropertyFlags.SupportsDeepCopy|W.PropertyFlags.AffectRender),vr=W.Property.define(Qn,"m_startLocation","Location",W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.SupportsDeepCopy,t,t),lr=W.Property.define(Qn,"m_renderingProperties","RenderingProperties",
W.PropertyFlags.Persistent|W.PropertyFlags.TwoWayReference|W.PropertyFlags.NotifyChange|W.PropertyFlags.AffectRender|W.PropertyFlags.SupportsDeepCopy),mr=W.Property.define(Qn,"m_lineTypePriorityValue",Number,W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.SupportsShallowCopy|W.PropertyFlags.AffectIndexing),dr=W.Property.define(Qn,"m_jumperList","List",W.PropertyFlags.None),wr=W.Property.define(Qn,"m_trimToStartArrow",Boolean,W.PropertyFlags.None),br=W.Property.define(Qn,"m_trimToEndArrow",Boolean,W.PropertyFlags.None),_r=W.Property.define(Qn,"m_styleProvider","IConnectionStyleProvider",W.PropertyFlags.None),yr=W.Property.define(Qn,"m_auxDisplayLines","List",W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.AffectRender|W.PropertyFlags.TwoWayReference|W.PropertyFlags.SupportsDeepCopy|W.PropertyFlags.IsCollection);function gr(t,i,n,r,s,h,u){ai.call(this,t,i,n,r,s,h,u),Sr.setRawValue(this,new W.List),Nr.setRawValue(this,H.AllowedSides.ALL),
this.OW=[],this.tA=[]}Qn.createConnection=function(t,i){var n=null,r=t.createDefaultCenterPort(),i=i.createDefaultCenterPort();return r&&i&&(r.isAllowMoreConnections()&&i.isAllowMoreConnections()||W.common.ExceptionHelper.throwException(W.common.ExceptionTypes.InvalidConnectionNumber.id),n=new Qn(t=t.getOwningSheet(),r,i),t.addSheetElement(n)),n},Qn.roundRect=function(t,i,n,r){var s=[];if(!t||!i)return s;var h=t.clone();h.union(i);var u=n.length;s.push(n[0]),r=r||0;for(var o=0;o<u-2;o++){var e=n[o],f=n[o+1];e.equal(f)&&(n.splice(o,1),o--,u--)}2<u&&n[u-2].equal(n[u-1])&&(n.splice(u-1,1),u--);for(o=1;o<u-2;o++){var c,a,v,l=n[o-1],m=n[o],d=n[o+1],w=n[o+2];0!==H.MathUtil.doubleCompare(m.x,d.x)||0!==H.MathUtil.doubleCompare(m.y,d.y)?(t.isPointInside(m)||i.isPointInside(m)||t.isPointInside(d)||i.isPointInside(d)||(c=new H.Line(m,d),(H.Intersection.getIntersectionOfRectAndLine(t,c)||H.Intersection.getIntersectionOfRectAndLine(i,c))&&(0===H.MathUtil.doubleCompare(m.y,d.y)?(a=!1,
1===o?m.y-l.y<0?a=!0:m.y-l.y==0&&(a=Math.abs(m.y-h.y)<Math.abs(m.y-(h.y+h.height))):o===u-3?d.y-w.y<0?a=!0:d.y-w.y==0&&(a=Math.abs(m.y-h.y)<Math.abs(m.y-(h.y+h.height))):a=m.y<l.y&&d.y<w.y||!(m.y>l.y&&d.y>w.y)&&(d.x===n[u-1].x?d.y<n[u-1].y:m.x===n[0].x?m.y<n[0].y:Math.abs(m.y-h.y)<Math.abs(m.y-(h.y+h.height))),a=a?-r-Math.abs(m.y-h.y):r+Math.abs(m.y-(h.y+h.height)),0!==H.MathUtil.doubleCompare(m.x,l.x)&&0===H.MathUtil.doubleCompare(m.y,l.y)&&(v=m.clone(),s.push(v)),0!==H.MathUtil.doubleCompare(d.x,w.x)&&0===H.MathUtil.doubleCompare(d.y,w.y)&&(v=d.clone(),n.splice(o+2,0,v),u++),m.y+=a,d.y+=a):(a=(1===o?m.x-l.x<0:o===u-3?d.x-w.x<0:m.x<l.x&&d.x<w.x||!(m.x>l.x&&d.x>w.x)&&(d.y===n[u-1].y?d.x<n[u-1].x:m.y===n[0].y?m.x<n[0].x:Math.abs(m.x-h.x)<Math.abs(m.x-(h.x+h.width))))?-r-Math.abs(m.x-h.x):r+Math.abs(m.x-(h.x+h.width)),0===H.MathUtil.doubleCompare(m.x,l.x)&&0!==H.MathUtil.doubleCompare(m.y,l.y)&&(v=m.clone(),s.push(v)),0===H.MathUtil.doubleCompare(d.x,w.x)&&0!==H.MathUtil.doubleCompare(
d.y,w.y)&&(v=d.clone(),n.splice(o+2,0,v),u++),m.x+=a,d.x+=a))),s.push(m)):s.push(m)}return 2<u&&s.push(n[u-2]),s.push(n[u-1]),s},Qn.prototype.NS=function(t,i,n,r,s){for(var h,u,o=[],e=i.length,f=r.length,c=0;c<e;c++)for(var a=i[c].normalize(),v=0;v<f;v++){var l=r[v].normalize(),m=new H.Point(t.x+s*a.x,t.y+s*a.y),l=new H.Point(n.x+s*l.x,n.y+s*l.y);m.x===l.x?(o.push([t,m,l,n]),o.push([t,m,new H.Point(m.x-s,m.y),new H.Point(m.x-s,l.y),l,n]),o.push([t,m,new H.Point(m.x+s,m.y),new H.Point(m.x+s,l.y),l,n])):m.y===l.y?(o.push([t,m,l,n]),o.push([t,m,new H.Point(m.x,m.y-s),new H.Point(l.x,l.y-s),l,n]),o.push([t,m,new H.Point(m.x,m.y+s),new H.Point(l.x,l.y+s),l,n])):(o.push([t,m,new H.Point(m.x,l.y),l,n]),o.push([t,m,new H.Point(l.x,m.y),l,n]))}for(var c=0,d=o.length;c<d;c++){var w=o[c],b=w.length,_=w[2],y=w[1],g=w[0],p=_.x*y.y+_.y*g.x+y.x*g.y-(_.x*g.y+_.y*y.x+y.y*g.x);0===H.MathUtil.doubleCompare(p,0)&&g.x<=Math.max(_.x,y.x)&&g.x>=Math.min(_.x,y.x)&&g.y<=Math.max(_.y,y.y)&&g.y>=Math.min(_.y,y.y
)||(_=w[b-3],y=w[b-2],g=w[b-1],p=_.x*y.y+_.y*g.x+y.x*g.y-(_.x*g.y+_.y*y.x+y.y*g.x),0===H.MathUtil.doubleCompare(p,0)&&g.x<=Math.max(_.x,y.x)&&g.x>=Math.min(_.x,y.x)&&g.y<=Math.max(_.y,y.y)&&g.y>=Math.min(_.y,y.y)||(this.Fk(w),(void 0===u||w.length<u)&&(u=(h=w).length)))}return h},Qn.prototype.w4=function(){return!1},Qn.routingPath=function(t,i,n,r,s,h){var u,o,e,f,c,a,v,l,m,d,w,b,_=[],y=!1;return t&&n&&(void 0===s&&(s=0),e=i,f=r,(u=t).x>(o=n).x&&(u=n,o=t,e=r,f=i,y=!0),_.push(u),e=(1==e.x&&0===e.y?"R":-1==e.x&&0===e.y&&"L")||0===e.x&&1==e.y&&"T"||"B",f=(1==f.x&&0===f.y?"R":-1==f.x&&0===f.y&&"L")||0===f.x&&1==f.y&&"T"||"B","L"==e?"L"==f?0===H.MathUtil.doubleCompare(u.y,o.y)?(_.push(new H.Point(u.x,u.y+h)),_.push(new H.Point(o.x,u.y+h))):_.push(new H.Point(u.x,o.y)):"T"==f?Math.abs(o.y-u.y)<s?(c=Math.max(o.y,u.y)+1.5*s,_.push(new H.Point(u.x,c)),_.push(new H.Point(o.x,c))):_.push(new H.Point(u.x,o.y)):"B"==f?Math.abs(o.y-u.y)<s?(l=Math.min(o.y,u.y)-1.5*s,_.push(new H.Point(u.x,l)),_.push(
new H.Point(o.x,l))):_.push(new H.Point(u.x,o.y)):"R"==f&&(0==H.MathUtil.doubleCompare(o.y,u.y)&&Math.abs(o.x-u.x)<2*h||u.x<o.x&&o.x-u.x<=h+H.MathUtil.doubleTolerance?_.push(new H.Point(o.x,u.y)):Math.abs(o.y-u.y)<s?(c=Math.max(o.y,u.y)+1.5*s,_.push(new H.Point(u.x,c)),_.push(new H.Point(o.x,c))):(w=new H.Point(u.x,(o.y+u.y)/2),b=new H.Point(o.x,(o.y+u.y)/2),_.push(w),_.push(b))):"R"==e?"L"==f?_.push(new H.Point(u.x,o.y)):"R"==f?0===H.MathUtil.doubleCompare(u.y,o.y)?(_.push(new H.Point(u.x,u.y-h)),_.push(new H.Point(o.x,u.y-h))):_.push(new H.Point(o.x,u.y)):"B"==f?(v=u.y>o.y,_.push(new H.Point((v?u:o).x,(v?o:u).y))):"T"==f&&(v=u.y>o.y,_.push(new H.Point((v?o:u).x,(v?u:o).y))):"T"==e?"L"==f?Math.abs(o.x-u.x)<s?(a=Math.min(o.x,u.x)-1.5*s,_.push(new H.Point(a,u.y)),_.push(new H.Point(a,o.y))):(d=u.y<o.y,_.push(new H.Point((d?u:o).x,(d?o:u).y))):"R"==f?!(u.y<o.y||u.y>o.y&&u.y-o.y<=h)&&Math.abs(o.x-u.x)<s?(a=Math.max(o.x,u.x)+1.5*s,_.push(new H.Point(a,u.y)),_.push(new H.Point(a,o.y))
):_.push(new H.Point(o.x,u.y)):"T"==f?0===H.MathUtil.doubleCompare(u.x,o.x)?(_.push(new H.Point(u.x+h,u.y)),_.push(new H.Point(o.x+h,o.y))):(v=u.y>o.y,m=new H.Point(v&&o.x||u.x,v&&u.y||o.y),_.push(m)):"B"==f&&((d=u.y<o.y)?_.push(new H.Point(u.x,o.y)):(w=new H.Point((o.x+u.x)/2,u.y),b=new H.Point((o.x+u.x)/2,o.y),_.push(w),_.push(b))):"B"==e&&("L"==f?_.push(new H.Point(o.x,u.y)):"R"==f?Math.abs(o.y-u.y)<s?(l=Math.min(o.y,u.y)-1.5*s,w=new H.Point(u.x,l),b=new H.Point(o.x,l),_.push(w),_.push(b)):u.x===o.x?(_.push(new H.Point(u.x+h,u.y)),_.push(new H.Point(u.x+h,o.y))):_.push(new H.Point(o.x,u.y)):"B"==f?0===H.MathUtil.doubleCompare(u.x,o.x)?(_.push(new H.Point(u.x-h,u.y)),_.push(new H.Point(o.x-h,o.y))):(h=u.y<o.y,m=new H.Point(h&&o.x||u.x,h&&u.y||o.y),_.push(m)):"T"==f&&((d=u.y<o.y)?(w=new H.Point((o.x+u.x)/2,u.y),b=new H.Point((o.x+u.x)/2,o.y),_.push(w),_.push(b)):_.push(new H.Point(o.x,u.y)))),_.push(o)),_=y?_.reverse():_};function pr(t,i){if(t instanceof Qn
)H.CommonUtil.pushItemIfNotExist(i,t);else if(t.askLinkedConnections){for(var n=t.askLinkedConnections(),r=n.length,s=0;s<r;s++)H.CommonUtil.pushItemIfNotExist(i,n[s]);if(t.getGroupMembers){var h=t.getGroupMembers();if(h)for(r=h.length,s=0;s<r;s++)pr(h[s],i)}}}gr.prototype.addPort=function(t,i){var n=Sr.getValue(this);t&&i.setDirection(t),n.add(i),i.setOwner(this);t=i.getLocation();t||(t=new a((n=i.getAnchorPosition()).x,n.y),i.setLocation(t)),t.setReference(this),i.jF=!0},gr.prototype.getPorts=function(t){var i=Sr.getValue(this);if(!i)return[];for(var n=[],r=i.size(),s=0;s<r;s++)t&&i.get(s).getDirection()!=t||n.push(i.get(s));return n},gr.prototype.removePort=function(t){Sr.getValue(this).remove(t)},gr.prototype.setPorts=function(t){W.common.ExceptionHelper.throwIfInvalidArray(t,"Symbol array");var i=t.length;Sr.getValue(this).clear();for(var n=0;n<i;n++)this.addPort(null,t[n])},gr.prototype.setVariablePortSides=function(t){Nr.setValue(this,t)},
gr.prototype.getVariablePortSides=function(){return Nr.getValue(this)},gr.prototype.isPortAllowedAtLocationByApplication=function(){return!!Mr.getValue(this)},gr.prototype.registerPortLocationCheckCB=function(t){Mr.setValue(this,t)},gr.prototype.findRelatedConnections=function(){var t=[];return pr(this,t),t},gr.prototype.qM=function(){for(var t,i=this.getPorts(),n=i.length,r=0,s=0;s<n;s++)i[s].isVisible()&&(t=i[s].eC(),this.OW[r++]=t);return this.OW.splice(r,this.OW.length-r),this.OW},gr.prototype.JM=function(){return this.getSession().xA.JM(this)},gr.prototype.J4=function(){return this.getPorts()||[]},gr.prototype._4=function(){var t=this.getPorts();if(t)for(var i=t.length,n=0;n<i;++n){var r=t[n];r.getWidthPolicy()!=H.SizingPolicy.PERCENT&&r.getHeightPolicy()!=H.SizingPolicy.INHERIT||r._4()}ai.prototype._4.call(this)},gr.prototype.LE=function(t){var i=ai.prototype.LE.call(this,t),n=this.getPorts();if(n)for(var r=0,s=n.length;r<s;r++)if(t.indexOf(n[r])<0){n[r].isVisible()&&i.push(n[r])
;for(var h=n[r].LE(t),u=0,o=h.length;u<o;u++)i.push(h[u])}return i},gr.prototype.wN=function(){var t=ai.prototype.wN.call(this),i=this.getPorts(),n=i.length,r=[];if(0<n){for(var s,h=0;h<n;h++)s=i[h].wN(),Array.prototype.push.apply(r,s);Array.prototype.push.apply(t,i),Array.prototype.push.apply(t,r)}return t},gr.prototype.askLinkedConnections=function(){for(var t=[],i=this.getPorts(),n=i.length,r=0;r<n;r++)for(var s=i[r].getConnections(),h=s.length,u=0;u<h;u++)t.indexOf(s[u])<0&&t.push(s[u]);return t},gr.prototype.remove=function(){var t=Sr.getValue(this);if(t){for(var i=t.size(),n=t.toArray(),r=0;r<i;r++)n[r].remove(!0);t.clear(),Sr.setValue(this,null)}ai.prototype.remove.call(this)},ai.inheritedBy(gr);var Mr=W.Property.define(gr,"m_applicationPortLocationCheck",Function,W.PropertyFlags.SupportsShallowCopy),Sr=W.Property.define(gr,"m_ports","List",W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.SupportsDeepCopy|W.PropertyFlags.IsCollection),Nr=W.Property.define(
gr,"m_variablePortSides",Number,W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.SupportsShallowCopy);function Lr(t,i,n,r){gr.call(this,t,0,0,null,i,n,r),this.kN=!1,this.TW=!0}function Or(t){if(!t.isInUpdateAnnotationSize){t.isInUpdateAnnotationSize=!0;var i,n,r=t.getSymbols(),s=void 0,h=r.length;if(0<h)for(var u=0;u<h;u++){var o=r[u],e=o.getSymbolSize();e&&(o=o.getRenderingPosition(),e=new H.Rect(o.x,o.y,e[0],e[1]),s=s?s.union(e):e)}s&&(t.setWidthValue(s.width),t.setHeightValue(s.height)),!t.getPlacementRule()||(i=t.getLocation())&&(n=i.getEvaluatedLocation(),i.setEvaluatedLocation(n.x,n.y)),delete t.isInUpdateAnnotationSize}}Lr.prototype.setPlacementRule=function(t){Tr.setValue(this,t),t&&this.getSession().DA(t)},Lr.prototype.getPlacementRule=function(){return Tr.getValue(this)},Lr.prototype.addLeaderLine=function(t){var i=Ar.getValue(this);t.setOwner(this),(i=i||new W.List).add(t),Ar.setValue(this,i)},Lr.prototype.removeLeaderLine=function(t){
var i=Ar.getValue(this);i&&(i.remove(t),t.setOwner(void 0))},Lr.prototype.setLeaderLines=function(t){W.common.ExceptionHelper.throwIfInvalidArray(t,"member array");var i=Ar.getValue(this);i&&i.clear();for(var n=t.length,r=0;r<n;r++)this.addLeaderLine(t[r])},Lr.prototype.getLeaderLines=function(){var t=Ar.getValue(this);return t?t.toArray():void 0},Lr.prototype.setText=function(t){(0<this.getSymbols().length?function(t,i){for(var n=t.getSymbols(),r=n.length,s=0;s<r;s++){var h=n[s].getSymbol();if(h&&h instanceof wt){h.setTextString(i);break}}}:function(t,i){i=new jt(null,null,new wt(i));t.addSymbol(i)})(this,t),this.setUpToDate(!1),this.hL=!0,this.nL=!0},Lr.prototype.getText=function(){for(var t=0;t<this.getSymbols().length;t++){var i=this.getSymbols()[t].getSymbol();if(i instanceof wt)return i.getTextString()}},Lr.prototype.getCollapsedOwner=function(){var t=this.getOwner();return t&&t instanceof ai&&(t.getCollapsedOwner()||t.isExpanded&&!t.isExpanded()&&t.getLabel()!==this&&t)||null},
Lr.prototype.remove=function(t){t||(t=this.getOwner())&&this.kN&&t.setLabel&&t.setLabel(null);var i=Ar.getValue(this);if(i)for(;!i.isEmpty();)i.get(0).remove(),i.removeAt(0);this.setPlacementRule(void 0),gr.prototype.remove.call(this)},Lr.prototype.getWidthValue=function(){return!this.hL&&this.WF||Or(this),gr.prototype.getWidthValue.call(this),this.WF},Lr.prototype.getHeightValue=function(){return!this.nL&&this.HF||Or(this),gr.prototype.getHeightValue.call(this),this.HF},Lr.prototype.addSymbol=function(t){gr.prototype.addSymbol.call(this,t),!t||(t=t.getSymbol())instanceof wt&&t.addAnnotaion(this)},Lr.prototype.setSymbols=function(t){gr.prototype.setSymbols.call(this,t);for(var i=t.length,n=0;n<i;n++){var r=t[n].getSymbol();r instanceof wt&&r.addAnnotaion(this)}},Lr.prototype.resize=function(t,i,n,r){gr.prototype.resize.call(this,t,i,n,r),Or(this)},Lr.prototype.F4=function(t,i){return{dx:t,dy:i}},Lr.prototype.getXform=function(){if(this.jF){var t=this.getRotation(),i=this.getAnchor(),
n=this.getLocation(),r="0",s="0";n&&(t=n.e8(t=t||0),(t%=360)<0&&(t+=360),90==t?(t=-90,r=1-2*i.y+"*height",s=1-2*i.x+"*width"):180==t&&(t=360,r=-(1-2*i.x)+"* width",s=-(1-2*i.y)+"* height"));var h=H.Matrix.identity,u=this.getMirrorX(),o=this.getMirrorY();if(u&&o?(h=H.Matrix.flipXY,f=this.getWidthValue(),e=this.getHeightValue(),h=h.append(new H.Matrix(1,0,0,1,2*f*i.x,2*e*i.y))):u?(h=H.Matrix.flipX,e=this.getHeightValue(),h=h.append(new H.Matrix(1,0,0,1,0,2*e*i.y))):o&&(h=H.Matrix.flipY,f=this.getWidthValue(),h=h.append(new H.Matrix(1,0,0,1,2*f*i.x,0))),0!==t&&void 0!==t&&(f=f||this.getWidthValue(),e=e||this.getHeightValue(),h=h.rotateAt(t,i.x*f,i.y*e),r=(r=r.replace("width",f)).replace("height",e),s=(s=s.replace("height",e)).replace("width",f),h.m[6]+=new Function("return "+r)(),h.m[7]+=new Function("return "+s)()),n){var e=n.getLocationRule(),f=n.getReference();if(f&&e&&e.i8&&f.rx){r=f.getOwner();if(r.getRotation&&e.i8()){s=f.rx(),n=r.getRotation();if(n%=360){e=!1;if(
e=r.getAnchor?.5===(r=r.getAnchor()).x&&.5===r.y:e){var c=f.getWidthValue(),a=f.getHeightValue(),v=this.getWidthValue(),l=this.getHeightValue(),m=0,d=0;if(90==n)switch(s){case 1:m=c/2+v/2,d=a/2+l/2;break;case 2:m=-(c/2+v/2),d=-(a/2+l/2);break;case 4:m=c/2+v/2,d=-(a/2+l/2);break;case 8:m=-(c/2+v/2),d=a/2+l/2}else if(180==n)switch(s){case 1:m=0,d=a+l;break;case 2:m=0,d=-(a+l);break;case 4:m=c+v,d=0;break;case 8:m=-(c+v),d=0}else if(270==n)switch(s){case 1:m=-(c/2+v/2),d=a/2+l/2;break;case 2:m=c/2+v/2,d=-(a/2+l/2);break;case 4:m=c/2+v/2,d=a/2+l/2;break;case 8:m=-(c/2+v/2),d=-(a/2+l/2)}h=h.append(new H.Matrix(1,0,0,1,m,d))}}}}}this.zF=h,this.jF=!1}return this.zF},Lr.prototype.p4=function(t,i,n){return i},Lr.prototype.renderOverview=function(t){},Lr.prototype.setUpToDate=function(t){this.TW=!0,gr.prototype.setUpToDate.call(this,t)};Lr.prototype.isVisible=function(){return gr.prototype.isVisible.call(this)&&function(t){var i=t.getOwner();if(i instanceof Qn){var n,r,s=void 0;if(s||(
n=t.getLocation())&&(r=n.getEvaluatedX(),h=n.getEvaluatedY(),s=new H.Point(r,h)),s){var h=t.getOwningSheet();if(h){h=h.getPreferences();if(h){h=h.getConnectionLabelAutoHideOption();if(h)return e.getInstance().evaluate(i,t,s,!0,h)}}}}return!0}(this)},Lr.prototype.getLineHeight=function(){for(var t=this.getSymbols(),i=t.length,n=0;n<i;n++){var r=t[n].getSymbol();if(r instanceof wt)return r.AF}return 0},Lr.prototype.getDefaultConnectionLocationRule=function(){if(this.kN)return qi.getDefaultRule()},Lr.prototype.getDefaultRenderingProperties=function(){var t=this.getOwningSheet();if(t){t=t.getPreferences();return this.kN?t.getConnectionLabelTextStyle():t.getNoteTextStyle()}},Lr.prototype.wN=function(){var t=gr.prototype.wN.call(this),i=this.getLeaderLines();return i?t.concat(i):t},Lr.prototype.G4=function(){return[H.Constants.PrimaryZIndexAnnotation,this.X4]},Lr.fastCreation=function(t,i,n,r,s){var h=new Lr(t);h.setText(i),i=new(n instanceof Qn?vt:a),h.setLocation(i),n&&n.setLabel(h,
H.AlignmentMode.TOP,30,r,s);s=h.getSymbols(),s[0].Jk();return s[0].getSymbol().setAllowWrapping(!1),t.addSheetElement(h),h},Lr.prototype.PF=function(){return this.kN?this.getOwner().PF():this.getOwningSheet().getPreferences().getNoteTextAlignment()},Lr.prototype.DF=function(){return this.kN?this.getOwner().DF():this.getOwningSheet().getPreferences().getNoteTextAllowWrapping()},Lr.prototype.RF=function(){return this.kN?this.getOwner().RF():this.getOwningSheet().getPreferences().getNoteTextAutoFit()},Lr.prototype.FF=function(){if(this.kN)return(t=this.getOwner()).FF();if(t=this.getOwningSheet()){var t=t.askPreferences();return t?t.getNoteTextMargin():null}return null},Lr.prototype.setRenderingPosition=function(t,i){var n=this.getWidthValue(),r=this.getHeightValue(),n=void 0===t?void 0:t+n*this.IR.x,r=void 0===i?void 0:i+r*this.IR.y;this.setAnchorPosition(n,r)},Lr.prototype.startPreview=function(){gr.prototype.startPreview.call(this);var t=this.getPlacementRule();t&&t.startPreview(this)},
Lr.prototype.getLodVisibleOption=function(){var t=gr.prototype.getLodVisibleOption.call(this);return void 0===t?H.LODVisibleOptions.HideOnOverviewLevel:t},Lr.prototype.doAlign=function(t,i,n,r,s,h){if(!(h.indexOf(H.AlignmentType.NodeToAnnotation)<0&&h.indexOf(H.AlignmentType.AnnotationToAnnotation)<0&&h.indexOf(H.AlignmentType.ConnectionToAnnotation)<0))return ai.prototype.doAlign.call(this,t,i,n,r,s,h)},Lr.prototype.updateAnchor=function(){gr.prototype.updateAnchor.call(this),this.setUpToDate(!1)},gr.inheritedBy(Lr);var Tr=W.Property.define(Lr,"m_placementRule","PlacementRule",W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.AffectRender|W.PropertyFlags.SupportsShallowCopy|W.PropertyFlags.TwoWayReference),Ar=W.Property.define(Lr,"m_leaderLines","List",W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.SupportsShallowCopy);function Pr(t){V.call(this),t&&Cr.setRawValue(this,t)}Pr.prototype.getContent=function(){return Cr.getValue(this)},
Pr.prototype.setContent=function(t){return Cr.setValue(this,t)},Pr.prototype.ik=function(t,i){t.preRenderBitmap&&t.preRenderBitmap(this,i)},Pr.prototype.render=function(t,i){t.renderBitmap(this,i)},Pr.prototype.updateRender=function(t,i,n){t.updateRenderBitmap(this,i,n)},Pr.prototype.hA=function(){return!1},V.inheritedBy(Pr);var Cr=W.Property.define(Pr,"m_content",String,W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.AffectRender|W.PropertyFlags.SupportsShallowCopy);function kr(){l.call(this),this.setDefault()}function Br(){kr.call(this)}kr.prototype.setDefault=function(){},kr.prototype.clear=function(){this.setDefault()},l.inheritedBy(kr),Br.prototype.setDefault=function(){xr.setRawValue(this,!1),Er.setRawValue(this,!1),Dr.setRawValue(this,H.ConnectionBendControlOption.Orthogonal),Rr.setRawValue(this,!1),Fr.setRawValue(this,!1),Ir.setRawValue(this,!1),Wr.setRawValue(this,!1)},Br.prototype.setNodeCreationContext=function(t){xr.setValue(this,t)},
Br.prototype.getNodeCreationContext=function(){return xr.getValue(this)},Br.prototype.setConnectionCreationContext=function(t){Er.setValue(this,t)},Br.prototype.getConnectionCreationContext=function(){return Er.getValue(this)},Br.prototype.setConnectionCreationRoutingType=function(t){Dr.setValue(this,t)},Br.prototype.getConnectionCreationRoutingType=function(){return Dr.getValue(this)},Br.prototype.setViewOnlyMode=function(t){Rr.setValue(this,t)},Br.prototype.isViewOnlyMode=function(){return Rr.getValue(this)},Br.prototype.setSheetFeatureEditMode=function(t){Fr.setValue(this,t)},Br.prototype.getSheetFeatureEditMode=function(){return Fr.getValue(this)},Br.prototype.setDragDropForCreation=function(t){Ir.setValue(this,t)},Br.prototype.getDragDropForCreation=function(){return Ir.getValue(this)},Br.prototype.setTextEditMode=function(t){Wr.setValue(this,t)},Br.prototype.getTextEditMode=function(){return Wr.getValue(this)},Br.prototype.clear=function(){kr.prototype.clear.call(this)
;var t=this.getSession();!t||(t=t.uN)&&t.resetCommandStates()},kr.inheritedBy(Br);var xr=W.Property.define(Br,"m_nodeCreationContext",Boolean,W.PropertyFlags.None,function(t,i,n,r){t=t.getSession();t&&t.uN&&(t=t.uN,n?(t.changeCommandState("CREATENODE",!0),t.changeCommandState("DEFAULT",!1)):(t.changeCommandState("CREATENODE",!1),t.changeCommandState("DEFAULT",!0),(t=t.getCommand("CreateNodeCommand"))&&t.cleanup&&t.cleanup()))}),Er=W.Property.define(Br,"m_connectionCreationContext",Boolean,W.PropertyFlags.None,function(t,i,n,r){t=t.getSession();t&&t.uN&&(t=t.uN,n?(t.changeCommandState("CREATECONNECTION",!0),t.changeCommandState("DEFAULT",!1)):(t.changeCommandState("CREATECONNECTION",!1),t.changeCommandState("DEFAULT",!0),(t=t.getCommand("CreateConnectionCommand"))&&t.cleanup&&t.cleanup()))}),Dr=W.Property.define(Br,"m_connectionCreationRoutingType",Number,W.PropertyFlags.None),Rr=W.Property.define(Br,"m_viewOnlyMode",Boolean,W.PropertyFlags.None,function(t,i,n,r){t=t.getSession()
;t&&t.uN&&(t=t.uN,n?t.changeCommandState("VIEWONLY",!0):t.changeCommandState("VIEWONLY",!1))}),Fr=W.Property.define(Br,"m_sheetFeatureEditMode",Boolean,W.PropertyFlags.None),Ir=W.Property.define(Br,"m_dragDropForCreation",Boolean,W.PropertyFlags.None,function(t,i,n,r){t=t.getSession();t&&t.uN&&((t=t.uN.getCommand("DragDropCommand"))&&t.reset&&t.reset())}),Wr=W.Property.define(Br,"m_textEditMode",Boolean,W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange);function Hr(){kr.call(this),this.TR=[]}Hr.prototype.setDefault=function(){jr.setRawValue(this,50),zr.setRawValue(this,!1),Vr.setRawValue(this,5),Yr.setRawValue(this,new H.Color(129,182,196)),Xr.setRawValue(this,!1),Gr.setRawValue(this,!1),Ur.setRawValue(this,!0),Jr.setRawValue(this,1),qr.setRawValue(this,!0),Zr.setRawValue(this,H.GridType.LINE),Kr.setRawValue(this,!1),Qr.setRawValue(this,0)};v=function(t,i,n,r){for(var s=t.TR,h=s.length,u=0;u<h;u++)s[u].update()};Hr.prototype.getMajorGridSpacing=function(){return jr.getValue(this)
},Hr.prototype.setMajorGridSpacing=function(t){jr.setValue(this,t)},Hr.prototype.isShowGrid=function(){return zr.getValue(this)},Hr.prototype.setShowGrid=function(t){zr.setValue(this,t)},Hr.prototype.setMinorLinesPerMajor=function(t){Vr.setValue(this,t)},Hr.prototype.getMinorLinesPerMajor=function(t){return Vr.getValue(this)},Hr.prototype.setGridColor=function(t){var i,n;null!=t&&W.common.ArrayHelper.isArrayType(t)&&(i=new H.Color,(n=t.length)<3?W.common.ExceptionHelper.throwException(W.common.ExceptionTypes.InvalidColor.id):4===n?(i.red=t[0],i.green=t[1],i.blue=t[2],i.alpha=t[3]):(i.red=t[0],i.green=t[1],i.blue=t[2]),Yr.setValue(this,i))},Hr.prototype.getGridColor=function(){return Yr.getValue(this)},Hr.prototype.setSnapToGrid=function(t){Xr.setValue(this,t)},Hr.prototype.isSnapToGrid=function(){return Xr.getValue(this)},Hr.prototype.setBringGridToTop=function(t){Gr.setValue(this,t)},Hr.prototype.isBringGridToTop=function(){return Gr.getValue(this)},
Hr.prototype.setShowMajorLines=function(t){Ur.setValue(this,t)},Hr.prototype.isShowMajorLines=function(){return Ur.getValue(this)},Hr.prototype.setSnapPointsPerMinor=function(t){Jr.setValue(this,t)},Hr.prototype.getSnapPointsPerMinor=function(){return Jr.getValue(this)},Hr.prototype.setShowMinorLines=function(t){qr.setValue(this,t)},Hr.prototype.isShowMinorLines=function(){return qr.getValue(this)},Hr.prototype.setGridType=function(t){Zr.setValue(this,t)},Hr.prototype.getGridType=function(){return Zr.getValue(this)},Hr.prototype.setSnapConnectionToGrid=function(t){Kr.setValue(this,t)},Hr.prototype.isSnapConnectionToGrid=function(){return Kr.getValue(this)},Hr.prototype.setSnapConnectionToGridTolerance=function(t){Qr.setValue(this,t)},Hr.prototype.getSnapConnectionToGridTolerance=function(){return Qr.getValue(this)},Hr.prototype.remove=function(){this.TR=[],kr.prototype.remove.call(this)},kr.inheritedBy(Hr);var jr=W.Property.define(Hr,"m_majorGridSpacing",Number,W.PropertyFlags.None,v),
zr=W.Property.define(Hr,"m_showGrid",Boolean,W.PropertyFlags.None,v),Vr=W.Property.define(Hr,"m_minorLinesPerMajor",Number,W.PropertyFlags.None,v),Yr=W.Property.define(Hr,"m_gridColor","Color",W.PropertyFlags.None,v),Xr=W.Property.define(Hr,"m_snapToGrid",Boolean,W.PropertyFlags.None,v),Gr=W.Property.define(Hr,"m_bringGridToTop",Boolean,W.PropertyFlags.None,v),Ur=W.Property.define(Hr,"m_showMajorLines",Boolean,W.PropertyFlags.None,v),Jr=W.Property.define(Hr,"m_snapPointsPerMinor",Number,W.PropertyFlags.None,v),qr=W.Property.define(Hr,"m_showMinorLines",Boolean,W.PropertyFlags.None,v),Zr=W.Property.define(Hr,"m_gridType",Boolean,W.PropertyFlags.None,v),Kr=W.Property.define(Hr,"m_snapConnectionToGrid",Boolean,W.PropertyFlags.None),Qr=W.Property.define(Hr,"m_connectionSnappingTolerance",Number,W.PropertyFlags.None);function $r(){kr.call(this)}$r.prototype.setDefault=function(){ts.setRawValue(this,[]),is.setRawValue(this,[])},$r.prototype.setHighlightedObjects=function(t){ts.setValue(this,
t)},$r.prototype.getHighlightedObjects=function(){return ts.getValue(this)},$r.prototype.setColorData=function(t){is.setValue(this,t)},$r.prototype.getColorData=function(){return is.getValue(this)},$r.prototype.UF=function(t){var i=this.getHighlightedObjects();if(i){var n=i.indexOf(t),r=this.getColorData(),i=r[3*n]<=1?Math.round(255*r[3*n]):Math.round(r[3*n]),t=r[3*n+1]<=1?Math.round(255*r[3*n+1]):Math.round(r[3*n+1]),n=r[3*n+2]<=1?Math.round(255*r[3*n+2]):Math.round(r[3*n+2]);return new H.Color(i,t,n)}return null};kr.inheritedBy($r);var ts=W.Property.define($r,"m_highlightedObjects",Array,W.PropertyFlags.None,function(t,i,n,r){var s;r&&0<r.length&&(s=r[0].getOwningSheet(),r.forEach(function(t){s.removeColoringHighlightElement(t)})),n&&0<n.length&&(s=n[0].getOwningSheet(),n.forEach(function(t){s.addColoringHighlightElement(t)}))}),is=W.Property.define($r,"m_colorData",Array,W.PropertyFlags.None);function ns(){kr.call(this)}ns.prototype.setDefault=function(){rs.setRawValue(this,!1),
this.m_overviewWindowDom=null,this.m_wrapper=null,this.manager=null,this.m_hasMargin=!1,this.m_autoShrinkView=!1},ns.prototype.getOverviewWrapper=function(){return this.m_wrapper},ns.prototype.setOverviewWrapper=function(t){this.m_wrapper=t},ns.prototype.getOverviewWindowDom=function(){return this.m_overviewWindowDom},ns.prototype.setOverviewWindowDom=function(t){this.m_overviewWindowDom=t},ns.prototype.getDisplayWindow=function(){return rs.getValue(this)},ns.prototype.setDisplayWindow=function(t){rs.setValue(this,t)},ns.prototype.SR=function(t){this.manager=t};kr.inheritedBy(ns);var rs=W.Property.define(ns,"m_displayWindow",Boolean,W.PropertyFlags.NotifyChange,function(t,i,n,r){t.manager&&t.manager.update()});function ss(){kr.call(this),this.highlightThickWidth=2}ss.prototype.setDefault=function(){hs.setRawValue(this,H.SelectionRadius.MEDIUM),us.setRawValue(this,!0),os.setRawValue(this,!0),es.setRawValue(this,!0),fs.setRawValue(this,!0),cs.setRawValue(this,0),as.setRawValue(this,
H.SelectionRule.INSIDE),vs.setRawValue(this,!1),ls.setRawValue(this,31)},ss.prototype.getSelectionRadiusPixel=function(){switch(hs.getValue(this)){case H.SelectionRadius.MEDIUM:return H.Constants.SEL_PREF_selection_radius_medium;case H.SelectionRadius.SMALL:return H.Constants.SEL_PREF_selection_radius_small;case H.SelectionRadius.LARGE:return H.Constants.SEL_PREF_selection_radius_large;default:return H.Constants.SEL_PREF_selection_radius_medium}},ss.prototype.setSelectionRadius=function(t){hs.setValue(this,t)},ss.prototype.isHighlightSelectionOnRollover=function(){return us.getValue(this)},ss.prototype.setHighlightSelectionOnRollover=function(t){us.setValue(this,t)},ss.prototype.isChangeColorOnSelection=function(){return os.getValue(this)},ss.prototype.setChangeColorOnSelection=function(t){os.setValue(this,t)},ss.prototype.isHighlightWithThickWidth=function(){return es.getValue(this)},ss.prototype.setHighlightWithThickWidth=function(t){es.setValue(this,t)},
ss.prototype.isTooltipOnRollover=function(){return fs.getValue(this)},ss.prototype.setTooltipOnRollover=function(t){fs.setValue(this,t)},ss.prototype.getHighlightRolloverDelay=function(){return cs.getValue(this)},ss.prototype.setHighlightRolloverDelay=function(t){cs.setValue(this,t)},ss.prototype.getMultiSelectSelectionRule=function(){return as.getValue(this)},ss.prototype.setMultiSelectSelectionRule=function(t){as.setValue(this,t)},ss.prototype.isHighlightChildrenWithElement=function(){return vs.getValue(this)},ss.prototype.setHighlightChildrenWithElement=function(t){vs.setValue(this,t)},ss.prototype.getMultipleSelectionHandleDisplayOption=function(){return ls.getValue(this)},ss.prototype.setMultipleSelectionHandleDisplayOption=function(t){ls.setValue(this,t)},kr.inheritedBy(ss);var hs=W.Property.define(ss,"m_selectionRadius",Number,W.PropertyFlags.None),us=W.Property.define(ss,"m_highlightSelectionOnRollover",Boolean,W.PropertyFlags.None),os=W.Property.define(ss,
"m_changeColorOnSelection",Boolean,W.PropertyFlags.None),es=W.Property.define(ss,"m_highlightWithThickWidth",Boolean,W.PropertyFlags.None),fs=W.Property.define(ss,"m_tooltipOnRollover",Boolean,W.PropertyFlags.None),cs=W.Property.define(ss,"m_highlightRolloverDelay",Number,W.PropertyFlags.None),as=W.Property.define(ss,"m_multiSelectSelectionRule",Number,W.PropertyFlags.None),vs=W.Property.define(ss,"m_highlightChildrenWithElement",Boolean,W.PropertyFlags.None),ls=W.Property.define(ss,"m_hideHandlesOnMultiSelection",Boolean,W.PropertyFlags.None);function ms(){kr.call(this),this.AW=null,this.rN=[],this.Hx=1}ms.prototype.setDefault=function(){ws.setRawValue(this,!1),bs.setRawValue(this,!1),_s.setRawValue(this,!1),ys.setRawValue(this,!0),gs.setRawValue(this,!1),ps.setRawValue(this,1),Ms.setRawValue(this,!1),Ss.setRawValue(this,!1)},ms.prototype.getScaleFactor=function(){return ps.getValue(this)},ms.prototype.setScaleFactor=function(t){ps.setValue(this,t)},ms.prototype.isFit=function(){
return ws.getValue(this)},ms.prototype.setFit=function(t){ws.setValue(this,t)},ms.prototype.isFitToSelection=function(){return bs.getValue(this)},ms.prototype.setFitToSelection=function(t){bs.setValue(this,t)},ms.prototype.isPanMode=function(){return _s.getValue(this)},ms.prototype.setPanMode=function(t){_s.setValue(this,t)},ms.prototype.isAutoPanMode=function(){return ys.getValue(this)},ms.prototype.setAutoPanMode=function(t){ys.setValue(this,t)},ms.prototype.isRefresh=function(){return gs.getValue(this)},ms.prototype.setRefresh=function(t){gs.setValue(this,t)},ms.prototype.isZoomInOutMode=function(){return Ms.getValue(this)},ms.prototype.setZoomInOutMode=function(t){Ms.setValue(this,t)},ms.prototype.isZoomMode=function(){return Ss.getValue(this)},ms.prototype.setZoomMode=function(t){Ss.setValue(this,t)},ms.prototype.setSheetToViewXform=function(t){Ls.setValue(this,t)},ms.prototype.getSheetToViewXform=function(){return Ls.getValue(this)},ms.prototype.kx=function(t){this.AW=t},
ms.prototype.vF=function(t){return this.AW},ms.prototype.setViewport=function(t){W.common.ExceptionHelper.throwIfInvalidArray(t,"host viewport array error"),Ns.setValue(this,t)},ms.prototype.getViewport=function(){var t=Ns.getValue(this);if(t){var i=new H.Rect(0,0,0,0),n=t.length;return 2!==n&&4!==n||(i.x=t[0],i.y=t[1],4===n&&(i.width=t[2],i.height=t[3])),i}},ms.prototype.PW=function(t){var i=Ns.getValue(this);(i=i||[])[0]=t.x,i[1]=t.y,i[2]=t.width,i[3]=t.height,Ns.setValue(this,i)},ms.prototype.remove=function(){this.rN=[],kr.prototype.remove.call(this)},ms.prototype.getMaxScaleFactor=function(){var t=Os.getValue(this);return t=null==t?ds(this).maxZoomRatio:t},ms.prototype.setMaxScaleFactor=function(t){Os.setValue(this,t)},ms.prototype.getMinScaleFactor=function(){var t=Ts.getValue(this);return t=null==t?ds(this).minZoomRatio:t},ms.prototype.setMinScaleFactor=function(t){Ts.setValue(this,t)},ms.prototype.getElementsForFit=function(){return As.getValue(this)},
ms.prototype.setElementsForFit=function(t){As.setValue(this,t)};var ds=function(t){return t.getSession().getSheetConfigurationData()};kr.inheritedBy(ms);var ws=W.Property.define(ms,"m_fit",Boolean,W.PropertyFlags.None,function(t,i,n,r){t.rN.length&&t.rN[0].fit()}),bs=W.Property.define(ms,"m_fitToSelection",Boolean,W.PropertyFlags.None,function(t,i,n,r){var s;!t.rN.length||(t=(s=t.rN[0]).getSheet().getSelectedElements())&&0<t.length&&s.fit(t,null,null,!0)}),_s=W.Property.define(ms,"m_panMode",Boolean,W.PropertyFlags.None,function(t,i,n,r){t=t.getSession();t&&t.uN&&(t=t.uN,n?t.changeCommandState("PANMODE",!0):t.changeCommandState("PANMODE",!1))}),ys=W.Property.define(ms,"m_autoPanMode",Boolean,W.PropertyFlags.None),gs=W.Property.define(ms,"m_refresh",Boolean,W.PropertyFlags.None,function(t,i,n,r){t.rN.length&&t.rN[0].refresh(!0)}),ps=W.Property.define(ms,"m_scaleFactor",Number,W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange,function(t,i,n,r){var s;!t.rN.length||(s=t.getSession()
)&&s.isInUpdateProcess()&&t.rN[0].setCurrentZoomFactor(null,n,!0)}),Ms=W.Property.define(ms,"m_zoomInOutMode",Boolean,W.PropertyFlags.None),Ss=W.Property.define(ms,"m_zoomMode",Boolean,W.PropertyFlags.None,function(t,i,n,r){t=t.getSession();t&&t.uN&&(t=t.uN,n?t.changeCommandState("ZOOMMODE",!0):t.changeCommandState("ZOOMMODE",!1))}),Ns=W.Property.define(ms,"m_viewport",Array,W.PropertyFlags.Persistent|W.PropertyFlags.AffectRender|W.PropertyFlags.NotifyChange|W.PropertyFlags.AffectViewport,function(t,i,n,r){var s,h;t.rN.length&&n&&n.length&&(s=new H.Rect(0,0,0,0),2!==(h=n.length)&&4!==h||(s.x=n[0],s.y=n[1],4===h&&(s.width=n[2],s.height=n[3])),t.rN[0].setViewport(s))}),Ls=W.Property.define(ms,"m_sheetToViewXform","Matrix",W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange),Os=W.Property.define(ms,"m_maxScaleFactor",Number,W.PropertyFlags.None,function(t,i,n,r){t=ds(t);t&&(t.maxZoomRatio=n)}),Ts=W.Property.define(ms,"m_minScaleFactor",Number,W.PropertyFlags.None,function(t,i,n,r){
t=ds(t);t&&(t.minZoomRatio=n)}),As=W.Property.define(ms,"m_elementsForFit",Array,W.PropertyFlags.None,function(t,i,n,r){t.rN.length&&0<n.length&&t.rN[0].fit(n,null,null,!0)});function Ps(){kr.call(this)}Ps.prototype.setDefault=function(){ks.setRawValue(this,new H.Color(255,215,0)),Bs.setRawValue(this,new H.Color(0,191,255)),xs.setRawValue(this,new H.Color(255,127,39)),Es.setRawValue(this,H.FitOption.FitToAllObjects),Rs.setRawValue(this,1),Ds.setRawValue(this,[.5,.5]),Is.setRawValue(this,!1),Ws.setRawValue(this,.6),Hs.setRawValue(this,.3)};function Cs(t){if(null!=t&&W.common.ArrayHelper.isArrayType(t)){var i=new H.Color,n=t.length;if(!(n<3))return 4===n?(i.red=t[0],i.green=t[1],i.blue=t[2],i.alpha=t[3]):(i.red=t[0],i.green=t[1],i.blue=t[2]),i;W.common.ExceptionHelper.throwException(W.common.ExceptionTypes.InvalidColor.id)}}Ps.prototype.getPreSelectionColor=function(){return ks.getValue(this)},Ps.prototype.setPreSelectionColor=function(t){t=Cs(t);t&&ks.setValue(this,t)},
Ps.prototype.getFitOption=function(){return Es.getValue(this)},Ps.prototype.setFitOption=function(t){Es.setValue(this,t)},Ps.prototype.getSelectionColor=function(){return Bs.getValue(this)},Ps.prototype.setSelectionColor=function(t){t=Cs(t);t&&Bs.setValue(this,t)},Ps.prototype.getDropHighlightColor=function(){return xs.getValue(this)},Ps.prototype.setDropHighlightColor=function(t){t=Cs(t);t&&xs.setValue(this,t)},Ps.prototype.getVectorEffectOption=function(){return Rs.getValue(this)},Ps.prototype.setVectorEffectOption=function(t){Rs.setValue(this,t)},Ps.prototype.setFitViewPosition=function(t){Ds.setValue(this,t)},Ps.prototype.getFitViewPosition=function(){return Ds.getValue(this)},Ps.prototype.setFitPercentage=function(t){Fs.setValue(this,t)},Ps.prototype.getFitPercentage=function(){return Fs.getValue(this)},Ps.prototype.setEnableLod=function(t){Is.setValue(this,t)},Ps.prototype.getEnableLod=function(){return Is.getValue(this)},Ps.prototype.setIntermediateLevelThresholdRatio=function(t
){Ws.setValue(this,t)},Ps.prototype.getIntermediateLevelThresholdRatio=function(){return Ws.getValue(this)},Ps.prototype.setOverviewLevelThresholdRatio=function(t){Hs.setValue(this,t)},Ps.prototype.getOverviewLevelThresholdRatio=function(){return Hs.getValue(this)},kr.inheritedBy(Ps);var ks=W.Property.define(Ps,"m_preSelectionColor","Color",W.PropertyFlags.None),Bs=W.Property.define(Ps,"m_selectionColor","Color",W.PropertyFlags.None),xs=W.Property.define(Ps,"m_dropHighlightColor","Color",W.PropertyFlags.None),Es=W.Property.define(Ps,"m_fitOption",Number,W.PropertyFlags.None),Ds=W.Property.define(Ps,"m_fitViewPosition",Array,W.PropertyFlags.None),Rs=W.Property.define(Ps,"m_vectorEffectOption",Number,W.PropertyFlags.None,function(t,i,n,r){t=t.getSession();t&&((t=t.getSheetConfigurationData()).vectorEffectOption=n,t.viewData.rN[0].refresh(!0))}),Fs=W.Property.define(Ps,"m_fitPercentage",Number,W.PropertyFlags.None,function(t,i,n,r){t=t.getSession();t&&(t.getViewConfig().fitPercentage=n)})
,Is=W.Property.define(Ps,"m_enableLod",Boolean,W.PropertyFlags.None),Ws=W.Property.define(Ps,"m_intermediateLevelThresholdRatio",Number,W.PropertyFlags.None),Hs=W.Property.define(Ps,"m_overviewLevelThresholdRatio",Number,W.PropertyFlags.None);function js(t,i,n){l.call(this),zs.setRawValue(this,i||""),Vs.setRawValue(this,n||[]),t&&t.addCollection(this)}js.prototype.setName=function(t){zs.setValue(this,t)},js.prototype.getName=function(){return zs.getValue(this)},js.prototype.setInteractiveSettings=function(t){Ys.setValue(this,t)},js.prototype.getInteractiveSettings=function(){return Ys.getValue(this)},js.prototype.setSheetElements=function(t){for(var i=Vs.getValue(this),n=(r=i.length)-1;0<=n;n--)i[n].setCollection(null);Vs.setValue(this,[]);for(var r=t.length,n=0;n<r;n++)this.addSheetElement(t[n])},js.prototype.getSheetElements=function(){return Vs.getValue(this)},js.prototype.addSheetElement=function(t){var i=t.getCollection();i&&i.removeSheetElement(t);i=Vs.getValue(this);i.indexOf(t
)<0&&(i.push(t),t.setCollection(this))},js.prototype.removeSheetElement=function(t){var i=Vs.getValue(this),n=i.indexOf(t);0<=n&&(i.splice(n,1),t.setCollection(null))},js.prototype.remove=function(){this.setSheetElements([]);var t=this.getInteractiveSettings();t&&(t.remove(),this.setInteractiveSettings(null)),l.prototype.remove.call(this)},l.inheritedBy(js);var zs=W.Property.define(js,"m_name",String,W.PropertyFlags.Persistent|W.PropertyFlags.SupportsShallowCopy),Vs=W.Property.define(js,"m_sheetElements",Array,W.PropertyFlags.Persistent|W.PropertyFlags.SupportsDeepCopy|W.PropertyFlags.IsCollection),Ys=W.Property.define(js,"m_interactiveSettings","InteractiveSettings",W.PropertyFlags.Persistent|W.PropertyFlags.SupportsDeepCopy);function Xs(){Z.call(this)}function Gs(t){K.call(this),Us.setRawValue(this,0),t&&Js.setRawValue(this,t),this.getAllowedShape=function(){return Us.getValue(this)},this.setAllowedShape=function(t){return Us.setValue(this,t)},this.getPathType=function(){
return Js.getValue(this)},this.setPathType=function(t){Js.setValue(this,t)}}Xs.prototype.render=function(t,i){var n=i.width,r=i.height,r=new H.Rect(0,0,n,r);t.renderEllipse(r,i)},Xs.prototype.updateRender=function(t,i,n){var r=i.width,s=i.height,s=new H.Rect(0,0,r,s);t.updateRenderEllipse(s,i,n)},Xs.prototype.select=function(t,i,n,r,s,h,u){r/=2,s/=2,n=new H.Point(i+r,n+s);return h===H.SelectionRegionType.Outline?H.MathUtil.isPointOnEllipse(t.point,n,r,s,t.tolerance):H.MathUtil.isPointInsideEllipse(t.point,n,r,s,t.tolerance)},Xs.prototype.yF=function(){return!0},Xs.prototype.intersectWithSegment=function(t,i,n,r,s,h){n/=2,r/=2,i=new H.Point(t+n,i+r);return H.Intersection.getIntersectionOfEllipseAndLine(n,r,i,new H.Line(s,h))},Xs.prototype.isPointInside=function(t,i,n,r,s,h){n/=2,r/=2,i=new H.Point(t+n,i+r);return H.MathUtil.isPointInsideEllipse(s,i,n,r,h)},Z.inheritedBy(Xs),Gs.prototype.select=function(t,i,n,r,s,h,u){return!!u&&u(t,this,i,n,r,s,h)},K.inheritedBy(Gs)
;var Us=W.Property.define(Gs,"m_allowedShape",Number,W.PropertyFlags.Persistent|W.PropertyFlags.AffectRender|W.PropertyFlags.SupportsShallowCopy),Js=W.Property.define(Gs,"m_pathType",String,W.PropertyFlags.Persistent|W.PropertyFlags.AffectRender|W.PropertyFlags.SupportsShallowCopy);function qs(t){ai.call(this,t)}qs.prototype.addMember=function(t){var i=Zs.getValue(this);null!=i&&void 0!==i||(i=new ni,Zs.setValue(this,i)),i.addMember(t)},qs.prototype.getMember=function(t){var i=Zs.getValue(this);if(null!=i&&void 0!==i)return i.getMember(t)},qs.prototype.getMembers=function(){var t=Zs.getValue(this);if(null!=t&&void 0!==t)return t.getMembers()},qs.prototype.removeAllMembers=function(t){var i=Zs.getValue(this);if(null!=i&&void 0!==i)return i.removeAllMembers()},qs.prototype.removeMember=function(t){var i=Zs.getValue(this);null!=i&&void 0!==i&&i.removeMember(t)},qs.prototype.remove=function(){var t=Zs.getValue(this);t&&(this.getOwner(),t.remove()),ai.prototype.remove.call(this)},
ai.inheritedBy(qs);var Zs=W.Property.define(qs,"m_members","GroupContainer",W.PropertyFlags.Persistent|W.PropertyFlags.TwoWayReference|W.PropertyFlags.SupportsDeepCopy|W.PropertyFlags.IsCollection);function Ks(t){l.call(this),t&&t.setDisplayStrategy(this)}Ks.prototype.collapse=function(){H.NestedNodeUtil.applyDefaultDisplayStrategyForMembers(this.getOwner())},Ks.prototype.expand=function(){H.NestedNodeUtil.applyDefaultDisplayStrategyForMembers(this.getOwner())},Ks.prototype.show=function(){var t=this.getOwner();if(t){var i=t.getLabel();i&&this.removeHiddenElement(i);var n=t.getPorts();if(n)for(var r=0,s=n.length;r<s;r++)this.removeHiddenElement(n[r])}},Ks.prototype.hide=function(){var t=this.getOwner();if(t){var i=t.getLabel();i&&this.addHiddenElement(i);var n=t.getPorts();if(n)for(var r=0,s=n.length;r<s;r++)this.addHiddenElement(n[r])}},Ks.prototype.getHiddenElements=function(){return Qs.getValue(this)},Ks.prototype.setHiddenElements=function(t){Qs.setValue(this,t)},
Ks.prototype.addHiddenElement=function(t){var i=Qs.getValue(this);i?(i.push(t),t.setVisibleByParent(!1)):this.setHiddenElements([t])},Ks.prototype.removeHiddenElement=function(t){t.setVisibleByParent(!0);var i=Qs.getValue(this);!i||0<=(t=i.indexOf(t))&&i.splice(t,1)},Ks.prototype.getCollapsedElements=function(){return $s.getValue(this)},Ks.prototype.setCollapsedElements=function(t){$s.setValue(this,t)},Ks.prototype.addCollapsedElement=function(t){var i=$s.getValue(this);i?(i.push(t),t.setVisibleByNestedNode(!1)):this.setCollapsedElements([t])},Ks.prototype.removeCollapsedElement=function(t){t.setVisibleByNestedNode(!0);var i=$s.getValue(this);!i||0<=(t=i.indexOf(t))&&i.splice(t,1)},l.inheritedBy(Ks);var Qs=W.Property.define(Ks,"m_hiddenElements",Array,W.PropertyFlags.NotifyChange|W.PropertyFlags.SupportsShallowCopy,function(t,i,n,r){if(r)for(var s=r.length,h=0;h<s;++h)r[h].setVisibleByParent(!0);if(n)for(s=n.length,h=0;h<s;++h)n[h].setVisibleByParent(!1)}),$s=W.Property.define(Ks,
"m_collapsedElements",Array,W.PropertyFlags.NotifyChange|W.PropertyFlags.SupportsShallowCopy,function(t,i,n,r){r&&r.forEach(function(t){t.setVisibleByNestedNode(!0)}),n&&n.forEach(function(t){t.setVisibleByNestedNode(!1)})});function th(){W.common.ObjectBase.call(this)}function ih(){l.call(this),nh.setRawValue(this,H.PrintStatus.IF_VISIBLE)}th.prototype.getRenderingProperties=function(t){},th.prototype.getStartArrow=function(t){},th.prototype.getEndArrow=function(t){},W.common.ObjectBase.inheritedBy(th),ih.prototype.setPrintStatus=function(t){nh.setValue(this,t)},ih.prototype.getPrintStatus=function(){return nh.getValue(this)},l.inheritedBy(ih);var nh=W.Property.define(ih,"m_printStatus",Number,W.PropertyFlags.Persistent|W.PropertyFlags.SupportsShallowCopy);function rh(t,i,n){l.call(this),hh.setRawValue(this,1),sh.setRawValue(this,!1),eh.setRawValue(this,!0),this.CW=i,t&&this.attachSession(t);n=void 0!==n?n:H.DisplayOrderOption.Default;this.setDisplayOrderOption(n)}
rh.prototype.setRenderCanvas=function(t){oh.setValue(this,t)},rh.prototype.getRenderCanvas=function(){return oh.getValue(this)},rh.prototype.getLayer=function(){return hh.getValue(this)},rh.prototype.setLayer=function(t){hh.setValue(this,t)},rh.prototype.getUserName=function(){return uh.getValue(this)},rh.prototype.setUserName=function(t){uh.setValue(this,t)},rh.prototype.isHidden=function(){return sh.getValue(this)},rh.prototype.setHidden=function(t){sh.setValue(this,t);var i=this.getRenderCanvas();if(i){this.CW.kW(i,!t);for(var n=this.getReferencings(),r=0;r<n.length;r++)n[r].l4()}else for(var s=this.getReferencings(),h=s.length,u=0;u<h;u++){var o=s[u];o&&o.updateRenderPolyline&&o.updateRenderPolyline(),o&&o.setVisibleByLayer&&o.setVisibleByLayer(!t)}},rh.prototype.setSelectable=function(t){eh.setValue(this,t)},rh.prototype.isSelectable=function(){return eh.getValue(this)},rh.prototype.getDisplayOrderOption=function(){return fh.getValue(this)}
;rh.prototype.setDisplayOrderOption=function(t){fh.setValue(this,t)},l.inheritedBy(rh);var sh=W.Property.define(rh,"m_hidden",Boolean,W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.SupportsShallowCopy),hh=W.Property.define(rh,"m_layer",Number,W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.SupportsShallowCopy),uh=W.Property.define(rh,"m_userName",String,W.PropertyFlags.Persistent|W.PropertyFlags.None|W.PropertyFlags.SupportsShallowCopy),oh=W.Property.define(rh,"m_renderCanvas","RenderCanvas",W.PropertyFlags.AffectRender|W.PropertyFlags.NotifyChange|W.PropertyFlags.SupportsDeepCopy),eh=W.Property.define(rh,"m_selectable",Boolean,W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.SupportsShallowCopy),fh=W.Property.define(rh,"m_displayOrderOption",Number,W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.SupportsShallowCopy,function(t,i,n,r){var s,h,u,o;n===H.DisplayOrderOption.Below?(
s=t.getSession())&&(h=(h=t.CW)||s.hT())&&(r===H.DisplayOrderOption.Above&&(u=t.getRenderCanvas())&&h.BW(u),o=h.xW(),t.setRenderCanvas(o)):n===H.DisplayOrderOption.Above&&(s=t.getSession())&&(h=(h=t.CW)||s.hT())&&(r===H.DisplayOrderOption.Below&&(u=t.getRenderCanvas())&&h.BW(u),o=h.EW(),t.setRenderCanvas(o))});function ch(t,i,n,r,s,h,u,o,e){Qn.call(this,t,h,u,o,e),ah.setRawValue(this,null!=n?n:20),vh.setRawValue(this,null!=r?r:H.StubSideType.INFERRED),lh.setRawValue(this,null!=s?s:H.LeaderLineType.PLAIN),i&&i.addLeaderLine(this)}ch.prototype.getStubLength=function(){var t=ah.getValue(this);return t=null==t?this.getSession().getSheetConfigurationData().minSegmentLength:t},ch.prototype.setStubLength=function(t){ah.setValue(this,t),this.setUpToDate(!1)},ch.prototype.getStubSides=function(){return vh.getValue(this)},ch.prototype.setStubSides=function(t){vh.setValue(this,t),this.setUpToDate(!1)},ch.prototype.getLeaderineType=function(){return lh.getValue(this)},
ch.prototype.setLeaderineType=function(t){lh.setValue(this,t),this.setUpToDate(!1)},ch.prototype.getLeaderType=function(){return lh.getValue(this)},ch.prototype.setLeaderType=function(t){lh.setValue(this,t),this.setUpToDate(!1)},ch.prototype.getVerticalAlignment=function(){return mh.getValue(this)},ch.prototype.setVerticalAlignment=function(t){mh.setValue(this,t),this.setUpToDate(!1)},ch.prototype.Z9=function(){},ch.prototype.kM=function(){},ch.prototype.setStartLocation=function(t,i){Qn.prototype.setStartLocation.call(this,t,i),t&&(t.sF=!0)},ch.prototype.setEndLocation=function(t,i){Qn.prototype.setEndLocation.call(this,t,i),t&&(t.sF=!0)},ch.prototype.getValidStartNode=function(){var t,i,n=Qn.prototype.getValidStartNode.call(this);return n||this.getLeaderType()!==H.LeaderLineType.WITHOUT_STUB||(i=this.getStartLocation())&&(t=this.getOwner(),(i=i.getReference())&&i===t&&(n=i)),n},ch.prototype.getValidEndNode=function(){var t,i,n=Qn.prototype.getValidEndNode.call(this)
;return n||this.getLeaderType()!==H.LeaderLineType.WITHOUT_STUB||(i=this.getEndLocation())&&(t=this.getOwner(),(i=i.getReference())&&i===t&&(n=i)),n},ch.prototype.DW=function(t,i,n){var r=this.getOwner(),s=0,h=r.getLineHeight(),u=(h=0==h?r.getBBox().height:h)/2,o=this.getSession().getSheetConfigurationData().stubBoundingBoxDistance;0!=o&&(s=h*(o||.5));var o=this.getVerticalAlignment(),e=u,f=0;o==H.LeaderLineAlignmentType.MIDDLE?(e=0,f=.5):o==H.LeaderLineAlignmentType.BOTTOM&&(e=-u,f=1);var c=this.getStubLength(),a=null;switch(this.getStubSides()){case H.StubSideType.INFERRED:a=r.getAnchorPosition().x<n.x?(t.setInput(H.CoordinateMode.PERCENT,H.Axis.X,1),t.setInput(H.CoordinateMode.ABSOLUTE,H.Axis.X,0),t.setInput(H.CoordinateMode.PERCENT,H.Axis.Y,f),t.setInput(H.CoordinateMode.ABSOLUTE,H.Axis.Y,e),(i=t.getEvaluatedLocation()).x+=s,new H.Point(i.x+c,i.y)):(t.setInput(H.CoordinateMode.PERCENT,H.Axis.X,0),t.setInput(H.CoordinateMode.ABSOLUTE,H.Axis.X,0),t.setInput(H.CoordinateMode.PERCENT,
H.Axis.Y,f),t.setInput(H.CoordinateMode.ABSOLUTE,H.Axis.Y,e),(i=t.getEvaluatedLocation()).x-=s,new H.Point(i.x-c,i.y));break;case H.StubSideType.LEFT:t.setInput(H.CoordinateMode.PERCENT,H.Axis.X,0),t.setInput(H.CoordinateMode.ABSOLUTE,H.Axis.X,0),t.setInput(H.CoordinateMode.PERCENT,H.Axis.Y,f),t.setInput(H.CoordinateMode.ABSOLUTE,H.Axis.Y,e),(i=t.getEvaluatedLocation()).x-=s,a=new H.Point(i.x-c,i.y);break;case H.StubSideType.RIGHT:t.setInput(H.CoordinateMode.PERCENT,H.Axis.X,1),t.setInput(H.CoordinateMode.ABSOLUTE,H.Axis.X,0),t.setInput(H.CoordinateMode.PERCENT,H.Axis.Y,f),t.setInput(H.CoordinateMode.ABSOLUTE,H.Axis.Y,e),(i=t.getEvaluatedLocation()).x+=s,a=new H.Point(i.x+c,i.y)}return{stubPoint:a,connToAnoPt:i}},ch.prototype.routing=function(){var t=this.getStartPoint(),i=this.getEndPoint();if(t&&i){var n=this.getOwner();if(n&&n.getLineHeight){var r,s=this.getStartLocation(),h=this.getEndLocation(),u=s.getReference(),o=h.getReference(),e=null,f=t,c=i;if(u&&u===n)e=s;else if(o&&o===n
)e=h,c=t,f=i;else if(!o&&!u)return;c&&f&&(f=this.getLeaderType()===H.LeaderLineType.WITHOUT_STUB?(e.setInput(H.CoordinateMode.PERCENT,H.Axis.X,.5),e.setInput(H.CoordinateMode.ABSOLUTE,H.Axis.X,0),e.setInput(H.CoordinateMode.PERCENT,H.Axis.Y,.5),e.setInput(H.CoordinateMode.ABSOLUTE,H.Axis.Y,0),e.getEvaluatedLocation()):(r=(c=this.DW(e,f,c)).stubPoint,c.connToAnoPt),u&&u===n?t=f:o&&o===n&&(i=f),f=this.getGeometry()||new K,i=[t,i],r&&i.splice(1,0,r),f.setPoints(i),this.setGeometry(f))}}},ch.prototype.TE=function(t){Qn.prototype.TE.call(this,t),t.keepLastPreviewPath=!0},ch.prototype.Q9=function(){},ch.prototype.cE=function(){this.routing(),this.yM()},ch.prototype.remove=function(){var t=this.getOwner();t&&t.removeLeaderLine&&t.removeLeaderLine(this),Qn.prototype.remove.call(this)},ch.prototype.NW=function(){return!1},ch.prototype.VD=function(){var t=this.getOwner();if(t&&t instanceof ai){var i=ai.prototype.Y4.call(this,t),t=this.U4();return i.unshift(t),i}return Qn.prototype.VD.call(this)}
,Qn.inheritedBy(ch);var ah=W.Property.define(ch,"m_stubLength",Number,W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.SupportsShallowCopy),vh=W.Property.define(ch,"m_stubSides",Number,W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.SupportsShallowCopy),lh=W.Property.define(ch,"m_leaderType",Number,W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.SupportsShallowCopy),mh=W.Property.define(ch,"m_verticalAlignment",Number,W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.SupportsShallowCopy);function dh(t){l.call(this),this.points=t,this.RW=!0,this.nO=null,this.QC=null,_h.setRawValue(this,new W.List)}ch.createLeaderLine=function(t,i,n,r,s){var h=t.getOwningSheet(),u=t.createDefaultCenterPort(),o=i.getLineHeight(),e=(o=0==o?i.getBBox().height:o)/2,t=new en(h,null,null,null,null,null,i);t.setOwner(i),i.addPort(null,t);var f=t.getLocation();f.setInput(H.CoordinateMode.ABSOLUTE,H.Axis.X,0);o=r;switch(
o=null==r?H.StubSideType.LEFT:o){case H.StubSideType.INFERRED:case H.StubSideType.LEFT:f.setInput(H.CoordinateMode.PERCENT,H.Axis.X,0);break;case H.StubSideType.RIGHT:f.setInput(H.CoordinateMode.PERCENT,H.Axis.X,1)}return f.setInput(H.CoordinateMode.PERCENT,H.Axis.Y,0),f.setInput(H.CoordinateMode.ABSOLUTE,H.Axis.Y,e),new ch(h,i,n,o,s,u,t)};t=function(t,i,n,r){t.a4=n};dh.prototype.setPoints=function(t){this.points=t},dh.prototype.getPoints=function(){return this.points},dh.prototype.setLineOffset=function(t){wh.setValue(this,t)},dh.prototype.getLineOffset=function(){return wh.getValue(this)},dh.prototype.setOffsetOption=function(t){bh.setValue(this,t)},dh.prototype.getOffsetOption=function(){return bh.getValue(this)},dh.prototype.setSymbols=function(t){W.common.ExceptionHelper.throwIfInvalidArray(t,"Symbol array");var i=t.length;this.a4.clear();for(var n=0;n<i;n++)this.addSymbol(t[n])},dh.prototype.addSymbol=function(t){this.a4.add(t),t.setOwner(this)},dh.prototype.getLines=function(){
var t=[],i=this.points;if(1<i.length)for(var n=i.length-1,r=0;r<n;r++){var s=i[r],h=i[r+1],h=new H.Line(s,h);t.push(h)}return t},dh.prototype.getReversedLines=function(){var t=[],i=this.points;if(1<i.length)for(var n=i.length-1;1<=n;n--){var r=i[n],s=i[n-1],s=new H.Line(r,s);t.push(s)}return t},dh.prototype.nA=function(){var t=[],i=this.QC;if(i&&0<i.path.length)for(var n=i.path,r=0;r<n.length;r++){if(r===n.length-1)return t;var s=new H.Line(n[r],n[r+1]);t.push(s)}return t},dh.prototype.FW=function(t){var i=this.a4;if(i)for(var n=i.size(),r=0;r<n;r++){var s=i.get(r),h=s.getPlacementRule();if(h){var u=[],o=h.evaluate(s);if(o)for(var e=0;e<o.length;++e){var f,c,a=o[e],v=new H.Matrix(1,0,0,1,a.x,a.y);a.angle&&(a.xFlip?0!==H.MathUtil.angleCompare(a.angle,90)&&0!==H.MathUtil.angleCompare(a.angle,270)||(f=H.Matrix.identity,f=H.Matrix.flipX,c=-a.y,v.m[7]+=c,(v=v.append(f)).m[7]-=c,v=v.rotateAt(-90,a.x,a.y)):a.yFlip?0!==H.MathUtil.angleCompare(a.angle,90)&&0!==H.MathUtil.angleCompare(a.angle,
270)||(f=H.Matrix.identity,f=H.Matrix.flipY,c=-a.x,v.m[6]+=c,(v=v.append(f)).m[6]-=c,v=v.rotateAt(-90,a.x,a.y)):a.rightReading?0!==H.MathUtil.angleCompare(a.angle,90)&&0!==H.MathUtil.angleCompare(a.angle,270)||(v=v.rotateAt(-90,a.x,a.y)):v=v.rotateAt(-a.angle,a.x,a.y)),u.push(v)}t.renderMarker(s,u)}}},dh.prototype.isVisible=function(){return this.RW},dh.prototype.XM=function(){return 0},dh.prototype.getSymbols=function(){var t=this.a4;return t?t.toArray():[]},dh.prototype.removeSymbol=function(t){this.a4.remove(t),t.setOwner(void 0)},dh.prototype.setRenderingProperties=function(t){yh.setValue(this,t)},dh.prototype.getRenderingProperties=function(){var t=yh.getValue(this);if(t)return t;t=new T;return yh.setValue(this,t),t},dh.prototype.A_=function(){var t=this.aW();this.QC=t;var i=this.getRenderingPoints();t.path=i},dh.prototype.ZF=function(){this.nO=this.QC},dh.prototype.qF=function(t){var i=t.createConnectionAnimator(this),t=this.nO;return t?i.setFromRenderStyle(t):(
i.initializeAnimationStyle(this),0===i.from.path.length&&(t=this.getStartPoint(),i.from.path.push(new H.Point(t.x,t.y)))),i.to=this.QC.clone(),i},dh.prototype.aW=function(){var t=this.getRenderingProperties().toRenderStyle();return t.transform=H.Matrix.identity,t.fillColor="none",t.T5=!0,t},dh.prototype.getRenderingPoints=function(){var t=[],i=this.getOwner().getLines(),n=[],r=wh.getValue(this),s=bh.getValue(this),h=.5*Math.PI;180<=i[0].getAngle()&&(h=-h);for(var u=0;u<i.length;++u){var o=i[u],e=o.start.clone(),f=o.end.clone(),c=new H.Vector(f.x-e.x,f.y-e.y).normalize();0<u&&2==s&&(h=.5*Math.PI,180<=o.getAngle()&&(h=-h)),c.rotate(h),c.x=c.x*r,c.y=c.y*r,e.move(c),f.move(c),n.push(new H.Line(e,f))}t.push(n[0].start);for(var a=n.length-1,v=0;v<a;++v){var l=n[v],m=n[v+1],m=l.getIntersectedPoint(m);t.push(m)}return t.push(n[a].end),this.points=t},dh.prototype.render=function(t,i){var n,r=this.QC;0!==this.getRenderingPoints().length&&(n=this.getOwner().getConnectionDisplayOption(),
i?t.updateRenderPath(r.path,r,this,n):t.renderPath(r.path,r,this,n),this.FW(t))},dh.prototype.remove=function(){this.points=[];var t=yh.getValue(this);t&&t.remove();var i=this.a4;if(i){for(var n=i.size()-1;0<=n;n--){var r=i.get(n);r.remove(!0),r.setOwner(void 0)}i.clear(),_h.setValue(this,null)}l.prototype.remove.call(this)},l.inheritedBy(dh);var wh=W.Property.define(dh,"m_lineOffset","Number",W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.AffectRender|W.PropertyFlags.SupportsShallowCopy),bh=W.Property.define(dh,"m_offsetOption","Number",W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.AffectRender|W.PropertyFlags.SupportsShallowCopy),_h=W.Property.define(dh,"m_symbols","List",W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.AffectRender|W.PropertyFlags.TwoWayReference|W.PropertyFlags.SupportsDeepCopy|W.PropertyFlags.IsCollection,t,t),yh=W.Property.define(dh,"m_renderingProperties","RenderingProperties",
W.PropertyFlags.Persistent|W.PropertyFlags.TwoWayReference|W.PropertyFlags.NotifyChange|W.PropertyFlags.AffectRender|W.PropertyFlags.SupportsDeepCopy);function gh(){Z.call(this)}gh.prototype.setCornerRadius=function(t,i){W.common.ExceptionHelper.throwIfNegative(t,"x corner radius"),W.common.ExceptionHelper.throwIfNegative(i,"y corner radius"),ph.setValue(this,t),Mh.setValue(this,i)},gh.prototype.getCornerRadius=function(){return{x:ph.getValue(this),y:Mh.getValue(this)}},gh.prototype.setXCornerRadius=function(t){W.common.ExceptionHelper.throwIfNegative(t,"x corner radius"),ph.setValue(this,t)},gh.prototype.getXCornerRadius=function(){return ph.getValue(this)},gh.prototype.setYCornerRadius=function(t){W.common.ExceptionHelper.throwIfNegative(t,"y corner radius"),Mh.setValue(this,t)},gh.prototype.getYCornerRadius=function(){return Mh.getValue(this)},gh.prototype.render=function(t,i){var n=new H.Rect(0,0,i.width,i.height),r=ph.getValue(this),s=Mh.getValue(this)
;!r||r>=i.width||s>=i.height?t.renderRect(n,i):t.renderRoundedRect(n,r,s,i)},gh.prototype.updateRender=function(t,i,n){var r=i.width,s=i.height,h=new H.Rect(0,0,r,s),r=ph.getValue(this),s=Mh.getValue(this);!r||r>=i.width||s>=i.height?t.updateRenderRect(h,i,n):t.updateRenderRoundedRect(h,r,s,i,n)},gh.prototype.select=function(t,i,n,r,s,h,u){var o=[];o.push(new H.Point(i,n)),o.push(new H.Point(i+r,n)),o.push(new H.Point(i+r,n+s)),o.push(new H.Point(i,n+s));var e=ph.getValue(this),f=Mh.getValue(this);return!e||r/2<=e||s/2<=f?h===H.SelectionRegionType.Outline?H.MathUtil.isPointOnPolyline(t.point,o.concat(o[0]),t.tolerance):H.MathUtil.isPointOnPolyline(t.point,o.concat(o[0]),t.tolerance)||H.MathUtil.isPointInsidePolygon(t.point,o,t.tolerance):h===H.SelectionRegionType.Outline?H.MathUtil.isPointOnRoundedRect(t.point,new H.Rect(i,n,r,s),e,f,t.tolerance):H.MathUtil.isPointOnRoundedRect(t.point,new H.Rect(i,n,r,s),e,f,t.tolerance)||H.MathUtil.isPointInsideRoundedRect(t.point,new H.Rect(i,n,r,s)
,e,f,t.tolerance)},gh.prototype.yF=function(){return!0},gh.prototype.intersectWithSegment=function(t,i,n,r,s,h){var u=[];u.push(new H.Point(t,i)),u.push(new H.Point(t+n,i)),u.push(new H.Point(t+n,i+r)),u.push(new H.Point(t,i+r));var o=ph.getValue(this),u=Mh.getValue(this),h=new H.Line(s,h);return!o||n/2<=o||r/2<=u?H.Intersection.getIntersectionOfRectAndLine(new H.Rect(t,i,n,r),h):H.Intersection.getIntersectionOfRoundedRectAndLine(new H.Rect(t,i,n,r),o,u,h)},gh.prototype.isPointInside=function(t,i,n,r,s,h){var u=[];u.push(new H.Point(t,i)),u.push(new H.Point(t+n,i)),u.push(new H.Point(t+n,i+r)),u.push(new H.Point(t,i+r));var o=ph.getValue(this),e=Mh.getValue(this);return!o||n/2<=o||r/2<=e?H.MathUtil.isPointInsidePolygon(s,u,h):H.MathUtil.isPointInsideRoundedRect(s,new H.Rect(t,i,n,r),o,e,h)},Z.inheritedBy(gh);var ph=W.Property.define(gh,"m_xCornerRadius",Number,W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChanget|W.PropertyFlags.AffectRender|W.PropertyFlags.SupportsShallowCopy),
Mh=W.Property.define(gh,"m_yCornerRadius",Number,W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.AffectRender|W.PropertyFlags.SupportsShallowCopy);function Sh(t,i,n,r,s,h,u){gr.call(this,t,i,n,r,s,h,u),Xh.setRawValue(this,!0),Uh.setRawValue(this,!1),this.IW=0,this.WW=null}function Nh(t,i,n,r,s){var h=[];if(!t.D4()){var u=t.askLinkedConnections(),o=t.guid;if(!r[o]){for(var e=0;e<u.length;e++){var f=Ch(u[e]),c=kh(u[e]);u[e].D4()&&!s||(c===t&&(h.push(f),i.push(f)),r[o]=!0)}if(n)for(var e=0,a=h.length;e<a;e++)Nh(h[e],i,n,r,s)}}}function Lh(t,i,n,r,s){for(var h=[],u=0;u<t.length;u++)for(var o=t[u].askLinkedConnections(),e=0;e<o.length;e++){var f=kh(o[e]),c=Ch(o[e]);o[e].D4()||(f===t[u]&&c!=r?c!=s&&c!=r&&t.indexOf(c)<0&&h.indexOf(c)<0&&i.indexOf(c)<0&&h.push(c):c===t[u]&&f!=s&&f!=r&&t.indexOf(f)<0&&h.indexOf(f)<0&&i.indexOf(f)<0&&h.push(f)),i.indexOf(t[u])<0&&t[u]!=r&&i.push(t[u])}if(n)for(var u=0,a=t.length;u<a;u++)t[u]!=s&&Lh(h,i,n,t[u],s)}function Oh(t,i){
t.forEach(function(t){i.indexOf(t)<0&&i.push(t),t.askLinkedConnections().forEach(function(t){i.indexOf(t)<0&&i.push(t)})})}function Th(t,i){t.IW|=i,t.askLinkedConnections().forEach(function(t){t.IW|=i})}function Ah(t,i){(t=t.getOwner())instanceof Sh&&t.isNestedViewMode()&&(Th(t,Eh),i.push(t),Ah(t,i))}function Ph(t,i,n){var r=[];t.isNestedViewMode()&&t.getChildNodes().forEach(function(t){t!=n&&(Th(t,xh),r.push(t),i.push(t))});for(var s=0;s<r.length;s++)Ph(r[s],i,n)}function Ch(t){return t.getEnd().getOwner()}function kh(t){return t.getStart().getOwner()}var Bh=0,xh=1,Eh=2,Dh=4,Rh=Dh,Fh=Dh|xh,Ih=Dh|Eh,Wh=Dh|Eh|xh,Hh=xh,jh=Eh,zh=Eh|xh;Sh.prototype.HW=function(){var t=null;return this.s4()&H.VisibleMask.HIDDENBYNESTEDNODE?t=this.getCollapsedOwner():this.isExpanded()||(t=this),t};function Vh(t){t.isNestedViewMode()?t.O4():t.R4()}Sh.prototype.jW=function(t,i,n){var r=n.getOuterNode();if(r&&r instanceof Sh){if(r===this)return void Vh(this);r.removeGroupMember(n)}t.addMember(n),t.n4(this,[n]),
Vh(this)},Sh.prototype.n4=function(t,i){if(i){for(var n=!1,r=0,s=i.length;r<s;r++){var h=i[r],u=h.getOuterNode();u&&u instanceof Sh?u!==this&&(u.removeGroupMember(h),n=!0):n=!0}n&&(t.addMembers(i),t.n4(this,i),Vh(this))}},Sh.prototype.addGroupMember=function(t){!1===this.isGroupingAllowed()&&!this.getIsContainer()||this.jW(this.getGroupContainer(),null,t)},Sh.prototype.addGroupMembers=function(t){t.length<1||!1===this.isGroupingAllowed()&&!this.getIsContainer()||this.n4(this.getGroupContainer(),t)},Sh.prototype.removeGroupMember=function(t){var i=Gh.getValue(this);i&&(i.removeMember(t),i.i4(this,[t]))},Sh.prototype.removeGroupMemberAfterDelete=function(t){var i=Gh.getValue(this);i&&i.removeMember(t)},Sh.prototype.getChildNodes=function(){var t=this.getGroupMembers(),i=[];if(t)for(var n=0,r=t.length;n<r;n++){var s=t[n];s instanceof Sh&&i.push(s)}return i},Sh.prototype.getConnectionsToChildren=function(){for(var t=[],i=this.askLinkedConnections(),n=i.length,r=0;r<n;r++){var s=i[r],
h=s.getStart(),u=s.getEnd();h&&u&&(h=h.getOwner(),u=u.getOwner(),h.hasOwnership(this)&&u.hasOwnership(this)&&H.CommonUtil.pushItemIfNotExist(t,s))}return t},Sh.prototype.switchViewMode=function(t){(this.isGroupingAllowed()||this.getIsContainer())&&this.getGroupContainer().setViewMode(t,this)},Sh.prototype.isNestedViewMode=function(){if(!this.isGroupingAllowed()&&!this.getIsContainer())return!1;var t=Gh.getValue(this);return(t?t.getViewMode():this.getOwningSheet().getGroupViewMode())===H.GroupViewMode.Nested},Sh.prototype.isTreeViewMode=function(){if(!this.isGroupingAllowed())return!1;var t=Gh.getValue(this);return(t?t.getViewMode():this.getOwningSheet().getGroupViewMode())===H.GroupViewMode.Tree},Sh.prototype.z4=function(){return this.isNestedViewMode()},Sh.prototype.nN=function(){var t=!1,i=this.isNestedViewMode(),n=this.getIsContainer();return t=(i||n)&&this.getMovePolicy()===H.GroupMovePolicy.SelfAndContent?!0:t},Sh.prototype.getGroupMembers=function(){var t=Gh.getValue(this)
;return t?t.getMembers():null},Sh.prototype.getAllMembers=function(){var t=null,i=[],n=0;(t=this.getGroupMembers())&&(n=t.length);for(var r=0;r<n;r++){var s=t[r];i.push(s),s instanceof Sh&&(s.isGroupingAllowed()||s.getIsContainer())&&(i=i.concat(s.getAllMembers()))}return i},Sh.prototype.r4=function(t){var i=[];if(t||this.isNestedViewMode()){var n=this.getGroupMembers();if(n)for(;0<n.length;){var r=n.shift();i.push(r),r.isTreeViewMode&&r.isTreeViewMode()&&((r=r.getGroupMembers())&&(n=n.concat(r)))}}return i};Sh.prototype.updateProxyPorts=function(t){var i;this.isHiddenByNestedNode()||((i=this.getDefaultProxyPort())&&(i.getLocation().setUpToDate(!1),this.setUpToDate(!1),i.update()),t?H.NestedNodeUtil.resetProxyPorts(this,!0):H.NestedNodeUtil.setProxyPort(this,i,!0))},Sh.prototype.createProxyPort=function(){var t=this.createDefaultCenterPort();return t?(t.setInternal(!0),t.setIsProxy(!0),t):null},Sh.prototype.getDefaultProxyPort=function(){var t,i=this.getPorts(H.Direction.BOTH);if(i
)for(var n=i.length,r=0;r<n;++r)if(i[r].isProxy()){t=i[r];break}return t=t||this.createProxyPort()},Sh.prototype.zW=function(t){var i=null;if(this.isHiddenByNestedNode()?i=this.getCollapsedOwner():this.isExpanded()||(i=this),i)for(var n=i.getDefaultProxyPort(),r=0,s=t.length;r<s;r++)H.NestedNodeUtil.setProxyPort(t[r],n,!1)},Sh.prototype.VW=function(t){if(this.isHiddenByNestedNode()||!this.isExpanded())for(var i=0,n=t.length;i<n;i++)H.NestedNodeUtil.resetProxyPorts(t[i],!1)},Sh.prototype.YW=function(t){this.updateProxyPorts(t)},Sh.prototype.setExpanded=function(t){Xh.setValue(this,t)},Sh.prototype.isExpanded=function(){return Xh.getValue(this)},Sh.prototype.A4=function(){return this.isGroupingAllowed()||this.getIsContainer()},Sh.prototype.P4=function(t){return!!gr.prototype.P4.call(this,t)&&(this!==t&&(!t.hasOwnership(this)&&!this.getIsContainer()))},Sh.prototype.C4=function(){var t,i=gr.prototype.C4.call(this);return this.isExpanded()||(t=this.getGroupMembers()||[],
i=H.ArrayUtil.subtract(i,t)),i},Sh.prototype.k4=function(){var t=gr.prototype.k4.call(this),i=this.getGroupMembers()||[];return H.ArrayUtil.subtract(t,i)};function Yh(t){return!((t=t.getOwner())&&t.isGroupingAllowed&&t.isGroupingAllowed())||!!t.d4&&Yh(t)}Sh.prototype.XW=function(t){if(this.isGroupingAllowed()){var i=Yh(this);if(gr.prototype.setVisible.call(this,t,i),i){var n=this.getGroupMembers();if(n)for(var r=n.length,s=0;s<r;++s)n[s].setVisibleByParent(t)}}else gr.prototype.setVisible.call(this,t)},Sh.prototype.setVisible=function(t){var i=this.getDisplayStrategy();i?(gr.prototype.setVisible.call(this,t,!1),t?i.show():i.hide()):this.XW(t)},Sh.prototype.setNodePaddings=function(t){(this.isGroupingAllowed()||this.getIsContainer())&&this.getGroupContainer().setNodePaddings(t)},Sh.prototype.getNodePaddings=function(){var t=Gh.getValue(this);if(t){t=t.getNodePaddings();if(void 0!==t)return{top:t[0],bottom:t[1],left:t[2],right:t[3]}}return this.session.getSheetConfigurationData(
).nodePaddings||{top:0,right:0,bottom:0,left:0}},Sh.prototype.getGroupContainer=function(){var t=Gh.getValue(this);return t||(t=new ni,Gh.setValue(this,t),t.setOwner(this)),t},Sh.prototype.GW=function(t){if(this.isGroupingAllowed()){if(this.getSession())for(var i=this.getSymbols(),n=i.length,r=0;r<n;r++)i[r].getSymbolType()!=H.NestedNodeSymbolType.ExpandButton&&i[r].getSymbolType()!=H.NestedNodeSymbolType.CollapseButton||i[r].setVisible(!i[r].isVisible());var s,h=void 0!==t?t:this.isExpanded();this.updateProxyPorts(h),this._4(),h&&(this.nL=!0,this.hL=!0),s=h,(h=(t=this).getDisplayStrategy())?s?h.expand():h.collapse():H.NestedNodeUtil.applyDefaultDisplayStrategyForMembers(t);t=this.L4();if(t)t.O4();else for(var u=this.findRelatedConnections(),o=this.getAllMembers(),n=u.length,r=0;r<n;++r)o.indexOf(u[r])<0&&u[r].update()}},Sh.prototype.t4=function(t,i){if(t)for(var n=this.isGroupingAllowed(),r=this.HW(),s=0,h=t.length;s<h;s++){var u=t[s],o=u.getOuterNode()
;o&&o instanceof Sh&&o!==this&&o.removeGroupMember(u),n&&u.setOwner(this),r&&u.setVisibleByNestedNode(!1)}},Sh.prototype.setGroupContainer=function(t){var i;Gh.setValue(this,t),t&&(t.setOwner(this),0<((i=t.getMembers())?i.length:0)&&(this.t4(i,t),t.n4(this,i),Vh(this)))},Sh.prototype.setGroupingAllowed=function(t){t&&this.getIsContainer()?W.common.ExceptionHelper.throwException(W.common.ExceptionTypes.InvalidOperationError.id,"Container node cannot set to nested node"):(Uh.setValue(this,t),!1===t&&Xh.setValue(this,!0),!0===t&&(this.getSession().wA=!0))},Sh.prototype.isGroupingAllowed=function(){return Uh.getValue(this)},Sh.prototype.setIsContainer=function(t){t&&this.isGroupingAllowed()?W.common.ExceptionHelper.throwException(W.common.ExceptionTypes.InvalidOperationError.id,"Nested node cannot set to container node"):Jh.setValue(this,t)},Sh.prototype.getIsContainer=function(){return Jh.getValue(this)},Sh.prototype.setMovePolicy=function(t){this.getGroupContainer().setMovePolicy(t)},
Sh.prototype.getMovePolicy=function(){var t,i=Gh.getValue(this);return t=i?(t=i.getMovePolicy())||H.GroupMovePolicy.SelfAndContent:t},Sh.prototype.setResizePolicy=function(t){this.getGroupContainer().setResizePolicy(t)},Sh.prototype.getResizePolicy=function(){var t,i=Gh.getValue(this);return t=i?(t=i.getResizePolicy())||H.GroupResizePolicy.FitToContent:t},Sh.prototype.setFitToContentTypes=function(t){this.getGroupContainer().setFitToContentTypes(t)},Sh.prototype.getFitToContentTypes=function(){var t,i=Gh.getValue(this);return t=i?i.getFitToContentTypes():t},Sh.prototype.fitToContent=function(){var t,i,n,r,s;!this.getIsContainer()&&!this.isGroupingAllowed()||(t=this.getContentBBox())&&(this.M4(),s=this.getNodePaddings(),i=t.x-s.left,n=t.y-s.top,r=t.width+s.left+s.right,s=t.height+s.top+s.bottom,this.setWidthValue(r),this.setHeightValue(s),this.setRenderingPosition(i,n),this.S4(),this.N4())},Sh.prototype.getWidthValue=function(){if(Xh.getValue(this)
)return gr.prototype.getWidthValue.call(this);var t=this.getSession();if(t){t=t.getSheetConfigurationData();if(t){t=t.nestedNodeCollapsedWidth;return t?t:gr.prototype.getWidthValue.call(this)}}},Sh.prototype.getHeightValue=function(){if(Xh.getValue(this))return gr.prototype.getHeightValue.call(this);var t=this.getSession();if(t){t=t.getSheetConfigurationData();if(t){t=t.nestedNodeCollapsedHeight;return t?t:gr.prototype.getHeightValue.call(this)}}},Sh.prototype.getResizeMinimumSize=function(){var t={width:0,height:0},i=this.getMinNodeSize();return i?(t.width=i[0],t.height=i[1]):(i=this.getSession())&&(i=i.getSheetConfigurationData(),this.isGroupingAllowed()?(t.width=i.nestedNodeResizeMinimumWidth,t.height=i.nestedNodeResizeMinimumHeight):(t.width=i.resizeMinimumWidth,t.height=i.resizeMinimumHeight)),t},Sh.prototype.getContentBBox=function(){var t,i=this.r4();if(i&&0<i.length)for(var n,r=this.getFitToContentTypes(),s=0<=r.indexOf("Port"),h=0<=r.indexOf("Label"),u=0;u<i.length;u++)if((
n=i[u])&&n.isVisible()&&n.W4(this)&&0<=r.indexOf(n.getTypeName())){if(t?t.union(n.getTransformedBBox()):t=n.getTransformedBBox(),s)for(var o,e=n.getPorts?n.getPorts():[],f=0;f<e.length;f++)(o=e[f])&&t.union(o.getTransformedBBox());!h||(n=n.getLabel())&&t.union(n.getTransformedBBox())}return t},Sh.prototype.getMargins=function(){var t=this.getBBox(),i={left:t.width,top:t.height,right:t.width,bottom:t.height},n=this.getResizePolicy();if(n===H.GroupResizePolicy.SelfOnly||n===H.GroupResizePolicy.SelfAndContent)return i;var r=this.getGroupMembers();return r&&0<r.length&&this.z4()&&(n=this.getContentBBox(),this.getSession()&&n&&(r=this.getNodePaddings(),i.left=n.x-t.x-r.left,i.top=n.y-t.y-r.top,i.right=t.x+t.width-(n.x+n.width)-r.right,i.bottom=t.y+t.height-(n.y+n.height)-r.bottom)),i},Sh.prototype.W4=function(){var t=this.XM();return!(t&Ht.MovePreview||t&Ht.CopyPreview)},Sh.prototype.V4=function(t){var i=Gh.getValue(this);return!i||i.getViewMode()==H.GroupViewMode.Nested||t.getOuterNode(
)!==this},Sh.prototype.render=function(t){var i,n=this.getSymbols();n&&0<n.length?gr.prototype.render.call(this,t):(i=this.getBBox())&&((n=new H.RenderStyle).strokeColor=H.Color.Black.toString(),t.renderRect(i,n))},Sh.prototype.updateRender=function(t){var i,n=this.getSymbols();!n||n.length<1?(t.clearElement(this),(i=this.getBBox())&&((n=new H.RenderStyle).strokeColor=H.Color.Black.toString(),t.renderRect(i,n))):gr.prototype.updateRender.call(this,t)},Sh.prototype.renderOverview=function(t){var i=t.getStyle(),n=this.getRenderingPosition();n&&(i.transform=this.getEvaluatedTransform(1,1,n));i=this.getWidthValue(),n=this.getHeightValue();this.isGroupingAllowed()?this.isExpanded()&&this.isNestedViewMode()?t.uR(new H.Rect(0,0,i,n)):t.renderRect(new H.Rect(0,0,i,n)):this.getIsContainer()?t.uR(new H.Rect(0,0,i,n)):t.renderRect(new H.Rect(0,0,i,n))},Sh.prototype.getConnectionsOnProxyPorts=function(){var t=[],i=this.getPorts();if(i)for(var n=i.length,r=0;r<n;r++){var s=i[r];if(s.isProxy())for(
var h=s.getProxyMasterPorts(),u=0,o=h.length;u<o;u++){var e=h[u].getConnections();Array.prototype.push.apply(t,e)}}return t},Sh.prototype.LE=function(t){var i=gr.prototype.LE.call(this,t),n=this.getSession().getSheetConfigurationData();if(n.transformPreviewOption.connectionPreviewEnabled)for(var r=this.getConnectionsOnProxyPorts(),s=0,h=r.length;s<h;s++)if(r[s].isVisible()){i.push(r[s]);for(var u=0,o=(f=r[s].LE(t)).length;u<o;u++)i.push(f[u])}if(!n.transformPreviewOption.nestedNodeChildPreviewEnabled)return i;var e=this.getGroupMembers();if(e)for(s=0,h=e.length;s<h;s++)if(t.indexOf(e[s])<0&&e[s].isVisible()){i.push(e[s]);for(var f,u=0,o=(f=e[s].LE(t)).length;u<o;u++)i.push(f[u])}return i},Sh.prototype.getRenderingBBox=function(){var t,i=gr.prototype.getRenderingBBox.call(this);if(i)return this.isExpanded()||(t=this.getSession())&&(!(t=t.getSheetConfigurationData())||(t=t.nestedNodeCollapsedHeight)&&(i.height=t)),i},Sh.prototype.WA=function(){var t;this.isGroupingAllowed()&&(Vh(this),(
t=this.isExpanded())?this.isHiddenByNestedNode()||H.NestedNodeUtil.resetProxyPorts(this,!1):this.GW(t),!(t=Gh.getValue(this))||(t=t.getMemberDisplayStrategy())&&t.UW())},Sh.prototype.remove=function(){var t=this.getGroupMembers();if(t)for(var i=this.u9(),n=this.getIsContainer(),r=0,s=t.length;r<s;r++)!n&&i&&t[r].o9()&&t[r].getOwner()===this||this.removeGroupMember(t[r]);var h=Gh.getValue(this);h&&(h.remove(),this.setGroupContainer(null));h=this.getDisplayStrategy();h&&(h.remove(),this.setDisplayStrategy(null)),gr.prototype.remove.call(this)},Sh.prototype.createDefaultCenterPort=function(){var t=this.getOwningSheet();if(t){var i=new en(t,0,0,null,0,0,this),t=i.getLocation();return t.setReference(this,!0),this.addPort(H.Direction.BOTH,i),(t=i.getLocation()).setInput(H.CoordinateMode.PERCENT,H.Axis.X,.5),t.setInput(H.CoordinateMode.ABSOLUTE,H.Axis.X,0),t.setInput(H.CoordinateMode.PERCENT,H.Axis.Y,.5),t.setInput(H.CoordinateMode.ABSOLUTE,H.Axis.Y,0),i}},
Sh.prototype.getDisplayStrategy=function(){var t=this.WW;if(t)return t;t=Gh.getValue(this);if(t){t=t.getMemberDisplayStrategy();if(t)return t.getOwner()!==this&&t.setOwner(this),t}return null},Sh.prototype.setDisplayStrategy=function(t){var i=this.WW;i&&i.setOwner(null),(this.WW=t)&&t.setOwner(this)},Sh.prototype.setOwner=function(t){gr.prototype.setOwner.call(this,t);for(var i=this.findRelatedConnections(),n=i.length,r=0;r<n;++r)i[r].Z9()},Sh.prototype._4=function(){var t=this.getGroupMembers();if(t)for(var i=t.length,n=0;n<i;++n){var r=t[n];r.getWidthPolicy()!=H.SizingPolicy.PERCENT&&r.getHeightPolicy()!=H.SizingPolicy.INHERIT||r._4()}gr.prototype._4.call(this)},Sh.prototype.PF=function(){return this.getOwningSheet().getPreferences().getNoteTextAlignment()},Sh.prototype.DF=function(){return this.getOwningSheet().getPreferences().getNoteTextAllowWrapping()},Sh.prototype.RF=function(){return this.getOwningSheet().getPreferences().getNoteTextAutoFit()},Sh.prototype.FF=function(){
var t=this.getOwningSheet();if(t){t=t.askPreferences();return t?t.getNodeLabelTextMargin():null}return null};Sh.prototype.checkOverlaps=function(){if(W.DebugFlags.UseLegacyRenderZDepth){var t=this.getBBox(),i=this.lN().owningElement,n=this.getSession().iN;if(n){for(var t=n.Lx(t),r=[],s=H.CommonUtil.retrieveSheetElements(t,function(t){return t instanceof Qn&&r.push(t),t instanceof Sh&&t.lN().owningElement===i}),h=0,u=r.length;h<u;h++){var o,e=r[h].getStart();e&&(o=e.getOwner()).lN().owningElement===i&&-1===s.indexOf(o)&&s.push(o);var f,e=r[h].getEnd();e&&(f=e.getOwner()).lN().owningElement===i&&-1===s.indexOf(f)&&s.push(f)}return s.sort(H.CommonUtil.compareElementsByZDepth),s}return[]}var c=[];if((i=this.lN().owningElement)&&i instanceof Sh)c=i.getChildNodes();else for(var a=i.getAllElements(),v=this.getOwner(),h=0;h<a.length;h++){var l=a[h].getOwner();a[h]instanceof Sh&&l==v&&c.push(a[h])}return c.sort(H.CommonUtil.compareElementsByZDepth),c},Sh.prototype.bringForward=function(){var t,
i,n,r={frontNode:null,previousNode:null,result:H.ChangeRenderOrderResult.NoChange},s=this.checkOverlaps();return 0<s.length?(n=s.indexOf(this),(t=s[n+1])?(i=t.getZDepth(),n=this.getZDepth(),this.setZDepth(i),t.setZDepth(n),r.result=H.ChangeRenderOrderResult.Success,r.frontNode=t===s[s.length-1]?this:s[s.length-1],r.previousNode=t):(r.result=H.ChangeRenderOrderResult.NoChange,r.frontNode=this)):(r.result=H.ChangeRenderOrderResult.NoChange,r.frontNode=this),r},Sh.prototype.collapseOutgoing=function(){var n,i,r=this,t=[],s=[],h=[],u=[],o=[],e=[],f=[],c=[],a=[];Nh(r,t,!0,{});var v=t.filter(function(t){if(t!=r)return t});Lh(v,h,!0,r,r),h.forEach(function(t){Th(t,xh),Ph(t,e,r)}),Ah(r,o),o.forEach(function(i){i.askLinkedConnections().forEach(function(t){(n=Ch(t))===i&&u.push(n)})}),r.askLinkedConnections().forEach(function(t){n=Ch(t),i=kh(t),n===r&&(t.D4()||i==r||u.push(i)),n===i&&(r.IW|=Dh,t.IW|=Dh)});for(var l,m,d=t.concat([r],h,o,e),w=0;w<d.length;w++)f.indexOf(d[w])<0&&f.push(d[w]);if(
0<u.length){Lh(u,s,!0,r,r),s.forEach(function(t){Ah(t,o),Th(t,Eh)});for(var b=d.concat(o,s),w=0;w<b.length;w++)f.indexOf(b[w])<0&&f.push(b[w])}return Oh(f,c),l=r,m=a,c.forEach(function(t){switch(t.IW){case Rh:case Fh:case Ih:case Wh:t!=l&&(t.E4(!1),m.push(t));break;case Hh:t.E4(!1),m.push(t);break;case jh:case zh:t instanceof Qn&&kh(t)===l&&(t.E4(!1),m.push(t))}t.IW=Bh}),a},Sh.prototype.expandOutgoingOneLevel=function(){var t=[],i=[],n=this,r=[];return Nh(n,t,!1,{},!0),Oh(t,i),i.forEach(function(t){t instanceof Sh?t.D4()&&(t.E4(!0),r.push(t)):t instanceof Qn&&kh(t)===n&&t.D4()&&(t.E4(!0),r.push(t))}),r},Sh.prototype.bringFront=function(){var t,i={frontNode:null,previousNode:null,result:H.ChangeRenderOrderResult.NoChange},n=this.checkOverlaps();return 0<n.length?(n=(t=n[n.length-1]).getZDepth(),this.getZDepth()<n?(this.setZDepth(++n),i.result=H.ChangeRenderOrderResult.Success,i.frontNode=this,i.previousNode=t):(i.result=H.ChangeRenderOrderResult.NoChange,i.frontNode=this)):(
i.result=H.ChangeRenderOrderResult.NoChange,i.frontNode=this),i},Sh.prototype.sendBack=function(){var t,i,n={backNode:null,nextNode:null,result:H.ChangeRenderOrderResult.NoChange},r=this.checkOverlaps();return 0<r.length&&(i=(t=r[0]).getZDepth())<this.getZDepth()?(this.setZDepth(--i),n.result=H.ChangeRenderOrderResult.Success,n.backNode=this,n.nextNode=t):(n.result=H.ChangeRenderOrderResult.NoChange,n.backNode=this),n},Sh.prototype.sendBackward=function(){var t,i,n,r={backNode:null,nextNode:null,result:H.ChangeRenderOrderResult.NoChange},s=this.checkOverlaps();return 0<s.length?(n=s.indexOf(this),(t=s[n-1])?(i=t.getZDepth(),n=this.getZDepth(),this.setZDepth(i),t.setZDepth(n),r.result=H.ChangeRenderOrderResult.Success,r.backNode=t===s[0]?this:s[0],r.nextNode=t):(r.result=H.ChangeRenderOrderResult.NoChange,r.backNode=this)):(r.result=H.ChangeRenderOrderResult.NoChange,r.backNode=this),r},Sh.prototype.getRenderCanvas=function(){var t=this.getLayer();if(t){t=t.getRenderCanvas()
;return t?t:this.w9()}return this.getIsContainer()?this.getSession().lk(H.Constants.CANVAS_ID_FOR_CONTAINER):this.w9()},Sh.prototype.doAlign=function(t,i,n,r,s,h){if(!(h.indexOf(H.AlignmentType.NodeToNode)<0&&h.indexOf(H.AlignmentType.AnnotationToNode)<0&&h.indexOf(H.AlignmentType.ConnectionToNode)<0))return ai.prototype.doAlign.call(this,t,i,n,r,s,h)},Sh.prototype._9=function(t){var i=this.guid,n=this.getBBox(),r=!this.isGroupingAllowed(),s={id:i,bbox:{x:n.x,y:n.y,w:n.width,h:n.height},ports:[],isLeaf:r};this.getPorts().forEach(function(t){var i=t.guid,n=t.getBBox(),r=t.isPinned()?"fix":"floating",t=t.getLocation(),t={percentX:t.getInputPercentX(),percentY:t.getInputPercentY(),offsetX:t.getInputValueX(),offsetY:t.getInputValueY()},t={id:i,bbox:{x:n.x,y:n.y,w:n.width,h:n.height},constraint:r,relativeLocation:t,connectionDirection:"any"};s.ports.push(t)}),t.graph.nodes.push(s)},gr.inheritedBy(Sh);var Xh=W.Property.define(Sh,"m_expanded",Boolean,
W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.SupportsShallowCopy,function(t,i,n,r){var s;(s=t).updateBinding("getWidthValue"),s.updateBinding("getHeightValue"),t.GW(n)}),Gh=W.Property.define(Sh,"m_groupContainer","GroupContainer",W.PropertyFlags.Persistent|W.PropertyFlags.TwoWayReference|W.PropertyFlags.NotifyChange|W.PropertyFlags.SupportsDeepCopy|W.PropertyFlags.IsCollection),Uh=W.Property.define(Sh,"m_groupingAllowed",Boolean,W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.SupportsShallowCopy),Jh=W.Property.define(Sh,"m_isContainer",Boolean,W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.SupportsShallowCopy,function(t,i,n,r){n&&(t.getLayer()||((t=t.getSession()).lk(H.Constants.CANVAS_ID_FOR_CONTAINER)||t.pA(H.Constants.CANVAS_ID_FOR_CONTAINER)))});function qh(){K.call(this)}function Zh(){Kh.setRawValue(this,"12px"),Qh.setRawValue(this,"Arial"),$h.setRawValue(this,1),tu.setRawValue(this,H.TextStyleType.Plain),
T.call(this)}Sh.createNode=function(t,i,n,r,s,h,u,o){r=new Sh(t,i,n,null,r,s,null);t.addSheetElement&&(t.addSheetElement(r),r.setOwner(t));s=new jt(null,null,h||new gh);return r.addSymbol(s),h||s.getRenderingProperties().setFillColor(o||H.Color.PureBlue),r.setVisible(!0),r.setGroupingAllowed(!1),u&&Lr.fastCreation(t,u,r),r},Sh.prototype.JW=function(){var t=this.getSession();W.common.ExceptionHelper.throwIfInvalid(t,"SheetSession");for(var i=t.getSheetConfigurationData().defaultNestedNodeSettings,n=i.titleBarHeight,r=[new H.Point(0,4*n/5),new H.Point(n/2,n/5),new H.Point(n,4*n/5)],t=[new H.Point(0,n/5),new H.Point(n/2,4*n/5),new H.Point(n,n/5)],s=[{symbolOccWidth:0,symbolOccHeight:0,symbolInstance:new gh,symbolOccStrokeColor:null,symbolOccStrokeWidth:null,symbolOccFillColor:i.backgroundColor,symbolOccWidthPolicy:H.SizingPolicy.INHERIT,symbolOccHeightPolicy:H.SizingPolicy.INHERIT,symbolOccLocationPercentX:0,symbolOccLocationAbsoluteX:0,symbolOccLocationPercentY:0,
symbolOccLocationAbsoluteY:0,symbolOccType:H.NestedNodeSymbolType.Background,visible:!0},{symbolOccWidth:0,symbolOccHeight:n,symbolInstance:new gh,symbolOccStrokeColor:null,symbolOccStrokeWidth:null,symbolOccFillColor:i.titleBarColor,symbolOccWidthPolicy:H.SizingPolicy.INHERIT,symbolOccHeightPolicy:H.SizingPolicy.LENGTH,symbolOccLocationPercentX:0,symbolOccLocationAbsoluteX:0,symbolOccLocationPercentY:0,symbolOccLocationAbsoluteY:0,symbolOccType:H.NestedNodeSymbolType.Banner,visible:!0},{symbolOccWidth:n,symbolOccHeight:n,symbolInstance:new K(new W.List(r)),symbolOccStrokeColor:i.statusSymbolColor,symbolOccStrokeWidth:2,symbolOccFillColor:null,symbolOccWidthPolicy:H.SizingPolicy.LENGTH,symbolOccHeightPolicy:H.SizingPolicy.LENGTH,symbolOccLocationPercentX:1,symbolOccLocationAbsoluteX:-n,symbolOccLocationPercentY:0,symbolOccLocationAbsoluteY:0,symbolOccType:H.NestedNodeSymbolType.ExpandButton,visible:!0},{symbolOccWidth:n,symbolOccHeight:n,symbolInstance:new K(new W.List(t)),
symbolOccStrokeColor:i.statusSymbolColor,symbolOccStrokeWidth:2,symbolOccFillColor:null,symbolOccWidthPolicy:H.SizingPolicy.LENGTH,symbolOccHeightPolicy:H.SizingPolicy.LENGTH,symbolOccLocationPercentX:1,symbolOccLocationAbsoluteX:-n,symbolOccLocationPercentY:0,symbolOccLocationAbsoluteY:0,symbolOccType:H.NestedNodeSymbolType.CollapseButton,visible:!1}],h=s.length,u=0;u<h;u++){var o,e=new jt(s[u].symbolOccWidth,s[u].symbolOccHeight,s[u].symbolInstance);s[u].symbolOccStrokeColor&&e.getRenderingProperties().setStrokeColor(s[u].symbolOccStrokeColor),s[u].symbolOccStrokeWidth&&e.getRenderingProperties().setStrokeWidth(s[u].symbolOccStrokeWidth),s[u].symbolOccFillColor&&e.getRenderingProperties().setFillColor(s[u].symbolOccFillColor),e.setWidthPolicy(s[u].symbolOccWidthPolicy),e.setHeightPolicy(s[u].symbolOccHeightPolicy),0===s[u].symbolOccLocationPercentX&&0===s[u].symbolOccLocationAbsoluteX&&0===s[u].symbolOccLocationPercentY&&0===s[u].symbolOccLocationAbsoluteY||((o=e.getLocation())||(
o=new a(0,0),e.setLocation(o)),o.setReference(this),o.setInput(H.CoordinateMode.PERCENT,H.Axis.X,s[u].symbolOccLocationPercentX),o.setInput(H.CoordinateMode.ABSOLUTE,H.Axis.X,s[u].symbolOccLocationAbsoluteX),o.setInput(H.CoordinateMode.PERCENT,H.Axis.Y,s[u].symbolOccLocationPercentY),o.setInput(H.CoordinateMode.ABSOLUTE,H.Axis.Y,s[u].symbolOccLocationAbsoluteY)),e.setVisible(s[u].visible),e.setSymbolType(s[u].symbolOccType),this.addSymbol(e)}H.CommonUtil.addMethods(Sh,{setExpandButton:function(t){t&&t.setSymbolType(H.NestedNodeSymbolType.ExpandButton);for(var i=this.getSymbols(),n=i.length,r=0;r<n;r++)if(i[r].getSymbolType()==H.NestedNodeSymbolType.ExpandButton){i[r].remove(),i[r]=t;break}this.setSymbols(i)},setCollapseButton:function(t){t&&t.setSymbolType(H.NestedNodeSymbolType.CollapseButton);for(var i=this.getSymbols(),n=i.length,r=0;r<n;r++)if(i[r].getSymbolType()==H.NestedNodeSymbolType.CollapseButton){i[r].remove(),i[r]=t;break}this.setSymbols(i)},setBannar:function(t){
t&&t.setSymbolType(H.NestedNodeSymbolType.Banner);for(var i=this.getSymbols(),n=i.length,r=0;r<n;r++)if(i[r].getSymbolType()==H.NestedNodeSymbolType.Banner){i[r].remove(),i[r]=t;break}this.setSymbols(i)},setBackgroundSymbol:function(t){t&&t.setSymbolType(H.NestedNodeSymbolType.Background);for(var i=this.getSymbols(),n=i.length,r=0;r<n;r++)if(i[r].getSymbolType()==H.NestedNodeSymbolType.Background){i[r].remove(),i[r]=t;break}this.setSymbols(i)}})},Sh.createDefaultNestedNode=function(t,i,n){n=new Sh(t,i,n);return n.setGroupingAllowed(!0),n.removeSymbols(),n.JW(),n.setRenderingPosition(0,0),n.setVisible(!0),t.addSheetElement&&(t.addSheetElement(n),n.setOwner(t)),n},Sh.createNestedNode=function(t,i,n,r){W.common.ExceptionHelper.throwIfInvalidArray(t,"sheet element array");for(var s=null,h=null,u=t.length,o=0;o<u;o++){var e=t[o];if(e)if(e instanceof Lr||e instanceof en)t.splice(t.indexOf(e),1);else if(e.getOwner)for(var f=u-1;f>t.indexOf(e);f--){var c,a;if(t[f]){if(c=e.hasOwnership(t[f]),
a=t[f].hasOwnership(e),c){t.splice(t.indexOf(e),1);break}a&&t.splice(t.indexOf(t[f]),1)}}}var v=t.length;if(v<1)return null;if(s=t[0].getOwningSheet()){for(var l=null,o=0;o<v;++o){var m=t[o].getRenderingBBox();0===o?l=m.clone():l.union(m)}var d=s.getSession();W.common.ExceptionHelper.throwIfInvalid(d,"SheetSession");var w=d.getSheetConfigurationData(),d=w.defaultNestedNodeSettings.titleBarHeight,w=w.nodePaddings;return l.x-=w.left,l.y-=w.top-d,l.width+=w.left+w.right,l.height+=w.top+w.bottom-d,(h=Sh.createNode(s,l.width,l.height,l.x,l.y,n,i,null)).setRenderingPosition(l.x,l.y),h.setGroupingAllowed(!0),n||h.JW(),h.addGroupMembers(t),r&&(!!(r instanceof Sh)&&r.isGroupingAllowed()||W.common.ExceptionHelper.throwException(W.common.ExceptionTypes.InvalidParent.id),r.addGroupMember(h)),h}},qh.prototype.render=function(t,i){var n=this.getPoints();n.push(n[0]),t.renderPolyline(n,i)},qh.prototype.updateRender=function(t,i,n){var r=this.getPoints();r.push(r[0]),t.updateRenderPolyline(r,i,n)},
qh.prototype.select=function(t,i,n,r,s,h,u){for(var o=[],e=this.getPoints(),f=0,c=e.length;f<c;f++){var a=e[f].clone();a.x+=i,a.y+=n,o.push(a)}return h===H.SelectionRegionType.Outline?H.MathUtil.isPointOnPolyline(t.point,o.concat(o[0]),t.tolerance):H.MathUtil.isPointOnPolyline(t.point,o.concat(o[0]),t.tolerance)||H.MathUtil.isPointInsidePolygon(t.point,o,t.tolerance)},qh.prototype.intersectWithSegment=function(t,i,n,r,s,h){for(var u=this.getPoints(),o=[],e=new H.Line(s,h),f=0,c=u.length;f<c;f++){var a=u[f],v=f===c-1?u[0]:u[f+1],v=new H.Line(new H.Point(a.x+t,a.y+i),new H.Point(v.x+t,v.y+i)),v=H.Intersection.getIntersectionOfLines(v,e);v&&o.push(v)}return o},K.inheritedBy(qh),Zh.prototype.setFontSize=function(t){Kh.setValue(this,t)},Zh.prototype.getFontSize=function(){return Kh.getValue(this)},Zh.prototype.setFontFamily=function(t){Qh.setValue(this,t)},Zh.prototype.getFontFamily=function(){return Qh.getValue(this)},Zh.prototype.setLineSpacing=function(t){$h.setValue(this,t)},
Zh.prototype.getLineSpacing=function(){return $h.getValue(this)},Zh.prototype.setStyle=function(t){tu.setValue(this,t)},Zh.prototype.getStyle=function(){return tu.getValue(this)},Zh.prototype.getAttributes=function(){var t=T.prototype.getAttributes.call(this);t["font-family"]=this.getFontFamily(),t["font-size"]=this.getFontSize();var i=this.getStyle(),n=(i&H.TextStyleType.Bold)===H.TextStyleType.Bold,i=(i&H.TextStyleType.Italic)===H.TextStyleType.Italic;return n&&(t["font-weight"]="bold"),i&&(t["font-style"]="italic"),t},Zh.prototype.getReferencings=function(){var t=T.prototype.getReferencings.call(this);return t=this.BI?t.concat(this.BI):t},Zh.prototype.toRenderStyle=function(t){var i=T.prototype.toRenderStyle.call(this,t),n=!1,r=this.getFontFamily();t&&r===i.fontFamily||(i.fontFamily=r,n=!0);r=this.getFontSize();t&&r===i.fontsize||(i.fontsize=r,n=!0);r=this.getStyle();return t&&r===i.fontStyle||(i.fontStyle=r,n=!0),n&&t&&(
i.renderReason=i.renderReason|H.RenderReason.RenderingPropertiesChange),i};v=function(t){t.getReferencings().forEach(function(t){t&&t.notifySizeUpdateOnTextStyleChanged&&t.notifySizeUpdateOnTextStyleChanged()})};T.inheritedBy(Zh);var Kh=W.Property.define(Zh,"m_fontSize",String,W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.AffectRender|W.PropertyFlags.SupportsShallowCopy,v),Qh=W.Property.define(Zh,"m_fontFamily",String,W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.AffectRender|W.PropertyFlags.SupportsShallowCopy,v),$h=W.Property.define(Zh,"m_lineSpacing",Number,W.PropertyFlags.AffectRender|W.PropertyFlags.NotifyChange|W.PropertyFlags.SupportsShallowCopy,v),tu=W.Property.define(Zh,"m_style",Number,W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.AffectRender|W.PropertyFlags.SupportsShallowCopy,v);function iu(t){l.call(this),su.setRawValue(this,3),vu.setRawValue(this,H.TextAlignment.LEFT),lu.setRawValue(this,
H.TextAlignment.LEFT),mu.setRawValue(this,!0),du.setRawValue(this,!0),wu.setRawValue(this,H.TextBoxAutoFitType.RESIZE_OUTLINE),bu.setRawValue(this,H.TextBoxAutoFitType.RESIZE_OUTLINE),_u.setRawValue(this,!0),Su.setRawValue(this,H.ConnectionLabelRotationMode.RightReading),Ou.setRawValue(this,H.PropagationOptions.All),Tu.setRawValue(this,H.LineDisplayOption.Polyline),Au.setRawValue(this,!1),Pu.setRawValue(this,H.ConnectionHandleOption.ALL_HANDLES),this.initialize(),t&&t.setPreferences(this)}iu.prototype.initialize=function(){},iu.prototype.getMinSegmentLength=function(){return ru.getValue(this)},iu.prototype.setMinSegmentLength=function(t){ru.setValue(this,t)},iu.prototype.getSegmentAngleTolerance=function(){return su.getValue(this)},iu.prototype.setSegmentAngleTolerance=function(t){su.setValue(this,t)};iu.prototype.getConnectionLabelOrientation=function(){return hu.getValue(this)},iu.prototype.setConnectionLabelOrientation=function(t){hu.setValue(this,t)},
iu.prototype.getConnectionLabelPosition=function(){return uu.getValue(this)},iu.prototype.setConnectionLabelPosition=function(t){uu.setValue(this,t)},iu.prototype.getConnectionLabelOffset=function(){return ou.getValue(this)},iu.prototype.setConnectionLabelOffset=function(t){ou.setValue(this,t)},iu.prototype.getConnectionLabelTextStyle=function(){return eu.getValue(this)},iu.prototype.setConnectionLabelTextStyle=function(t){eu.setValue(this,t)},iu.prototype.getConnectionLabelRepeatSetting=function(){return fu.getValue(this)},iu.prototype.setConnectionLabelRepeatSetting=function(t){fu.setValue(this,t)},iu.prototype.getConnectionLabelAutoHideOption=function(){return cu.getValue(this)},iu.prototype.setConnectionLabelAutoHideOption=function(t){cu.setValue(this,t)},iu.prototype.getNoteTextStyle=function(){return au.getValue(this)},iu.prototype.setNoteTextStyle=function(t){au.setValue(this,t)};t=function(t){t.notifySizeUpdateOnTextStyleChanged()}
;iu.prototype.notifySizeUpdateOnTextStyleChanged=function(){var t=this.getOwner();t&&(!(t=t.getAllElements())||(t=t.filter(function(t){return t.kN}))&&t.forEach(function(t){t.notifySizeUpdateOnTextStyleChanged()}))},iu.prototype.getConnectionTagAlignment=function(){return vu.getValue(this)},iu.prototype.setConnectionTagAlignment=function(t){vu.setValue(this,t)},iu.prototype.getNoteTextAlignment=function(){return lu.getValue(this)},iu.prototype.setNoteTextAlignment=function(t){lu.setValue(this,t)},iu.prototype.getConnectionTagAllowWrapping=function(){return mu.getValue(this)},iu.prototype.setConnectionTagAllowWrapping=function(t){mu.setValue(this,t)},iu.prototype.getNoteTextAllowWrapping=function(){return du.getValue(this)},iu.prototype.setNoteTextAllowWrapping=function(t){du.setValue(this,t)},iu.prototype.getConnectionTagAutoFit=function(){return wu.getValue(this)},iu.prototype.setConnectionTagAutoFit=function(t){wu.setValue(this,t)},iu.prototype.getConnectionDisplayOption=function(){
return Tu.getValue(this)},iu.prototype.setConnectionDisplayOption=function(t){Tu.setValue(this,t)},iu.prototype.getNoteTextAutoFit=function(){return bu.getValue(this)},iu.prototype.setNoteTextAutoFit=function(t){bu.setValue(this,t)},iu.prototype.isDefaultAutoRoutingOn=function(){var t=_u.getValue(this);return t=void 0===t?!0:t},iu.prototype.getIsDefaultAutoRoutingOn=function(){return _u.getValue(this)},iu.prototype.setIsDefaultAutoRoutingOn=function(t){_u.setValue(this,t)},iu.prototype.getConnectionLabelTextMargin=function(){return yu.getValue(this)},iu.prototype.setConnectionLabelTextMargin=function(t){yu.setValue(this,t)},iu.prototype.getNodeLabelTextMargin=function(){return gu.getValue(this)},iu.prototype.setNodeLabelTextMargin=function(t){gu.setValue(this,t)},iu.prototype.getPortLabelTextMargin=function(){return pu.getValue(this)},iu.prototype.setPortLabelTextMargin=function(t){pu.setValue(this,t)},iu.prototype.getNoteTextMargin=function(){return Mu.getValue(this)},
iu.prototype.setNoteTextMargin=function(t){Mu.setValue(this,t)},iu.prototype.getConnectionLabelRotation=function(){return Su.getValue(this)},iu.prototype.setConnectionLabelRotation=function(t){Su.setValue(this,t)},iu.prototype.getConnectionAutoRoutingType=function(){return Nu.getValue(this)},iu.prototype.setConnectionAutoRoutingType=function(t){Nu.setValue(this,t)},iu.prototype.getConnectionAutoRoutingTypeForPreview=function(){return Lu.getValue(this)},iu.prototype.setConnectionAutoRoutingTypeForPreview=function(t){Lu.setValue(this,t)},iu.prototype.getAllowedPropagations=function(){return Ou.getValue(this)},iu.prototype.setAllowedPropagations=function(t){Ou.setValue(this,t)},iu.prototype.isTextAnchorBasedOnCapHeight=function(){return Au.getValue(this)},iu.prototype.setTextAnchorBasedOnCapHeight=function(t){Au.setValue(this,t)},iu.prototype.setConnectionHandles=function(t){Pu.setValue(this,t)},iu.prototype.getConnectionHandles=function(){return Pu.getValue(this)},
iu.prototype.f9=function(){return this.getAllowedPropagations()&H.PropagationOptions.HoverHighlightPropagateAllowed},iu.prototype.c9=function(){return this.getAllowedPropagations()&H.PropagationOptions.SelectHighlightPropagateAllowed},iu.prototype.o9=function(){return this.getAllowedPropagations()&H.PropagationOptions.DeletePropagateAllowed},iu.prototype.a9=function(){return this.getAllowedPropagations()&H.PropagationOptions.RotatePropagateAllowed},iu.prototype.v9=function(){return this.getAllowedPropagations()&H.PropagationOptions.MovePropagateAllowed},iu.prototype.l9=function(){return this.getAllowedPropagations()&H.PropagationOptions.VisiblePropagateAllowed},iu.prototype.m9=function(){return this.getAllowedPropagations()&H.PropagationOptions.CollapseVisiblePropagateAllowed},iu.prototype.d9=function(){return this.getAllowedPropagations()&H.PropagationOptions.LayerVisiblePropagateAllowed};function nu(t){if(t)return t.getSheetConfigurationData()}v=function(t,i,n,r){t=t.getSession()
;t&&(t.NA=n)};l.inheritedBy(iu);var ru=W.Property.define(iu,"m_minSegmentLength",Number,W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.AffectRender|W.PropertyFlags.SupportsShallowCopy,function(t,i,n,r){n<=0||(t=t.getSession(),(t=nu(t))&&(t.minSegmentLength=n,t.minNodeToEdgeDist=n,t.minPortExtensionDist=n))}),su=W.Property.define(iu,"m_segmentAngleTolerance",Number,W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.SupportsShallowCopy),hu=W.Property.define(iu,"m_connectionLabelOrientation",Number,W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.AffectRender|W.PropertyFlags.SupportsShallowCopy,function(t,i,n,r){qi.getDefaultRule().setOffsetPosition(n)}),uu=W.Property.define(iu,"m_connectionLabelPosition",Number,W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.AffectRender|W.PropertyFlags.SupportsShallowCopy,function(t,i,n,r){ut.getDefaultRule().setPlacementPosition(n)}),ou=W.Property.define(iu,
"m_connectionLabelOffset",Number,W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.AffectRender|W.PropertyFlags.SupportsShallowCopy,function(t,i,n,r){qi.getDefaultRule().setDistanceOffset(n)}),eu=W.Property.define(iu,"m_connectionLabelTextStyle",Zh,W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.AffectRender|W.PropertyFlags.TwoWayReference|W.PropertyFlags.SupportsShallowCopy,t),fu=W.Property.define(iu,"m_connectionLabelRepeatSetting",it,W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.AffectRender|W.PropertyFlags.SupportsShallowCopy,function(t,i,n,r){ut.getDefaultRule().setRepeat(n)}),cu=W.Property.define(iu,"m_connectionLabelAutoHideOption",Number,W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.AffectRender|W.PropertyFlags.SupportsShallowCopy),au=W.Property.define(iu,"m_noteTextStyle",Zh,
W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.AffectRender|W.PropertyFlags.TwoWayReference|W.PropertyFlags.SupportsShallowCopy,t),vu=W.Property.define(iu,"m_connectionTagAlignment",Number,W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.AffectRender|W.PropertyFlags.SupportsShallowCopy),lu=W.Property.define(iu,"m_noteTextAlignment",Number,W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.AffectRender|W.PropertyFlags.SupportsShallowCopy),mu=W.Property.define(iu,"m_connectionTagAllowWrapping",Boolean,W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.AffectRender|W.PropertyFlags.SupportsShallowCopy),du=W.Property.define(iu,"m_noteTextAllowWrapping",Boolean,W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.AffectRender|W.PropertyFlags.SupportsShallowCopy),wu=W.Property.define(iu,"m_connectionTagAutoFit",Number,
W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.AffectRender|W.PropertyFlags.SupportsShallowCopy),bu=W.Property.define(iu,"m_noteTextAutoFit",Number,W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.AffectRender|W.PropertyFlags.SupportsShallowCopy),_u=W.Property.define(iu,"m_isDefaultAutoRoutingOn",Boolean,W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.AffectRender|W.PropertyFlags.SupportsShallowCopy),yu=W.Property.define(iu,"m_connectionLabelTextMargin",Array,W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.SupportsDeepCopy),gu=W.Property.define(iu,"m_nodeLabelTextMargin",Array,W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.SupportsDeepCopy),pu=W.Property.define(iu,"m_portLabelTextMargin",Array,W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.SupportsDeepCopy),Mu=W.Property.define(iu,"m_noteTextMargin",Array,
W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.SupportsDeepCopy),Su=W.Property.define(iu,"m_connectionLabelRotation",Number,W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.SupportsDeepCopy),Nu=W.Property.define(iu,"m_connectionAutoRoutingType",Number,W.PropertyFlags.None,function(t,i,n,r){n<0||(t=t.getSession(),(t=nu(t))&&(t.autoRoutingType=n))}),Lu=W.Property.define(iu,"m_connectionAutoRoutingTypeForPreview",Number,W.PropertyFlags.None,function(t,i,n,r){n<0||(t=t.getSession(),(t=nu(t))&&(t.autoRoutingTypeForPreview=n))}),Ou=W.Property.define(iu,"m_allowedPropagations",Number,W.PropertyFlags.None),Tu=W.Property.define(iu,"m_connectionDisplayOption",Number,W.PropertyFlags.None),Au=W.Property.define(iu,"m_textAnchorBasedOnCapHeight",Boolean,W.PropertyFlags.None,v,v),Pu=W.Property.define(iu,"m_connectionHandles",Number,W.PropertyFlags.Persistent|W.PropertyFlags.AffectRender);function Cu(t){ai.call(this,t),this.getDefinition=function(t){
return"Needs to be implemented"}}function ku(){var s=new W.Map;s.put("A0",{width:1189,height:841}),s.put("A1",{width:841,height:594}),s.put("A2",{width:594,height:420}),s.put("A3",{width:420,height:297}),s.put("A4",{width:297,height:210}),s.put("A5",{width:210,height:148}),this.getWidth=function(t,i,n){var r=0,t=s.get(t);return null!=t&&(r=n?t.height:t.width),"inches"==i&&(r/=25.4),r},this.getHeight=function(t,i,n){var r=0,t=s.get(t);return null!=t&&(r=n?t.width:t.height),"inches"==i&&(r/=25.4),r}}function Bu(t,i,n){l.call(this);var r=new ku;null!=t&&(Vu.setValue(this,t),Yu.setValue(this,i),Xu.setValue(this,r.getWidth(t,i,n)),Gu.setValue(this,r.getHeight(t,i,n))),xu.setRawValue(this,H.JumperShapeType.NONE),Ru.setValue(this,H.JumperPriority.HORIZONTAL),Iu.setRawValue(this,0),Wu.setRawValue(this,0),ju.setRawValue(this,1),Ju.setRawValue(this,0),this.pM=!0;var s,h=new W.Map,u=H.ElementType;for(s in u)h.put(u[s],new W.Map);zu.setRawValue(this,h);var o=h.get(H.ElementType.FEATURE)
;Eu.setRawValue(this,o);var e=new W.Map;Hu.setRawValue(this,e);var f=new W.Map;qu.setRawValue(this,f);var c,a=[],v=[];this.g9=function(){return h},this.qW=function(t,i){var n=this.getSession();!n||(n=n.CM())&&(n.FI()||n.BM(new W.messages.PropertyChangedMessage(t,i,null,null,W.ChangeType.Add)))},this.addLayer=function(t,i){var n=e.get(t);return n||((n=new rh(this.getSession(),this,i)).setLayer(t),e.put(t,n)),n},this.getLayer=function(t){return e.get(t)},this.getLayers=function(){return e.values()},this.deleteLayer=function(t){var i;t&&0===t.getReferencings().length&&((i=t.getRenderCanvas())&&this.BW(i),e.removeByValue(t),t.remove())},this.deleteLayerByIndex=function(t){var i,n=e.get(t);n&&0===n.getReferencings().length&&((i=n.getRenderCanvas())&&this.BW(i),e.removeByKey(t),n.remove())},this.getCollections=function(){return f.values()},this.getCollection=function(t){return f.get(t)},this.setCollections=function(t){W.common.ExceptionHelper.throwIfInvalidArray(t,"Collection array");for(
var i=this.getCollections(),n=i.length-1;0<=n;n--)this.removeCollection(i[n]);f.clear();for(var n=0,r=t.length;n<r;n++)this.addCollection(t[n])},this.addCollection=function(t){f.put(t.getName(),t)},this.removeCollection=function(t){f.removeByKey(t.getName()),t.remove()},this.addSheetElement=function(t){var i=h.get(H.ElementType.DEFAULT);i.get(t.guid)||i.put(t.guid,t),this.qW(t,zu)},this.addElement=function(t){var i=t.getElementType(),i=h.get(i);i.get(t.guid)||i.put(t.guid,t),this.qW(t,zu)},this.addElements=function(t){if(t)for(var i=t.length,n=0;n<i;n++)this.addElement(t[n])},this.getSheetElements=function(){return h.get(H.ElementType.DEFAULT).values()},this.removeElement=function(t){var i=a.indexOf(t);0<=i&&a.splice(i,1),t&&t.setHighlightFlags(Ht.None),t.setOwner(null);i=t.getElementType();h.get(i).removeByKey(t.guid)},this.removeElements=function(t){if(t)for(var i=t.length,n=0;n<i;n++)this.removeElement(t[n])},this.removeSheetElements=function(t){if(t)for(var i=t.length,n=h.get(
H.ElementType.DEFAULT),r=0;r<i;r++)n.removeByKey(t[r].guid)},this.ZW=function(t){for(var i=this.getSheetElements(),n=i.length,r=0;r<n;r++){var s=i[r];if(s.guid==t)return this.removeElement(s),s}},this.getAllElements=function(){for(var t=[],i=h.values(),n=i.length,r=0;r<n;r++)var s=i[r],t=t.concat(s.values());return t},this.removeAllElements=function(){for(var t=this.getAllElements(),i=t.length,n=0;n<i;n++)this.removeElement(t[n]);var r,s=this.g9(),h=H.ElementType;for(r in h)s.get(h[r]).clear()},this.getAllIndexedElements=function(){for(var t=this.getAllElements(),i=t.length,n=[],r=[],s=0;s<i;s++){var h=t[s].vM();Array.prototype.push.apply(n,h.indexedElements),Array.prototype.push.apply(r,h.discardedIndexedElements)}return{allIndexedElements:n,allDiscardedIndexedElements:r}},this.getVisibleElements=function(t,i){for(var n=[],r=this.getAllElements(),s=r.length,h=0;h<s;h++){var u=r[h];u.isVisible()&&(!t||u instanceof t)&&(i&&!i.call(this,u)||n.push(u))}return n},
this.addSelectionDataObserver=function(t){v.indexOf(t)<0&&v.push(t)},this.removeSelectionDataObserver=function(t){t=v.indexOf(t);0<=t&&v.splice(t,1)},this.getSelectionDataObservers=function(){return v},this.addToSelectedElements=function(t){if(t&&0<t.length){for(var i=0,n=t.length;i<n;i++){t[i].XM();t[i].setHighlightFlags(Ht.Selected,!0),a.indexOf(t[i])<0&&a.push(t[i])}for(var r=v.length,s=0;s<r;s++)v[s].onSelectionObjectsAdded(t)}},this.removeFromSelectedElements=function(t){if(t&&0<t.length){for(var i=0,n=t.length;i<n;i++)t[i].XM()&Ht.Selected&&(t[i].setHighlightFlags(Ht.Selected,!1),t[i].setHighlightFlags(Ht.Focused,!1),t[i].setHighlightFlags(Ht.Preview,!1));t.forEach(function(t){t.XM()===Ht.None&&(t=a.indexOf(t),a.splice(t,1))});for(var r=v.length,s=0;s<r;s++)v[s].onSelectionObjectsRemoved(t)}},this.setSelectedElements=function(t,i){if(i=null==i?!0:i){var n=[];if(a&&0<a.length){for(var r=a.length-1;0<=r;r--){var s=a[r];s.XM()&Ht.Selected&&(!t||t.indexOf(s)<0)&&(s.setHighlightFlags(
Ht.Selected,!1),s.setHighlightFlags(Ht.Focused,!1),s.setHighlightFlags(Ht.Preview,!1),n.push(s))}n&&0<n.length&&n.forEach(function(t){t.XM()===Ht.None&&(t=a.indexOf(t),a.splice(t,1))})}this.addToSelectedElements(t);for(var h=v.length,u=0;u<h;u++)v[u].onSelectionObjectsRemoved(n)}else this.removeFromSelectedElements(t)},this.getSelectedElements=function(){var t=[];if(a&&0<a.length)for(var i=a.length,n=0;n<i;n++)(a[n].XM()&Ht.Selected)===Ht.Selected&&t.push(a[n]);return t},this.isMultipleSelection=function(){var t=0,i=a.length;if(0<i)for(var n=0;n<i;n++){var r=a[n].XM();if(r&Ht.Selected&&1<++t)return!0}return!1},this.addChildrenSelectedElement=function(t){t&&(t.setHighlightFlags(Ht.ChildrenSelected,!0),a.indexOf(t)<0&&a.push(t))},this.removeChildrenSelectedElement=function(t){var i;t&&(i=a.indexOf(t),t.setHighlightFlags(Ht.ChildrenSelected,!1),0<=i&&t.XM()===Ht.None&&a.splice(i,1))},this.setHoveredElements=function(t,i){if(a&&0<a.length)for(var n=(s=a.length)-1;0<=n;n--){var r=a[n].XM()
;(r&Ht.Hover)===Ht.Hover&&(a[n].setHighlightFlags(Ht.Hover,!1),r&Ht.EntireConnectionHover&&a[n].setHighlightFlags(Ht.EntireConnectionHover,!1),a[n].XM()===Ht.None&&a.splice(n,1))}if(t&&0<t.length)for(var s=t.length,n=0;n<s;n++)t[n].setHighlightFlags(Ht.Hover,i),a.indexOf(t[n])<0&&a.push(t[n])},this.getHoveredElements=function(){var t=[];if(a&&0<a.length)for(var i=a.length,n=0;n<i;n++){var r=a[n].XM(),s=Ht.Hover;(r&s)===s&&t.push(a[n])}return t},this.addColoringHighlightElement=function(t){t&&(t.setHighlightFlags(Ht.ColoringHighlight,!0),a.indexOf(t)<0&&a.push(t))},this.removeColoringHighlightElement=function(t){var i;t&&(i=a.indexOf(t),t.setHighlightFlags(Ht.ColoringHighlight,!1),0<=i&&t.XM()===Ht.None&&a.splice(i,1))},this.setFocusedElements=function(t,i){if(a&&0<a.length)for(var n=(r=a.length)-1;0<=n;n--)(a[n].XM()&Ht.Focused)===Ht.Focused&&(a[n].setHighlightFlags(Ht.Focused,!1),a[n].XM()===Ht.None&&a.splice(n,1));if(t&&0<t.length)for(var r=t.length,n=0;n<r;n++
)t[n].setHighlightFlags(Ht.Focused,i),a.indexOf(t[n])<0&&a.push(t[n])},this.getFocusedElements=function(){var t=[];if(a&&0<a.length)for(var i=a.length,n=0;n<i;n++)(a[n].XM()&Ht.Focused)===Ht.Focused&&t.push(a[n]);return t},this.getHighlightedElements=function(){return a},this.addFeature=function(t){o.get(t.guid)||o.put(t.guid,t),t.setElementType(H.ElementType.FEATURE),this.qW(t,Eu)},this.getFeatures=function(){return o?o.values():null},this.setFeatures=function(t){W.common.ExceptionHelper.throwIfInvalidArray(t,"feature array"),o.clear();for(var i=t.length,n=0;n<i;n++)o.put(t[n].guid,t[n]),t[n].setElementType(H.ElementType.FEATURE)},this.removeFeatures=function(t){return o.removeByKey(t.guid)},this.getElements=function(t){return(null==t?h.get(H.ElementType.DEFAULT):h.get(t)).values()},this.setJumperType=function(t){c=t,xu.setValue(this,t)},this.getJumperType=function(){return xu.getValue(this)},this.setAllowJumpers=function(t){t?this.getJumperType()||(c?xu.setValue(this,c):(xu.setValue(
this,H.JumperShapeType.ARC),c=H.JumperShapeType.ARC)):xu.setValue(this,H.JumperShapeType.NONE)},this.isAllowJumpers=function(){return!!xu.getValue(this)},this.isJumperPriorityUseLineType=function(){return Du.getValue(this)},this.setJumperPriorityUseLineType=function(t){Du.setValue(this,t)},this.getJumperPriorityType=function(){return Ru.getValue(this)},this.setJumperPriorityType=function(t){Ru.setValue(this,t)},this.getJumperAppearance=function(){return Fu.getValue(this)},this.setJumperAppearance=function(t){Fu.setValue(this,t)},this.getJumperHeight=function(){return Iu.getValue(this)},this.setJumperHeight=function(t){W.common.ExceptionHelper.throwIfNegative(t,"Jumper height"),Iu.setValue(this,t)},this.getJumperWidth=function(){return Wu.getValue(this)},this.setJumperWidth=function(t){W.common.ExceptionHelper.throwIfNegative(t,"Jumper width"),Wu.setValue(this,t)},this.getSheetSize=function(){return Vu.getValue(this)},this.getSheetSizeValue=function(){return{width:r.getWidth(
this.getSheetSize(),i),height:r.getHeight(this.getSheetSize(),i)}},this.setSize=function(t){Vu.setValue(this,t),Xu.setValue(this,r.getWidth(t,this.getUnits())),Gu.setValue(this,r.getHeight(t,this.getUnits()))},this.getUnits=function(){return Yu.getValue(this)},this.setUnits=function(t){Yu.setValue(this,t),Xu.setValue(this,r.getWidth(this.getSheetSize(),t)),Gu.setValue(this,r.getHeight(this.getSheetSize(),t))},this.getWidth=function(){return Xu.getValue(this)},this.setWidth=function(t){Xu.setValue(this,t)},this.getHeight=function(){return Gu.getValue(this)},this.setHeight=function(t){Gu.setValue(this,t)},this.setOpacity=function(t){ju.setValue(this,t)},this.getOpacity=function(){return ju.getValue(this)},this.containsElement=function(t){var i=t.getElementType();return!!h.get(i).get(t.guid)},this.containsFeature=function(t){return!!o.get(t.guid)},this.getDefaultSheetRect=function(){var t,i=null;return this.getSheetSize()?i=new H.Rect(0,0,this.getWidth(),this.getHeight()):!(
t=this.getSession())||(t=t.getSheetConfigurationData())&&(i=new H.Rect(0,0,t.initViewportWidth,t.initViewportHeight)),i},this.getDefaultSheetAspectRatio=function(){var t,i=1;return this.getSheetSize()?i=this.getWidth()/this.getHeight():!(t=this.getSession())||(t=t.getSheetConfigurationData())&&(i=t.initViewportWidth/t.initViewportHeight),i},this.getSheetBoundsOverview=function(){var t=null,i=this.getVisibleElements();if(0<i.length)for(var t=i[0].getRenderingBBox(),n=i.length,r=1;r<n;++r)(i[r]instanceof Sh||i[r]instanceof Qn)&&t.union(i[r].getRenderingBBox());var s=this.getDefaultSheetRect();return t&&(this.getSheetSize()?s.union(t):s=t),s},this.getSheetBounds=function(){var t=null,i=this.getVisibleElements(null,function(t){t=t.getElementType();return t===H.ElementType.DEFAULT||t===H.ElementType.FEATURE});if(0<i.length)for(var t=i[0].getRenderingBBox(),n=i.length,r=1;r<n;++r)t.union(i[r].getRenderingBBox());var s=this.getDefaultSheetRect();return t&&(this.getSheetSize()?s.union(t):s=t),
s}}ai.inheritedBy(Cu);t=function(t,i,n,r){t.pM=!1};Bu.prototype.getPreferences=function(){return Uu.getValue(this)||new iu(this)},Bu.prototype.askPreferences=function(){return Uu.getValue(this)},Bu.prototype.askPreferences=function(){return Uu.getValue(this)},Bu.prototype.setPreferences=function(t){Uu.setValue(this,t),t.setOwner(this)},Bu.prototype.getPreferencesInternal=function(t){return Uu.getValue(this)},Bu.prototype.getGroupViewMode=function(){return Ju.getValue(this)},Bu.prototype.setGroupViewMode=function(t){Ju.setValue(this,t)},Bu.prototype.A4=function(){return!1},Bu.prototype.removeAllContent=function(){var t=this.getAllElements();if(null!=t)for(var i=t.length,n=0;n<i;n++){var r=t[n];r&&r.PL()}var s=this.askPreferences();s&&s.PL();var h=this.getCollections();if(h)for(n=h.length-1;0<=n;n--)this.removeCollection(h[n]);this.removeAllElements(),this.fN().KW()},Bu.prototype.remove=function(){l.prototype.remove.call(this),this.removeAllContent()},
Bu.prototype.setCanvasAboveSystemMain=function(t){this.fN().QW(t,!0)},Bu.prototype.setCanvasBelowSystemMain=function(t){this.fN().QW(t,!1)},Bu.prototype.getCanvasAboveSystemMain=function(){return this.fN().$W(!0)},Bu.prototype.getCanvasBelowSystemMain=function(){return this.fN().$W(!1)},Bu.prototype.EW=function(){return this.fN().s8(!0)},Bu.prototype.xW=function(){return this.fN().s8(!1)},Bu.prototype.BW=function(t){this.fN().BW(t)},Bu.prototype.kW=function(t,i){this.fN().kW(t,i)},Bu.prototype.fN=function(){return this.getSession().fN()},Bu.prototype._9=function(){var i={graph:{nodes:[],connections:[]}};return this.getAllElements().forEach(function(t){t._9(i)}),i},l.inheritedBy(Bu);var xu=W.Property.define(Bu,"m_jumperType",Number,W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.AffectRender|W.PropertyFlags.SupportsShallowCopy|W.PropertyFlags.AffectIndexing,t),Eu=W.Property.define(Bu,"m_features","Map",
W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.AffectRender|W.PropertyFlags.SupportsDeepCopy|W.PropertyFlags.IsCollection),Du=W.Property.define(Bu,"m_jumperPriorityUseLineType",Boolean,W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.SupportsShallowCopy|W.PropertyFlags.AffectIndexing,t),Ru=W.Property.define(Bu,"m_jumperPriorityType",Number,W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.SupportsShallowCopy|W.PropertyFlags.AffectIndexing,t),Fu=W.Property.define(Bu,"m_jumperAppearance","Symbol",W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.SupportsDeepCopy),Iu=W.Property.define(Bu,"m_jumperHeight",Number,W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.SupportsShallowCopy|W.PropertyFlags.AffectIndexing,t),Wu=W.Property.define(Bu,"m_jumperWidth",Number,
W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.SupportsShallowCopy|W.PropertyFlags.AffectIndexing,t),Hu=W.Property.define(Bu,"m_layers","Map",W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.SupportsDeepCopy|W.PropertyFlags.IsCollection),ju=W.Property.define(Bu,"m_opacity",Number,W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.SupportsShallowCopy),zu=W.Property.define(Bu,"m_elements","Map",W.PropertyFlags.NotifyChange|W.PropertyFlags.AffectOverlay|W.PropertyFlags.AffectIndexing|W.PropertyFlags.SupportsDeepCopy|W.PropertyFlags.IsCollection),Vu=W.Property.define(Bu,"m_size",String,W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.AffectRender|W.PropertyFlags.AffectIndexing|W.PropertyFlags.SupportsShallowCopy),Yu=W.Property.define(Bu,"m_units",String,W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.AffectRender|W.PropertyFlags.SupportsShallowCopy),Xu=W.Property.define(Bu,
"m_width",Number,W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.AffectRender|W.PropertyFlags.SupportsShallowCopy),Gu=W.Property.define(Bu,"m_height",Number,W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.AffectRender|W.PropertyFlags.SupportsShallowCopy),Uu=W.Property.define(Bu,"m_preferences",iu,W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.SupportsShallowCopy),Ju=W.Property.define(Bu,"m_groupViewMode",Number,W.PropertyFlags.None|W.PropertyFlags.SupportsShallowCopy),qu=W.Property.define(Bu,"m_collections","Map",W.PropertyFlags.SupportsDeepCopy|W.PropertyFlags.IsCollection);function Zu(){l.call(this),Ku.setRawValue(this,H.SelectionRegionType.InsideOutline),Qu.setRawValue(this,H.SelectionAccuracyType.RoughSelection),to.setRawValue(this,H.SelectionSymbolVisibilityType.VisibleOnSelect),$u.setRawValue(this,-1),this.h8=null;var t=this.getSession();t&&(t.l_=!0)}Zu.prototype.setSelectionRegion=function(t){Ku.setValue(
this,t)},Zu.prototype.getSelectionRegion=function(){return Ku.getValue(this)},Zu.prototype.setSelectionAccuracy=function(t){Qu.setValue(this,t)},Zu.prototype.getSelectionAccuracy=function(){return Qu.getValue(this)},Zu.prototype.setSelectionSymbolIndex=function(t){$u.setValue(this,t)},Zu.prototype.getSelectionSymbolIndex=function(){return $u.getValue(this)},Zu.prototype.setSelectionSymbolVisibility=function(t){to.setValue(this,t)},Zu.prototype.getSelectionSymbolVisibility=function(){return to.getValue(this)},Zu.prototype.getSelectionSymbol=function(){var t,i;return this.h8||(!(i=this.getOwner())||0<=(t=this.getSelectionSymbolIndex())&&(i=i.getSymbols(),this.h8=i[t])),this.h8},Zu.prototype.remove=function(){var t=this.getOwner();t&&t.setSelectionPolicy(null)};l.inheritedBy(Zu);var Ku=W.Property.define(Zu,"m_selectionRegion",Number,W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.SupportsShallowCopy),Qu=W.Property.define(Zu,"m_selectionAccuracy",Number,
W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.SupportsShallowCopy),$u=W.Property.define(Zu,"m_selectionSymbolIndex",Number,W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.AffectRender|W.PropertyFlags.SupportsDeepCopy,function(t,i,n,r){var s;0<=n?(s=t.getOwner())&&(s=s.getSymbols(),t.h8=s[n]):t.h8=null}),to=W.Property.define(Zu,"m_selectionSymbolVisibility",Number,W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.AffectRender|W.PropertyFlags.SupportsShallowCopy);function io(t){l.call(this)}io.prototype.setObserverObject=function(t){ro.setValue(this,t)},io.prototype.getObserverObject=function(){return ro.getValue(this)},io.prototype.setReferenceObject=function(t){so.setValue(this,t)},io.prototype.getReferenceObject=function(){return so.getValue(this)},io.prototype.setWidth=function(t){ho.setValue(this,t)},io.prototype.getWidth=function(){return ho.getValue(this)},io.prototype.setHeight=function(t){uo.setValue(this,t)
},io.prototype.getHeight=function(){return uo.getValue(this)};function no(t,i,n){var r;return r=t&&"string"==typeof t?(r=t.replace("w",i)).replace("h",n):r}io.prototype.evaluate=function(){var t,i=this.getObserverObject(),n=this.getReferenceObject(),r=this.getWidth(),s=this.getHeight();i&&i.setWidthValue&&i.setHeightValue&&n&&n.getSize&&1!=i.wM&&(n=(t=n.getSize())[0],t=t[1],r&&"number"==typeof r?i.setWidthValue(r):(r=no(r,n,t))&&(r=new Function("return "+r)(),i.setWidthValue(r)),s&&"number"==typeof s?i.setHeightValue(s):(t=no(s,n,t),s&&(t=new Function("return "+t)(),i.setHeightValue(t))))},io.prototype.remove=function(){var t=this.getObserverObject();t&&t.XF&&delete t.XF,l.prototype.remove.call(this)};v=function(t,i,n,r){t.evaluate()};l.inheritedBy(io);var ro=W.Property.define(io,"m_observerObject","BaseObject",W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.AffectRender|W.PropertyFlags.SupportsShallowCopy,function(t,i,n,r){r&&r.XF&&delete r.XF,n.XF=t}),
so=W.Property.define(io,"m_referenceObject","BaseObject",W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.AffectRender|W.PropertyFlags.SupportsShallowCopy,v),ho=W.Property.define(io,"m_width",String,W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.AffectRender|W.PropertyFlags.SupportsShallowCopy,v),uo=W.Property.define(io,"m_height",String,W.PropertyFlags.Persistent|W.PropertyFlags.NotifyChange|W.PropertyFlags.AffectRender|W.PropertyFlags.SupportsShallowCopy,v);function oo(t,i,n){this.u8=i,W.common.IdentifiableObject.call(this),this.o8=t,this.ex=n,this.f8=!1,this.c8=!0,this.tD=0,this.ZO=H.ElementCoordinateMode.Sheet,this.aN=null,this.a8="renderCanvas_"+this.guid,this.v8=!1,this.l8=H.RenderingMode.Svg,this.m8=!1}oo.prototype._R=function(t){this.ex=t},oo.prototype.hT=function(){return this.ex.getSheet()},oo.prototype.getCanvasOption=function(){return this.o8},oo.prototype.cO=function(){return this.f8},oo.prototype.d8=function(t){this.f8=t},
oo.prototype.lD=function(){return this.c8},oo.prototype.w8=function(t){this.c8=t},oo.prototype._O=function(){var t=[];switch(this.o8){case H.CanvasOption.ViewFeatureCanvas:t=this.b8();break;case H.CanvasOption.SheetFeatureCanvas:t=this._8();break;case H.CanvasOption.ElementCanvas:t=this.y8();break;case H.CanvasOption.OverlayCanvas:t=this.g8();break;default:W.common.ExceptionHelper.throwException(W.common.ExceptionTypes.ArgumentError.id,"Invalid canvas option: "+this.o8)}return t},oo.prototype.b8=function(){var t=this.ex.getViewFeatures();return eo(t,this)},oo.prototype._8=function(){var t=this.hT().getFeatures();return eo(t,this)},oo.prototype.y8=function(){var t=this.hT().getAllElements();return eo(t,this)},oo.prototype.g8=function(){var t=this.ex,i=t.getSheetSession(),n=t.getOverlays();return i.getSheetConfigurationData().transformImmediateUpdate&&(t=t.getPreviewOverlays(),0<=(t=n.indexOf(t))&&n.splice(t,1)),1===i.fN().oN(H.CanvasOption.OverlayCanvas).length?n:eo(n,this)}
;var eo=function(t,i){for(var n=[],r=i.ex.getSheetSession(),s=t?t.length:0,h=0;h<s;h++){var u=t[h];u.getRenderCanvas(r)===i&&n.push(u)}return n};function fo(){Ks.call(this),co.setRawValue(this,H.MemberDisplayOption.HideAll)}oo.prototype.wS=function(){return this.v8},oo.prototype.p8=function(t){this.v8=t},oo.prototype.dS=function(){return this.l8},oo.prototype.mS=function(t){this.l8=t},oo.prototype.r5=function(){return this.m8},oo.prototype.M8=function(t){this.m8=t},oo.prototype.wD=function(t){return this.a8},oo.prototype.S8=function(t){this.a8=t},W.common.IdentifiableObject.inheritedBy(oo),fo.prototype.getDisplayOption=function(){return co.getValue(this)},fo.prototype.setDisplayOption=function(t){co.setValue(this,t),this.UW()},fo.prototype.getVisibleMembers=function(){return ao.getValue(this)},fo.prototype.setVisibleMembers=function(t){ao.setValue(this,t),this.UW()},fo.prototype.UW=function(){this.setHiddenElements([]);var t=this.getOwner();t&&(t.x4()||!t.isPrimitiveVisible(
)?this.hide():this.show())},fo.prototype.N8=function(){var t=this.getVisibleMembers(),i=this.getOwner();if(!t||t.length<1)i&&this.setHiddenElements(i.getGroupMembers());else{var n=[];!i||(i=i.getGroupMembers())&&(n=i);for(var r=0,s=n.length;r<s;r++){var h=n[r];t.indexOf(h)<0&&this.addHiddenElement(h)}}},fo.prototype.show=function(){this.setHiddenElements([])},fo.prototype.hide=function(){switch(this.getDisplayOption()){case H.MemberDisplayOption.HideAll:Ks.prototype.hide.call(this);var t=this.getOwner();t&&this.setHiddenElements(t.getGroupMembers());break;case H.MemberDisplayOption.ShowAll:Ks.prototype.hide.call(this);break;case H.MemberDisplayOption.ShowSpecified:Ks.prototype.hide.call(this),this.N8()}},Ks.inheritedBy(fo);var co=W.Property.define(fo,"m_displayOption",Number,W.PropertyFlags.None),ao=W.Property.define(fo,"m_visibleMembers",Array,W.PropertyFlags.None);function vo(t,i){this.r_=t,this.ex=i,this.L8=[{type:"VIEWFEATURE",isSys:!0,domID:H.Constants.DOM_VIEW_FEATURE},{
type:"FEATURE",isSys:!0,domID:H.Constants.DOM_SHEET_FEATURE},{type:"DEFAULT",isBelowMain:!0},{type:"DEFAULT",isSys:!0,canSwitchRenderingMode:!0,isMultiDomAlloc:!0,domID:H.Constants.DOM_MAIN_CANVAS},{type:"DEFAULT"},{type:"DEFAULT",isSys:!0,isTempGeo:!0,domID:H.Constants.DOM_OVERLAY_CANVAS}],this.B5=lo(this.L8[0]),this.Z5=lo(this.L8[1]),this.U5=lo(this.L8[3]),this.q5=lo(this.L8[4]),this.G5=lo(this.L8[5]),this.O8=[H.ElementType.OVERLAY,H.ElementType.UI],this.T8=H.Constants.CANVAS_ID_FOR_CONTAINER,this.A8=null,this.P8=[],this.C8=[],this.k8=[],this.B8=[this.B5,this.Z5,this.U5,this.G5],this.hc()}vo.prototype.hc=function(){var t=this.x8(),i=this.E8();this.P8=t.concat(i);for(var n=this.B8,r=0,s=n.length;r<s;r++){var h=n[r];this.pA(h,!0)}this.D8()},vo.prototype.x8=function(){for(var t=[],i=this.L8.length,n=0;n<i;n++){var r=this.L8[n],r=this.R8(r);t.push(r)}return t},vo.prototype.E8=function(){for(var t=[],i=this.O8.length,n=0;n<i;n++){var r,s,h=this.O8[n];for(s in H.ElementType)if(
H.ElementType[s]===h){r=s;break}var u=this.F8(r),t=t.concat(u)}return t},vo.prototype.F8=function(t){var i=[];return i.push(this.R8({type:t,isSys:!0,sizeOnDevice:!1,isTempGeo:!1})),i.push(this.R8({type:t,isSys:!0,sizeOnDevice:!0,isTempGeo:!1})),i.push(this.R8({type:t,isSys:!0,sizeOnDevice:!1,isTempGeo:!0})),i.push(this.R8({type:t,isSys:!0,sizeOnDevice:!0,isTempGeo:!0})),i};var lo=function(t){var i={VIEWFEATURE:H.Constants.CANVAS_ID_FOR_VIEWFEATURE,DEFAULT:H.Constants.CANVAS_ID_FOR_DEFAULT,FEATURE:H.Constants.CANVAS_ID_FOR_FEATURE,UI:H.Constants.CANVAS_ID_FOR_UI,OVERLAY:H.Constants.CANVAS_ID_FOR_OVERLAY},n={Sheet:H.Constants.CANVAS_ID_FOR_SIZE_ON_SHEET,Device:H.Constants.CANVAS_ID_FOR_SIZE_ON_DEVICE},r={Element:H.Constants.CANVAS_ID_SUFFIX,TempGeo:H.Constants.CANVAS_ID_SUFFIX+H.Constants.CANVAS_ID_SUFFIX_FOR_TEMPGEO},s={Sys:H.Constants.CANVAS_ID_PREFIX_FOR_SYSTEM,BelowMain:H.Constants.CANVAS_ID_PREFIX_FOR_USERBELOWMAIN,AboveMain:H.Constants.CANVAS_ID_PREFIX_FOR_USERABOVEMAIN
}[t.isSys?"Sys":t.isBelowMain?"BelowMain":"AboveMain"];return s+=i[t.type],s+=n[t.sizeOnDevice?"Device":"Sheet"],s+=r[t.isTempGeo?"TempGeo":"Element"]};vo.prototype.R8=function(t){var i=this,n={};return n.id=lo(t),n.value=t.isSys?null:[],n.creator=function(){return i.I8(t)},n},vo.prototype.I8=function(t){var i="VIEWFEATURE"===t.type?H.CanvasOption.ViewFeatureCanvas:"FEATURE"===t.type?H.CanvasOption.SheetFeatureCanvas:t.isTempGeo?H.CanvasOption.OverlayCanvas:H.CanvasOption.ElementCanvas,i=this.W8(i,t.isSys);return t.domID&&i.S8(t.domID),t.sizeOnDevice&&(i.ZO=H.ElementCoordinateMode.Device),t.canSwitchRenderingMode&&i.p8(!0),t.isMultiDomAlloc&&i.M8(!0),i},vo.prototype.clear=function(){},vo.prototype.lk=function(t){return t===this.T8?this.A8:this.H8(t).category.value},vo.prototype.j8=function(t,i,n){var r;i===this.T8?(this.A8&&W.common.ExceptionHelper.throwException(W.common.ExceptionTypes.ArgumentError.id,"category status is incorrect: "+i),this.A8=t,this.lk(
"userBelowMain_DefaultElement_SizeSheet_Canvas").push(t)):(r=this.H8(i).category).value?W.common.ArrayHelper.isArrayType(r.value)?r.value.push(t):W.common.ExceptionHelper.throwException(W.common.ExceptionTypes.ArgumentError.id,"category status is incorrect: "+i):r.value=t,n||this.z8(t,"add")},vo.prototype.pA=function(t,i){var n=null;return n=t===this.T8?this.V8():this.H8(t).category.creator(),this.j8(n,t,i),n},vo.prototype.Y8=function(t){for(var i=!1,n=this.P8,r=0,s=n.length;r<s;r++){var h=n[r];if(h.value)if(W.common.ArrayHelper.isArrayType(h.value)){var u=h.value,o=u.indexOf(t);if(0<=o){u.splice(o,1),i=!0;break}}else if(h.value===t){i=!(h.value=null);break}}return this.A8===t&&(this.A8=null),i&&this.z8(t,"remove"),i},vo.prototype.KW=function(){for(var t=this.B8,i=this.P8,n=0,r=i.length;n<r;n++){var s=i[n];if(!(0<=t.indexOf(s.id)))for(var h=this.X8(s),u=0,o=h.length;u<o;u++){var e=h[u];this.Y8(e)}}},vo.prototype.QW=function(t,i){for(
var n=i?"userAboveMain_DefaultElement_SizeSheet_Canvas":"userBelowMain_DefaultElement_SizeSheet_Canvas",r=this.lk(n).slice(0),s=0,h=r.length;s<h;s++)this.BW(r[s]);for(var u=0,o=t.length;u<o;u++)this.j8(t[u],n)},vo.prototype.$W=function(t){t=t?"userAboveMain_DefaultElement_SizeSheet_Canvas":"userBelowMain_DefaultElement_SizeSheet_Canvas";return this.fN().lk(t)},vo.prototype.s8=function(t){return this.pA(t?"userAboveMain_DefaultElement_SizeSheet_Canvas":"userBelowMain_DefaultElement_SizeSheet_Canvas")},vo.prototype.BW=function(t){t.w8(!1),this.Y8(t)},vo.prototype.kW=function(t,i){t.d8(!i),this.z8(t,i?"show":"hide")},vo.prototype.X5=function(t,i){var n=this.H8(t),r=i?this.H8(i):null,s=n.category,t=n.inx,n=r?r.category:null,r=r?r.inx:-1;if(!s||i&&!n)return!1;if(t===r+1)return!1;i=this.P8;r<0?(i.splice(t,1),i.unshift(s)):(i.splice(t,1),n=i.indexOf(n),i.splice(n+1,0,s)),this.G8();for(var h=this.X8(s),u=0,o=h.length;u<o;u++){var e=h[u];this.U8({action:"reorder",targetRcCanvas:e,
preRcCanvas:this.pD(e)})}return!0},vo.prototype.H8=function(t){for(var i=null,n=this.P8,r=0,s=n.length;r<s;r++){var h=n[r];if(h.id===t){i={inx:r,category:h};break}}return i},vo.prototype.X8=function(t){t=this.lk(t.id);return(t=t&&!W.common.ArrayHelper.isArrayType(t)?[t]:t)||[]},vo.prototype.hT=function(){return this.ex?this.ex.getSheet():this.r_.hT()},vo.prototype.iD=function(){return this.r_},vo.prototype._R=function(t){this.ex=t;for(var i=this.oN(),n=0,r=i.length;n<r;n++)i[n]._R(t)},vo.prototype.V8=function(){var t=this.J8();return t.S8("containerCanvas"),t},vo.prototype.DD=function(){for(var t=this.oN(),i=0,n=t.length;i<n;i++)if(t[i].ZO===H.ElementCoordinateMode.Device)return!0;return!1},vo.prototype._D=function(t){for(var i=this.oN(),n=0,r=i.length;n<r;n++){var s=i[n];s.ZO===H.ElementCoordinateMode.Device&&(s.aN=t)}},vo.prototype.J8=function(){return this.W8(H.CanvasOption.ElementCanvas,!1)},vo.prototype.W8=function(t,i){return new oo(t,i,this.ex)},vo.prototype.oN=function(t){
var i=null;if(void 0===t)i=this.C8;else for(var i=[],n=this.C8,r=0,s=n.length;r<s;r++){var h=n[r];h.getCanvasOption()===t&&i.push(h)}return i},vo.prototype.pD=function(t){var i=this.oN(),t=i.indexOf(t);return 0===t?null:i[t-1]},vo.prototype.z8=function(t,i){this.G8(),this.U8({action:i,targetRcCanvas:t,preRcCanvas:this.pD(t)})},vo.prototype.G8=function(){this.D8();for(var t=this.hT().getAllElements(),i=0;i<t.length;i++)t[i].u4&&0<t[i].u4.length&&(t[i].u4[0]=t[i].getRenderCanvas().tD)},vo.prototype.D8=function(){for(var t=[],i=this.P8,n=0,r=i.length;n<r;n++)var s=i[n],s=this.X8(s),t=t.concat(s);return this.C8=t,this.q8(),t},vo.prototype.q8=function(){for(var t=this.oN(),i=0,n=t.length;i<n;i++)t[i].tD=i},vo.prototype.SD=function(t){this.k8.push(t)},vo.prototype.k_=function(t){var i=this.k8,t=i.indexOf(t);return 0<=t&&(i.splice(t,1),!0)},vo.prototype.U8=function(t){for(var i=this.k8,n=0,r=i.length;n<r;n++)i[n].YO(t)};t=W.common.ObjectHelper.rootNamespace,v={};return(v.Annotation=Lr
).__typeName__="Annotation",(v.Arrow=Zn).__typeName__="Arrow",(v.BaseObject=l).__typeName__="BaseObject",(v.BitMap=Pr).__typeName__="BitMap",(v.BaseData=kr).__typeName__="BaseData",(v.ContextData=Br).__typeName__="ContextData",(v.ViewData=ms).__typeName__="ViewData",(v.OverviewWindowData=ns).__typeName__="OverviewWindowData",(v.GridPreferencesData=Hr).__typeName__="GridPreferencesData",(v.SelectionPreferencesData=ss).__typeName__="SelectionPreferencesData",(v.HighlightData=$r).__typeName__="HighlightData",(v.VisualizationPreferencesData=Ps).__typeName__="VisualizationPreferencesData",(v.Collection=js).__typeName__="Collection",(v.ConnectableElement=gr).__typeName__="ConnectableElement",(v.Connection=Qn).__typeName__="Connection",(v.ConnectionLabelLocationRule=qi).__typeName__="ConnectionLabelLocationRule",(v.ConnectionLabelPlacementRule=ut).__typeName__="ConnectionLabelPlacementRule",(v.ConnectionLocation=vt).__typeName__="ConnectionLocation",(v.Ellipse=Xs).__typeName__="Ellipse",(
v.FreeForm=Gs).__typeName__="FreeForm",(v.Group=qs).__typeName__="Group",(v.GroupContainer=ni).__typeName__="GroupContainer",(v.GroupingDisplayStrategy=Ks).__typeName__="GroupingDisplayStrategy",(v.HighlightFlags=Ht).__typeName__="HighlightFlags",(v.IConnectionStyleProvider=th).__typeName__="IConnectionStyleProvider",(v.InteractiveSettings=ih).__typeName__="InteractiveSettings",(v.Jumper=Qi).__typeName__="Jumper",(v.Layer=rh).__typeName__="Layer",(v.LeaderLine=ch).__typeName__="LeaderLine",(v.AuxDisplayLine=dh).__typeName__="AuxDisplayLine",(v.RenderingProperties=T).__typeName__="RenderingProperties",(v.RepeatModeSetting=it).__typeName__="RepeatModeSetting",(v.Location=a).__typeName__="Location",(v.LocationRule=c).__typeName__="LocationRule",(v.Node=Sh).__typeName__="Node",(v.PlacementRule=z).__typeName__="PlacementRule",(v.Polygon=qh).__typeName__="Polygon",(v.Polyline=K).__typeName__="Polyline",(v.Port=en).__typeName__="Port",(v.PreferenceData=iu).__typeName__="PreferenceData",(
v.Rectangle=gh).__typeName__="Rectangle",(v.Shape=Cu).__typeName__="Shape",(v.Sheet=Bu).__typeName__="Sheet",(v.SheetElement=ai).__typeName__="SheetElement",(v.SelectionPolicy=Zu).__typeName__="SelectionPolicy",(v.SizeObserverObject=io).__typeName__="SizeObserverObject",(v.StrokeSet=Z).__typeName__="StrokeSet",(v.SVG=Yn).__typeName__="SVG",(v.SvgTemplate=Wn).__typeName__="SvgTemplate",(v.Symbol=V).__typeName__="Symbol",(v.SymbolOccurrence=jt).__typeName__="SymbolOccurrence",(v.TextBox=wt).__typeName__="TextBox",(v.TextRenderingProperties=Zh).__typeName__="TextRenderingProperties",(v.BoundTemplateData=jn).__typeName__="BoundTemplateData",(v.RenderCanvas=oo).__typeName__="RenderCanvas",(v.MemberDisplayStrategy=fo).__typeName__="MemberDisplayStrategy",(v.RenderCanvasManager=vo).__typeName__="RenderCanvasManager",t.Models=v},"object"==typeof exports&&"undefined"!=typeof module?module.exports=n(require("@diagramming/core"),require("@diagramming/utils"),require("lodash")
):"function"==typeof define&&define.amd?define(["@diagramming/core","@diagramming/utils","lodash"],n):((t=t||self).diagramfoundation=t.diagramfoundation||{},t.diagramfoundation.models=n(t.diagramfoundation.core,t.diagramfoundation.utils,t._));