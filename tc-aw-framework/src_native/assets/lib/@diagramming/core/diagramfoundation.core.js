// @<COPYRIGHT>@
// ==================================================
// Copyright Siemens 2020.
// PL Diagram Foundation 1973.0.1-0
// ==================================================
// @<COPYRIGHT>@
var t,n;t=this,n=function(){"use strict";function e(t){for(var n=Array.prototype.slice.apply(arguments).slice(1),i=0;i<n.length;i++){var r,e=n[i];for(r in e)Object.prototype.hasOwnProperty.call(t,r)||(t[r]=e[r])}return t}function r(t){var n;return t.__typeName__||(n=/function (.{1,})\(/.exec(t.toString()),t.__typeName__=n&&1<n.length?n[1]:""),t.__typeName__}var t=function(t){for(var n,i=t.split("."),r=window,e=0;e<i.length;e++)r[n=i[e]]=r[n]||{},r=r[n];return r},n=t("SDF");n.version="1973.0.1";var m={isSubTypeOf:function(t,n){for(var i=t;null!=i;){if(i==n)return!0;i=i.__base__}return!1},inherit:function(t,n){if(t&&n&&"function"==typeof t&&"function"==typeof n){var i={};return e(i,t.prototype),t.prototype=(r=n.prototype,Object.create||(Object.create=function(t){function n(){}return n.prototype=t,new n}),Object.create(r)),e(t.prototype,i),e(t,n),(t.prototype.constructor=t)!=n&&(t.__base__=n),delete t.__index__,delete t.__typeName__,t}var r},getTypeName:r,isDerivedFrom:function(t,n){for(
var i=t;null!=i;){if(r(i)==n)return!0;i=i.__base__}return!1},isTypeIncluded:function(t,n){if(!n)return!1;for(var i=!1,r=0;r<n.length;++r){var e=n[r];if(i=this.isDerivedFrom(t,e))break}return i},namespace:t,rootNamespace:n},i=0;function s(){}function u(){s.call(this);var n=!1,i=!1;this.altKey=!1,this.ctrlKey=!1,this.shiftKey=!1,this.setHandled=function(t){n=t},this.isHandled=function(){return n},this.setCancelled=function(t){i=t},this.isCancelled=function(){return i},this.getIsAltKey=function(){return this.altKey},this.getIsCtrlKey=function(){return this.ctrlKey},this.getIsShiftKey=function(){return this.shiftKey},this.TM=function(t,n,i){this.altKey=t,this.ctrlKey=n,this.shiftKey=i}}function o(){var e=[];this.subscribe=function(t){e.push(t)},this.unsubscribe=function(t){for(var n=e.length-1;0<=n;n--)e[n]===t&&e.splice(n,1)},this.notify=function(t,n){var i;t=t||new u;for(var r=0;r<e.length&&!t.isCancelled();r++)i=e[r].call(this,t,n);return i}}s.prototype.getType=function(){
return this.constructor},s.prototype.getTypeName=function(){return m.getTypeName(this.constructor)},s.inheritedBy=function(t){m.inherit(t,this),t.__typeId__=i++},u.prototype.getType=function(){return null},s.inheritedBy(u);var p={Add:0,Remove:1,Property:2};function w(t){this.BR=t&&t.length||0,this.y=t||[],this.x=new o,this.ey=null}function h(){this.y=[],this.BR=0}w.prototype.II=function(t){var n,i,r=!1;try{0<=t&&t<this.BR&&(n=t,i=this.y.splice(t,1),this.BR--,this.x.notify(null,{owner:this.ey,source:this,changeType:p.Remove,oldIndex:n,newIndex:-1,oldItem:i[0],newItem:null}),r=!0)}catch(t){r=!1}return r},w.prototype.onListChanged=function(t){return this.ey=t,this.x},w.prototype.get=function(t){if(0<=t&&t<this.BR)return this.y[t]},w.prototype.size=function(){return this.BR},w.prototype.isEmpty=function(){return this.BR<1},w.prototype.indexOf=function(t){for(var n=this.BR,i=this.y,r=0;r<n;r++)if(i[r]==t)return r;return-1},w.prototype.clear=function(){this.y=[],this.BR=0},
w.prototype.set=function(t,n){return 0!==this.BR&&(0<=t&&t<this.BR&&(this.y[t]=n,!0))},w.prototype.add=function(t){var n=this.BR-1,i=1+n;this.y.push(t),this.BR++,this.x.notify(null,{owner:this.ey,source:this,changeType:p.Add,oldIndex:n,newIndex:i,oldItem:null,newItem:t})},w.prototype.insertAt=function(t,n){if(t==this.BR)return this.add(n),!0;var i,r=!1;if(0<=this.BR)try{0<=t&&t<this.BR&&(i=t,this.y.splice(t,0,n),this.BR++,this.x.notify(null,{owner:this.ey,source:this,changeType:p.Add,oldIndex:-1,newIndex:i,oldItem:null,newItem:n}),r=!0)}catch(t){r=!1}else r=!1;return r},w.prototype.remove=function(t){t=this.y.indexOf(t);return this.II(t)},w.prototype.removeAt=function(t){return this.II(t)},w.prototype.removeAll=function(){for(;!this.isEmpty();)this.removeAt(0)},w.prototype.contains=function(t){return 0<=this.indexOf(t)},w.prototype.toArray=function(){return this.y.concat()},w.prototype.TI=function(t){for(var n=null,i=this.BR,r=this.y,e=0;e<i;++e){var s=r[e];if(s.TI&&(n=s.TI(t)
)&&2===n.status)break}return n},w.prototype.copyFrom=function(t,n,i){this.clear();for(var r=t.size(),e=0;e<r;++e){var s=t.get(e),u=s;n&&(u=s.clone(i)),this.add(u)}},w.prototype.clone=function(t,n){var i=new w;return i.copyFrom(this,t,n),i},w.prototype.XE=function(t,n){for(var i=this.BR,r=this.y,e=0;e<i;++e){var s,u=r[e];t?u.XE&&u.XE(n):(s=null,u.getType&&u.guid&&(u=u.guid,n.containsKey(u)&&(s=n.get(u))),s&&(r[e]=s))}},w.prototype.sort=function(t){this.y.sort(t)},w.prototype.toJsonObject=function(){return this.y.slice(0)},h.prototype.size=function(){return this.BR},h.prototype.isEmpty=function(){return this.BR<1},h.prototype.clear=function(){this.y=[],this.BR=0},h.prototype.put=function(t,n){this.y[t]=n,this.BR++},h.prototype.removeByKey=function(t){var n=this.y[t],n=null!=n&&void 0!==n;return n&&(delete this.y[t],this.BR--),n},h.prototype.removeByValue=function(t){var n,i=this.y;for(n in i)if(i[n]==t)return delete i[n],this.BR--,!0;return!1},h.prototype.get=function(t){return this.y[t]
},h.prototype.containsKey=function(t){t=this.y[t];return null!=t&&void 0!==t},h.prototype.containsValue=function(t){var n,i=this.y;for(n in i)if(i[n]==t)return!0;return!1},h.prototype.keys=function(){var t,n=[],i=this.y,r=0;for(t in i)Object.prototype.hasOwnProperty.call(i,t)&&(n[r++]=t);return n},h.prototype.values=function(){var t,n=[],i=0,r=this.y;for(t in r)Object.prototype.hasOwnProperty.call(r,t)&&(n[i++]=r[t]);return n},h.prototype.TI=function(t){var n,i=null,r=this.y;for(n in r)if((i=r[n].TI(t))&&2===i.status)break;return i},h.prototype.copyFrom=function(t,n,i){this.clear();for(var r=t.keys(),e=0;e<r.length;++e){var s=t.get(r[e]),u=s;n&&(u=s.clone(i)),this.put(r[e],u)}},h.prototype.clone=function(t,n){var i=new h;return i.copyFrom(this,t,n),i},h.prototype.XE=function(t,n){var i,r=this.y;for(i in r){var e,s=r[i];t?s.XE(n):(e=null,s.getType&&s.guid&&(s=s.guid,n.containsKey(s)&&(e=n.get(s))),e&&(r[i]=e))}};var g={CheckParameter:!(h.prototype.toJsonObject=function(){var t,n={},
i=this.y;for(t in i){var r=i[t];void 0!==r&&(n[t]=r)}return n}),CheckPerformance:!1,CheckRendering:!1,UseLegacyRenderZDepth:!1,CheckLicense:"true",UseNativeDomId:!1},y={InvalidConnectionNumber:{id:1,message:"The port does not allow any more connections to be attached."},InvalidParent:{id:101,message:"The given parent for the Nested Node is invalid."},InvalidColor:{id:201,message:"Does not conform with the R,G,B format. Please check the array."},InvalidColorArray:{id:202,message:"One of the values in the RGB array exceeds 255 or the Alpha opacity value exceeds 1. Please check the array."},LayoutError:{id:301,message:"There were errors when applying the layout."},LayoutNotLoadError:{id:302,message:"The Layout library was not loaded."},ServerError:{id:401,message:"There were errors from an HTTP/Server request."},ServerRequestVersionError:{id:402,
message:"The requested version is incompatible with the version of the available service. Please use a version that has the same major numbering as the available service version."},RoutingError:{id:501,message:"There were errors when calculating the Connection routing."},JavascriptError:{id:601,message:"A JavaScript exception occurred."},ArgumentError:{id:602,message:"The parameter of a JavaScript method was illegal."},ArgumentNullError:{id:603,message:"The parameter of a JavaScript method does not support Null or Undefined."},ArgumentNotArrayError:{id:604,message:"The parameter of a JavaScript method was not an array."},ArgumentOutOfRangeError:{id:605,message:"The parameter of a JavaScript method was out of range."},NullReferenceError:{id:606,message:"A Null value was used during calculation."},InvalidOperationError:{id:701,message:"The current operation was invalid."},NotImplementedError:{id:702,message:"The JavaScript method was not implemented."},InvalidAlignElement:{id:801,
message:"The aligned element was invalid."},InvalidLicenseKey:{id:901,message:"A valid license key is required for using PL Diagram Foundation."}};var f=new function(){this.isArrayType=function(t){var n=!1;return Array.isArray?n=Array.isArray(t):"[object Array]"===Object.prototype.toString.call(t)&&(n=!0),n}};function a(t,n,i){this.message=t,this.id=n,this.innerException=i}function c(){this.throwNotImplemented=function(){this.throwException(y.NotImplementedError.id)},this.throwIfInvalid=function(t,n){null==t&&this.throwException(y.ArgumentNullError.id,'parameter "'+n+'" cannot be null or "underfined".')},this.throwIfNegative=function(t,n){void 0!==t&&t<0&&this.throwException(y.ArgumentOutOfRangeError.id,'parameter "'+n+'" cannot be negative.')},this.throwIfInvalidArray=function(t,n){var i=!1;(i=null==t||!f.isArrayType(t)?!0:i)&&this.throwException(y.ArgumentNotArrayError.id,'parameter "'+n+'" is an invalid array')},this.throwException=function(t,n){throw new a(
n||this.getExceptionMessage(t),t,null)}}c.prototype.getExceptionMessage=function(t){var n,i="";for(n in y)if(y[n].id===t){i=y[n].message;break}return i};var b=new c;var l=new function(){var o="",t=m.rootNamespace.version,n=t.substring(0,t.indexOf(".")),i=this;this.AI=function(t){o=t},this.NI=function(){if(g.CheckLicense==="$DIA"+n+"_v1.0_internal")return!0;if(!o)return b.throwException(y.InvalidLicenseKey.id),!1;try{if("1.0"===atob(o.substring(o.length-8)).substring(2,5))return function(){var n=atob(o.substring(0,o.length-8));n=(n=(n=n.replace(/(>|:|#)/g,function(){var t=arguments;return"{"===n.charAt(t[2]-1)?t[1]:":"})).replace(/(\$|\|)/g,function(){var t=arguments;return"{"===n.charAt(t[2]-1)?t[1]:","})).replace(/\{(\||\$|>|:|#)\}/g,"$1");var t=JSON.parse(n);if(t){var i,r=0;for(i in t)r++;if(4===r){var e=t.application,s=t.contact,u=t.date,t=t.email;if(e&&s&&u&&t){u=10===u.length&&-1<u.search(/[0-9]{4}\/[0-9]{2}\/[0-9]{2}/),t=-1<t.search(/@{1}/);if(u&&t)return!0}}}
return b.throwException(y.InvalidLicenseKey.id),!1}()}catch(t){b.throwException(y.InvalidLicenseKey.id)}return b.throwException(y.InvalidLicenseKey.id),!1},m.rootNamespace=m.rootNamespace||{},m.rootNamespace.setLicenseKey=function(t){i.AI(t)}};var v=new function(){this.SI=!1;var f=new h,r={},e={},i=[];this.workSheetSession=null,this.addObject=function(t){var n=t.getType().__typeId__,i=f.get(n);void 0===i&&(i=new h,f.put(n,i)),i.put(t.getId(),t),(r[t.guid]=t).session=this.workSheetSession},this.deleteObject=function(t,n){var i=!1,r=t.getType().__typeId__,r=f.get(r);return r&&(void 0!==n?r.removeByKey(n)&&(i=!0):r.removeByValue(t)&&(i=!0),e[t.guid]=t),i},this.getBaseObject=function(t,n){if(n){n=f.get(n.__typeId__);if(n)return n.get(t)}else for(var i=f.values(),r=i.length,e=0;e<r;e++){var s=i[e];if(s instanceof h&&s.containsKey(t))return s.get(t)}},this.getBaseObjectByGuid=function(t,n){if(n){n=f.get(n.__typeId__);if(n)for(o=(s=n.values()).length,h=0;h<o;h++)if((u=s[h])&&t===u.guid
)return u}else for(var i=f.values(),r=i.length,e=0;e<r;e++)for(var s,u,o=(s=i[e].values()).length,h=0;h<o;h++)if((u=s[h])&&t===u.guid)return u},this.clear=function(){f.clear()},this.getElementsByType=function(t){if(t)for(var n=f.keys(),i=n.length,r=0;r<i;r++){var e=n[r];if(e==t.__typeId__&&f.get(e)instanceof h)return f.get(e).values()}return[]},this.getObjectMap=function(){return f},this.clearUpdateList=function(){r={},e={}},this.isNewObject=function(t){return void 0!==r[t.guid]},this.isDeletedObject=function(t){return void 0!==e[t.guid]},this.addSheetSession=function(t){if(!this.SI){if(!l.NI())return;this.SI=!0}i.push(t),this.workSheetSession=t},this.removeSheetSession=function(t){var n=i.indexOf(t);i.splice(n,1),this.workSheetSession===t&&(0<i.length?this.workSheetSession=i[0]:this.workSheetSession=null)},this.hasSheetSession=function(){return 0<i.length},this.getSheetSessions=function(){return i}};function d(){s.call(this)}function I(){d.call(this),this.EI=[],this.OI=null}
d.prototype.getId=function(){return this},d.prototype.kI=function(t){},s.inheritedBy(d),I.prototype.add=function(t){t.CI||(this.EI.push(t),t.CI=!0)},I.prototype.RI=function(t){if(this.OI){for(var n=null,i=this.OI;i;)i=(n=i).OI;n.OI=t}else this.OI=t},I.prototype.jI=function(){for(var t=this.OI;t;)Array.prototype.push.apply(this.EI,t.EI),t=t.OI},I.prototype.JI=function(t){Array.prototype.push.apply(this.EI,t)},I.prototype.getMessages=function(){return this.EI},I.prototype.getMessageCount=function(){return this.EI.length},d.inheritedBy(I);var T={None:0,NotifyChange:1,AffectRender:2,AffectOverlay:4,AffectIndexing:8,BoundingBox:16,TwoWayReference:32,Identifier:64,SupportsShallowCopy:128,SupportsDeepCopy:256,IsCollection:512,Persistent:1024,AffectViewport:2048};function A(t,n,i,r,e){d.call(this),this.owner=t,this.property=n,this.oldValue=i,this.newValue=r,this.changeType=null==e||void 0===e?p.Property:e,this.DI=null==n||void 0===n?T.None:n.getFlags(),this.CI=void 0}function N(t){
this.dataStore=[],this.length=0,this.LI=t||S}d.inheritedBy(A),A.prototype.toString=function(){return this.property.getName()},A.prototype.qI=function(){return T.BoundingBox&this.DI},A.prototype.getChangeType=function(){return this.changeType==p.Remove?p.Remove:this.owner.getSession().isNewObject(this.owner)?p.Add:p.Property},A.prototype.affectIndexing=function(){return T.AffectIndexing&this.DI},A.prototype.needsToRedrawSheet=function(){return T.AffectRender&this.DI},A.prototype.needsToRedrawOverlay=function(){return T.AffectOverlay&this.DI},A.prototype.needsToRedrawViewport=function(){return T.AffectViewport&this.DI},A.prototype.needsToStore=function(){var t=!1;return T.Persistent&this.DI&&(t=!0),t=this.changeType===p.Remove&&(null===this.property||void 0===this.property)?!0:t};function S(t,n){return n<t}function E(t,n,i,r,e,s,u,o){A.call(this,t,i,u,o,r),this.source=n,this.oldIndex=e,this.newIndex=s,this.oldItem=u,this.newItem=o}N.prototype.empty=function(){return 0==this.length},
N.prototype.push=function(t){if(0===this.length)return this.dataStore.push(t),void(this.length=1);for(var n=this.dataStore,i=this.length,r=0,e=this.LI;r<i;r++)if(!e(n[r],t))break;var s=r;n.splice(s,0,t),this.length++},N.prototype.size=function(){return this.length},N.prototype.top=function(){if(0!=this.length)return this.dataStore[this.length-1]},N.prototype.pop=function(){if(0!=this.length)return this.length--,this.dataStore.pop()},N.prototype.front=function(){return this.dataStore[0]},N.prototype.back=function(){return this.dataStore[this.length-1]},A.inheritedBy(E);var O=[];function k(t,n,i,r,e){b.throwIfInvalid(n,"name"),b.throwIfInvalid(i,"ownerType"),b.throwIfInvalid(r,"propType");function o(t){return(t=t.$I)?t[f]:null}function h(t,n,i){g.CheckParameter&&null!=i&&void 0!==i&&void 0!==t.getTypeName&&c&&c.constructor===String&&(m.isDerivedFrom(i.constructor,c)||(r=t.getTypeName()+"."+u+" require a '"+c+"'",b.throwException(y.ArgumentError.id,r))),((t.$I||(t.$I=[]))[f]=i
)&&i.onListChanged&&i.onListChanged(t).subscribe(d),n&&n.onListChanged&&n.onListChanged(t).unsubscribe(d);var r=T.TwoWayReference;if((a&r)==r){if(n){var e=n.BI;if(e)for(var s=e.indexOf(t);0<=s;)e.splice(s,1),s=e.indexOf(t)}!i||i instanceof w||(i.BI||(i.BI=[])).push(t)}}var u=n,f=t,a=e,s=i,c=r,l="set"+n.substring(2,3).toUpperCase()+n.substring(3),v=this,d=function(t,n){var i=n.owner;if((a&T.TwoWayReference)==T.TwoWayReference)switch(n.changeType){case p.Add:n.newItem&&(r=(r=n.newItem.BI)||(n.newItem.BI=[])).push(i);break;case p.Remove:if(n.oldItem&&n.oldItem.BI)for(var r,e=(r=n.oldItem.BI).indexOf(i);0<=e;)r.splice(e,1),e=r.indexOf(i)}var s=i.session;!s||(s=s.CM())&&((a&T.NotifyChange)!=T.NotifyChange||s.FI()||s.BM(new E(n.owner,n.source,v,n.changeType,n.oldIndex,n.newIndex,n.oldItem,n.newItem)))};this.getIndex=function(){return f},this.getFlags=function(){return a},this.setFlags=function(t){a=t},this.addFlag=function(t){a|=t},this.getOwnerType=function(){return s},
this.getName=function(){return u},this.getSetter=function(){return l},this.getValueType=function(){return c},this.getValue=o,this.setRawValue=function(t,n){h(t,void 0,n),v.UI&&v.UI(t,v,n)},this.setValue=function(t,n){var i=o(t);if(i!=n&&(h(t,i,n),v.VI&&v.VI(t,v,n,i),(a&T.NotifyChange)==T.NotifyChange)){var r=t.session;if(r){var e=!1;if(e=(a&T.AffectRender)==T.AffectRender||(a&T.AffectOverlay)==T.AffectOverlay||(a&T.AffectIndexing)==T.AffectIndexing||r.isPersistentDataTraceable()&&(a&T.Persistent)==T.Persistent?!0:e){var s=r.CM();if(s&&!s.FI()){t.GI||(t.GI=[]);var u,e=t.GI[f];switch((e=e||(t.GI[f]=new A(t,this,i,n))).oldValue=i,e.newValue=n,t.wM){case 0:u=p.Add;break;case 1:u=p.Remove;break;default:u=p.Property}e.changeType=u,s.BM(e),r.isInUpdateProcess()&&(a&T.Persistent)==T.Persistent&&r.addUpdateCandidate(t)}}}}},this.remove=function(t){t=t.$I;t&&(t[f]=void 0)}}k.prototype.toString=function(){return"Name: "+this.getName()+" Index: "+this.getIndex()};var x,C;k.define=function(t,n,i,r,
e,s){if(t&&"function"==typeof t){void 0!==t.__index__&&null!==t.__index__||(t.__index__=O.length);var u=O[t.__index__],o=0;if(u)o=t._I;else{u=[],t._I=0;var h,f=function(t){for(var n=t.__base__;n;){if(0<n._I&&void 0!==n.__index__&&null!==n.__index__)return n;n=n.__base__}return null}(t);if(f&&(h=O[f.__index__]))for(var a in o=f._I,t._I=o,h)u[a]=h[a];O[t.__index__]=u}f=u[n];return f||(f=new k(o,n,t,i,r),u[n]=f,t._I++),e&&(f.VI=e),s&&(f.UI=s),f}b.throwException(y.ArgumentError.id,"Invalid owner")},k.get=function(t,n){for(var i,r=null;t&&void 0===t.__index__;)t=t.__base__;return!t||void 0!==(i=t.__index__)&&(r=O[i]),r&&n?r[n]:r},k.getAllProperties=function(t){for(var n,i=null;t&&void 0===t.__index__;)t=t.__base__;return!t||void 0!==(n=t.__index__)&&(i=O[n]),i};function P(t,n,i){if(t===x&&C)(!i||C instanceof i)&&(n.push(C),J[C.guid]=!0);else if(t&&t.BI&&0<t.BI.length)for(var r=t.BI.length,e=0;e<r;e++){var s=t.BI[e];i&&s instanceof i&&(n.push(s),J[s.guid]=!0),C=t,P(s,n,i)
}else t&&void 0===J[t.guid]&&(!i||t instanceof i)&&(n.push(t),J[t.guid]=!0)}function R(t){if(t&&t.BI&&0<t.BI.length){t.BI.length;var n=t.BI[0];return R(n)}return t}function j(t){var n=t.getOwner();return n?j(n):t}var J={};function D(){s.call(this),this.guid=null}D.prototype.getReferencings=function(){var t=[];return Array.prototype.push.apply(t,this.BI),t},D.prototype.oM=function(t){var n=[];return D.evaluateReferencingRoots(this,n,t),n},D.prototype.HI=function(){return(this.getOwner&&this.getOwner()?j:R)(this)},D.evaluateReferencingRoots=function(t,n,i){!t||!t.BI||t.BI.length<1||(C=null,J={},P(x=t,n,i),C=x=null)},D.prototype.remove=function(){this.BI=null},s.inheritedBy(D);var L={None:0,Features:1,SheetElements:2,Overlays:4,Viewport:8,Sheet:7,Overview:16,AllElements:32,ExportStart:64,ExportEnd:128};function q(){this.viewport=null,this.updateFlags=L.None,this.lodType=void 0,this.dirtyRect=null,this.isAnimation=!1,this.fitAnimation=!1}function $(){D.call(this),this.session=null}
function B(t,n){d.call(this),this.PM=t,this.RM=n}function F(t){I.call(this),this.session=t,this.p_=!1,this.needsToRedrawSheet=!1,this.needsToRedrawOverlay=!1,this.KI=!1}function U(t){d.call(this),this.renderData=new q}$.prototype.detachSession=function(){this.session=null},$.prototype.attachSession=function(t){this.session=t},$.prototype.isAttached=function(){return null!==this.session},$.prototype.getSession=function(){return this.session||(this.session=this.MI())},$.prototype.MI=function(){var t=v.workSheetSession;if(t)return t;t=v.getSheetSessions();if(1===t.length)return t[0];if(t.length<1)return null;t=this.HI();return t&&t instanceof $?t==this?this.session:t.getSession():null},$.prototype.remove=function(){D.prototype.remove.call(this),this.detachSession()},D.inheritedBy($),B.prototype.kI=function(t){this.PM.ctrlKey||(this.PM.ctrlKey=t.c5.ctrlKey),this.PM.shiftKey||(this.PM.shiftKey=t.c5.shiftKey),this.PM.altKey||(this.PM.altKey=t.c5.altKey)},d.inheritedBy(B),
F.prototype.WI=function(t){if(t){this.jI();var n=this.session.LA();if(n)for(var i=n.length,r=0;r<i;r++)n[r].aM(this),n[r].fM(),n[r].cM()}if(this.ZI&&this.ZI.RI(this),t)for(var e=this.getMessages(),s=this.getMessageCount(),u=0;u<s;u++){var o=e[u],h=o.owner;h&&0===h.wM&&(h.wM=2),this.needsToRedrawOverlay||(this.needsToRedrawOverlay=o.needsToRedrawOverlay()),this.KI||(this.KI=o.needsToRedrawViewport()),o.CI=!1}},F.prototype.qC=function(){var t=L.None;return this.p_&&(t=L.Features),this.needsToRedrawSheet&&(t|=L.SheetElements),this.needsToRedrawOverlay&&(t|=L.Overlays),this.KI&&(t|=L.Viewport),t},F.prototype.reset=function(){for(var t=this.getMessages(),n=this.getMessageCount(),i=0;i<n;i++)t[i].CI=!1},I.inheritedBy(F),d.inheritedBy(U);var V=new function(){this.serialize=function(t){return JSON.stringify(t)},this.deserialize=function(t){return JSON.parse(t)},this.validateSchema=function(t){return!0}},G=0,_="i";function H(){s.call(this),this.guid=(G===Number.MAX_SAFE_INTEGER&&(G=0,_+="i"),
_+ ++G)}H.prototype.getId=function(){return this.guid},s.inheritedBy(H);var K=new function(){this.format=function(){var t=Array.prototype.slice.apply(arguments);t.length<2&&b.throwException(y.ArgumentError.id);var n,i=t[0],r=t.slice(1);for(n in r)i=i.replace("{"+n+"}",r[n]);return i},this.isStringBlank=function(t){return!t||/^\s*$/.test(t)}};t=new function(){this.queueMicroTask=function(t){"undefined"!=typeof Promise?Promise.resolve().then(t).catch(function(t){window.console&&window.console.log(t)}):setTimeout(t,0)}},n={};return n.AppSession=v,n.ChangeType=p,n.List=w,n.Map=h,n.Messenger=function(t){var u=[],e=0,n=0,o=null,h=t;function r(){var t=o;return o&&o.ZI&&((o=o.ZI).zI=null),t}this.NM=!1,this.OM=0,this.QI=null,this.DM=!1,this.register=function(t,n,i){var r=null;null==u[t]?u[t]=r=[]:r=u[t],null!=r&&r.push({messageType:t,recipient:n,handler:i})},this.tN=function(t,n,i){if(null!=u[t]){var r,e=u[t];for(r in e){var s=e[r];if(s.recipient==n&&s.messageType==t&&(!i||i==s.handler)){
e[r]=null,delete e[r];break}}}},this.XI=function(){return 0<e},this.BM=function(t){if(!this.FI()&&t)if(t instanceof A&&null!==o)o.add(t);else{var n=t.getType();if(null!=u[n]){t.kI(h);var i,r,e=u[n];for(r in e){var s=e[r];s.messageType==n&&null!=s.handler&&(i=s.handler(t,s.recipient))}return i}}},this.clear=function(){this.SM(),n=e=0},this.reset=function(){u=[],this.YI(),n=e=0},this.YI=function(){o&&!this.XI()&&(o.reset(),o=null)},this.SM=function(){for(;0<e;){var t=r();t&&(h.isInUpdateProcess()&&(h.setInUpdateProcess(!1),h.update()),e--,t.WI(0===e)),0===e&&(this.BM(o),this.YI(),h.clearUpdateList())}},this.dx=function(){var t,n;null===this.QI&&(t=this,n=h.getPerformanceCounter(),this.QI=window.setTimeout(function(){n.getWorkerTaskStartCb()&&n.getWorkerTaskStartCb()(),t.SM(),n.getWorkerTaskFinishCb()&&n.getWorkerTaskFinishCb()()},this.OM))},this.t6=function(){this.QI&&(window.clearTimeout(this.QI),this.QI=null)},this.beginTransaction=function(t){if(!this.FI()){if(m.isSubTypeOf(t,I
)||b.throwException(y.ArgumentError.id,"messageType should be derived from CompositeMessage"),0===e){this.YI();var n=h.LA();if(n)for(var i=n.length,r=0;r<i;r++)n[r].clear();h.clearUpdateList(),this.t6()}t=new t(h);e++,t=t,o&&((t.ZI=o).zI=t),o=t}},this.endTransaction=function(){if(!this.FI()){if(this.DM)return this.SM(),void(this.DM=!1);var t,n,i;this.NM?this.dx():((t=r())&&((n=h.isInUpdateProcess())&&(h.setInUpdateProcess(!1),h.update(),h.setInUpdateProcess(!0)),(i=0===--e)&&n&&(h.setInUpdateProcess(!1),n=!1),t.WI(i)),0===e&&(n&&h.setInUpdateProcess(!1),this.BM(o),this.YI(),h.clearUpdateList()))}},this.FI=function(){return 0<n},this.beginSuspension=function(){n++},this.endSuspension=function(){n--}},n.PriorityQueue=N,n.Property=k,n.PropertyFlags=T,n.ReferenceObject=D,n.RenderData=q,n.RenderUpdateFlags=L,n.SessionAwareObject=$,n.Event=o,n.EventArgs=u,n.DebugFlags=g,n.MicroTaskHelper=t,n.messages={},n.messages.CompositeMessage=I,n.messages.EventMessage=B,n.messages.ListChangedMessage=E,
n.messages.Message=d,n.messages.ModelChangeMessage=F,n.messages.PropertyChangedMessage=A,n.messages.RedrawMessage=U,n.common={},n.common.ArrayHelper=f,n.common.ExceptionHelper=b,n.common.ExceptionTypes=y,n.common.JsonUtility=V,n.common.ObjectBase=s,n.common.IdentifiableObject=H,n.common.ObjectHelper=m,n.common.StringHelper=K,n},"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):((t=t||self).diagramfoundation=t.diagramfoundation||{},t.diagramfoundation.core=n());