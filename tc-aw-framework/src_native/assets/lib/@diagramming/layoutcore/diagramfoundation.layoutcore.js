// @<COPYRIGHT>@
// ==================================================
// Copyright Siemens 2020.
// PL Diagram Foundation 1973.0.1-0
// ==================================================
// @<COPYRIGHT>@
var t,n;t=this,n=function(n,t){"use strict";function l(i,t){n.ValidSettingCalculator.apply(this,arguments)}function h(i,t){n.SimpleHVPathsAlgorithm.call(this,t,t.reportError),this.changeStateObj=t,this.initParams(i)}function w(i,t,s,r,h,o,e,n){if(this.type=i,this.reportError=n,this.nodeSide=t,this.rank=s,this.changeNode=r,this.changePort=h,this.il=e,this.tl(),this.attachmentList=[],h&&h.sl===r&&h.rl&&h.rl.push(this),"attachment"===i){h.Hu=this,h.sl===this.changeNode&&(h.hl=this);for(var l=o.length,a=0;a<l;++a)this.addConnection(o[a])}}function g(i,t,s,r,h,o,e,n){w.call(this,i,t,s,r,h,o,e,n),this.ol=!0}n=n&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n,(t=t&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t).common.ObjectHelper.inherit(l,n.ValidSettingCalculator),h.prototype.initParams=function(i){var t=new l(i),i=i.edgeDist;this.setEdgeDist(i.x,i.y);i=t.el();this.setEdgeToNodeDist(i.x,i.y);t=t.nl();this.setMinRunOut(t.x,t.y),this.setValidConfigMode("origin")
,this.ll()},h.prototype.$t=function(i,t,s,r,h,o){return n.SimpleHVPathsAlgorithm.prototype.findPath.call(this,t,s,0,h,o,0)},h.prototype.oi=function(i,t,s){return this.al(this.nList,this.reportError).oi(i,t,s)},h.prototype.hi=function(i,t){return this.al(this.nList,this.reportError).hi(i,t)},h.prototype.ui=function(i,t,s,r,h){return this.al(this.nList,this.reportError).ui(i,t,s,r,h)},h.prototype.dl=function(i,t,s,r,h){return this.al(this.nList,this.reportError).dl(i,t,s,r,h)},h.prototype.fl=function(i,t,s,r,h){return this.al(this.nList,this.reportError).fl(i,t,s,r,h)},h.prototype.ul=function(i,t,s,r,h){return this.al(this.nList,this.reportError).ul(i,t,s,r,h)},h.prototype.cl=function(i,t,s,r,h,o){return this.al(this.nList,this.reportError).cl(i,t,s,r,h,o)},h.prototype.wl=function(i,t,s){return this.al(this.nList,this.reportError).wl(i,t,s)},t.common.ObjectHelper.inherit(h,n.SimpleHVPathsAlgorithm),w.prototype.tl=function(){var i=this.changeNode,t=this.nodeSide,s=this.rank,
t=i.gluePointLists[t];this.gl(t,s),t[s]=this},w.prototype.vl=function(){var i=this.changeNode,t=this.nodeSide,s=this.rank;i.gluePointLists[t][s]=null},w.prototype.bl=function(){var i,t=this.changePort;t&&(t.Hu===this&&(t.Hu=null),t.hl===this&&(t.hl=null),!(i=t.rl)||0<=(t=i.indexOf(this))&&i.splice(t,1))},w.prototype.addConnection=function(i){var t,s;i&&(t=this.changePort,s=i.mi,s=t===i.pi?"last":t===s?"first":"crossover",this.attachmentList.push({changeCon:i,pathSide:s}))},w.prototype.removeConnection=function(i){if(i)for(var t=this.attachmentList,s=t.length,r=0;r<s;++r)if(t[r].changeCon===i){t.splice(r,1);break}},w.prototype.pl=function(){this.vl(),this.bl()},w.prototype.gl=function(i,t){var s,r;i[t]&&(this.gl(i,s=t+1),i[(r=i[t]).rank=s]=r,i[t]=null)},w.prototype.getPoint=function(){var i=this.changeNode,t=this.il.x,s=this.il.y,r=i.x,h=i.y,o=this.rank;switch(this.nodeSide){case"bottom":r+=o*t,h+=i.h;break;case"left":h+=o*s;break;case"right":r+=i.w,h+=o*s;break;case"top":r+=o*t}return{
x:r,y:h}},w.prototype.No=function(){return this.getPoint()},w.prototype.ml=function(i){this.vl();var t=this.changeNode,s=this.nodeSide,r=this.il.x,h=this.il.y,h="top"===s||"bottom"===s?Math.round((i.x-t.x)/r):Math.round((i.y-t.y)/h);this.rank=h,this.tl()},w.prototype.kl=function(i,t,s){var r=i.x,h=i.y;switch(s){case"left":r=t.x;break;case"right":r=t.x+t.w;break;case"bottom":h=t.y+t.h;break;case"top":h=t.y;break;default:this.reportError("Invalid node side: "+s),h=t.y+t.h}return{x:r,y:h}},t.common.ObjectHelper.inherit(g,w),g.prototype.getPoint=function(){return this.yl(this.changePort)},g.prototype.tl=function(){var i=this.changeNode,t=this.nodeSide,s=this.rank,i=i.gluePointLists[t],t=i[s];t&&(t.changePort.cn||t.changePort.Xu)&&this.reportError("The gp is used by float port."),i[s]=this},g.prototype.pl=function(){var i=this.changeNode,t=this.nodeSide,s=this.rank;w.prototype.pl.apply(this,arguments),this.xl(i,t,s)},g.prototype.xl=function(i,t,s){var r=this.Ml(i,t,s);r&&((
t=i.gluePointLists[t])[s]&&this.reportError("The rank is not empty on node."),t[s]=r)},g.prototype.No=function(){var i=this.getPoint(),t=this.changeNode,s=this.nodeSide;return i=this.kl(i,t,s)},g.prototype.yl=function(i){var t=i.ti,s=t.x,r=t.y,h=t.w,o=t.h,t=i.pos,i=i.userLoc;return i?(s=s+h*i.perX+i.absX,r=r+o*i.perY+i.absY):(s+=h*t.relx,r+=o*t.rely),{x:s,y:r}},g.prototype.Ol=function(i,t,s){var r=i.rl;if(r.length<1)return null;for(var h=0,o=r.length;h<o;++h){var e=r[h];if(e.rank===s&&e.nodeSide===t)return e}return null},g.prototype.Ml=function(i,t,s){for(var r=null,h=i.Rl,o=0,e=h.length;o<e&&!(r=this.Ol(h[o],t,s));++o);return r};var a={ShortestPath:0,FloatSide:1,FixedSide:2,FollowLayoutDirection:3,FollowOptimalConnectionDistance:4},k={TopToBottom:0,LeftToRight:1,BottomToTop:2,RightToLeft:3};function v(i,t,s){n.GluePointHelper.call(this,t,t.hostInterfaceObj.reportError),this.layoutSessionData=i,this.changeStateObj=t,this.hostInterfaceObj=t.hostInterfaceObj,
this.reportError=this.hostInterfaceObj.reportError,this.li=s,this.ci=new h(this.layoutSessionData,this.changeStateObj),this.il=this.layoutSessionData.edgeDist,this.zo=this.layoutSessionData.zo,this.lt=k.TopToBottom,this.ct=k.LeftToRight,this.wt=k.BottomToTop,this.pt=k.RightToLeft}function o(i,t,s){this.changeStateObj=t,this.li=s,this.hostInterfaceObj=t.hostInterfaceObj,this.reportError=this.hostInterfaceObj.reportError,this.layoutSessionData=i,this.ci=new h(this.layoutSessionData,this.changeStateObj),this.Au=new v(this.layoutSessionData,t,s),this.il=this.layoutSessionData.edgeDist,this.zo=this.layoutSessionData.zo,this.lt=k.TopToBottom,this.ct=k.LeftToRight,this.wt=k.BottomToTop,this.pt=k.RightToLeft}function d(i){n.AStarPathPlanningAlgorithm.call(this,null,i)}function i(i,t,s){this.changeStateObj=t,this.hostInterfaceObj=t.hostInterfaceObj,this.reportError=t.reportError,this.so=s,this.nodeDist=i.nodeDist,this.lt=k.TopToBottom,this.ct=k.LeftToRight,this.wt=k.BottomToTop,
this.pt=k.RightToLeft}v.prototype.Sl=function(i,t,s){var r={x:0,y:0};return"top"===t||"bottom"===t?(r.x=i.x+s*this.il.x,r.y=i.y,"bottom"===t&&(r.y+=i.h)):(r.x=i.x,r.y=i.y+s*this.il.y,"right"===t&&(r.x+=i.w)),r},v.prototype.Ll=function(i,t,s){i="top"===t||"bottom"===t?Math.round((s.x-i.x)/this.il.x):Math.round((s.y-i.y)/this.il.y);return i},v.prototype.Hl=function(i){return!!i&&null!==i.changePort},v.prototype.Tl=function(i){for(var t,s=this.changeStateObj.cList,r=s.length,h=0;h<r;++h){if((t=s[h]).mi===i)return!0;if(t.pi===i)return!0}return!1},v.prototype.Cl=function(i,t,s,r,h,o){var e=s.gluePointLists[t],n=e[i],l=1;if(this.Hl(n))l=this.Vl(e,i+1);else if((l=this.Dl(e,i,h,s,t,o))<1){for(var a=1-l,d=0;d<a&&"label"===r[d];++d)r[d]="skip";l=1}return l},v.prototype.Vl=function(i,t){for(var s,r=i.length,h=t;h<r;++h)if(s=i[h],!1===this.Hl(s))return h;return r},v.prototype.Dl=function(i,t,s,r,h,o){for(var e,n=s,l=t;0<n;)if(--n,e=i[--l],this.Hl(e))return l+1;return l},v.prototype.Nl=function(i,t
){this.changeStateObj;for(var s,r,h,o,e,n=null,l=-1,a=["bottom","right","left","top"],d=0,f=a.length;d<f;++d){var u=a[d],c=this.Bl(i,t,u);if(0<c){n=u,l=c;break}}return l<1&&i.gluePointLists&&(s=i.gluePointLists,r=this.Al(s.top),h=this.Al(s.left),o=this.Al(s.bottom),e=this.Al(s.right),n=Math.max(r,o)+1<=Math.max(h,e)+1?(l=this.Vl(s.bottom,o+1),"bottom"):(l=this.Vl(s.right,e+1),"right"),l<1&&(l=1)),{nodeSide:n,rank:l}},v.prototype.Bl=function(i,t,s){if(!i.gluePointLists)return-1;for(var r=this.ql(t,s),h=this.Gl(i,s)-r.displayLength+1,o=1;o<=h;++o)if(this.Pl(i,s,o,r,null))return o;return-1},v.prototype.Il=function(i,t,s){for(var r,h=i.length-1,o=Math.min(h,t+s-1),e=t;e<=o;++e)if(r=i[e],this.Hl(r))return!1;return!0},v.prototype.Ul=function(i,t,s,r,h,o,e,n,l){var a=s.Hu,d=o.Hu;if(a&&d)return{rank1:a.rank,rank2:d.rank};var f,u,c=this.ql(s,r),w=this.ql(o,e),g=(c.typeList.length,w.typeList.length,this.Gl(t,r),this.Gl(h,e),n),v=l,b=(t.gluePointLists[r],h.gluePointLists[e],this.il.x),p=this.il.y
,m={x:0,y:0},k={x:0,y:0},n={top:"up",bottom:"down",left:"left",right:"right"},l={left:"right",right:"left",down:"up",up:"down",none:"none"},y=n[r],x=n[e];if(a){if(a.nodeSide!==r)return null;m=a.getPoint(),y=n[a.nodeSide]}if(d){if(d.nodeSide!==e)return null;k=d.getPoint(),x=n[d.nodeSide]}i.Wu&&(i.Zu?y=l[y]:x=l[x]);var M,O,i={top:t.y,bottom:t.y+t.h,left:t.x,right:t.x+t.w},l={top:h.y,bottom:h.y+h.h,left:h.x,right:h.x+h.w};"top"===r||"bottom"===r?(m.y=i[r],k.y=l[e],M=b,O="x",a&&(v=g=m.x),d&&(v=g=k.x)):(m.x=i[r],k.x=l[e],M=p,O="y",a&&(v=g=m.y),d&&(v=g=k.y));var R,S,L=g+Math.floor(Math.round((v-g)/M)/2)*M,H=-1,T=0,C=this.ci;this.changeStateObj.jl(t,h);for(var V=g;V<=v&&(S=L+H*T,H<1&&(T+=M),H*=-1,!a&&(m[O]=S,f=this.Ll(t,r,m),!1===this.Pl(t,r,f,c,null))||!d&&(k[O]=S,u=this.Ll(h,e,k),!1===this.Pl(h,e,u,w,null))||!(R=C.$t(s,m,y,o,k,x)));V+=b);return R?{rank1:f,rank2:u}:null},v.prototype.Pl=function(i,t,s,r,h){if(h){var o=this.Sl(i,t,s);if(this.changeStateObj.El(o,h))return!1}
var e=i.gluePointLists[t];if(e[s])return!1;if("top"===t||"bottom"===t){if(i.w-(s*this.il.x+r.changePort.w/2)<this.zo.w/2)return!1;if(s*this.il.x-r.changePort.w/2<this.zo.w/2)return!1}else{if(i.h-(s*this.il.y+r.changePort.h/2)<this.zo.h/2)return!1;if(s*this.il.y-r.changePort.h/2<this.zo.h/2)return!1}r.typeList;var n,h=s-r.attachmentInx,l=h+r.typeList.length-1,t=this.Gl(i,t);if(h<1){if("leading"!==r.labelPosition)return!1;if(n=Math.abs(h)+1,r.labelLength<n)return!1;h=1}if(t<l){if("trailing"!==r.labelPosition)return!1;if(r.labelLength<(n=l-t))return!1;l=t}for(s=h;s<=l;++s)if(e[s])return!1;return!0},v.prototype.ql=function(i,t){var s,r,h,o,e,n,l,a,d,f=this.il.x,u=this.il.y,c=i.Ve;null===c?c={x:0,y:0,w:0,h:0}:(s=i.Ue,(Math.abs(s.x)>c.h||Math.abs(s.y)>c.h)&&(c={x:0,y:0,w:0,h:0}));var u="top"===t||"bottom"===t?(r=Math.ceil(i.w/f),h=Math.ceil(c.w/f),o="portDisplay",e="label",n=Math.floor(r/2),l=h,a=r,"trailing"):(r=Math.ceil(c.h/u),h=Math.ceil(i.h/u),o="label",e="portDisplay",n=Math.floor(h/2
)+r,l=r,a=h,"leading"),w=[];if(i.ignore)return w.push("attachment"),{typeList:w,attachmentInx:0,displayLength:1,changePort:i};for(d=0;d<r;++d)w.push(o);for(d=0;d<h;++d)w.push(e);return w[n]="attachment",{typeList:w,attachmentInx:n,labelLength:l,displayLength:a=a<1?1:a,labelPosition:u,changePort:i}},v.prototype.Fl=function(i,t,s,r){var h,o=this.il,e=this.Gl(t,s)+1,n=null,l=null;l="top"===s||"bottom"===s?(h=o.x,n=Math.ceil((i.x-t.x)/h),Math.ceil((i.x+i.w-t.x)/h)):(h=o.y,n=Math.ceil((i.y-t.y)/h),Math.ceil((i.y+i.h-t.y)/h));for(var a=[],d=n;d<=l;++d)d<0||e<d||a.push(d);a.length<1&&(e<n&&a.push(e),l<0&&a.push(0)),a.length<1&&this.reportError("The display rank list is empty.");for(var n=Math.floor(a.length/2),f=[],d=0,u=a.length;d<u;++d)f.push("portDisplay");f[n]="attachment";for(var c=[],d=0,u=a.length;d<u;++d)c.push(s);return r?{displayRanks:[a[n]],nodeSideList:[c[n]],attachmentInx:0,typeList:[f[n]]}:{displayRanks:a,nodeSideList:c,attachmentInx:n,typeList:f}},v.prototype.zl=function(i){
var t=this.layoutSessionData.Ft,s="bottom";t!==this.ct&&t!==this.pt||(s="right");var r=this.Xl(i),t=r.outPorts,r=r.inPorts,t=this.io(t,s),r=this.io(r,s),r=Math.max(t,r);this.no(i,s,r)},v.prototype.Xl=function(i){for(var t=[],s=[],r=[],h=this.changeStateObj.Ii(i),o=0,e=h.length;o<e;++o){var n,l,a=h[o];a.Qu||(n=a.mi,l=a.pi,n.ignore||l.ignore||(a.bi===i?0<=r.indexOf(n)||(t.push(n),r.push(n)):0<=r.indexOf(l)||(s.push(l),r.push(l))))}return{outPorts:t,inPorts:s}},v.prototype.io=function(i,t){for(var s=0,r=0,h=i.length;r<h;++r)s+=this.ql(i[r],t).typeList.length;return s},v.prototype.no=function(i,t,s){var r="x",h="w";"left"!==t&&"right"!==t||(r="y",h="h");var o,e=this.il[r]*(s+1);i[h]<e&&(o=i.x,t=i.y,r=i.w,s=i.h,"w"===h?r=e:s=e,this.li.Yl(i,o,t,r,s,"any"),this.changeStateObj._l(i,"sideOffset"))},v.prototype.Wl=function(i){var t=i.gluePointLists,s=this.il.x,r=this.il.y,h=i.x,o=i.y,e=i.w,n=i.h,l=this.Al(t.top,!0),a=this.Al(t.left,!0),d=this.Al(t.bottom,!0),f=this.Al(t.right,!0),u=!1,c=s*(
Math.max(l,d)+1),w=r*(Math.max(a,f)+1);e<c&&(e=c,u=!0),n<w&&(n=w,u=!0);d=Math.max(this.Zl(t.top,l,h,o,"x"),this.Zl(t.bottom,d,h,o,"x")),a=Math.max(this.Zl(t.left,a,h,o,"y"),this.Zl(t.right,f,h,o,"y")),t=this.zo.w/2,f=this.zo.h/2,d=h+e-d;d<t&&(e+=s*Math.ceil((t-d)/s),u=!0),(d=o+n-a)<f&&(n+=r*Math.ceil((f-d)/r),u=!0),i.Qh&&(d=this.Jl(i,e,n),0<(d=this.Kl(i)-d)&&(e+=(d=Math.ceil(d/2))*s,n+=d*r,u=!0)),u&&(this.li.Yl(i,h,o,e,n,"any"),this.changeStateObj._l(i,"sideOffset"))},v.prototype.Zl=function(i,t,s,r,h){r="x"===h?s:r;if(t<1)return r;if(i.length<t)return r;i=i[t];if(!i)return r;t=i.changePort;if(!t)return r;if(!(i=t.Hu))return r;if(t.ignore)return r;i=i.getPoint();return r="x"===h?i.x+t.w/2:i.y+t.h/2},v.prototype.Al=function(i,t){var s=i.length;if(s<1)return 0;for(var r,h,o=0,e=1;e<s;++e)(h=i[e])&&"label"!==h.type&&((r=h.changePort)&&r.ignore||t&&h.ol||o<e&&(o=e));return o},v.prototype.Gl=function(i,t){i="top"===t||"bottom"===t?Math.floor(i.w/this.il.x)-1:Math.floor(i.h/this.il.y)-1
;return i},v.prototype.Kl=function(i){if(!i.Qh)return 0;for(var t,s=this.changeStateObj,r=s.cList,h=r.length,o=0,e=0;e<h;++e)(t=r[e]).ignore||s.Ke(t,i)&&++o;return o},v.prototype.Jl=function(i,t,s){var r,h,o=this.changeStateObj,e=i.gluePointLists,n=!1;i.Qh&&(r=i.titleKeepOutArea,h={x:i.x,y:i.y,w:r.w,h:r.h},n=!0);for(var l,t=Math.round(t/this.il.x)-1,s=Math.round(s/this.il.y)-1,a=["top","bottom","left","right"],d=[t,t,s,s],f=a.length,u=0,c=0;c<f;++c)for(var w,g=d[c],v=e[w=a[c]],b=1;b<=g;++b)v[b]||(n?(l=this.Sl(i,w,b),o.El(l,h)||++u):++u);return u},v.prototype.Ql=function(i,t,s){var r,h={node:i,pnt:null,nodeSide:"?"},o=i.x,e=i.y,n=o+i.w,l=e+i.h,a={x:o,y:e},i=this.$l(t,s,a,r={x:n,y:e});return null!==i?(h.pnt=i,h.nodeSide="top",h):null!==(i=this.$l(t,s,a,r={x:o,y:l}))?(h.pnt=i,h.nodeSide="left",h):null!==(i=this.$l(t,s,a={x:n,y:l},r))?(h.pnt=i,h.nodeSide="bottom",h):null!==(i=this.$l(t,s,a,r={x:n,y:e}))?(h.pnt=i,h.nodeSide="right",h):null},v.prototype.$l=function(i,t,s,r){var h=(r.y-s.y)*(
t.x-i.x)-(r.x-s.x)*(t.y-i.y);if(Math.abs(h)<1e-7)return null;r=((r.x-s.x)*(i.y-s.y)-(r.y-s.y)*(i.x-s.x))/h,h=((t.x-i.x)*(i.y-s.y)-(t.y-i.y)*(i.x-s.x))/h;if(r<0||1<r)return null;if(h<0||1<h)return null;h=r*(t.x-i.x),t=r*(t.y-i.y),i={x:i.x,y:i.y};return i.x+=h,i.y+=t,i},v.prototype.zu=function(i,t){var s=null;switch(t){case a.FollowOptimalConnectionDistance:case a.ShortestPath:s=this.Ba(i);break;case a.FloatSide:case a.FixedSide:s=this.Ea(i);break;default:this.reportError("Un-supported port arrangement option: "+t),s=this.Ba(i)}return s},v.prototype.Ea=function(i){var t=[],s=this.layoutSessionData.Ft,r=this.Xa(i);r.sort(function(i,t){return t.connList.length-i.connList.length});for(var h=0,o=r.length;h<o;++h)var e=r[h].connList,e=this.Ya(e,s),t=t.concat(e);return t},v.prototype.Xa=function(i){for(var t=[],s=0,r=i.length;s<r;++s){for(var h=i[s],o=h.bi,e=null,n=0,l=t.length;n<l;++n){var a=t[n];if(a.node===o){e=a;break}}e||t.push(e={node:o,connList:[]}),e.connList.push(h)}return t},
v.prototype.Ya=function(i,t){for(var s=[],r=[],h=0,o=i.length;h<o;++h){var e=i[h],n=this._a(e,t),l=n.weight;n.quad<0?r.push(e):s.push({w:l,c:e})}s.sort(function(i,t){return i.w-t.w});for(var a=[],h=0,o=s.length;h<o;++h)a.push(s[h].c);for(h=0,o=r.length;h<o;++h)a.push(r[h]);return a},v.prototype._a=function(i,t){var s=-1,r=-1,h=i.bi,i=i.yi,o=i.x+i.w/2-(h.x+h.w/2),e=i.y+i.h/2-(h.y+h.h/2);switch(t){case this.ct:o<0&&e<=0?(s=Math.abs(e/o),r=0):0<=o&&e<0?(s=Math.abs(o/e),r=1):0<=o&&0<e?(s=Math.abs(o/e),r=3):o<0&&0<=e&&(s=Math.abs(e/o),r=2);break;case this.pt:o<=0&&e<0?(s=Math.abs(o/e),r=1):0<o&&e<=0?(s=Math.abs(e/o),r=0):0<o&&0<=e?(s=Math.abs(e/o),r=2):o<=0&&0<e&&(s=Math.abs(o/e),r=3);break;case this.lt:o<=0&&e<0?(s=Math.abs(o/e),r=0):0<=o&&e<0?(s=Math.abs(o/e),r=2):0<o&&0<=e?(s=Math.abs(e/o),r=3):o<0&&0<=e&&(s=Math.abs(e/o),r=1);break;case this.wt:o<0&&e<=0?(s=Math.abs(e/o),r=1):0<o&&e<=0?(s=Math.abs(e/o),r=3):0<=o&&0<e?(s=Math.abs(o/e),r=2):o<=0&&0<e&&(s=Math.abs(o/e),r=0);break;default:
this.reportError("Unknown layout direction: ")}return{weight:s,quad:r}},v.prototype.Wa=function(i){for(var t=[],s=this.changeStateObj.Ii(i),r=s.length,h=0;h<r;++h)this.Za(s[h],t);return t},v.prototype.Ja=function(i,t){var s=this.il.x,r=this.il.y,h=i.x+s,o=i.y+r,e=h+i.w-2*s,n=o+i.h-2*r,l=t.x+s,i=t.y+r,s=l+t.w-2*s,t=i+t.h-2*r,r={xOverlap:!1,xMin:0,xMax:0,yOverlap:!1,yMin:0,yMax:0},l=Math.max(h,l),s=Math.min(e,s);return l<=s&&(r.xOverlap=!0,r.xMin=l,r.xMax=s),(l=Math.max(o,i))<=(s=Math.min(n,t))&&(r.yOverlap=!0,r.yMin=l,r.yMax=s),r},t.common.ObjectHelper.inherit(v,n.GluePointHelper),o.prototype.Iu=function(i){var t,s=this.Au,r=this.changeStateObj.nList,h=r.length;if(this.layoutSessionData.du&&this.Ka(),"fixed"!==i){for(var o,e=0;e<h;++e)if(!(t=r[e]).ignore)for(var n,l=(n=t.ki).length,a=0;a<l;++a)(o=n[a]).Hu||!1===s.Tl(o)&&this.mf(o);for(e=0;e<h;++e)(t=r[e]).ignore||this.Qa(t)}else for(var e=0;e<h;++e)(t=r[e]).ignore||this.$a(t)},o.prototype.$a=function(i){for(var t,s=i.ki,r=s.length,
h=0;h<r;++h)(t=s[h]).Hu||this.Nf(t)},o.prototype.Ka=function(){for(var i=this.changeStateObj.nList,t=0,s=i.length;t<s;++t){var r=i[t];r.ignore||this.id(r)}},o.prototype.id=function(i){for(var t=i.ki,s=0,r=t.length;s<r;++s){var h=t[s];h.Hu||h.isUserLoc&&this.td(h)}},o.prototype.td=function(i){var t,s,r;i.Hu&&this.reportError("The port may have been assigned with some glue point."),i.Xu||(t=i.sl,s=(r=this.Au.Ru(i,t)).nodeSide,r=r.isInsideNode,this.sd(i,t,s,r))},o.prototype.sd=function(i,t,s,r){var h=i.Hu;if(h)return h;var o=this.il,e=this.changeStateObj._i(i),r=this.Au.Fl(i,t,s,r),n=r.displayRanks,l=r.nodeSideList,a=r.attachmentInx,d=r.typeList;this.rd(t,n,l);for(var f=0,u=n.length;f<u;++f){var c=d[f],w=n[f],w=new g(c,l[f],w,t,i,e,o,this.reportError);f===a&&(h=w)}return h||this.reportError("The attachment glue point is null"),h},o.prototype.rd=function(i,t,s){for(var r=i.gluePointLists,h=0,o=t.length;h<o;++h){var e=t[h],e=r[s[h]][e];e&&((e=e.changePort).cn?this.yf(e,!0
):e.isUserLoc?e.Xu&&this.yf(e,!1):this.reportError("Unknown status"))}},o.prototype.jf=function(i){for(var t=[],s=0,r=i.length;s<r;++s){var h=i[s];h.ignore||this.hd(h)&&(l=h.mi,a=h.pi,this.qf(l),this.qf(a),t.push(h))}var o=this.changeStateObj,e=o.cList,n=o.Qe;if(i.length<e.length)for(s=0,r=e.length;s<r;++s){var l,a,d=e[s];d.ignore||(l=d.mi,a=d.pi,l.Hu&&a.Hu||t.indexOf(d)<0&&(t.push(d),n&&n.ye.push(d)))}this.ua(t)},o.prototype.Qa=function(i){for(var t,s=this.changeStateObj,r=this.Au,h=i.ki,o=h.length,e=0;e<o;++e)(t=h[e]).ignore||t.Hu||!1===r.Tl(t)&&this.Nf(t);i=s.Ii(i);this.ua(i)},o.prototype.od=function(i){var t=this.Au,s=i.bi,r=i.yi,h=s.$n,o=r.$n,e=i.mi,n=i.pi,e=e.Hu,n=n.Hu,l=[];if(l.push(e),h===o)return l.push(n),l;var a=this.changeStateObj.ed(s,r),d=i.Bi;if(!d)return l.push(n),l;for(var f,u=d[0],c=d[1],w=d.length-2,g=0,v=[],b=[];h!==a;)if(null===(f=t.Ql(h,u,c))){if(w<++g)return this.reportError("GluePointUtils: no source side intersection found for a group crossover point"),null
;u=d[g],c=d[g+1]}else v.push(f),h=h.$n;for(u=d[(g=w)+1],c=d[g];o!==a;)if(null===(f=t.Ql(o,u,c))){if(--g<0)return this.reportError("GluePointUtils: no target side intersection found for a group crossover point"),null;u=d[g+1],c=d[g]}else b.push(f),o=o.$n;var p,m,k=v.length-1;for(i.Wu&&!1===i.Zu&&--k,m=0;m<=k;++m)f=v[m],p=this.nd(f.node,f.nodeSide,f.pnt,i),l.push(p);for(k=b.length-1,i.Wu&&i.Zu&&--k,m=k;0<=m;--m)f=b[m],p=this.nd(f.node,f.nodeSide,f.pnt,i),l.push(p);return l},o.prototype.kf=function(i){i.isUserLoc?this.td(i):this.Nf(i)},o.prototype.Nf=function(i){var t,s,r,h=i.ti,o=i.x,e=i.y,n=i.w,l=i.h,a=o+n/2,d=e+l/2,f=h.x,u=h.y,o=h.w,e=h.h,o=this.changeStateObj.hn(a,d,f,u,o,e),e=this.Au.Gl(h,o);"top"===o||"bottom"===o?(s=this.il.x,(t=Math.round((a-f)/s))<(r=Math.ceil(n/s))&&(t=r)):(s=this.il.y,(t=Math.round((d-u)/s))<(r=Math.ceil(l/s))&&(t=r)),t<1?t=1:e<t&&(t=e),this.ld(o,t,h,i)},o.prototype.mf=function(i){var t=this.Au,s=i.ti;this.Au.Wl(s);var r=t.Nl(s,i),h=r.nodeSide,r=r.rank,t=t.Gl(s
,h);r<1?r=1:t<r&&(r=t),this.ld(h,r,s,i)},o.prototype.ua=function(i){var t=this.ad();if(t===a.FixedSide)for(var s=0,r=i.length;s<r;++s){var h=i[s];this.Au.zl(h.bi),this.Au.zl(h.yi)}for(var o=this.Au.zu(i,t),s=0,r=o.length;s<r;++s){var e=(h=o[s]).mi,n=h.pi;e.Hu&&n.Hu||this.dd(h)}for(s=0,r=o.length;s<r;++s){e=(h=o[s]).mi,n=h.pi;e.Hu&&n.Hu||this.fd(h,!0)}},o.prototype.fd=function(i,t){var s;i.Qu?this.ud(i,[{side1:"bottom",side2:"right",dir1:"hi2low",dir2:"hi2low",goal:"first"},{side1:"bottom",side2:"left",dir1:"low2hi",dir2:"hi2low",goal:"first"},{side1:"top",side2:"right",dir1:"hi2low",dir2:"low2hi",goal:"first"},{side1:"top",side2:"left",dir1:"low2hi",dir2:"low2hi",goal:"first"},{side1:"bottom",side2:"top",dir1:"low2hi",dir2:"low2hi",goal:"first"},{side1:"left",side2:"right",dir1:"low2hi",dir2:"low2hi",goal:"first"}]):this.dd(i)||(i.Wu?(s=this.cd(i),this.ud(i,s)):(s=this.wd(i),this.ud(i,s)))},o.prototype.wd=function(i){var t,s=i.bi,i=i.yi,r=this.gd(s,i),h=this.ad();switch(h){
case a.FollowOptimalConnectionDistance:case a.ShortestPath:t=this.vd(r);break;case a.FloatSide:t=this.bd(r);break;case a.FixedSide:t=this.pd(r);break;default:this.reportError("Un-supported port arrangement option: "+h),t=this.vd(r)}return t},o.prototype.vd=function(i){var t=[{side1:"bottom",side2:"top",dir1:"low2hi",dir2:"low2hi",goal:"first"}];switch(i){case"topLeft":t=[{side1:"right",side2:"top",dir1:"hi2low",dir2:"low2hi",goal:"best"},{side1:"bottom",side2:"left",dir1:"hi2low",dir2:"low2hi",goal:"best"},{side1:"right",side2:"left",dir1:"hi2low",dir2:"low2hi",goal:"first"},{side1:"bottom",side2:"top",dir1:"hi2low",dir2:"low2hi",goal:"first"},{side1:"left",side2:"bottom",dir1:"hi2low",dir2:"low2hi",goal:"first"},{side1:"top",side2:"right",dir1:"hi2low",dir2:"low2hi",goal:"first"}];break;case"topRight":t=[{side1:"left",side2:"top",dir1:"hi2low",dir2:"hi2low",goal:"best"},{side1:"bottom",side2:"right",dir1:"low2hi",dir2:"low2hi",goal:"best"},{side1:"left",side2:"right",dir1:"hi2low",
dir2:"low2hi",goal:"first"},{side1:"bottom",side2:"top",dir1:"low2hi",dir2:"hi2low",goal:"first"},{side1:"right",side2:"bottom",dir1:"hi2low",dir2:"hi2low",goal:"first"},{side1:"top",side2:"left",dir1:"low2hi",dir2:"low2hi",goal:"first"}];break;case"topOverlap":t=[{side1:"bottom",side2:"top",dir1:"low2hi",dir2:"low2hi",goal:"best"},{side1:"left",side2:"left",dir1:"hi2low",dir2:"low2hi",goal:"best"},{side1:"right",side2:"right",dir1:"hi2low",dir2:"low2hi",goal:"best"},{side1:"bottom",side2:"left",dir1:"low2hi",dir2:"low2hi",goal:"first"},{side1:"bottom",side2:"right",dir1:"hi2low",dir2:"low2hi",goal:"first"},{side1:"top",side2:"bottom",dir1:"low2hi",dir2:"low2hi",goal:"first"}];break;case"bottomLeft":t=[{side1:"right",side2:"bottom",dir1:"low2hi",dir2:"low2hi",goal:"best"},{side1:"top",side2:"left",dir1:"hi2low",dir2:"hi2low",goal:"best"},{side1:"right",side2:"left",dir1:"low2hi",dir2:"hi2low",goal:"first"},{side1:"top",side2:"bottom",dir1:"hi2low",dir2:"low2hi",goal:"first"},{
side1:"left",side2:"top",dir1:"hi2low",dir2:"low2hi",goal:"first"},{side1:"bottom",side2:"right",dir1:"hi2low",dir2:"hi2low",goal:"first"}];break;case"bottomRight":t=[{side1:"left",side2:"bottom",dir1:"low2hi",dir2:"hi2low",goal:"best"},{side1:"top",side2:"right",dir1:"low2hi",dir2:"hi2low",goal:"best"},{side1:"left",side2:"right",dir1:"low2hi",dir2:"hi2low",goal:"first"},{side1:"top",side2:"bottom",dir1:"low2hi",dir2:"hi2low",goal:"first"},{side1:"right",side2:"top",dir1:"low2hi",dir2:"low2hi",goal:"first"},{side1:"bottom",side2:"left",dir1:"hi2low",dir2:"hi2low",goal:"first"}];break;case"bottomOverlap":t=[{side1:"top",side2:"bottom",dir1:"low2hi",dir2:"low2hi",goal:"best"},{side1:"left",side2:"left",dir1:"low2hi",dir2:"hi2low",goal:"best"},{side1:"right",side2:"right",dir1:"low2hi",dir2:"hi2low",goal:"best"},{side1:"top",side2:"left",dir1:"low2hi",dir2:"hi2low",goal:"first"},{side1:"top",side2:"right",dir1:"hi2low",dir2:"hi2low",goal:"first"},{side1:"bottom",side2:"top",
dir1:"low2hi",dir2:"low2hi",goal:"first"}];break;case"leftOverlap":t=[{side1:"right",side2:"left",dir1:"low2hi",dir2:"low2hi",goal:"best"},{side1:"top",side2:"top",dir1:"hi2low",dir2:"low2hi",goal:"best"},{side1:"bottom",side2:"bottom",dir1:"hi2low",dir2:"low2hi",goal:"best"},{side1:"right",side2:"top",dir1:"low2hi",dir2:"low2hi",goal:"first"},{side1:"right",side2:"bottom",dir1:"hi2low",dir2:"low2hi",goal:"first"},{side1:"left",side2:"right",dir1:"low2hi",dir2:"low2hi",goal:"first"}];break;case"rightOverlap":t=[{side1:"left",side2:"right",dir1:"low2hi",dir2:"low2hi",goal:"best"},{side1:"top",side2:"top",dir1:"low2hi",dir2:"hi2low",goal:"best"},{side1:"bottom",side2:"bottom",dir1:"low2hi",dir2:"hi2low",goal:"best"},{side1:"left",side2:"top",dir1:"low2hi",dir2:"hi2low",goal:"first"},{side1:"left",side2:"bottom",dir1:"hi2low",dir2:"hi2low",goal:"first"},{side1:"right",side2:"left",dir1:"low2hi",dir2:"low2hi",goal:"first"}];break;default:this.reportError(
"AllocateGluePoints: invalid relative node positions")}return t},o.prototype.bd=function(i){var t=[],s=this.layoutSessionData.Ft;switch(s){case this.lt:t=this.md(i);break;case this.wt:t=this.kd(i);break;case this.ct:t=this.yd(i);break;case this.pt:t=this.xd(i);break;default:this.reportError("Un-supported layout direction: "+s),t=this.md(i)}return t},o.prototype.yd=function(i){var t=[{side1:"right",side2:"left",dir1:"low2hi",dir2:"low2hi",goal:"first"}];switch(i){case"topLeft":t=[{side1:"right",side2:"left",dir1:"hi2low",dir2:"low2hi",goal:"best"},{side1:"right",side2:"top",dir1:"hi2low",dir2:"low2hi",goal:"first"},{side1:"right",side2:"bottom",dir1:"hi2low",dir2:"low2hi",goal:"first"},{side1:"right",side2:"right",dir1:"hi2low",dir2:"low2hi",goal:"first"},{side1:"bottom",side2:"left",dir1:"hi2low",dir2:"low2hi",goal:"first"},{side1:"top",side2:"left",dir1:"hi2low",dir2:"low2hi",goal:"first"},{side1:"left",side2:"left",dir1:"hi2low",dir2:"low2hi",goal:"first"}];break;case"topRight":
case"topOverlap":t=[{side1:"right",side2:"left",dir1:"hi2low",dir2:"low2hi",goal:"best"},{side1:"right",side2:"right",dir1:"hi2low",dir2:"low2hi",goal:"first"},{side1:"right",side2:"bottom",dir1:"hi2low",dir2:"hi2low",goal:"first"},{side1:"right",side2:"top",dir1:"hi2low",dir2:"hi2low",goal:"first"},{side1:"left",side2:"left",dir1:"hi2low",dir2:"low2hi",goal:"first"},{side1:"top",side2:"left",dir1:"low2hi",dir2:"low2hi",goal:"first"},{side1:"bottom",side2:"left",dir1:"low2hi",dir2:"low2hi",goal:"first"}];break;case"bottomLeft":t=[{side1:"right",side2:"left",dir1:"low2hi",dir2:"hi2low",goal:"best"},{side1:"right",side2:"bottom",dir1:"low2hi",dir2:"low2hi",goal:"first"},{side1:"right",side2:"top",dir1:"low2hi",dir2:"low2hi",goal:"first"},{side1:"right",side2:"right",dir1:"low2hi",dir2:"hi2low",goal:"first"},{side1:"top",side2:"left",dir1:"hi2low",dir2:"hi2low",goal:"first"},{side1:"bottom",side2:"left",dir1:"hi2low",dir2:"hi2low",goal:"first"},{side1:"left",side2:"left",dir1:"low2hi",
dir2:"hi2low",goal:"first"}];break;case"bottomRight":case"bottomOverlap":t=[{side1:"right",side2:"left",dir1:"low2hi",dir2:"hi2low",goal:"best"},{side1:"right",side2:"right",dir1:"low2hi",dir2:"hi2low",goal:"first"},{side1:"right",side2:"top",dir1:"low2hi",dir2:"hi2low",goal:"first"},{side1:"right",side2:"bottom",dir1:"low2hi",dir2:"hi2low",goal:"first"},{side1:"left",side2:"left",dir1:"low2hi",dir2:"hi2low",goal:"first"},{side1:"bottom",side2:"left",dir1:"low2hi",dir2:"hi2low",goal:"first"},{side1:"top",side2:"left",dir1:"low2hi",dir2:"hi2low",goal:"first"}];break;case"leftOverlap":t=[{side1:"right",side2:"left",dir1:"low2hi",dir2:"low2hi",goal:"best"},{side1:"right",side2:"bottom",dir1:"hi2low",dir2:"low2hi",goal:"first"},{side1:"right",side2:"top",dir1:"low2hi",dir2:"low2hi",goal:"first"},{side1:"right",side2:"right",dir1:"hi2low",dir2:"hi2low",goal:"first"},{side1:"top",side2:"left",dir1:"hi2low",dir2:"hi2low",goal:"first"},{side1:"bottom",side2:"left",dir1:"hi2low",dir2:"hi2low",
goal:"first"},{side1:"left",side2:"left",dir1:"low2hi",dir2:"low2hi",goal:"first"}];break;case"rightOverlap":t=[{side1:"right",side2:"left",dir1:"hi2low",dir2:"hi2low",goal:"best"},{side1:"right",side2:"right",dir1:"low2hi",dir2:"low2hi",goal:"best"},{side1:"right",side2:"top",dir1:"low2hi",dir2:"hi2low",goal:"first"},{side1:"right",side2:"bottom",dir1:"hi2low",dir2:"hi2low",goal:"first"},{side1:"left",side2:"left",dir1:"hi2low",dir2:"hi2low",goal:"first"},{side1:"bottom",side2:"left",dir1:"low2hi",dir2:"hi2low",goal:"first"},{side1:"top",side2:"left",dir1:"low2hi",dir2:"low2hi",goal:"first"}];break;default:this.reportError("AllocateGluePoints: invalid relative node positions")}return t},o.prototype.xd=function(i){var t=[{side1:"left",side2:"right",dir1:"low2hi",dir2:"low2hi",goal:"first"}];switch(i){case"topLeft":t=[{side1:"left",side2:"right",dir1:"hi2low",dir2:"low2hi",goal:"best"},{side1:"left",side2:"left",dir1:"hi2low",dir2:"low2hi",goal:"first"},{side1:"left",side2:"bottom",
dir1:"hi2low",dir2:"low2hi",goal:"first"},{side1:"left",side2:"top",dir1:"hi2low",dir2:"low2hi",goal:"first"},{side1:"right",side2:"right",dir1:"hi2low",dir2:"low2hi",goal:"first"},{side1:"top",side2:"right",dir1:"hi2low",dir2:"low2hi",goal:"first"},{side1:"bottom",side2:"right",dir1:"hi2low",dir2:"low2hi",goal:"first"}];break;case"topRight":t=[{side1:"left",side2:"right",dir1:"hi2low",dir2:"low2hi",goal:"best"},{side1:"left",side2:"top",dir1:"hi2low",dir2:"hi2low",goal:"first"},{side1:"left",side2:"left",dir1:"hi2low",dir2:"low2hi",goal:"first"},{side1:"left",side2:"bottom",dir1:"hi2low",dir2:"hi2low",goal:"first"},{side1:"bottom",side2:"right",dir1:"low2hi",dir2:"low2hi",goal:"first"},{side1:"right",side2:"right",dir1:"hi2low",dir2:"low2hi",goal:"first"},{side1:"top",side2:"right",dir1:"low2hi",dir2:"low2hi",goal:"first"}];break;case"topOverlap":t=[{side1:"left",side2:"right",dir1:"hi2low",dir2:"low2hi",goal:"best"},{side1:"left",side2:"top",dir1:"hi2low",dir2:"low2hi",goal:"first"},
{side1:"left",side2:"left",dir1:"hi2low",dir2:"low2hi",goal:"first"},{side1:"left",side2:"bottom",dir1:"hi2low",dir2:"low2hi",goal:"first"},{side1:"bottom",side2:"right",dir1:"low2hi",dir2:"low2hi",goal:"first"},{side1:"right",side2:"right",dir1:"hi2low",dir2:"low2hi",goal:"first"},{side1:"top",side2:"right",dir1:"low2hi",dir2:"low2hi",goal:"first"}];break;case"bottomLeft":t=[{side1:"left",side2:"right",dir1:"low2hi",dir2:"hi2low",goal:"best"},{side1:"left",side2:"left",dir1:"low2hi",dir2:"hi2low",goal:"first"},{side1:"left",side2:"top",dir1:"low2hi",dir2:"low2hi",goal:"first"},{side1:"left",side2:"bottom",dir1:"low2hi",dir2:"low2hi",goal:"first"},{side1:"right",side2:"right",dir1:"low2hi",dir2:"hi2low",goal:"first"},{side1:"bottom",side2:"right",dir1:"hi2low",dir2:"hi2low",goal:"first"},{side1:"top",side2:"right",dir1:"hi2low",dir2:"low2hi",goal:"first"}];break;case"bottomRight":t=[{side1:"left",side2:"right",dir1:"low2hi",dir2:"hi2low",goal:"best"},{side1:"left",side2:"bottom",
dir1:"low2hi",dir2:"hi2low",goal:"first"},{side1:"left",side2:"left",dir1:"low2hi",dir2:"hi2low",goal:"first"},{side1:"left",side2:"top",dir1:"low2hi",dir2:"hi2low",goal:"first"},{side1:"top",side2:"right",dir1:"low2hi",dir2:"hi2low",goal:"first"},{side1:"right",side2:"right",dir1:"low2hi",dir2:"hi2low",goal:"first"},{side1:"bottom",side2:"right",dir1:"low2hi",dir2:"hi2low",goal:"first"}];break;case"bottomOverlap":t=[{side1:"left",side2:"right",dir1:"low2hi",dir2:"hi2low",goal:"best"},{side1:"left",side2:"bottom",dir1:"low2hi",dir2:"low2hi",goal:"first"},{side1:"left",side2:"left",dir1:"low2hi",dir2:"hi2low",goal:"first"},{side1:"left",side2:"top",dir1:"low2hi",dir2:"low2hi",goal:"first"},{side1:"right",side2:"right",dir1:"low2hi",dir2:"hi2low",goal:"first"},{side1:"top",side2:"right",dir1:"hi2low",dir2:"hi2low",goal:"first"},{side1:"bottom",side2:"right",dir1:"hi2low",dir2:"hi2low",goal:"first"}];break;case"leftOverlap":t=[{side1:"left",side2:"right",dir1:"hi2low",dir2:"hi2low",
goal:"best"},{side1:"left",side2:"left",dir1:"low2hi",dir2:"low2hi",goal:"first"},{side1:"left",side2:"top",dir1:"low2hi",dir2:"low2hi",goal:"first"},{side1:"left",side2:"bottom",dir1:"low2hi",dir2:"low2hi",goal:"first"},{side1:"right",side2:"right",dir1:"low2hi",dir2:"hi2low",goal:"first"},{side1:"bottom",side2:"right",dir1:"hi2low",dir2:"hi2low",goal:"first"},{side1:"top",side2:"right",dir1:"hi2low",dir2:"low2hi",goal:"first"}];break;case"rightOverlap":t=[{side1:"left",side2:"right",dir1:"low2hi",dir2:"low2hi",goal:"best"},{side1:"left",side2:"bottom",dir1:"hi2low",dir2:"hi2low",goal:"first"},{side1:"left",side2:"left",dir1:"hi2low",dir2:"hi2low",goal:"first"},{side1:"left",side2:"top",dir1:"low2hi",dir2:"hi2low",goal:"first"},{side1:"top",side2:"right",dir1:"low2hi",dir2:"low2hi",goal:"first"},{side1:"right",side2:"right",dir1:"low2hi",dir2:"low2hi",goal:"first"},{side1:"bottom",side2:"right",dir1:"low2hi",dir2:"hi2low",goal:"first"}];break;default:this.reportError(
"AllocateGluePoints: invalid relative node positions")}return t},o.prototype.md=function(i){var t=[{side1:"bottom",side2:"top",dir1:"low2hi",dir2:"low2hi",goal:"first"}];switch(i){case"topLeft":t=[{side1:"bottom",side2:"top",dir1:"hi2low",dir2:"low2hi",goal:"best"},{side1:"bottom",side2:"left",dir1:"hi2low",dir2:"low2hi",goal:"first"},{side1:"bottom",side2:"bottom",dir1:"hi2low",dir2:"low2hi",goal:"first"},{side1:"bottom",side2:"right",dir1:"hi2low",dir2:"low2hi",goal:"first"},{side1:"right",side2:"top",dir1:"hi2low",dir2:"low2hi",goal:"first"},{side1:"top",side2:"top",dir1:"hi2low",dir2:"low2hi",goal:"first"},{side1:"left",side2:"top",dir1:"hi2low",dir2:"low2hi",goal:"first"}];break;case"topRight":t=[{side1:"bottom",side2:"top",dir1:"low2hi",dir2:"hi2low",goal:"best"},{side1:"bottom",side2:"right",dir1:"low2hi",dir2:"low2hi",goal:"first"},{side1:"bottom",side2:"bottom",dir1:"low2hi",dir2:"low2hi",goal:"first"},{side1:"bottom",side2:"left",dir1:"low2hi",dir2:"low2hi",goal:"first"},{
side1:"left",side2:"top",dir1:"hi2low",dir2:"hi2low",goal:"first"},{side1:"top",side2:"top",dir1:"low2hi",dir2:"hi2low",goal:"first"},{side1:"right",side2:"top",dir1:"hi2low",dir2:"hi2low",goal:"first"}];break;case"topOverlap":t=[{side1:"bottom",side2:"top",dir1:"low2hi",dir2:"low2hi",goal:"best"},{side1:"bottom",side2:"left",dir1:"low2hi",dir2:"low2hi",goal:"first"},{side1:"bottom",side2:"right",dir1:"low2hi",dir2:"low2hi",goal:"first"},{side1:"bottom",side2:"bottom",dir1:"low2hi",dir2:"low2hi",goal:"first"},{side1:"left",side2:"top",dir1:"hi2low",dir2:"low2hi",goal:"first"},{side1:"top",side2:"top",dir1:"low2hi",dir2:"low2hi",goal:"first"},{side1:"right",side2:"top",dir1:"hi2low",dir2:"hi2low",goal:"first"}];break;case"bottomLeft":t=[{side1:"bottom",side2:"top",dir1:"hi2low",dir2:"low2hi",goal:"best"},{side1:"bottom",side2:"bottom",dir1:"hi2low",dir2:"low2hi",goal:"first"},{side1:"bottom",side2:"right",dir1:"hi2low",dir2:"hi2low",goal:"first"},{side1:"bottom",side2:"left",
dir1:"hi2low",dir2:"hi2low",goal:"first"},{side1:"top",side2:"top",dir1:"hi2low",dir2:"low2hi",goal:"first"},{side1:"left",side2:"top",dir1:"low2hi",dir2:"low2hi",goal:"first"},{side1:"right",side2:"top",dir1:"low2hi",dir2:"low2hi",goal:"first"}];break;case"bottomRight":t=[{side1:"bottom",side2:"top",dir1:"low2hi",dir2:"hi2low",goal:"best"},{side1:"bottom",side2:"bottom",dir1:"low2hi",dir2:"hi2low",goal:"first"},{side1:"bottom",side2:"left",dir1:"low2hi",dir2:"hi2low",goal:"first"},{side1:"bottom",side2:"right",dir1:"low2hi",dir2:"hi2low",goal:"first"},{side1:"top",side2:"top",dir1:"low2hi",dir2:"hi2low",goal:"first"},{side1:"right",side2:"top",dir1:"low2hi",dir2:"hi2low",goal:"first"},{side1:"left",side2:"top",dir1:"low2hi",dir2:"hi2low",goal:"first"}];break;case"bottomOverlap":t=[{side1:"bottom",side2:"top",dir1:"low2hi",dir2:"low2hi",goal:"best"},{side1:"bottom",side2:"left",dir1:"low2hi",dir2:"hi2low",goal:"first"},{side1:"bottom",side2:"bottom",dir1:"low2hi",dir2:"low2hi",
goal:"first"},{side1:"bottom",side2:"right",dir1:"low2hi",dir2:"hi2low",goal:"first"},{side1:"right",side2:"top",dir1:"low2hi",dir2:"hi2low",goal:"first"},{side1:"left",side2:"top",dir1:"low2hi",dir2:"low2hi",goal:"first"},{side1:"top",side2:"top",dir1:"low2hi",dir2:"low2hi",goal:"first"}];break;case"leftOverlap":t=[{side1:"bottom",side2:"top",dir1:"hi2low",dir2:"low2hi",goal:"best"},{side1:"bottom",side2:"bottom",dir1:"hi2low",dir2:"low2hi",goal:"first"},{side1:"bottom",side2:"right",dir1:"hi2low",dir2:"hi2low",goal:"first"},{side1:"bottom",side2:"left",dir1:"hi2low",dir2:"hi2low",goal:"first"},{side1:"left",side2:"top",dir1:"low2hi",dir2:"low2hi",goal:"first"},{side1:"top",side2:"top",dir1:"hi2low",dir2:"low2hi",goal:"first"},{side1:"right",side2:"top",dir1:"low2hi",dir2:"low2hi",goal:"first"}];break;case"rightOverlap":t=[{side1:"bottom",side2:"top",dir1:"low2hi",dir2:"hi2low",goal:"best"},{side1:"bottom",side2:"bottom",dir1:"low2hi",dir2:"hi2low",goal:"first"},{side1:"bottom",
side2:"left",dir1:"low2hi",dir2:"low2hi",goal:"first"},{side1:"bottom",side2:"right",dir1:"low2hi",dir2:"low2hi",goal:"first"},{side1:"right",side2:"top",dir1:"low2hi",dir2:"hi2low",goal:"first"},{side1:"top",side2:"top",dir1:"low2hi",dir2:"hi2low",goal:"first"},{side1:"left",side2:"top",dir1:"low2hi",dir2:"hi2low",goal:"first"}];break;default:this.reportError("AllocateGluePoints: invalid relative node positions")}return t},o.prototype.kd=function(i){var t=[{side1:"top",side2:"bottom",dir1:"low2hi",dir2:"low2hi",goal:"first"}];switch(i){case"topLeft":t=[{side1:"top",side2:"bottom",dir1:"hi2low",dir2:"low2hi",goal:"best"},{side1:"top",side2:"top",dir1:"hi2low",dir2:"low2hi",goal:"first"},{side1:"top",side2:"left",dir1:"hi2low",dir2:"low2hi",goal:"first"},{side1:"top",side2:"right",dir1:"hi2low",dir2:"low2hi",goal:"first"},{side1:"bottom",side2:"bottom",dir1:"hi2low",dir2:"low2hi",goal:"first"},{side1:"right",side2:"bottom",dir1:"hi2low",dir2:"low2hi",goal:"first"},{side1:"left",
side2:"bottom",dir1:"hi2low",dir2:"low2hi",goal:"first"}];break;case"topRight":t=[{side1:"top",side2:"bottom",dir1:"low2hi",dir2:"hi2low",goal:"best"},{side1:"top",side2:"top",dir1:"low2hi",dir2:"hi2low",goal:"first"},{side1:"top",side2:"right",dir1:"low2hi",dir2:"low2hi",goal:"first"},{side1:"top",side2:"left",dir1:"low2hi",dir2:"low2hi",goal:"first"},{side1:"bottom",side2:"bottom",dir1:"low2hi",dir2:"hi2low",goal:"first"},{side1:"left",side2:"bottom",dir1:"hi2low",dir2:"hi2low",goal:"first"},{side1:"right",side2:"bottom",dir1:"hi2low",dir2:"hi2low",goal:"first"}];break;case"topOverlap":t=[{side1:"top",side2:"bottom",dir1:"low2hi",dir2:"low2hi",goal:"best"},{side1:"top",side2:"left",dir1:"low2hi",dir2:"low2hi",goal:"first"},{side1:"top",side2:"top",dir1:"low2hi",dir2:"low2hi",goal:"first"},{side1:"top",side2:"right",dir1:"low2hi",dir2:"low2hi",goal:"first"},{side1:"left",side2:"bottom",dir1:"hi2low",dir2:"low2hi",goal:"first"},{side1:"right",side2:"bottom",dir1:"hi2low",dir2:"hi2low",
goal:"first"},{side1:"bottom",side2:"bottom",dir1:"hi2low",dir2:"hi2low",goal:"first"}];break;case"bottomLeft":t=[{side1:"top",side2:"bottom",dir1:"hi2low",dir2:"low2hi",goal:"best"},{side1:"top",side2:"left",dir1:"hi2low",dir2:"hi2low",goal:"first"},{side1:"top",side2:"top",dir1:"hi2low",dir2:"low2hi",goal:"first"},{side1:"top",side2:"right",dir1:"hi2low",dir2:"hi2low",goal:"first"},{side1:"right",side2:"bottom",dir1:"low2hi",dir2:"low2hi",goal:"first"},{side1:"bottom",side2:"bottom",dir1:"hi2low",dir2:"low2hi",goal:"first"},{side1:"left",side2:"bottom",dir1:"low2hi",dir2:"low2hi",goal:"first"}];break;case"bottomRight":t=[{side1:"top",side2:"bottom",dir1:"low2hi",dir2:"hi2low",goal:"best"},{side1:"top",side2:"right",dir1:"low2hi",dir2:"hi2low",goal:"first"},{side1:"top",side2:"top",dir1:"low2hi",dir2:"hi2low",goal:"first"},{side1:"top",side2:"left",dir1:"low2hi",dir2:"hi2low",goal:"first"},{side1:"left",side2:"bottom",dir1:"low2hi",dir2:"hi2low",goal:"first"},{side1:"bottom",
side2:"bottom",dir1:"low2hi",dir2:"hi2low",goal:"first"},{side1:"right",side2:"bottom",dir1:"low2hi",dir2:"hi2low",goal:"first"}];break;case"bottomOverlap":t=[{side1:"top",side2:"bottom",dir1:"low2hi",dir2:"low2hi",goal:"best"},{side1:"top",side2:"left",dir1:"low2hi",dir2:"hi2low",goal:"first"},{side1:"top",side2:"right",dir1:"low2hi",dir2:"hi2low",goal:"first"},{side1:"top",side2:"top",dir1:"low2hi",dir2:"low2hi",goal:"first"},{side1:"left",side2:"bottom",dir1:"low2hi",dir2:"low2hi",goal:"first"},{side1:"right",side2:"bottom",dir1:"low2hi",dir2:"low2hi",goal:"first"},{side1:"bottom",side2:"bottom",dir1:"low2hi",dir2:"low2hi",goal:"first"}];break;case"leftOverlap":t=[{side1:"top",side2:"bottom",dir1:"hi2low",dir2:"low2hi",goal:"best"},{side1:"top",side2:"left",dir1:"hi2low",dir2:"low2hi",goal:"best"},{side1:"top",side2:"top",dir1:"hi2low",dir2:"low2hi",goal:"first"},{side1:"top",side2:"right",dir1:"hi2low",dir2:"low2hi",goal:"first"},{side1:"right",side2:"bottom",dir1:"low2hi",
dir2:"low2hi",goal:"first"},{side1:"bottom",side2:"bottom",dir1:"hi2low",dir2:"low2hi",goal:"first"},{side1:"left",side2:"bottom",dir1:"low2hi",dir2:"low2hi",goal:"first"}];break;case"rightOverlap":t=[{side1:"top",side2:"bottom",dir1:"low2hi",dir2:"hi2low",goal:"best"},{side1:"top",side2:"right",dir1:"low2hi",dir2:"low2hi",goal:"first"},{side1:"top",side2:"top",dir1:"low2hi",dir2:"hi2low",goal:"first"},{side1:"top",side2:"left",dir1:"low2hi",dir2:"low2hi",goal:"first"},{side1:"left",side2:"bottom",dir1:"low2hi",dir2:"hi2low",goal:"first"},{side1:"bottom",side2:"bottom",dir1:"low2hi",dir2:"hi2low",goal:"first"},{side1:"right",side2:"bottom",dir1:"hi2low",dir2:"hi2low",goal:"first"}];break;default:this.reportError("AllocateGluePoints: invalid relative node positions")}return t},o.prototype.pd=function(i){var t=[],s=this.layoutSessionData.Ft;switch(s){case this.lt:t=this.Md(i);break;case this.wt:t=this.Od(i);break;case this.ct:t=this.Rd(i);break;case this.pt:t=this.Sd(i);break;default:
this.reportError("Un-supported layout direction: "+s),t=this.Md(i)}return t},o.prototype.Rd=function(i){var t=[{side1:"right",side2:"left",dir1:"low2hi",dir2:"low2hi",goal:"best"}];switch(i){case"topLeft":case"topRight":case"topOverlap":t=[{side1:"right",side2:"left",dir1:"hi2low",dir2:"low2hi",goal:"best"}];break;case"bottomLeft":case"bottomRight":case"bottomOverlap":t=[{side1:"right",side2:"left",dir1:"low2hi",dir2:"hi2low",goal:"best"}];break;case"leftOverlap":case"rightOverlap":t=[{side1:"right",side2:"left",dir1:"low2hi",dir2:"low2hi",goal:"best"}];break;default:this.reportError("AllocateGluePoints: invalid relative node positions")}return t},o.prototype.Sd=function(i){var t=[{side1:"left",side2:"right",dir1:"low2hi",dir2:"low2hi",goal:"best"}];switch(i){case"topLeft":case"topRight":case"topOverlap":t=[{side1:"left",side2:"right",dir1:"hi2low",dir2:"low2hi",goal:"best"}];break;case"bottomLeft":case"bottomRight":case"bottomOverlap":t=[{side1:"left",side2:"right",dir1:"low2hi",
dir2:"hi2low",goal:"best"}];break;case"leftOverlap":case"rightOverlap":t=[{side1:"left",side2:"right",dir1:"low2hi",dir2:"low2hi",goal:"best"}];break;default:this.reportError("AllocateGluePoints: invalid relative node positions")}return t},o.prototype.Md=function(i){var t=[{side1:"bottom",side2:"top",dir1:"low2hi",dir2:"low2hi",goal:"best"}];switch(i){case"topLeft":t=[{side1:"bottom",side2:"top",dir1:"hi2low",dir2:"low2hi",goal:"best"}];break;case"topRight":t=[{side1:"bottom",side2:"top",dir1:"low2hi",dir2:"hi2low",goal:"best"}];break;case"topOverlap":t=[{side1:"bottom",side2:"top",dir1:"low2hi",dir2:"low2hi",goal:"best"}];break;case"bottomLeft":t=[{side1:"bottom",side2:"top",dir1:"hi2low",dir2:"low2hi",goal:"best"}];break;case"bottomRight":t=[{side1:"bottom",side2:"top",dir1:"low2hi",dir2:"hi2low",goal:"best"}];break;case"bottomOverlap":t=[{side1:"bottom",side2:"top",dir1:"low2hi",dir2:"low2hi",goal:"best"}];break;case"leftOverlap":t=[{side1:"bottom",side2:"top",dir1:"hi2low",
dir2:"low2hi",goal:"best"}];break;case"rightOverlap":t=[{side1:"bottom",side2:"top",dir1:"low2hi",dir2:"hi2low",goal:"best"}];break;default:this.reportError("AllocateGluePoints: invalid relative node positions")}return t},o.prototype.Od=function(i){var t=[{side1:"top",side2:"bottom",dir1:"low2hi",dir2:"low2hi",goal:"best"}];switch(i){case"topLeft":t=[{side1:"top",side2:"bottom",dir1:"hi2low",dir2:"low2hi",goal:"best"}];break;case"topRight":t=[{side1:"top",side2:"bottom",dir1:"low2hi",dir2:"hi2low",goal:"best"}];break;case"topOverlap":t=[{side1:"top",side2:"bottom",dir1:"low2hi",dir2:"low2hi",goal:"best"}];break;case"bottomLeft":t=[{side1:"top",side2:"bottom",dir1:"hi2low",dir2:"low2hi",goal:"best"}];break;case"bottomRight":t=[{side1:"top",side2:"bottom",dir1:"low2hi",dir2:"hi2low",goal:"best"}];break;case"bottomOverlap":t=[{side1:"top",side2:"bottom",dir1:"low2hi",dir2:"low2hi",goal:"best"}];break;case"leftOverlap":t=[{side1:"top",side2:"bottom",dir1:"hi2low",dir2:"low2hi",goal:"best"}
];break;case"rightOverlap":t=[{side1:"top",side2:"bottom",dir1:"low2hi",dir2:"hi2low",goal:"best"}];break;default:this.reportError("AllocateGluePoints: invalid relative node positions")}return t},o.prototype.ud=function(i,t){var s=this.Au,r=i.bi,h=i.yi,o=i.mi,e=i.pi;this.changeStateObj.jl(r,h);var n=o.Hu,l=e.Hu;if(!n||!l){var a,d,f,u=null,c=0,w=0,g=0;n&&(w=n.rank,a=n.nodeSide),l&&(g=l.rank,d=l.nodeSide);var v,b,p,m,k=null,y=null;i.Zu?(f=r.titleKeepOutArea,k={x:r.x,y:r.y,w:f.w,h:f.h}):i.$u&&(f=h.titleKeepOutArea,y={x:h.x,y:h.y,w:f.w,h:f.h});for(var x,M,O,R,S,L,H,T=0,C=0,V=t.length,D=0;D<V&&!("first"===(H=t[D]).goal&&0<w&&0<g);++D)if(p=H.side1,m=H.side2,O=H.dir1,R=H.dir2,S=s.ql(o,p),L=s.ql(e,m),0<(v=this.Ld(r,p,O,S,k))&&0===T&&(T=v,x=p),0<(b=this.Ld(h,m,R,L,y))&&0===C&&(C=b,M=m),"first"===H.goal){if(0<v&&0<b){w=v,g=b,a=p,d=m;break}}else for(;0<v&&0<b;){var N=this.Hd(r,o,p,v,h,e,m,b,u,c);!N&&null!==u||(w=v,g=b,a=p,d=m,c=this.Td(u=N)),v=(N=this.Cd(r,p,O,v,S,k,h,m,R,b,L,y)).nextRank1,
b=N.nextRank2}if(0<w&&0<g&&u)return n||this.ld(a,w,r,o),void(l||this.ld(d,g,h,e));!n&&0<T&&this.ld(x,T,r,o),!l&&0<C&&this.ld(M,C,h,e),this.Vd(i)}},o.prototype.Hd=function(i,t,s,r,h,o,e,n,l,a){var d=this.ci,f=this.Au,r=f.Sl(i,s,r),h=f.Sl(h,e,n),n={top:"up",bottom:"down",left:"left",right:"right"},e=d.$t(t,r,n[s],o,h,n[e]);if(null===l)return e;if(e){if(e.length<l.length)return e;if(e.length===l.length)if(this.Td(e)<a)return e}return null},o.prototype.Td=function(i){if(!i)return 0;for(var t,s,r,h,o=i.length-2,e=0,n=0;n<=o;++n)r=i[n],h=i[n+1],t=r.x,s=r.y,r=h.x,h=h.y,e+=t===r?Math.abs(s-h):Math.abs(t-r);return e},o.prototype.Cd=function(i,t,s,r,h,o,e,n,l,a,d,f){var u=r,a=this.Dd(e,n,l,a,d,f);return 0===a&&(a=this.Ld(e,n,l,d,f),0===(u=this.Dd(i,t,s,r,h,o))&&(a=0)),{nextRank1:u,nextRank2:a}},o.prototype.Ld=function(i,t,s,r,h){var o=this.Au,e=o.Gl(i,t);if("low2hi"===s){for(var n=e-r.displayLength+1,l=1;l<=n;++l)if(o.Pl(i,t,l,r,h))return l}else{n=r.displayLength;for(l=e;n<=l;--l)if(o.Pl(i,t,l,r
,h))return l}return 0},o.prototype.Dd=function(i,t,s,r,h,o){var e=this.Au;if("low2hi"===s){for(var n=e.Gl(i,t)-h.displayLength+1,l=r+1;l<=n;++l)if(e.Pl(i,t,l,h,o))return l}else{n=h.displayLength;for(l=r-1;n<=l;--l)if(e.Pl(i,t,l,h,o))return l}return 0},o.prototype.Vd=function(i){var t=i.mi,s=i.pi,t=t.Hu,s=s.Hu;if(!t||!s){var r=this.ad();switch(r){case a.FollowOptimalConnectionDistance:case a.ShortestPath:this.Nd(i);break;case a.FloatSide:this.Bd(i);break;case a.FixedSide:this.Ad(i);break;default:this.reportError("Un-supported port arrangement option: "+r)}}},o.prototype.Nd=function(i){var t=i.mi,s=i.pi,r=t.Hu,i=s.Hu;r||this.Nf(t),i||this.Nf(s)},o.prototype.Bd=function(i){return this.Ad(i)},o.prototype.Ad=function(i){var t,s,r,h,o=i.mi,e=i.pi,n=o.Hu,l=e.Hu;n&&l||(t=i.bi,s=i.yi,i=(r=this.qd(i)).side1,r=r.side2,n||(h=this.Au.Gl(t,i),this.ld(i,h,t,o)),l||(h=this.Au.Gl(s,r),this.ld(r,h,s,e)))},o.prototype.dd=function(i){var t=this.Au,s=i.bi,r=i.yi,h=i.mi,o=i.pi,e=h.Hu,n=o.Hu;if(e&&n)return!0
;for(var l=this.Gd(i),a=0,d=l.length;a<d;++a){var f=l[a],u=f.min,c=f.max,w=f.side1,f=f.side2;if(c=t.Ul(i,s,h,w,r,o,f,u,c))return e||this.ld(w,c.rank1,s,h),n||this.ld(f,c.rank2,r,o),!0}return!1},o.prototype.Gd=function(i){var t,s=this.ad();switch(s){case a.FollowOptimalConnectionDistance:case a.ShortestPath:t=this.Pd(i);break;case a.FloatSide:t=this.Id(i);break;case a.FixedSide:t=this.Ud(i);break;default:this.reportError("Un-supported port arrangement option: "+s),t=this.Pd(i)}return t},o.prototype.Pd=function(i){var t,s,r,h,o,e,n,l,a,d,f=[],u=i.bi,c=i.yi,w=this.Au.Ja(u,c),g=w.xOverlap,v=w.yOverlap;return(g||v)&&(i.Wu?(h=u.y,o=c.y,t=h+u.h,s=o+c.h,r=u.x,i=c.x,h=r+u.w,o=i+c.w,(e={}).bottom=Math.abs(t-s),e.right=Math.abs(h-o),e.left=Math.abs(r-i),f.push({side1:"bottom",side2:"bottom",min:w.xMin,max:w.xMax,searchAxis:"x"}),f.push({side1:"right",side2:"right",min:w.yMin,max:w.yMax,searchAxis:"y"}),f.push({side1:"left",side2:"left",min:w.yMin,max:w.yMax,searchAxis:"y"}),f.sort(function(i,t){
return e[i.side1]-e[t.side1]})):(g&&(n=w.xMin,l=w.xMax,a="bottom",d="top",u.y>c.y&&(a="top",d="bottom"),f.push({side1:a,side2:d,min:n,max:l,searchAxis:"x"})),v&&(n=w.yMin,l=w.yMax,a="right",d="left",u.x>c.x&&(a="left",d="right"),f.push({side1:a,side2:d,min:n,max:l,searchAxis:"y"})))),f},o.prototype.Id=function(i){return this.Ud(i)},o.prototype.Ud=function(i){for(var t=[],s=this.Pd(i),i=this.qd(i),r=i.side1,h=i.side2,o=0,e=s.length;o<e;++o){var n=s[o];n.side1===r&&n.side2===h&&t.push(n)}return t},o.prototype.cd=function(i){var t,s=this.ad();switch(s){case a.FollowOptimalConnectionDistance:case a.ShortestPath:t=this.jd();break;case a.FloatSide:t=this.Ed(i);break;case a.FixedSide:t=this.Fd(i);break;default:this.reportError("Un-supported port arrangement option: "+s),t=this.jd()}return t},o.prototype.jd=function(){return[{side1:"bottom",side2:"bottom",dir1:"low2hi",dir2:"low2hi",goal:"first"},{side1:"right",side2:"right",dir1:"hi2low",dir2:"hi2low",goal:"first"},{side1:"left",side2:"left",
dir1:"hi2low",dir2:"hi2low",goal:"first"},{side1:"top",side2:"top",dir1:"low2hi",dir2:"low2hi",goal:"first"}]},o.prototype.Ed=function(i){var t=this.layoutSessionData.Ft;return i.$u?this.zd(t):this.Xd(t)},o.prototype.Xd=function(i){var t=[{side1:"bottom",side2:"bottom",dir1:"low2hi",dir2:"low2hi",goal:"first"}];switch(i){case this.ct:t=[{side1:"left",side2:"left",dir1:"low2hi",dir2:"low2hi",goal:"best"},{side1:"left",side2:"bottom",dir1:"hi2low",dir2:"low2hi",goal:"first"},{side1:"left",side2:"top",dir1:"low2hi",dir2:"low2hi",goal:"first"},{side1:"left",side2:"right",dir1:"low2hi",dir2:"low2hi",goal:"first"},{side1:"bottom",side2:"left",dir1:"low2hi",dir2:"hi2low",goal:"first"},{side1:"right",side2:"left",dir1:"low2hi",dir2:"low2hi",goal:"first"}];break;case this.pt:t=[{side1:"right",side2:"right",dir1:"low2hi",dir2:"low2hi",goal:"best"},{side1:"right",side2:"bottom",dir1:"hi2low",dir2:"hi2low",goal:"first"},{side1:"right",side2:"top",dir1:"low2hi",dir2:"hi2low",goal:"first"},{
side1:"right",side2:"left",dir1:"low2hi",dir2:"low2hi",goal:"first"},{side1:"bottom",side2:"right",dir1:"hi2low",dir2:"hi2low",goal:"first"},{side1:"left",side2:"right",dir1:"low2hi",dir2:"low2hi",goal:"first"}];break;case this.lt:t=[{side1:"top",side2:"top",dir1:"low2hi",dir2:"low2hi",goal:"best"},{side1:"left",side2:"top",dir1:"low2hi",dir2:"low2hi",goal:"first"},{side1:"right",side2:"top",dir1:"hi2low",dir2:"hi2low",goal:"first"},{side1:"bottom",side2:"top",dir1:"low2hi",dir2:"low2hi",goal:"first"},{side1:"top",side2:"right",dir1:"hi2low",dir2:"low2hi",goal:"first"},{side1:"top",side2:"left",dir1:"low2hi",dir2:"low2hi",goal:"first"}];break;case this.wt:t=[{side1:"bottom",side2:"bottom",dir1:"low2hi",dir2:"low2hi",goal:"best"},{side1:"bottom",side2:"right",dir1:"hi2low",dir2:"hi2low",goal:"first"},{side1:"bottom",side2:"left",dir1:"low2hi",dir2:"hi2low",goal:"first"},{side1:"bottom",side2:"top",dir1:"low2hi",dir2:"low2hi",goal:"first"},{side1:"right",side2:"bottom",dir1:"hi2low",
dir2:"hi2low",goal:"first"},{side1:"left",side2:"bottom",dir1:"hi2low",dir2:"low2hi",goal:"first"}];break;default:this.reportError("Un-supported layout direction: "+i)}return t},o.prototype.zd=function(i){var t=[{side1:"bottom",side2:"bottom",dir1:"low2hi",dir2:"low2hi",goal:"first"}];switch(i){case this.ct:t=[{side1:"right",side2:"right",dir1:"low2hi",dir2:"low2hi",goal:"best"},{side1:"right",side2:"bottom",dir1:"hi2low",dir2:"hi2low",goal:"first"},{side1:"right",side2:"left",dir1:"low2hi",dir2:"low2hi",goal:"first"},{side1:"bottom",side2:"right",dir1:"hi2low",dir2:"hi2low",goal:"first"},{side1:"top",side2:"right",dir1:"hi2low",dir2:"low2hi",goal:"first"},{side1:"left",side2:"right",dir1:"low2hi",dir2:"low2hi",goal:"first"}];break;case this.pt:t=[{side1:"left",side2:"left",dir1:"low2hi",dir2:"low2hi",goal:"best"},{side1:"left",side2:"bottom",dir1:"hi2low",dir2:"low2hi",goal:"first"},{side1:"left",side2:"right",dir1:"low2hi",dir2:"low2hi",goal:"first"},{side1:"bottom",side2:"left",
dir1:"low2hi",dir2:"hi2low",goal:"first"},{side1:"top",side2:"left",dir1:"low2hi",dir2:"low2hi",goal:"first"},{side1:"right",side2:"left",dir1:"low2hi",dir2:"low2hi",goal:"first"}];break;case this.lt:t=[{side1:"bottom",side2:"bottom",dir1:"low2hi",dir2:"low2hi",goal:"best"},{side1:"bottom",side2:"right",dir1:"hi2low",dir2:"hi2low",goal:"first"},{side1:"bottom",side2:"left",dir1:"low2hi",dir2:"hi2low",goal:"first"},{side1:"right",side2:"bottom",dir1:"hi2low",dir2:"hi2low",goal:"first"},{side1:"left",side2:"bottom",dir1:"hi2low",dir2:"low2hi",goal:"first"},{side1:"bottom",side2:"top",dir1:"low2hi",dir2:"low2hi",goal:"first"}];break;case this.wt:t=[{side1:"top",side2:"top",dir1:"low2hi",dir2:"low2hi",goal:"best"},{side1:"top",side2:"left",dir1:"low2hi",dir2:"low2hi",goal:"first"},{side1:"top",side2:"right",dir1:"hi2low",dir2:"low2hi",goal:"first"},{side1:"top",side2:"bottom",dir1:"low2hi",dir2:"low2hi",goal:"first"},{side1:"right",side2:"top",dir1:"low2hi",dir2:"hi2low",goal:"first"},{
side1:"left",side2:"top",dir1:"low2hi",dir2:"low2hi",goal:"first"}];break;default:this.reportError("Un-supported layout direction: "+i)}return t},o.prototype.Fd=function(i){var t=this.qd(i),i=t.side1,t=t.side2;return"top"===i&&"top"===t?[{side1:i,side2:t,dir1:"hi2low",dir2:"hi2low",goal:"first"}]:[{side1:i,side2:t,dir1:"low2hi",dir2:"low2hi",goal:"best"}]},o.prototype.qd=function(i){var t={side1:null,side2:null},s=this.layoutSessionData.Ft;if(i.Wu){var r=i.$u;switch(s){case this.lt:t=r?{side1:"bottom",side2:"bottom"}:{side1:"top",side2:"top"};break;case this.wt:t=r?{side1:"top",side2:"top"}:{side1:"bottom",side2:"bottom"};break;case this.ct:t=r?{side1:"right",side2:"right"}:{side1:"left",side2:"left"};break;case this.pt:t=r?{side1:"left",side2:"left"}:{side1:"right",side2:"right"};break;default:this.reportError("Un-supported layout direction: "+s)}}else switch(s){case this.lt:t={side1:"bottom",side2:"top"};break;case this.wt:t={side1:"top",side2:"bottom"};break;case this.ct:t={
side1:"right",side2:"left"};break;case this.pt:t={side1:"left",side2:"right"};break;default:this.reportError("Un-supported layout direction: "+s)}return t},o.prototype.ld=function(i,t,s,r){var h=this.Au,o=r.Hu;if(o)return o;for(var e,n,l=this.changeStateObj._i(r),a=h.ql(r,i),d=a.typeList,f=d.length,a=a.attachmentInx,u=h.Cl(t,i,s,d,a,r),c=0;c<f;++c)"skip"!==(n=d[c])&&(e=new w(n,i,u,s,r,l,this.il,this.reportError),++u,"attachment"===n&&(o=e));return o},o.prototype.nd=function(i,t,s,r){var h=[];return h.push(r),new w("crossover",t,this.Au.Ll(i,t,s),i,null,h,this.il,this.reportError)},o.prototype.Vu=function(){for(var i,t=this.Au,s=this.changeStateObj.nList,r=s.length,h=0;h<r;++h)(i=s[h]).ignore||t.Wl(i)},o.prototype.So=function(){for(var i,t=this.changeStateObj.nList,s=t.length,r=0;r<s;++r)i=t[r],this.Fu(i)},o.prototype.Fu=function(i){for(var t,s,r=this.changeStateObj,h=i.ki,o=h.length,e=0;e<o;++e)(t=h[e]).ignore||(s=t.Hu)&&(s=s.getPoint(),t.x=s.x-t.w/2,t.y=s.y-t.h/2,r.Vi(t))},
o.prototype.yf=function(i,t){var s=null,s=t?[]:i.rl.slice(0),i=i.Hu;s.indexOf(i)<0&&s.push(i);for(var r=0,h=s.length;r<h;++r){var o=s[r];o&&o.pl()}},o.prototype.pf=function(i){var t=i.mi,s=i.pi;t&&s&&(t=t.Hu,s=s.Hu,t&&t.removeConnection(i),s&&s.removeConnection(i))},o.prototype.Hf=function(){for(var i,t=this.changeStateObj.nList,s=t.length,r=0;r<s;++r)i=t[r],this.Yd(i,"crossover")},o.prototype.Yd=function(i,t){var s=i.gluePointLists,r=!0;"all"===t&&(r=!1);for(var h,o=["top","bottom","left","right"],e=o.length,n=0;n<e;++n)for(var l,a=(l=s[o[n]]).length,d=0;d<a;++d)(h=l[d])&&(r&&h.type!==t||h.pl())},o.prototype.collapseGroupNode=function(i){this.changeStateObj.ko(),this.changeStateObj.Oo(),this._d(i,!0),this.Wd(i),this.Qa(i)},o.prototype.Wd=function(i){for(var t,s=i._n,r=s.length,h=0;h<r;++h)t=s[h],this.Zd(t),t.Jh&&this.Wd(t)},o.prototype.expandGroupNode=function(i){this._d(i,!1),this.changeStateObj.ko(),this.changeStateObj.Oo(),this.Zd(i),this.Wd(i),this.Iu("float")},
o.prototype._d=function(i,t){this.changeStateObj.ko();for(var s=this.Au,r=i.ki,h=0,o=r.length;h<o;++h){var e=r[h];e.cn&&!1===s.Tl(e)&&(e.ignore=t)&&(e.hl===e.Hu&&(e.hl=null),this.yf(e,!e.cn))}},o.prototype.xo=function(){for(var i,t=this.changeStateObj.nList,s=t.length,r=0;r<s;++r)i=t[r],this.Zd(i)},o.prototype.Zd=function(i){this.changeStateObj;for(var t,s=i.ki.slice(0),r=s.length,h=0;h<r;++h)t=s[h],this.fa(t)},o.prototype.fa=function(i){var t,s,r,h=this.changeStateObj,o=h._i(i);o.length<1||(t=i.sl,s=i.ti,r=i.Hu,null!==(o=this.oa(i,o[0]))&&o!==s&&(i.ti=o,i.Hu=null,o===t?(i.Hu=i.hl,i.Xu=!1):i.Xu=!0,o!==s&&(h.To(s.ki,i),o.ki.push(i)),s!==t&&r&&r.vl()))},o.prototype.oa=function(i,t){return i===t.mi?t.bi:i===t.pi?t.yi:(this.reportError("AllocateGluePoints: connection does not reference expected port"),null)},o.prototype.gd=function(i,t){return this.Au.gd(i,t)},o.prototype.qf=function(i,t){if(i)(i.cn||i.Xu)&&this.yf(i,!i.cn);else if(t)for(var s,r,h=t.length,o=0;o<h;o++)s=(r=t[o]).mi,r=r.pi,
s&&r&&((s.cn||s.Xu)&&this.yf(s,!s.cn),(r.cn||r.Xu)&&this.yf(r,!r.cn));else for(var e=this.changeStateObj.nList,n=e.length,o=0;o<n;o++)this.Jd(e[o])},o.prototype.Jd=function(i){for(var t,s=i.ki,r=s.length,h=0;h<r;h++)((t=s[h]).cn||t.Xu)&&this.yf(t,!t.cn)},o.prototype.Kd=function(i,t,s,r,h){if(i.Xu&&!t.Xu){var o=t.Hu;if(o){var e=o.getPoint();if("x"===h){if(e.x>r||e.x<s)return!1}else if(e.y>r||e.y<s)return!1}}if(!i.Xu&&t.Xu){i=i.Hu;if(i){e=i.getPoint();if("x"===h){if(e.x>r||e.x<s)return!1}else if(e.y>r||e.y<s)return!1}}return!0},o.prototype.hd=function(i){var t=i.mi,i=i.pi;return!!(t.cn||i.cn||t.Xu||i.Xu)},o.prototype.Yu=function(){for(this.Vu(),this.Rf();this.Qd();)this.Iu("float"),this.Vu(),this.Rf()},o.prototype.Rf=function(){for(var i=this.changeStateObj,t=i.nList,s=0,r=t.length;s<r;++s){var h=t[s];if(!h.ignore)for(var o=h.ki,e=0,n=o.length;e<n;++e){var l=o[e];l.isUserLoc&&!l.Xu&&(this.yf(l,!1),i.$d(l,"sideOffset"),this.td(l))}}},o.prototype.Qd=function(){for(
var i=this.changeStateObj.nList,t=0,s=i.length;t<s;++t){var r=i[t];if(!r.ignore)for(var h=r.ki,o=0,e=h.length;o<e;++o){var n=h[o];if((n.cn||n.Xu)&&!n.Hu)return!0}}return!1},o.prototype.ad=function(){return this.layoutSessionData.portArrangement},d.prototype.i2=function(i,t,s){this.t2(i),this.setCellSize(t.x,t.y),this.setMinRunOut(s.x,s.y)},t.common.ObjectHelper.inherit(d,n.AStarPathPlanningAlgorithm),i.prototype.rf=function(i,t){this.qo([i],t,"sideOffset")},i.prototype.af=function(i,t,s){for(var r=this.changeStateObj,h=[],o=i.length,e=0;e<o;++e){if(n=i[e],!1===r.zi(n))return void this.reportError("BoxLayout: prioritizedBoxLayout - prioritized layout was given a node that is not in the change state");var n=r.Fi(n);h.push(n)}this.qo(h,t,s)},i.prototype.qo=function(i,t,s){var r=this.changeStateObj;r.Lo();for(var h,o=[],e=i.length,n=0;n<e;++n)h=i[n],this.s2(h,o);for(var l=this.r2(o),a=l.siblingsList,d=l.minSizeList,f=l.groupList,u=this.nodeDist.x,c=this.nodeDist.y,w=0,g=f.length;w<g;++w
)for(var v=(m=f[w])._n,b=0,p=(y=a[w]).length;b<p;++b)r.To(v,y[b]);for(w=0,g=f.length;w<g;++w){var m=f[w],k=d[w],y=a[w],x=k.w+2*u,k=k.h+2*c;this.h2(y,m,x,k,t)}r.Uo(s)},i.prototype.h2=function(i,t,s,r,h){var o=i.length;if(!(o<1)){var e=!1;(l=t._n).length<1&&(this.o2(t,i[0],h),e=!0);for(var n=this.e2(t,s,r).emptyBoxList,l=t._n,a=e?1:0;a<o;++a)var d=i[a],f=this.n2(n,d,h),n=f?(l.push(d),this.so.Tf(d,f.x,f.y,"any"),this.l2(n,d,s,r)):(f=this.a2(t,d,h),l.push(d),this.so.Tf(d,f.x,f.y,f.clearDirection),this.e2(t,s,r).emptyBoxList)}},i.prototype.r2=function(i){for(var t=[],s=[],r=[],h=0,o=i.length;h<o;++h){var e=i[h],n=e.$n,l=r.indexOf(n);l<0?(t.push([e]),r.push(n),s.push({w:e.w,h:e.h})):(t[l].push(e),this.d2(s[l],e.w,e.h))}return{siblingsList:t,minSizeList:s,groupList:r}},i.prototype.d2=function(i,t,s){i.w>t&&(i.w=t),i.h>s&&(i.h=s)},i.prototype.a2=function(i,t,s){i=i._n;if(!(i.length<1)){var r=this.changeStateObj.Yf(i),h="H";r.w>r.h&&(h="V");var o,e,n="any",l=this.nodeDist.x,a=this.nodeDist.y
;switch(s){case this.lt:case this.ct:n="H"===h?(o=r.x+r.w+l,e=r.y,"right"):(o=r.x,e=r.y+r.h+a,"down");break;case this.pt:n="H"===h?(o=r.x-t.w-l,e=r.y,"left"):(o=r.x+r.w-t.w,e=r.y+r.h+a,"down");break;case this.wt:n="H"===h?(o=r.x+r.w+l,e=r.y+r.h-t.h,"right"):(o=r.x,e=r.y-t.h-a,"up")}return{x:o,y:e,clearDirection:n}}this.reportError("BoxLayout: growGraphForNewNodePosition - the group cannot be empty in this method.")},i.prototype.n2=function(i,t,s){var r,h,o,e=this.nodeDist.x,n=this.nodeDist.y,l=t.w+2*e,a=t.h+2*n;switch(s){case this.lt:(r=this.f2(i,l,a))&&(h=r.x+e,o=r.y+n);break;case this.ct:(r=this.u2(i,l,a))&&(h=r.x+e,o=r.y+n);break;case this.pt:(r=this.c2(i,l,a))&&(h=r.x+r.w-(t.w+e),o=r.y+n);break;case this.wt:(r=this.w2(i,l,a))&&(h=r.x+e,o=r.y+r.h-(t.h+n));break;default:this.reportError("BoxLayout: findOpenPositionInEmptyBoxList - invalid layout direction - using top-down"),(r=this.f2(i,l,a))&&(h=r.x+e,o=r.y+n)}return r?{x:h,y:o}:null},i.prototype.f2=function(i,t,s){var r,h=i.length
;if(h<1)return null;for(var o=null,e=null,n=null,l=0;l<h;++l)(r=i[l]).w<t||r.h<s||(!o||r.y<n||r.y===n&&r.x<e)&&(e=(o=r).x,n=r.y);return o},i.prototype.c2=function(i,t,s){var r,h=i.length;if(h<1)return null;for(var o=null,e=null,n=null,l=null,a=0;a<h;++a)(r=i[a]).w<t||r.h<s||(o?(n<(e=r.x+r.w)||e===n&&r.y<l)&&(n=e,l=(o=r).y):(n=e=(o=r).x+r.w,l=r.y));return o},i.prototype.u2=function(i,t,s){var r,h=i.length;if(h<1)return null;for(var o=null,e=null,n=null,l=0;l<h;++l)(r=i[l]).w<t||r.h<s||(!o||r.x<e||r.x===e&&r.y<n)&&(e=(o=r).x,n=r.y);return o},i.prototype.w2=function(i,t,s){var r,h=i.length;if(h<1)return null;for(var o=null,e=null,n=null,l=null,a=0;a<h;++a)(r=i[a]).w<t||r.h<s||(o?(l<(n=r.y+r.h)||n===l&&r.x<e)&&(e=(o=r).x,l=n):(e=(o=r).x,l=n=r.y+r.h));return o},i.prototype.e2=function(i,t,s){var r=this.nodeDist.x,h=this.nodeDist.y,o=this.changeStateObj,e=i._n,n=e.length;if(!(n<1)){o=o.Yf(e);o.x-=r,o.y-=h,o.w+=2*r,o.h+=2*h;var l=[];l.push(o);for(var a=0;a<n;++a)l=this.l2(l,e[a],t,s);return{
groupNodeBox:o,emptyBoxList:l}}this.reportError("BoxLayout: buildEmptyBoxListInGroup - the group cannot be empty in this method.")},i.prototype.o2=function(i,t,s){var r,h,o,e,n=i._n;0<n.length?this.reportError("BoxLayout: addBackFirstChildInEmptyGroup - The group is not empty."):(o=i.x,e=i.y,i.$n&&(h=this.hostInterfaceObj.getGroupNodePadding(i.hostNode),o=i.x+h.left,e=i.y+h.top,i.Qh&&(r=t.w+h.left+h.right,h=t.h+h.top+h.bottom,this.g2(i,r,h,s))),n.push(t),this.so.Tf(t,o,e,"any"))},i.prototype.g2=function(i,t,s,r){var h=i.x,o=i.y,e=t,n=s,l=this.so;switch(r){case this.lt:case this.wt:l.Yl(i,h,o,e,i.h,"right"),l.Yl(i,h,o,e,n,"down");break;case this.ct:case this.pt:l.Yl(i,h,o,i.w,n,"down"),l.Yl(i,h,o,e,n,"right");break;default:this.reportError("BoxLayout: changeGroupSizeInTwoSteps - invalid layout direction"),l.Yl(i,h,o,e,i.h,"right"),l.Yl(i,h,o,e,n,"down")}},i.prototype.l2=function(i,t,s,r){for(var h,o={x:t.x,y:t.y,w:t.w,h:t.h},e=[],n=i.length,l=0;l<n;++l)h=i[l],this.v2(h,o)?(this.b2(e,h,o
,r),this.m2(e,h,o,r),this.k2(e,h,o,s),this.y2(e,h,o,s)):this.x2(e,h);return e},i.prototype.v2=function(i,t){var s=i.x,r=i.y,h=i.w,o=i.h,e=t.x,n=t.y,i=t.w,t=t.h;return!(s+h<=e)&&(!(r+o<=n)&&(!(e+i<=s)&&!(n+t<=r)))},i.prototype.b2=function(i,t,s,r){var h=t.y,s=s.y-h;s<r||(s={x:t.x,y:h,w:t.w,h:s},this.x2(i,s))},i.prototype.m2=function(i,t,s,r){var h=t.y+t.h,s=s.y+s.h,h=h-s;h<r||(h={x:t.x,y:s,w:t.w,h:h},this.x2(i,h))},i.prototype.k2=function(i,t,s,r){var h=t.x,s=s.x-h;s<r||(t={x:h,y:t.y,w:s,h:t.h},this.x2(i,t))},i.prototype.y2=function(i,t,s,r){var h=t.x+t.w,s=s.x+s.w,h=h-s;h<r||(t={x:s,y:t.y,w:h,h:t.h},this.x2(i,t))},i.prototype.x2=function(i,t){for(var s,r=t.x,h=t.y,o=t.w,e=t.h,n=i.length,l=0;l<n;++l)if(r===(s=i[l]).x&&h===s.y&&o===s.w&&e===s.h)return;i.push(t)},i.prototype.s2=function(i,t){var s,r,h=i.w*i.h,o=this.tryGetNodePriority(this.hostInterfaceObj,i.hostNode);i.boxLayoutNodeSize=h,i.boxLayoutPriority=o;for(var e=t.length,n=0;n<e;++n){if(s=(r=t[n]).boxLayoutNodeSize,
r=r.boxLayoutPriority,s<h)return void t.splice(n,0,i);if(h===s&&o<=r)return void t.splice(n,0,i)}t.push(i)},i.prototype.tryGetNodePriority=function(i,t){var s=1;return s=i.getNodePriority?i.getNodePriority(t):s};var f={NONE:0,NEW:1,MOVE:2,RESIZE:4},e={Tree:0,Hierarchical:1,Balloon:2,Orthogonal:3,Compact:4,Circular:5,Organic:6,Snake:7,Group:8,SimpleTree:9,SimpleBalloon:10,NoLayout:11,OrthogonalGroup:13},u=4,c={AnchorPointAlignment:0,LayoutDirection:1,Top:2,Bottom:3,Left:4,Right:5,Center:6},b={Global:0,InsideToOut:1};function s(){}s.prototype.toLayerAlignmentValue=function(i,t){var s=t===k.BottomToTop||t===k.RightToLeft,r=.5;switch(i){case c.Center:r=.5;break;case c.Top:r=s?1:0;break;case c.Bottom:r=s?0:1;break;case c.Left:r=s?1:0;break;case c.Right:r=s?0:1;break;case c.AnchorPointAlignment:r=0,t!==k.BottomToTop&&t!==k.RightToLeft||(r=1)}return r},s.prototype.tryGetMinNodeSize=function(i,t){t=i.getMinNodeSize?i.getMinNodeSize(t):{w:0,h:0};return t},s.prototype.tryIsNestedView=function(i
){var t=!0;return t=i.isNestedView?i.isNestedView():t},s.prototype.tryIsRSOPEnabled=function(i){var t=!0;return t=i.isRSOPEnabled?i.isRSOPEnabled():t},s.prototype.tryGetPortBehavior=function(i,t){return n.Helper.M2(i,t)},s.prototype.Bo=function(i,t,s){var r;t.getNodeToNodeDist&&(r=t.getNodeToNodeDist(),i.nodeDist={x:r.x,y:r.y}),t.getEdgeToEdgeDist&&(r=t.getEdgeToEdgeDist(),i.edgeDist={x:r.x,y:r.y}),t.getLayoutDirection&&(i.Ft=t.getLayoutDirection()),t.getStandardPortSize?i.zo=t.getStandardPortSize():i.zo=this.checkStdPortSize(t,s),t.getMinSegmentLength&&(i.minSegmentLength=t.getMinSegmentLength()),t.getIncUpdatePathType&&(i.at=t.getIncUpdatePathType()),t.getGroupAutoShrink&&(i.ph=t.getGroupAutoShrink()),t.isRSOPEnabled&&(i.isRSOPEnabled=t.isRSOPEnabled()),t.isMakeRoomInRSOPDisabled&&(i.Vo=!t.isMakeRoomInRSOPDisabled()),t.isNestedView&&(i.isNestedView=t.isNestedView()),t.isAutoClearNodeArea&&(i.isAutoClearNodeArea=t.isAutoClearNodeArea()),t.getHostManagesGroupNodeSizes&&(
i.Sa=t.getHostManagesGroupNodeSizes()),t.getLayoutType&&(i.fh=t.getLayoutType()),t.getRoutingType&&(i.ah=t.getRoutingType()),t.getMinPortExtensionDist&&(i.minPortExtensionDist=t.getMinPortExtensionDist()),t.getMinSegmentDist&&(i.vh=t.getMinSegmentDist()),t.getWrapMirror&&(i.xh=t.getWrapMirror()),t.getWrapFixedLength&&(i.Sh=t.getWrapFixedLength()),t.getWrapLength&&(i.Oh=t.getWrapLength()),t.getWrapRatio&&(i.Ph=t.getWrapRatio()),t.getEnableGlobalLayout&&(i.nestedNodeLayoutStrategy=t.getEnableGlobalLayout()?b.Global:b.InsideToOut),t.enableCompactLayout&&(i.fu=t.enableCompactLayout()),t.getRankingStrategy&&(i.rankingStrategy=t.getRankingStrategy())},s.prototype.checkStdPortSize=function(i,t){for(var s=0,r=0,h=t?t.length:0,o=0;o<h;++o)for(var e=i.getAllPortsForNode(t[o]),n=0,l=e.length;n<l;++n){var a=i.getPortRect(e[n]);a&&(s<a.w&&(s=a.w),r<a.h&&(r=a.h))}return{w:s,h:r}},s.prototype.Xo=function(i){var t=i.nodeDist;i.ch=Math.max(t.x,t.y),i.minLayerDistance=Math.max(t.x,t.y);t=i.edgeDist
;i.lh=Math.max(t.x,t.y)},s.prototype.Mh=function(i){i=i?i.coreType:null;return"yfiles"===i||"homegrown"!==i&&!!t.common.ObjectHelper.rootNamespace.Layout.YfGlobalLayout},s.prototype.w=function(i){return i.portArrangement===a.FollowLayoutDirection&&i.fh===e.Hierarchical||i.ah===u&&i.fh===e.Hierarchical},s.prototype.Gu=function(i,t){for(var s=0,r=i.length;s<r;++s){var h,o=i[s];!this._u(o)||(h=t?o.O2:o.R2)&&(o.w=h.w,o.h=h.h)}},s.prototype._u=function(i){return!(i.Jh&&i.Qh&&0<i._n.length)},s.prototype.Fo=function(i,t,s){var r="round";s.Mu&&(s.ah===u&&s.fh===e.Hierarchical||(r="ceil")),this.S2(i,t,r)},s.prototype.S2=function(i,t,s){for(var r=("ceil"===s?this.L2:this.H2).bind(this),h=t.x,o=t.y,e=0,n=i.length;e<n;++e){var l=i[e],a=r(l.w,h),d=r(l.h,o);l.O2={w:l.w,h:l.h},l.R2={w:a,h:d},l.w=a,l.h=d}},s.prototype.H2=function(i,t){return 0===t?i:Math.round(i/t)*t},s.prototype.L2=function(i,t){return 0===t?i:Math.ceil(i/t)*t},s.prototype.Mo=function(){var i,t=null
;return arguments&&0<arguments.length&&((i=arguments[arguments.length-1])&&"DfDebug"===i.DfDebug&&(t=i)),t};var p=new s;function r(i,t,s,r){this.layoutSessionData=t,this.hostInterfaceObj=i,this.reportError=i.reportError,this.du=!1;var h,o,e,n=0,l=0;for(this.nList=[],this.cList=[],this.zh=new m(null),this.zh._n=[],this.zh.T2=!0,null!==s&&(n=s.length),null!==r&&(l=r.length),e=0;e<n;++e)h=new m(s[e]),this.C2(h),this.nList.push(h),this.V2(h);for(e=0;e<l;++e)o=new x(r[e]),this.D2(o),this.cList.push(o);for(e=0;e<n;++e)h=this.nList[e],this.N2(h)._n.push(h);for(this.B2(this.zh,!1),e=0;e<n;++e)!1!==(h=this.nList[e]).Jh&&(!1!==h.Qh&&!h.ignore||(h.uf=!0));this.ko(),this.Oo(),this.isPartialUpdate=!1,this.A2=void 0,this.q2=void 0}function m(i){M(i,this),this.hostNode=i,this.$n=null,this._n=null,this.ki=null,this.Rl=[],this.uf=!1,this.Jh=!0,this.Qh=!0,this.ignore=!1,this.vs=f.NEW,this.gluePointLists={top:[],left:[],bottom:[],right:[]},this.x=0,this.y=0,this.w=0,this.h=0,this.G2=function(){
this.gluePointLists.top=[],this.gluePointLists.left=[],this.gluePointLists.bottom=[],this.gluePointLists.right=[]}}function y(i,t){O(i,this),this.Ci=i,this.ti=t,this.Hu=null,this.hl=null,this.rl=[],this.Oe=null,this.Ve=null,this.Ue=null,this.cn=!1,this.Xu=!1,this.vs=f.NEW,this.ti.vs|=f.NEW,this.x=0,this.y=0,this.w=0,this.h=0,this.sl=t,this.ignore=!1,this.Oi=0}function x(i){R(i,this),this.Si=i,this.su=null,this.Oe=null,this.Ve=null,this.Ue=null,this.ignore=!1,this.Bi=null,this.mi=null,this.pi=null,this.bi=null,this.yi=null,this.P2=null,this.I2=null,this.Wu=!1,this.U2=!1,this.Qu=!1,this.Zu=!1,this.$u=!1,this.j2=!1,this.nodeDist=0,this.E2=null,this.Ti=!1,this.vs=f.NEW}r.prototype.Yo=function(){var i,t=this.nList,s=t.length,r=0,h=this.zh;this.F2=h,this.z2=h;for(var o=0;o<s;++o)if((i=t[o])!==h){i.T2=!1;for(var e=[],n=i.$n,r=0;n!==h;)e.push(n),r++,n=n.$n;i.parentNodes=r?e:void 0}},r.prototype.X2=function(i,t){if(i){var s=i.parentNodes;if(s)for(var r=s.length,h=0;h<r;h++)s[h].T2=t}},
r.prototype.jl=function(i,t){var s=i.$n,r=t.$n,h=this.F2,o=this.z2;s==h&&r==o||(h==o?s==h&&r==h||(s!=h&&r!=h?(this.X2(this.A2,!1),this.X2(i,!0),s!=r&&this.X2(t,!0)):s!=h?this.X2(i,!0):this.X2(t,!0)):(this.X2(this.A2,!1),this.X2(this.q2,!1),this.X2(i,!0),s!=r&&this.X2(t,!0)),this.A2=i,this.q2=t,this.F2=s,this.z2=r)},r.prototype.xi=function(){for(var i,t=this.cList,s=this.nList,r=s.length,h=t.length,o=0;o<h;++o)R(t[o].Si,null);for(var e=0;e<r;++e){i=s[e],M(i.hostNode,null);for(var n,l=(n=i.ki).length,a=0;a<l;++a)O(n[a].Ci,null)}this.zh._n=[],this.nList=[],this.cList=[]},r.prototype.getAllCsNodes=function(){return this.nList},r.prototype.getAllCsConnections=function(){return this.cList},r.prototype.zi=function(i){return!!this.Fi(i)},r.prototype.addNewNode=function(i){var t=new m(i);this.C2(t),this.nList.push(t);i=this.N2(t);return null===i._n&&(i.Jh=!0,i._n=[]),i._n.push(t),t.ignore=i.ignore||!1===i.Qh,t.ki=[],t},r.prototype.convertNodeToGroupNode=function(i){var t=this.Fi(i);if(!t
)return this.reportError("ChangeState: request to convert a node to a group node that is not in the change state"),null;if(null!==t._n)return this.reportError("ChangeState: request to convert a node to a group node that is already a group node"),null;t._n=[],t.Jh=!0,t.Qh=this.hostInterfaceObj.isExpanded(i);var s={w:t.w,h:t.h};return t.titleKeepOutArea=this.hostInterfaceObj.getGroupNodeKeepOutArea(i,s),t},r.prototype.convertGroupNodeToNode=function(i){i=this.Fi(i);return i?null===i._n?(this.reportError("ChangeState: request to convert a group to a normal node that is already a normal node"),null):0<i._n.length?(this.reportError("ChangeState: request to convert a group to a normal node that is not empty group"),null):(i._n=null,i.Jh=!1,i.Qh=!1,i.uf=!1,i.titleKeepOutArea=null,i):(this.reportError("ChangeState: request to convert a group to a normal node that is not in the change state"),null)},r.prototype.Y2=function(i){i=this.Fi(i);if(i){i.isOutOfControl=!0;for(var t=this.Ii(i),
s=t.length,r=0;r<s;++r)t[r].ignore=!0}else this.reportError("ChangeState: a node that is not in the change state")},r.prototype.removeNode=function(i){var t=this.Fi(i);if(t){for(var s=this._2(t),r=s.length,h=0;h<r;++h)this.removeConnection(s[h].Si);var o=t.ki;if(o)for(;0<o.length;)this.removePort(o[0].Ci);var e=t._n;if(null!==e)for(;0<e.length;)this.removeNode(e[0].hostNode);var n=t.$n;this.To(this.nList,t),this.To(n._n,t),M(i,null)}else this.reportError("ChangeState: request to remove a node that is not in the change state")},r.prototype._e=function(i){var t,s=this.Fi(i);null!==s?(t=s.$n)!==(i=this.N2(s))&&(this.To(t._n,s),null===i._n&&(i.Jh=!0,i._n=[]),i._n.push(s),this.B2(i,i.ignore),this.ko(),this.Oo()):this.reportError("ChangeState: request to re-parent a node that is not in the change state")},r.prototype.hf=function(i){for(var t=i.length,s=0;s<t;++s)this._e(i[s])},r.prototype.ji=function(i){return!!this.ru(i)},r.prototype.addNewPort=function(i){
var t=this.hostInterfaceObj.getNodeOfPort(i),t=this.Fi(t);if(!t)return this.reportError("ChangeState: attempting to add a new port for a node that is not in the change state"),null;i=new y(i,t);return this.W2(i),t.ki.push(i),t.Rl.push(i),i},r.prototype.movePort=function(i){var t,s=this.ru(i);s?(t=this.hostInterfaceObj.getNodeOfPort(i).changeStateNode)?t===s.sl?this.Z2(i):this.J2(i):this.reportError("ChangeState: port's new owing node is not in the change state"):this.reportError("ChangeState: request to remove a port that is not in the change state")},r.prototype.Z2=function(i){var t=this.ru(i);t?(i=this.hostInterfaceObj.getPortRect(i),t.x=i.x,t.y=i.y,t.userLoc=this.K2(t),this.Vi(t)):this.reportError("ChangeState: request to remove a port that is not in the change state")},r.prototype.J2=function(i){var t,s,r,h=this.ru(i);h?(t=h.ti,s=h.sl,(r=this.hostInterfaceObj.getNodeOfPort(i).changeStateNode)?(h.Xu=!1,h.ti=r,h.sl=r,this.To(t.ki,h),this.To(s.Rl,h),r.ki.push(h),r.Rl.push(h),h.Hu=null
,h.hl=null,h.rl=[],h.ignore=!1,this.Z2(i)):this.reportError("ChangeState: port's new owing node is not in the change state")):this.reportError("ChangeState: request to remove a port that is not in the change state")},r.prototype.removePort=function(i){var t,s,r=this.ru(i);r?(t=r.ti,s=r.sl,this.To(t.ki,r),this.To(s.Rl,r),O(i,null)):this.reportError("ChangeState: request to remove a port that is not in the change state")},r.prototype.changePortLabel=function(i){var t,s,r,h=this.ru(i);h?(t=this.hostInterfaceObj.getPortLabel?this.hostInterfaceObj.getPortLabel(i):null)?h.Oe===t?(s=this.hostInterfaceObj.getLabelRect(t),r=h.Ve,(i=h.Ue).x+=s.x-r.x,i.y+=s.y-r.y,h.Ve=s):(h.Oe=t,h.Ve=this.hostInterfaceObj.getLabelRect(t),h.Ue={x:0,y:0}):(h.Oe=null,h.Ve=null,h.Ue={x:0,y:0}):this.reportError("ChangeState: request to change a label for a port that is not in the change state")},r.prototype.Di=function(i){return!!this.Gi(i)},r.prototype.addNewConnection=function(i){i=new x(i);return this.D2(i),
this.cList.push(i),i},r.prototype.removeConnection=function(i){var t=this.Gi(i);null!==t?(this.To(this.cList,t),R(i,null)):this.reportError("ChangeState: request to remove a connection that is not in the change state")},r.prototype.changeConnectionLabel=function(i){var t,s,r,h=this.Gi(i);null!==h?(t=this.hostInterfaceObj.getConnectionLabel?this.hostInterfaceObj.getConnectionLabel(i):null)?h.Oe===t?(s=this.hostInterfaceObj.getLabelRect(t),r=h.Ve,(i=h.Ue).x+=s.x-r.x,i.y+=s.y-r.y,h.Ve=s):(h.Oe=t,h.Ve=this.hostInterfaceObj.getLabelRect(t),h.Ue={x:0,y:0}):(h.Oe=null,h.Ve=null,h.Ue={x:0,y:0}):this.reportError("ChangeState: request to change a label for a connection that is not in the change state")},r.prototype.update=function(i){var t=this.hostInterfaceObj;return i<1?0:(t.stopDisplayUpdate(),this.Q2(this.zh,i),i<2&&(this.i1(),this.ca(),this.Eo(),this.t1()),t.updateDisplay(),--i)},r.prototype.Q2=function(i,t){for(var s,r,h,o,e,n,l=this.hostInterfaceObj,a=i._n,d=a.length,f=0;f<d;++f)(s=a[f]
).isOutOfControl||(r=s.hostNode,h=(n=l.getNodeRect(r)).x,o=n.y,e=n.w,n=n.h,h+=(s.x-h)/t,o+=(s.y-o)/t,e+=(s.w-e)/t,n+=(s.h-n)/t,l.setNodeRect(r,h,o,e,n),null!==s._n&&this.Q2(s,t))},r.prototype.i1=function(){for(var i,t,s=this.hostInterfaceObj,r=this.nList,h=r.length,o=0;o<h;++o)for(var e,n=(e=r[o].ki).length,l=0;l<n;++l)(i=e[l]).ignore||i.ti.isOutOfControl||(t=i.Ci,s.setPortRect(t,i.x,i.y,i.w,i.h))},r.prototype.ca=function(){var i=this.hostInterfaceObj;if(i.setGluePoints)for(var t,s,r=this.nList,h=r.length,o=0;o<h;++o)s=(t=r[o]).hostNode,i.setGluePoints(s,t.gluePointLists)},r.prototype.Eo=function(){for(var i,t=this.hostInterfaceObj,s=this.cList,r=s.length,h=0;h<r;++h)(i=s[h]).ignore||i.bi.isOutOfControl||i.yi.isOutOfControl||t.setPath(i.Si,i.su)},r.prototype.t1=function(){var i=this.hostInterfaceObj;if(i.setLabelRect){for(var t,s,r,h=this.nList,o=h.length,e=0;e<o;++e)for(var n,l=(n=h[e].ki).length,a=0;a<l;++a)(t=(r=n[a]).Oe)&&(s=r.Ve,i.setLabelRect(t,s.x,s.y,s.w,s.h));for(var d,
f=this.cList,u=f.length,c=0;c<u;++c)(t=(d=f[c]).Oe)&&(s=d.Ve,i.setLabelRect(t,s.x,s.y,s.w,s.h))}},r.prototype.s1=function(i){return{x:i.x+i.w/2,y:i.y+i.h/2}},r.prototype.r1=function(i,t){for(var s,r,h,o=i.gluePointLists[t],e=null,n=null,l=null,a=null,d=o.length,f=0;f<d;f++)(h=o[f])&&"attachment"===h.type&&(s=h.changePort)&&(s.ignore||s.cn||s.Xu||(r=s.x+s.w/2,h=s.y+s.h/2,null===e?(l=e=r,a=n=h):(r<e&&(e=r),h<n&&(n=h),l<r&&(l=r),a<h&&(a=h))));return null===e?null:{x:e,y:n,w:l-e,h:a-n}},r.prototype.h1=function(i,t){var s=this.r1(i,"top"),r=this.r1(i,"bottom"),s=this.o1(s,r),r=this.r1(i,"left"),i=this.r1(i,"right"),i=this.o1(r,i);return s&&i?{x:s.x,y:i.y,w:s.w,h:i.h}:s?{x:s.x,y:t.y,w:s.w,h:0}:i?{x:t.x,y:i.y,w:0,h:i.h}:null},r.prototype.Yf=function(i){var t=i.length;if(t<1)return{x:0,y:0,w:0,h:0};for(var s,r,h=i[0],o=h.x,e=h.y,n=o+h.w,l=e+h.h,a=1;a<t;++a)(s=(h=i[a]).x)<o&&(o=s),(r=h.y)<e&&(e=r),n<(s+=h.w)&&(n=s),l<(r+=h.h)&&(l=r);return{x:o,y:e,w:n-o,h:l-e}},r.prototype.o1=function(i,t){if(
i&&t){var s=Math.min(i.x,t.x),r=Math.min(i.y,t.y),h=i.x+i.w,o=i.y+i.h,e=t.x+t.w,n=t.y+t.h;return{x:s,y:r,w:Math.max(h,e)-s,h:Math.max(o,n)-r}}return i?{x:i.x,y:i.y,w:i.w,h:i.h}:t?{x:t.x,y:t.y,w:t.w,h:t.h}:null},r.prototype.El=function(i,t){var s=i.x,r=i.y,h=t.x,o=t.y,i=h+t.w,t=o+t.h;return!(s<h)&&(!(r<o)&&(!(i<s)&&!(t<r)))},r.prototype.Oo=function(){for(var i,t,s=this.hostInterfaceObj,r=this.nList,h=r.length,o={w:0,h:0},e=0;e<h;++e)(i=r[e]).titleKeepOutArea=null,i.Jh&&i.Qh&&(o.w=i.w,o.h=i.h,(t=s.getGroupNodeKeepOutArea(i.hostNode,o)).w=Math.min(o.w,t.w),t.h=Math.min(o.h,t.h),i.titleKeepOutArea=t)},r.prototype.V2=function(i){for(var t,s=i.hostNode,r=this.hostInterfaceObj.getAllPortsForNode(s),h=r.length,o=[],e=0;e<h;++e)t=new y(r[e],i),this.W2(t),o.push(t);i.ki=o,i.Rl=o.slice(0)},r.prototype.Lo=function(){for(var i,t=this.nList,s=t.length,r=0;r<s;++r)for(var h,o=(h=t[r].ki).length,e=0;e<o;++e)i=h[e],this.Vi(i)},r.prototype.Vi=function(i){i.isUserLoc?this.e1(i):this.n1(i)},
r.prototype.n1=function(i){var t=i.ti,s=i.x+i.w/2,r=i.y+i.h/2,h=s-t.x,o=r-t.y,e=h/t.w,n=o/t.h,t=this.hn(s,r,t.x,t.y,t.w,t.h);i.pos={nodeSide:t,dx:h,dy:o,relx:e,rely:n}},r.prototype.e1=function(i){if(!i.isUserLoc)return this.reportError("The port is not user defined port"),void this.n1(i);i.Xu||this.l1(i),this.n1(i)},r.prototype.l1=function(i){var t,s=i.userLoc;return s?(t=i.ti,i.x=t.x+t.w*s.perX+s.absX-i.w/2,i.y=t.y+t.h*s.perY+s.absY-i.h/2):this.reportError("Port has not user defined location."),!!s},r.prototype.K2=function(i){if(!i.isUserLoc)return null;var t=i.Ci,s=null,i=this.hostInterfaceObj;return(s=i.getPortLocation?i.getPortLocation(t):s)?{absX:s.absoluteX,absY:s.absoluteY,perX:s.percentX,perY:s.percentY}:(this.reportError("The port has no user defined location"),null)},r.prototype.Uo=function(i){for(var t,s=this.nList,r=s.length,h=0;h<r;++h)t=s[h],this._l(t,i)},r.prototype._l=function(i,t){for(var s,r=i.ki,h=r.length,o=0;o<h;++o)s=r[o],this.vn(s,t)},r.prototype.vn=function(i,t
){i.isUserLoc?this.$d(i,t):this.a1(i,t)},r.prototype.a1=function(i,t){var s=i.ti,r=s.x,h=s.y,o=s.w,e=s.h,n=i.pos;switch(t){case"sideOffset":var l=n.nodeSide;"left"===l?h+=n.dy:"right"===l?(r+=o,h+=n.dy):"bottom"===l?(r+=n.dx,h+=e):r+=n.dx;break;case"relative":r+=o*n.relx,h+=e*n.rely;break;case"absolute":r+=n.dx,h+=n.dy;break;default:this.reportError("ChangeState: invalid port position rule")}i.x=r-i.w/2,i.y=h-i.h/2},r.prototype.$d=function(i,t){if(!i.isUserLoc)return this.reportError("The port is not user defined port"),void this.a1(i,t);i.Xu?this.a1(i,t):(this.l1(i),this.n1(i))},r.prototype.hn=function(i,t,s,r,h,o){i=Math.abs(s-i),h=Math.abs(h-i),r=Math.abs(r-t),t=Math.abs(o-r),o="bottom";return i<Math.min(h,r,t)?o="left":h<Math.min(r,t)?o="right":r<t&&(o="top"),o},r.prototype.N2=function(i){var t=i.hostNode,s=this.hostInterfaceObj.getParentNode(t),t=this.zh;return null!==s&&null===(t=Object.prototype.hasOwnProperty.call(s,"changeStateNode")?this.Fi(s):t)?(i.$n=this.zh,this.zh):i.$n=t
},r.prototype.ia=function(i){for(var t,s,r,h=this.hostInterfaceObj,o=i.hostNode,e=i.ki,n=e.length,l=[],a=0;a<n;++a)for(var d,f=e[a].Ci,u=(d=h.getAllConnectionsForPort(f)).length,c=0;c<u;++c)s=d[c],t=h.getSourceNode(s),s=h.getTargetNode(s),t&&s&&(r=t===o?this.Fi(s):this.Fi(t))&&l.indexOf(r)<0&&l.push(r);return l},r.prototype._2=function(i){for(var t,s=[],r=this.cList,h=r.length,o=0;o<h;++o)(t=r[o]).P2!==i&&t.I2!==i||s.push(t);return s},r.prototype.Ii=function(i){for(var t,s=[],r=this.cList,h=r.length,o=0;o<h;++o)(t=r[o]).bi!==i&&t.yi!==i||s.push(t);return s},r.prototype._i=function(i){for(var t,s=[],r=this.cList,h=r.length,o=0;o<h;++o)(t=r[o]).mi!==i&&t.pi!==i||s.push(t);return s},r.prototype.ed=function(i,t){var s=i.$n,r=t.$n;if(r===this.zh)return r;for(;null!==s.$n;){for(r=t.$n;null!==r.$n;){if(s===r)return s;r=r.$n}s=s.$n}return s},r.prototype.d1=function(i){for(var t=i.$n,s=null;t!==this.zh;)t=(s=t).$n;return s},r.prototype.f1=function(i){for(var t=null,s=i.$n;s!==this.zh;
)!1===s.Qh&&(t=s),s=s.$n;return t},r.prototype.Nu=function(i,t){if(t===this.zh)return!0;for(var s=i.$n;s!==this.zh;){if(s===t)return!0;s=s.$n}return!1},r.prototype.Ke=function(i,t){if(!t.Qh)return!1;var s=i.bi,i=i.yi;if(s===t)return!1;if(i===t)return!1;s=this.Nu(s,t),t=this.Nu(i,t);return(!s||!t)&&(!!s||!!t)},r.prototype.B2=function(i,t){i.ignore=t;for(var s,r=!i.Qh||t,h=i._n,o=h.length,e=0;e<o;++e)(s=h[e]).ignore=r,null!==s._n&&this.B2(s,r)},r.prototype.To=function(i,t){t=i.indexOf(t);t<0?this.reportError("ChangeState: array item not found to remove"):i.splice(t,1)},r.prototype.C2=function(i){var t,s=i.hostNode;null!==s&&(M(s,i),t=this.hostInterfaceObj.getNodeRect(s),i.x=t.x,i.y=t.y,i.w=t.w,i.h=t.h,i.Jh=this.hostInterfaceObj.isGroupNode(s),i.Qh=this.hostInterfaceObj.isExpanded(s),i.Jh&&(t={w:i.w,h:i.h},i.titleKeepOutArea=this.hostInterfaceObj.getGroupNodeKeepOutArea(s,t),i._n=[]))},r.prototype.W2=function(i){var t,s,r=i.Ci;null!==r&&(t=this.hostInterfaceObj,
"layoutAllocatedPortFloat"===(s=p.tryGetPortBehavior(t,r))?i.cn=!0:"generalPort"===s&&(i.isUserLoc=!0,this.du=!0),O(r,i),s=t.getPortRect(r),i.x=s.x,i.y=s.y,i.w=s.w,i.h=s.h,i.userLoc=this.K2(i),(r=t.getPortLabel?t.getPortLabel(r):null)&&(i.Oe=r,i.Ve=t.getLabelRect(r),i.Ue={x:0,y:0}),this.Vi(i))},r.prototype.D2=function(i){var t,s,r,h,o=i.Si;null!==o&&(t=this.hostInterfaceObj.getSourcePort(o),s=this.hostInterfaceObj.getTargetPort(o),t&&s&&(r=this.hostInterfaceObj.getNodeOfPort(t),h=this.hostInterfaceObj.getNodeOfPort(s),r&&h&&(i.bi=this.Fi(r),i.yi=this.Fi(h),i.mi=this.ru(t),i.pi=this.ru(s),(i.mi.changeCon=i).pi.changeCon=i,(o=this.hostInterfaceObj.getConnectionLabel?this.hostInterfaceObj.getConnectionLabel(o):null)&&(i.Oe=o,i.Ve=this.hostInterfaceObj.getLabelRect(o),i.Ue={x:0,y:0}))))},r.prototype.ko=function(){for(var i=this.cList.length,t=0;t<i;++t)this.Pi(this.cList[t])},r.prototype.Pi=function(i){var t=this.hostInterfaceObj,s=i.Si,r=i.Bi,h=i.su;i.Bi=null,i.su=null,i.mi=null,i.pi=null
,i.bi=null,i.yi=null,i.P2=null,i.I2=null,i.Wu=!1,i.U2=!1,i.Qu=!1,i.Zu=!1,i.$u=!1,i.j2=!1,i.ignore=!0,i.nodeDist=0,i.E2=null;var o,e,n=t.getSourcePort(s),l=t.getTargetPort(s);n&&l&&(o=t.getNodeOfPort(n),e=t.getNodeOfPort(l),o&&e&&(s=this.Fi(o),t=this.Fi(e),i.P2=s,i.I2=t,s&&t&&(o=this.ru(n),e=this.ru(l),o&&e&&(i.ignore=!1,n=this.f1(s),l=this.f1(t),o.ignore=!1,e.ignore=!1,null!==n&&(s=n,o.ignore=!0),null!==l&&(t=l,e.ignore=!0),(null===n||n!==l)&&(!s.Jh||s.Qh||s!==t&&!this.Nu(t,s))&&(!t.Jh||t.Qh||s!==t&&!this.Nu(s,t))?(i.mi=o,i.pi=e,i.bi=s,i.yi=t,(i.mi.changeCon=i).pi.changeCon=i,s.$n!==t.$n&&(i.j2=!0),this.Nu(s,t)?(i.Wu=!0,i.$u=!0):this.Nu(t,s)&&(i.Wu=!0,i.Zu=!0),s===t&&(i.Qu=!0),i.Wu||i.Qu||(i.U2=!0),i.Bi=r,i.su=h,h=t.x-s.x,s=t.y-s.y,i.nodeDist=h*h+s*s):i.ignore=!0))))},r.prototype.u1=function(i){for(var t=this.cList,s=t.length,r=0;r<s;++r)if(t[r].mi===i)return!0;return!1},r.prototype.wi=function(i){var t=this.layoutSessionData.Ft,s=this.u1(i),r="bottom";switch(t){case 0:
r=s?"bottom":"top";break;case 1:r=s?"right":"left";break;case 2:r=s?"top":"bottom";break;case 3:r=s?"left":"right"}return r},r.prototype.Fi=function(i,t){i=i.changeStateNode;return i||(t&&this.reportError("ChangeState: node not found in change state"),null)},r.prototype.ru=function(i,t){i=i.changeStatePort;return i||(t&&this.reportError("ChangeState: port not found in change state"),null)},r.prototype.Gi=function(i,t){i=i.changeStateConnection;return i||(t&&this.reportError("ChangeState: connection not found in change state"),null)},r.prototype.Ei=function(){for(var i=this.nList,t=i.length,s=0;s<t;s++){i[s].vs=f.NONE;for(var r=i[s].ki,h=r.length,o=0;o<h;++o)r[o].vs=f.NONE}for(var e=this.cList,n=e.length,s=0;s<n;s++)e[s].vs=f.NONE,e[s].Ti=!1},m.prototype.Hi=function(i,t){this.x===i&&this.y===t||(this.vs|=f.MOVE),this.x=i,this.y=t},m.prototype.jn=function(i,t){this.w===i&&this.h===t||(this.vs|=f.RESIZE),this.w=i,this.h=t},y.prototype.Hi=function(i,t){this.x===i&&this.y===t||(
this.vs|=f.MOVE),this.x=i,this.y=t};var M=function(i,t){i&&(i.changeStateNode=t)},O=function(i,t){i&&(i.changeStatePort=t)},R=function(i,t){i&&(i.changeStateConnection=t)};function S(i,t,s,r,h,o,e,n){w.call(this,i,t,s,r,h,o,e,n),this.c1=!0}function L(i,t){this.reportError=t,(this.refNode=i).tabNode&&t&&t("TableNode: Table node data already exit on reference node."),(i.tabNode=this).ic=null,this.ir=null,this.x=i.x,this.y=i.y,this.h=i.h,this.w=i.w}function H(i){this.rows=[],this.minRow=null,this.maxRow=null,this.minCol=null,this.maxCol=null,this.reportError=i}function T(){}t.common.ObjectHelper.inherit(S,w),S.prototype.tl=function(){var i=this.changeNode,t=this.nodeSide,s=this.rank,t=i.gluePointLists[t];t[s]&&this.reportError("The rank has been occupied: "+s),t[s]=this},S.prototype.vl=function(){w.prototype.vl.apply(this,arguments)},L.prototype.Hi=function(i,t){this.x=i,this.y=t,this.refNode.Hi(i,t)},L.prototype.jn=function(i,t){this.w=i,this.h=t,this.refNode.jn(i,t)},
L.prototype.Zn=function(){return this.refNode},H.prototype.w1=function(i,t,s){var r,h;null!=t&&null!=s?((h=(r=(r=this.rows[t])||this.g1(t))[s])&&h!==i&&this.reportError("Target table cell is not empty."),(r[s]=i).ir=t,i.ic=s,this.v1(t,s)):this.reportError("Input index is not a number.")},H.prototype.b1=function(i){var t=i.ir,s=i.ic,t=this.rows[t];t[s]!==i&&this.reportError("Table content is not correct."),t[s]=null,i.ir=null,i.ic=null},H.prototype.m1=function(i,t){i=this.rows[i];return i?i[t]:null},H.prototype.getRow=function(i){return this.rows[i]},H.prototype.k1=function(i){var t=[],s=this.rows[i];if(!s)return t;for(var r=this.maxCol+1,h=this.minCol;h<r;++h){var o=s[h];o&&t.push(o)}return t},H.prototype.y1=function(i){var t=[],s=this.maxRow,r=this.minRow;if(null===s||null===r)return t;for(var h=this.rows,o=r;o<=s;++o){var e=h[o];e&&((e=e[i])&&t.push(e))}return t},H.prototype.Bt=function(i,t,s){i.ir!==t||i.ic!==s?(this.b1(i),this.w1(i,t,s)):this.m1(t,s)!==i&&this.reportError(
"The table content is incorrect")},H.prototype.v1=function(i,t){var s,r;null!==i?(s=this.maxRow,r=this.minRow,(null==s||s<i)&&(this.maxRow=i),(null==r||i<r)&&(this.minRow=i),null!==t&&(s=this.maxCol,r=this.minCol,(null==s||s<t)&&(this.maxCol=t),(null==r||t<r)&&(this.minCol=t))):this.reportError("Input row index is not a number")},H.prototype.x1=function(){return{minRow:this.minRow,maxRow:this.maxRow,minCol:this.minCol,maxCol:this.maxCol}},H.prototype.M1=function(i){var t=this.rows[i];if(t){var s=this.minCol,r=this.maxCol;if(null!==s&&null!==r){for(var h=null,o=null,e=s;e<=r;++e)if(t[e]){h=e;break}if(null!==h)for(e=r;s<=e;--e)if(t[e]){o=e;break}if(null!==h)return{min:h,max:o}}}else this.reportError("The row is not exist.")},H.prototype.O1=function(i){var t=this.minRow,s=this.maxRow;if(null!==t&&null!==s){for(var r=null,h=null,o=t;o<=s;++o)if(this.m1(o,i)){r=o;break}if(null!==r)for(o=s;t<=o;--o)if(this.m1(o,i)){h=o;break}if(null!==r)return{min:r,max:h}}},H.prototype.R1=function(i,t,s){
if(s<t)return this.reportError("Start column should not be bigger than end column."),!1;for(var r=s+1,h=t;h<r;++h)if(this.m1(i,h))return!1;return!0},H.prototype.S1=function(i,t,s){if(s<t)return this.reportError("Start row should not be bigger than end row."),!1;for(var r=s+1,h=t;h<r;++h)if(this.m1(h,i))return!1;return!0},H.prototype.L1=function(i,t){var s=this.M1(i);if(s){var r=s.min,i=s.max,s=!0;return{atHead:s=t<=r||!(i<=t)&&t<=r+(i-r)/2,inx:s?r-1:i+1}}},H.prototype.H1=function(i,t,s,r,h){if(r<s)return this.reportError("Start row should not be bigger than end row."),!1;if(h<=0)return this.reportError("request node number is not correct"),!1;for(var o=s,e=!0,n=0,l=[],a=s;a<=r;a++)if(this.m1(a,t)){if(h<=n)for(var d=o;d<=a-1-h+1;d++){var f=d,u=d+h-1,c=u<i?i-u:i<f?f-i:0;l.push({s:f,e:u,dis:c})}e=!(n=0)}else n++,e&&(o=a,e=!1);return l},H.prototype.T1=function(i,t){var s=this.O1(t),r=s.min,t=s.max,s=!0;return{atHead:s=i<=r||!(t<=i)&&i<=r+(t-r)/2,inx:s?r-1:t+1}},H.prototype.C1=function(i,t,
s,r,h){if(r<s)return this.reportError("Start col should not be bigger than end col."),!1;if(h<=0)return this.reportError("request node number is not correct"),!1;for(var o=s,e=!0,n=0,l=[],a=s;a<=r;a++)if(this.m1(t,a)){if(h<=n)for(var d=o;d<=a-1-h+1;d++){var f=d,u=d+h-1,c=u<i?i-u:i<f?f-i:0;l.push({s:f,e:u,dis:c})}e=!(n=0)}else n++,e&&(o=a,e=!1);return l},H.prototype.V1=function(i,t,s){if(0!==s){var r=this.minCol,h=this.maxCol;if(null!==r&&null!==h)if(0<s){var o=Math.max(t,r);--o;for(var e=h;o<e;--e)(n=this.m1(i,e))&&this.Bt(n,n.ir,n.ic+s)}else{o=Math.min(t,h);o+=1;for(var n,e=r;e<o;++e)(n=this.m1(i,e))&&this.Bt(n,n.ir,n.ic+s)}}},H.prototype.D1=function(i,t,s){if(0!==s){var r=this.minRow,h=this.maxRow;if(null!==r&&null!==h)if(0<s){var o=Math.max(i,r);--o;for(var e=h;o<e;--e)(n=this.m1(e,t))&&this.Bt(n,n.ir+s,n.ic)}else{o=Math.min(i,h);o+=1;for(var n,e=r;e<o;++e)(n=this.m1(e,t))&&this.Bt(n,n.ir+s,n.ic)}}},H.prototype.N1=function(i,t){var s=this.minRow,r=this.maxRow;if(null!==s&&null!==r){
var h=this.minCol,o=this.maxCol;if(null!==h&&null!==o){if(0!==i)for(var e=0<i?s:r,n=o+1,l=h;l<n;++l)this.D1(e,l,i);if(s=this.minRow,r=this.maxRow,0!==t)for(var a=0<t?h:o,n=r+1,l=s;l<n;++l)this.V1(l,a,t)}}},H.prototype.g1=function(i){if(!this.rows[i])return this.rows[i]=[],this.v1(i,null),this.rows[i];this.reportError("The row in table has existed: ")},T.findItemInList=function(i,t){for(var s=0,r=t.length;s<r;++s)if(t[s]===i)return s;return-1},T.removeItemInList=function(i,t){i=T.findItemInList(i,t);return!(i<0)&&(t.splice(i,1),!0)},T.addUniqueItemInList=function(i,t){return!(0<=T.findItemInList(i,t))&&(t.push(i),!0)},T.setAttrOnItems=function(i,t,s){for(var r=0,h=i.length;r<h;++r)i[r][t]=s},T.copyMethodsFrom=function(i,t){for(var s=C(t),r=0,h=s.length;r<h;++r){var o=s[r];i[o]=function(){var i=t[o];return function(){return i.apply(t,arguments)}}()}return i};var C=function(i){var t,s,r=[];for(t in i)(s=i[t])&&"function"==typeof s&&r.push(t);return r};function V(i){this.reportError=i,
this.nt=[],this.Tt=new H(this.reportError),this.B1=0,this.A1=0,this.lt=k.TopToBottom,this.wt=k.BottomToTop,this.ct=k.LeftToRight,this.pt=k.RightToLeft}function D(i,t,s,r,h,o,e,n,l){this.layoutSessionData=i,this.changeStateObj=t,this.reportError=t.reportError,this.edgeDist=this.layoutSessionData.edgeDist,this.nodeDist=this.layoutSessionData.nodeDist,this.q1=this.layoutSessionData.minSegmentLength;t=this.layoutSessionData.zo;this.G1=D.el(this.changeStateObj,t,this.edgeDist),this.P1=D.nl(this.changeStateObj,t,this.edgeDist,this.q1),this.I1=s,this.U1=r,this.j1=h,this.E1=o,this.F1=e,this.z1=n,this.X1=l,this.Y1=[]}function N(i,t,s,r,h,o){this.layoutSessionData=i,this.changeStateObj=t,this.hostInterfaceObj=t.hostInterfaceObj,this.reportError=t.reportError,this.edgeDist=this.layoutSessionData.edgeDist,this.q1=this.layoutSessionData.minSegmentLength;t=this.layoutSessionData.zo;this.G1=D.el(this.changeStateObj,t,this.edgeDist),this.P1=D.nl(this.changeStateObj,t,this.edgeDist,this.q1),
this.vPathSegList=r,this.hPathSegList=s,this._1=h,this.W1=o,this.I1="right",this.U1={x:0,y:0},this.j1=null,this.Z1=null,this.z1=null,this.X1=null,this.J1=null,this.K1={H:"down",V:"right"}}function B(i,t,s,r,h,o,e){n.DistributeAlgorithm.call(this,o,e);e=(this.layoutSessionData=i).edgeDist;this.setEdgeDist(e.x,e.y);i=this.layoutSessionData.edgeToNodeDist,i=this.el(i,e);this.setEdgeToNodeDist(i.x,i.y);e=this.nl(e);this.setMinRunOut(e.x,e.y),this.Q1(t,s,r,h)}function A(i,t,s){this.layoutSessionData=i,this.changeStateObj=t,this.hostInterfaceObj=t.hostInterfaceObj,this.reportError=this.hostInterfaceObj.reportError,this.li=s,this.ho=new o(this.layoutSessionData,this.changeStateObj,this.li),this.edgeDist=this.layoutSessionData.edgeDist,this.tc=this.layoutSessionData.Vo;t=new n.HVSegmentManager(t.cList,t.nList,this.reportError);t.sc(!0),t.rc(this.edgeDist.x,this.edgeDist.y),t.hc(),this.hPathSegList=t.oc("H"),this.vPathSegList=t.oc("V"),this._1=new n.RankIndexSegManager(this.hPathSegList,
this.edgeDist.y,this.reportError),this.W1=new n.RankIndexSegManager(this.vPathSegList,this.edgeDist.x,this.reportError),this.ec=new N(this.layoutSessionData,this.changeStateObj,this.hPathSegList,this.vPathSegList,this._1,this.W1),this.nc=new B(this.layoutSessionData,this.hPathSegList,this.vPathSegList,this._1,this.W1,this.changeStateObj,this.reportError)}function q(i,t,s,r){this.layoutSessionData=i,this.changeStateObj=t,this.hostInterfaceObj=t.hostInterfaceObj,this.reportError=t.reportError,this.li=s,this.ho=new o(this.layoutSessionData,this.changeStateObj,this.li),this.ci=new h(this.layoutSessionData,this.changeStateObj),this.edgeDist=this.layoutSessionData.edgeDist,this.zo=this.layoutSessionData.zo,this.Li={top:"up",bottom:"down",left:"left",right:"right"},this.lc=r,this.fs()}T.Map=n.NormalObjectMap,V.prototype.It=function(){return this.Tt},V.prototype.ac=function(i,t){t=this.Tt.m1(i,t);return t?t.Zn():null},V.prototype.Dt=function(i,t,s,r){var h=this.Tt;if(!h.m1(t,s)){i=this.rt(i)
;return h.w1(i,t,s),i}r&&this.reportError("The target cell has been occupied.")},V.prototype.rt=function(i){i=new L(i,this.reportError);return this.nt.push(i),i},V.prototype.removeNode=function(i){this.Tt.b1(i),T.removeItemInList(i,this.nt)},V.prototype.Et=function(i,t){this.B1=i,this.A1=t},V.prototype.dc=function(i){for(var t=[],s=0,r=i.length;s<r;++s){var h=i[s];null!==h.ir&&null!==h.ic||t.push(h)}return t},V.prototype.fc=function(i){for(var t=[],s=0,r=i.length;s<r;++s){var h=i[s];null!==h.ir&&null!==h.ic&&t.push(h)}return t},V.prototype.uc=function(i,t){var s,r,h=this.Tt;if(t===this.ct||t===this.pt){if(s=h.minRow,r=h.maxRow,h.S1(i,s,r))return!0}else if(s=h.minCol,r=h.maxCol,h.R1(i,s,r))return!0;return!1},V.prototype.cc=function(i,t,s,r){var h=this.Tt;if(r===this.ct||r===this.pt){if(h.S1(i,t,s))return!0}else if(h.R1(i,t,s))return!0;return!1},V.prototype.At=function(i,t,s,r){r===this.ct||r===this.pt?this.Tt.w1(i,s,t):this.Tt.w1(i,t,s)},V.prototype.wc=function(i,t,s,r,h){for(
var o=r-s+1,e=0;e<o;++e)this.At(i[e],t,s+e,h)},V.prototype.gc=function(i,t,s){var r=i,h=t;return s!==this.ct&&s!==this.pt||(r=t,h=i),this.Tt.m1(r,h)},V.prototype.getLayerSeqOfNode=function(i,t){var s=i.ir,r=i.ic;return t!==this.ct&&t!==this.pt||(s=i.ic,r=i.ir),{layer:s,seq:r}},V.prototype.vc=function(i,t,s){var r=i,h=t;return s!==this.ct&&s!==this.pt||(r=t,h=i),{ir:r,ic:h}},V.prototype.bc=function(i,t,s){var r=i,h=t;return s!==this.ct&&s!==this.pt||(r=t,h=i),{layer:r,seq:h}},V.prototype.pc=function(i,t,s){i=this.getLayerSeqOfNode(i,s),s=this.getLayerSeqOfNode(t,s);return i.seq===s.seq},V.prototype.St=function(i,t){i=i.tabNode;if(!t||i)return i;this.reportError("Table node does not exist for seed node.")},V.prototype.qi=function(){for(var i=this.nt,t=0,s=i.length;t<s;++t){var r=i[t];r.refNode.tabNode=null,r.refNode=null}},V.prototype.mc=function(i,t){return t===this.ct||t===this.pt?this.Tt.y1(i):this.Tt.k1(i)},V.prototype.N1=function(i,t){this.Tt.N1(i,t)},D.prototype.kc=function(i,t){
i?i.moving||(i.moving=!0,this.Y1.push({objectRef:i,type:t}),"node"===t?this.yc(i):"seg"===t?this.xc(i):"gSeg"===t?this.Mc(i):"gp"===t&&this.Oc(i)):this.reportError("RsopListDependentObjects: invalid object reference for type "+t)},D.prototype.Rc=function(i){for(var t,s=this.j1,r=s.length,h=0;h<r;++h)(t=s[h]).moving||this.Sc(i,{x:t.x,y:t.y,w:t.w,h:t.h})&&this.kc(t,"node");this.Lc(i)},D.prototype.Lc=function(i){for(var t,s,r,h=this.z1,o=h.length,e=0;e<o;++e)if(t=(r=h[e]).sideSeg1,s=r.sideSeg2,!t.moving){if(r=this.Hc(t),this.Sc(i,r)){t.moving=!0,this.kc(t.node,"halt");break}s.moving||(r=this.Hc(s),this.Sc(i,r)&&this.kc(s,"gSeg"))}},D.prototype.Tc=function(i){for(var t,s="right"===this.I1?"V":"H",r=this.F1.Cc(i,s),h=r.length,o=0;o<h;++o)(t=r[o]).moving||this.Sc(i,this.Hc(t))&&this.kc(t,"seg")},D.prototype.Vc=function(i){for(var t,s=this.X1,r=s.length,h=0;h<r;++h)for(var o,e=(o=s[h].gpList).length,n=0;n<e;++n)(t=o[n])&&this.Sc(i,this.Dc(t))&&this.kc(t,"gp")},D.prototype.yc=function(i){
this.Nc(i),this.Bc(i);var t=this.Ac(i);this.Rc(t),t=this.qc(i),this.Tc(t)},D.prototype.xc=function(i){this.Gc(i);var t=this.Pc(i);this.Rc(t),t=this.Ic(i),this.Tc(t),this.Vc(t)},D.prototype.Mc=function(i){var t=i.node,s=i.nodeSide;"top"!==s&&"left"!==s?(this.Uc(t,s),s=this.Hc(i),i=this.Ac(s),this.Rc(i),i=this.qc(s),this.Tc(i)):this.kc(t,"halt")},D.prototype.Oc=function(i){var t=i.segList;if(t)for(var s,r=t.length,h=0;h<r;++h)s=t[h],this.kc(s,"seg");o=this.jc(i),this.Tc(o);var o=this.Dc(i),e=0,n=0,l=i.changePort;l&&(e=l.w,n=l.h);var a=this.edgeDist.x,l=this.edgeDist.y;o.w=a*(Math.floor(e/(2*a))+2),o.h=l*(Math.floor(n/(2*l))+2),this.Lc(o);i=i.changeNode.gluePointLists[i.nodeSide][i.rank+1];i&&this.kc(i,"gp")},D.prototype.Nc=function(i){if(i._n){var t;if(i.Qh)for(var s,r=(s="right"===this.I1?i.inGroupNodeSegList.V:i.inGroupNodeSegList.H).length,h=0;h<r;++h)t=s[h],this.kc(t,"seg");for(var o,e=i._n,n=e.length,l=0;l<n;++l)if(!(o=e[l]).ignore&&!o.moving){if(o.rsopCanOnlyExpand){this.kc(o,
"halt");break}this.kc(o,"node"),o.Qh&&this.Nc(o)}}},D.prototype.Bc=function(i){for(var t,s=i.segList,r=s.length,h=0;h<r;++h)(t=s[h]).moving||this.Ec(t,i)},D.prototype.Uc=function(i,t){for(var s,r,h=i.segList,o=h.length,e=0;e<o;++e)(s=h[e]).moving||(r=s.nodeSide1,(r=s.node2===i?s.nodeSide2:r)===t&&this.Ec(s,i))},D.prototype.Ec=function(i,t){var s=i.nodeSide1,r=i.p1,h=i.seg2;t===i.node2&&(s=i.nodeSide2,r=i.p2,h=i.seg1),"right"===this.I1?"V"===i.type?this.kc(i,"seg"):"left"===s?!1===r.moving&&this.kc(r,"pnt"):(this.kc(r,"pnt"),h&&Math.abs(i.p2.x-i.p1.x)<=this.P1.x&&this.kc(h,"seg")):"H"===i.type?this.kc(i,"seg"):"top"===s?this.kc(r,"pnt"):(this.kc(r,"pnt"),h&&Math.abs(i.p2.y-i.p1.y)<=this.P1.y&&this.kc(h,"seg"))},D.prototype.Gc=function(i){var t=i.node1;t&&!1===t.moving&&!1===t.rsopCanOnlyExpand&&this.kc(t,"node"),(t=i.node2)&&!1===t.moving&&!1===t.rsopCanOnlyExpand&&this.kc(t,"node"),(t=i.seg1)&&!1===t.moving&&this.Fc(t,i),(t=i.seg2)&&!1===t.moving&&this.Fc(t,i),(t=i.gp1
)&&t.changeNode.rsopCanOnlyExpand&&this.kc(t,"gp"),(t=i.gp2)&&t.changeNode.rsopCanOnlyExpand&&this.kc(t,"gp")},D.prototype.Fc=function(i,t){var s,r,h=i.node1,o=i.nodeSide1,e=i.seg1;i.seg1===t&&(h=i.node2,o=i.nodeSide2,e=i.seg2),"H"===t.type?(s=t.p1.y,Math.min(i.p1.y,i.p2.y)<s||Math.abs(i.p2.y-i.p1.y)>this.P1.y||(e?this.kc(e,"seg"):h?h.rsopCanOnlyExpand?"top"===o?this.kc(h,"halt"):(r=this.zc(h,o),this.kc(r,"gSeg")):this.kc(h,"node"):this.reportError("RsopListDependentObjects - addSegAttachedToSeg: dangling H segment"))):(s=t.p1.x,Math.min(i.p1.x,i.p2.x)<s||Math.abs(i.p2.x-i.p1.x)>this.P1.y||(e?this.kc(e,"seg"):h?h.rsopCanOnlyExpand?"left"===o?this.kc(h,"halt"):(r=this.zc(h,o),this.kc(r,"gSeg")):this.kc(h,"node"):this.reportError("RsopListDependentObjects - addSegAttachedToSeg: dangling V segment")))},D.prototype.Ac=function(i){var t={x:0,y:0,w:0,h:0};return"right"===this.I1?(t.x=i.x+i.w,t.y=i.y-this.nodeDist.y,t.w=this.nodeDist.x+this.U1.x,t.h=i.h+2*this.nodeDist.y):(
t.x=i.x-this.nodeDist.x,t.y=i.y+i.h,t.w=i.w+2*this.nodeDist.x,t.h=this.nodeDist.y+this.U1.y),t},D.prototype.qc=function(i){var t={x:0,y:0,w:0,h:0};return"right"===this.I1?(t.x=i.x+i.w,t.y=i.y-this.G1.y,t.w=this.G1.x+this.U1.x,t.h=i.h+2*this.G1.y):(t.x=i.x-this.G1.x,t.y=i.y+i.h,t.w=i.w+2*this.G1.x,t.h=this.G1.y+this.U1.y),t},D.prototype.Pc=function(i){i=this.Hc(i);return"right"===this.I1?(i.y-=this.G1.y,i.w+=this.G1.x,i.h+=2*this.G1.y):(i.x-=this.G1.x,i.w+=2*this.G1.x,i.h+=this.G1.y),i},D.prototype.Ic=function(i){i=this.Hc(i);return"right"===this.I1?(i.x+=this.edgeDist.x,i.y-=this.edgeDist.y,i.w=this.edgeDist.x,i.h+=2*this.edgeDist.y):(i.x-=this.edgeDist.x,i.y+=this.edgeDist.y,i.w+=2*this.edgeDist.x,i.h=this.edgeDist.y),i},D.prototype.jc=function(i){i=this.Dc(i);return"right"===this.I1?(i.x+=this.edgeDist.x,i.y-=this.edgeDist.y,i.w=this.edgeDist.x,i.h+=2*this.edgeDist.y):(i.x-=this.edgeDist.x,i.y+=this.edgeDist.y,i.w+=2*this.edgeDist.x,i.h=this.edgeDist.y),i},D.prototype.Hc=function(i){
var t={x:Math.min(i.p1.x,i.p2.x),y:Math.min(i.p1.y,i.p2.y),w:Math.abs(i.p2.x-i.p1.x),h:Math.abs(i.p2.y-i.p1.y)};return"H"===i.type?t.h=this.edgeDist.y:t.w=this.edgeDist.x,t},D.prototype.Dc=function(i){i=i.getPoint();return{x:i.x-this.edgeDist.x/2,y:i.y-this.edgeDist.y/2,w:this.edgeDist.x,h:this.edgeDist.y}},D.prototype.Sc=function(i,t){var s=i.x,r=i.y,h=t.x,o=t.y;return!(s+i.w<=h)&&(!(r+i.h<=o)&&(!(s>=h+t.w)&&!(r>=o+t.h)))},D.prototype.zc=function(i,t){for(var s,r,h=this.z1,o=h.length,e=0;e<o;++e)if((r=(s=h[e]).sideSeg1).node===i)return r.nodeSide===t?r:s.sideSeg2;return this.reportError("RsopListDependentObjects: group node segment not found"),null},D.prototype.Xc=function(i,t){for(var s,r,h=this.Y1,o=h.length,e=(this.I1,0);e<o;++e){if("halt"===(n=(r=h[e]).type))return this.Yc(),!0;if("node"===n)s=this.qc(r.objectRef);else if("seg"===n){if(r.objectRef.rsopBundledSeg)continue;s=this.Ic(r.objectRef)}else if("gSeg"===n)s=this.Ic(r.objectRef);else{if("gp"!==n)continue;var n=(
l=r.objectRef.getPoint()).x,l=l.y;"right"===this.I1?(n+=this.edgeDist.x,--l):(--n,l+=this.edgeDist.y),s={x:n,y:l,w:2,h:2}}if(this.Sc(s,i))return this.Yc(),!0;if(t&&-1<t.indexOf(r.objectRef))return this.Yc(),!0}return!1},D.prototype.Yc=function(){for(var i=this.Y1,t=i.length,s=0;s<t;++s)i[s].objectRef.moving=!1},D.nl=function(i,t,s,r){var h=r.x,r=r.y,t=D._c(t,s),h=Math.max(h,t.x),r=Math.max(r,t.y);return{x:Math.max(1,Math.ceil(h/s.x))*s.x,y:r=Math.max(1,Math.ceil(r/s.y))*s.y}},D.el=function(i,t,s){var r=i.layoutSessionData.edgeToNodeDist,i=r.x,r=r.y,t=D._c(t,s),i=Math.max(i,t.x),r=Math.max(r,t.y);return{x:i=Math.max(1,Math.ceil(i/s.x))*s.x,y:Math.max(1,Math.ceil(r/s.y))*s.y}},D._c=function(i,t){var s=t.x*Math.max(1,Math.ceil(i.w/2/t.x)),r=t.y*Math.max(1,Math.ceil(i.h/2/t.y));return s===i.w/2&&(s+=t.x),r===i.h/2&&(r+=t.y),{x:s,y:r}},N.prototype.Wc=function(i,t,s){if(!(i.length<1)){var r,h,o=this.Zc(i,0,s);this.I1=this.K1[s],this.Jc(o),this.Kc(),this.U1.x=0,this.U1.y=0,"right"===this.I1?(
r=this.vPathSegList,h=this.W1,this.U1.x=this.edgeDist.x):(r=this.hPathSegList,h=this._1,this.U1.y=this.edgeDist.y),this.J1=new D(this.layoutSessionData,this.changeStateObj,this.I1,this.U1,this.j1,r,h,this.z1,this.X1);for(var e=this.J1,n=i.length,l=0;l<n;++l)e.kc(i[l],"seg");e.Xc(o,t)||(this.Qc(e.Y1,s),this.$c(),this.iw())}},N.prototype.tw=function(i,t,s){for(var r,h=[],o=t.length,e=1,n=0;n<o;++n)(r=t[n]).port1||r.port2?e=0:h.push(r);if(!(h.length<=e))for(var l,a,d,f,u,i="H"===s?(a="y",d="h",l=this.edgeDist.y,f=h[0].p1.y,Math.max(Math.floor((f-i.y)/l)-1,0)):(a="x",d="w",l=this.edgeDist.x,f=h[0].p1.x,Math.max(Math.floor((f-i.x)/l)-1,0)),o=h.length,c=l,n=i+e;n<o;++n){c+=l,(u=this.Zc(h,n,s))[a]=f,u[d]=c;var w=t.slice(n);if(!1===this.sw(u,t,w,s))break}},N.prototype.sw=function(i,t,s,r){var h=!0,o=!0,e=this.layoutSessionData.minSegmentLength;0!==e.x&&0!==e.y||(o=!1);var n,l,a,d,f,u,c=i.x,w=i.y,e=i.w,i=i.h,g={x:c,y:w,w:e,h:i};this.I1=this.K1[r],this.Jc(g),this.Kc(),u="right"===this.I1?(
n=this.vPathSegList,l=this.W1,a=this.edgeDist.x,d=e-(c-Math.floor(c/a)*a),f="x","w"):(n=this.hPathSegList,l=this._1,a=this.edgeDist.y,d=i-(w-Math.floor(w/a)*a),f="y","h"),this.U1.x=0,this.U1.y=0,this.U1[f]=a,this.J1=new D(this.layoutSessionData,this.changeStateObj,this.I1,this.U1,this.j1,n,l,this.z1,this.X1);var v=this.J1;this.rw(t,!0);for(var b=Math.ceil(d/a),p=0,m=0;m<b;++m)if(p+=a,p=Math.min(p,d),g[u]=p,v.Y1=[],this.Rc(g),this.Tc(l,g,r),this.Vc(g),o&&(this.hw(g),this.ow(g,s)),!(v.Y1.length<1)){if(v.Xc(g)){h=!1;break}this.Qc(v.Y1,r)}return this.rw(t,!1),this.$c(),this.iw(),h},N.prototype.rw=function(i,t){for(var s=i.length,r=0;r<s;++r)i[r].rsopBundledSeg=t},N.prototype.Qc=function(i,t){var s=[],r=this.U1.x,h=this.U1.y,o=this._1,e=h;"V"===t&&(o=this.W1,e=r);for(var n,l,a,d,f,u,c=i.length,w=0;w<c;++w){var g,v=(g=i[w]).objectRef,b=g.type;v.moving=!1,"seg"===b?(g=v.ew(),o.nw(v,g,g=g+e),v.lw(g)):"gSeg"===b?(v.p1.x+=r,v.p1.y+=h,v.p2.x+=r,v.p2.y+=h):"gp"===b?"attachment"===v.type&&s.push(
v.changePort):(v.x+=r,v.y+=h,v.Jh&&!v.Qh&&this.aw(v,r,h))}for(c=s.length,w=0;w<c;++w)d=(l=(a=(n=s[w]).Hu).changeNode).gluePointLists[a.nodeSide],this.dw(d,n);var p=this.X1,c=p.length;for(w=0;w<c;++w)d=(f=p[w]).gpList,l=f.node,u=f.nodeSide,f=this.fw(d),l.gluePointLists[u]=f},N.prototype.aw=function(i,t,s){for(var r,h=i._n,o=h.length,e=0;e<o;++e)(r=h[e]).x+=t,r.y+=s,null!==r._n&&this.aw(r,t,s)},N.prototype.dw=function(i,t){for(var s,r=i.length,h=0;h<r;++h)(s=i[h])&&s.changePort===t&&++s.rank},N.prototype.fw=function(i){for(var t,s=[],r=i.length,h=0;h<r;++h)(t=i[h])&&(s[t.rank]=t);return s},N.prototype.Jc=function(i){this.j1=[],this.Z1=[];for(var t,s=this.j1,r=this.Z1,h=this.changeStateObj.nList,o=h.length,e=0;e<o;++e)(t=h[e]).ignore||(this.uw(t,i)?(r.push(t),t.rsopCanOnlyExpand=!0):(s.push(t),t.rsopCanOnlyExpand=!1))},N.prototype.uw=function(i,t){if(!1===i.Qh)return!1;if(i._n.length<1)return!1;var s=t.x,r=t.y,h=s+t.w,o=r+t.h,e=i.x,n=i.y,t=i.w,i=i.h;if(h<=e)return!1;if(o<=n)return!1;if(
e+t<=s)return!1;if(n+i<=r)return!1;if("right"===this.I1){if(s<e&&e<=h)return!1}else if(r<n&&n<=o)return!1;return!0},N.prototype.Kc=function(){this.z1=[],this.X1=[];for(var i=this.Z1,t=i.length,s=0;s<t;++s)this.cw(i[s])},N.prototype.cw=function(i){var t,s,r=i.x,h=i.y,o=i.w,e=i.h,n={x:r,y:h},l={x:r+o,y:h},o={x:r+o,y:h+e},e={x:r,y:h+e};"right"===this.I1?(s={p1:l,p2:o,type:"V",node:i,nodeSide:"right",moving:!(t={p1:n,p2:e,type:"V",node:i,nodeSide:"left",moving:!1})},this.ww(i,"top"),this.ww(i,"bottom")):(s={p1:e,p2:o,type:"H",node:i,nodeSide:"bottom",moving:!(t={p1:n,p2:l,type:"H",node:i,nodeSide:"top",moving:!1})},this.ww(i,"left"),this.ww(i,"right")),this.z1.push({sideSeg1:t,sideSeg2:s})},N.prototype.ww=function(i,t){var s=i.gluePointLists[t];this.X1.push({gpList:s,node:i,nodeSide:t})},N.prototype.hw=function(i){var t=this.J1,s=this.I1,r=this.G1,h={x:i.x,y:i.y,w:i.w,h:i.h};"right"===s?h.w-=this.edgeDist.x:h.h-=this.edgeDist.y;for(var o=this.j1,e=0,n=o.length;e<n;++e){var l,a=o[e]
;a.moving||(l={x:a.x,y:a.y,w:a.w,h:a.h},"right"===s?(l.x-=r.x,l.w+=2*r.x):(l.y-=r.y,l.h+=2*r.y),this.gw(h,l)&&t.kc(a,"node"))}this.vw(h)},N.prototype.vw=function(i){for(var t,s,r,h=this.J1,o=this.G1,e=this.z1,n=e.length,l=0;l<n;++l)if(t=(r=e[l]).sideSeg1,s=r.sideSeg2,!t.moving){if(r=this.Hc(t),"H"===t.type?(r.y-=o.y,r.h+=2*o.y):(r.x-=o.x,r.w+=2*o.x),this.gw(i,r)){t.moving=!0,h.kc(t.node,"halt");break}s.moving||(r=this.Hc(s),"H"===s.type?(r.y-=o.y,r.h+=2*o.y):(r.x-=o.x,r.w+=2*o.x),this.gw(i,r)&&h.kc(s,"gSeg"))}},N.prototype.ow=function(i,t){var s=this.I1,r=i.y+i.h-this.edgeDist.y;"right"===s&&(r=i.x+i.w-this.edgeDist.x);for(var h=0,o=t.length;h<o;++h)this.bw(t[h],r)},N.prototype.bw=function(i,t){if(!i.port1&&!i.port2){var s=i.ew(),r=t-s;if(!(r<=0))for(var h=this.P1,o=this.J1,e=[i.seg1,i.seg2],n=0,l=e.length;n<l;++n){var a,d,f,u=e[n];u&&(a=u.node1,d=u.nodeSide1,a||(a=u.node2,d=u.nodeSide2),a&&(a.moving||("H"===i.type?Math.min(u.p1.y,u.p2.y)<s||Math.abs(u.p2.y-u.p1.y)-r<h.y&&(
a.rsopCanOnlyExpand?"top"===d?o.kc(a,"halt"):(f=o.zc(a,d),o.kc(f,"gSeg")):o.kc(a,"node")):Math.min(u.p1.x,u.p2.x)<s||Math.abs(u.p2.x-u.p1.x)-r<h.x&&(a.rsopCanOnlyExpand?"left"===d?o.kc(a,"halt"):(f=o.zc(a,d),o.kc(f,"gSeg")):o.kc(a,"node")))))}}},N.prototype.Rc=function(i){for(var t,s=this.J1,r=this.j1,h=r.length,o=0;o<h;++o)(t=r[o]).moving||this.gw(i,{x:t.x,y:t.y,w:t.w,h:t.h})&&s.kc(t,"node");this.Lc(i)},N.prototype.Lc=function(i){for(var t,s,r,h=this.J1,o=this.z1,e=o.length,n=0;n<e;++n)if(t=(r=o[n]).sideSeg1,s=r.sideSeg2,!t.moving){if(r=this.Hc(t),this.gw(i,r)){t.moving=!0,h.kc(t.node,"halt");break}s.moving||(r=this.Hc(s),this.gw(i,r)&&h.kc(s,"gSeg"))}},N.prototype.Tc=function(i,t,s){for(var r,h=this.J1,o=i.Cc(t,s),e=o.length,n=0;n<e;++n)(r=o[n]).moving||r.rsopBundledSeg||this.gw(t,this.Hc(r))&&h.kc(r,"seg")},N.prototype.Vc=function(i){for(var t,s=this.J1,r=this.X1,h=r.length,o=0;o<h;++o)for(var e,n=(e=r[o].gpList).length,l=0;l<n;++l)(t=e[l])&&this.gw(i,this.Dc(t))&&s.kc(t,"gp")},
N.prototype.Hc=function(i){var t={x:Math.min(i.p1.x,i.p2.x),y:Math.min(i.p1.y,i.p2.y),w:Math.abs(i.p2.x-i.p1.x),h:Math.abs(i.p2.y-i.p1.y)};return"H"===i.type?t.h=0:t.w=0,t},N.prototype.Zc=function(i,t,s){for(var r,h=i.length,o=i[t],e=Math.min(o.p1.x,o.p2.x),n=Math.min(o.p1.y,o.p2.y),l=e+Math.abs(o.p2.x-o.p1.x),a=n+Math.abs(o.p2.y-o.p1.y),d=t+1;d<h;++d)o=i[d],r=this.Hc(o),e=Math.min(e,r.x),n=Math.min(n,r.y),l=Math.max(l,r.x+r.w),a=Math.max(a,r.y+r.h);t={x:e,y:n,w:l-e,h:a-n};return"H"===s?t.h=this.edgeDist.y:t.w=this.edgeDist.x,t},N.prototype.Dc=function(i){i=i.getPoint();return{x:i.x,y:i.y,w:0,h:0}},N.prototype.gw=function(i,t){var s=i.x,r=i.y,h=t.x,o=t.y;if("right"===this.I1){if(s+i.w<=h)return!1;if(s>=h+t.w)return!1;if(r+i.h<o)return!1;if(r>o+t.h)return!1}else{if(r>=o+t.h)return!1;if(r+i.h<=o)return!1;if(s+i.w<h)return!1;if(s>h+t.w)return!1}return!0},N.prototype.iw=function(){for(var i,t,s,r,h,o=this.z1,e=o.length,n=0;n<e;++n)r=(s=o[n]).sideSeg1,h=s.sideSeg2,i=r.node,t=r.p1.x,s=r.p1.y
,r=h.p2.x,h=h.p2.y,i.x=t,i.y=s,i.w=r-t,i.h=h-s},N.prototype.$c=function(){for(var i,t,s,r=this.hostInterfaceObj,h=this.changeStateObj.cList,o=h.length,e=0;e<o;++e)if(!(s=h[e]).ignore&&null!==(i=s.Bi)){for(var n=[],l=i.length,a=0;a<l;++a)t=i[a],n.push(r.makePoint(t.x,t.y));s.su=n}},B.prototype.nl=function(i){var t=this.layoutSessionData.minSegmentLength,s=t.x,t=t.y;return{x:s=0<s&&s<i.x?i.x:s,y:t=0<t&&t<i.y?i.y:t}},B.prototype.el=function(i,t){var s=i.x,i=i.y;return{x:s=0<s&&s<t.x?t.x:s,y:i=0<i&&i<t.y?t.y:i}},B.prototype.pw=function(i,t){if(!(i.length<2)){var s=i[0].ew(),r=this.mw(i),h=r.lowSegList,o=r.highSegList,e=r.fixSegList,n=h.concat(o),i=this.kw(n,t);if(n.length<1)return i;r=i.min,h=i.max;if(null===r)return i;if(null===h)return i;var o=this.xw.yw,l=o.y;"V"===t&&(l=o.x);o=(h-r)/(n.length+1);if(l<=(o=0<e.length?(h-r)/(n.length+1+1):o))return i;var a=this.Mw([i]),r=Math.max(Math.floor((s-r)/l)-1,0),d=s;0<e.length&&(d=s+l);for(var f=r,u=n.length;f<u;++f){var c=n.slice(f),w=this.kw(c,
t),c=w.max;if(a.max=d+l,a.maxPad=0,null!==c&&c<=d){a.max=c,a.maxPad=w.maxPad;break}d+=l}return a}this.Zf("RsopDistribute: the num of overlaps is small than 2.")},B.prototype.Ow=function(i,t,s){if(t){if(!(i.length<1)){var r=i[0].ew(),h=t.min,o=t.max,e=t.minPad,n=t.maxPad;if(null!==h&&r<h)this.Zf("RsopDistribute: min rank is bigger than rank");else if(null!==o&&o<r)this.Zf("RsopDistribute: max rank is smaller than rank");else{var l=this.xw.yw,t=l.y;"V"===s&&(t=l.x);var a=i.length,d=0,f=null;if(null!==h&&null!==o){if(f=t<=(d=(o-h)/(a+1))?h<(l=r-(a-1)*(d=t))?l:r+(a-1)*t<o?r:h+d:(this.Rw&&(d=((o-=n)-(h+=e))/(a+1)),h+(d=d<0?0:d)),0===d)return;e=Math.floor(f/t)*t;e<=h&&(e+=t),e+(a-1)*t<o&&(f=e,d=t)}else if(null!==h&&null===o)d=t,f=r;else if(null===h&&null!==o)f=r-(a-1)*(d=t);else{if(null!==h||null!==o)return void this.Zf("RsopDistribute: unknown status");f=r-(a-1)*(d=t)}for(var u="V"===s?this.W1:this._1,c=0;c<a;++c){var w=i[c];u.nw(w,r,f),w.lw(f),f+=d}}}}else this.Zf(
"The input limit is null.")},B.prototype.Sw=function(i,t,s,r){if(s){if(!(i.length+t.length<1)){var h=s.min,o=s.max,e=s.minPad,n=s.maxPad,l=null;if(0<i.length&&(l=i[0].ew()),0<t.length&&(l=t[0].ew()),null!==h&&l<h)this.Zf("RsopDistribute: min rank is bigger than rank");else if(null!==o&&o<l)this.Zf("RsopDistribute: max rank is smaller than rank");else{var a=this.xw.yw,s=a.y;if("V"===r&&(s=a.x),null!==h&&null!==o){var d=i.length+t.length+1;if(0===(b=(b=s<(b=(o-h)/(d+1))?s:b)<s&&(b=this.Rw?((o-=n)-(h+=e))/(d+1):b)<0?0:b))return;var f=Math.round((l-h)/b)-1,u=Math.round((o-l)/b)-1;u<0&&(u=0);var c=[],w=[];if((f=f<0?0:f)>=i.length)if(u>=t.length)c=i.slice(0),w=t.slice(0);else{for(var c=i.slice(0),g=t.length-u,v=0;v<g;++v)c.push(t[v]);for(v=g;v<t.length;++v)w.push(t[v])}else{for(v=0;v<f;++v)c.push(i[v]);for(v=f;v<i.length;++v)w.push(i[v]);w=w.concat(t)}c.length+w.length!==i.length+t.length&&this.Zf("RsopDistribute: the total number of segments is not correct."),s<(b=(l-h)/(c.length+1))&&(b=s)
;d=l-(c.length+1)*b;0<(u=this.Lw(c,d,l,b,r)).length&&this.Zf("RsopDistribute: some segments are not moved in (minRank, rank)."),s<(b=(o-l)/(w.length+1))&&(b=s),0<(u=this.Lw(w,l,o,b,r)).length&&this.Zf("RsopDistribute: some segments are not moved in (rank, maxRank).")}else if(null!==h&&null===o){var b=s;(d=l-(i.length+1)*s)<h+e&&(h+=e,d=l-Math.floor((l-h)/b)*b);var p=(u=this.Lw(i,d,l,b,r)).concat(t);0<(u=this.Lw(p,l,null,b,r)).length&&this.Zf("RsopDistribute: some segments are not moved.")}else if(null===h&&null!==o){b=s,e=l+(t.length+1)*s;o-n<e&&(o-=n,e=l+Math.floor((o-l)/b)*b),t.reverse();u=this.Lw(t,e,l,0-b,r);i.reverse();p=u.concat(i);0<(u=this.Lw(p,l,null,0-b,r)).length&&this.Zf("RsopDistribute: some segments are not moved.")}else{if(null!==h||null!==o)return void this.Zf("RsopDistribute: unknown status");b=s,d=l-(i.length+1)*s;0<(u=this.Lw(i,d,l,b,r)).length&&this.Zf("RsopDistribute: some segments are not moved."),0<(u=this.Lw(t,l,null,b,r)).length&&this.Zf(
"RsopDistribute: some segments are not moved.")}}}}else this.Zf("The input limit is null.")},B.prototype.Lw=function(i,t,s,r,h){if(null==t)return this.Zf("RsopDistribute: input start rank is null"),[];if(i.length<1)return[];for(var o="V"===h?this.W1:this._1,e=0,n=0,l=i.length;n<l;++n){var a=t+(n+1)*r;if(null!==s&&(0<r?s<=a:a<=s))break;var d=i[n];o.nw(d,d.ew(),a),d.lw(a),++e}for(var f=[],n=e,l=i.length;n<l;++n)f.push(i[n]);return f},t.common.ObjectHelper.inherit(B,n.DistributeAlgorithm),A.prototype.Hw=function(){this.Tw(this.hPathSegList,"H",this.tc),this.Tw(this.vPathSegList,"V",this.tc),this.Cw(this.hPathSegList,"H"),this.Cw(this.vPathSegList,"V")},A.prototype.Tw=function(i,t,s){for(var r,h,o,e=this.nc,n=e.Vw(i),l=n.shift(),a=[];l;)l.length<2?l=n.shift():(r=(l=e.Dw(l))[0].ew(),(h=e.Nw(l,t))&&s&&(this.Ui(l,t,h),this.ho.So(),l=(o=e.Bw(l,r)).leftSegs,a=o.movedSegs,e.Aw(n,a)),e.qw(l,t),s&&(l=(o=e.Bw(l,r)).leftSegs,this.Gw(l,t),e.Aw(n,null)),l=n.shift())},A.prototype.Cw=function(i,t){
this.nc.Cw(i,t)},A.prototype.Ui=function(i,t,s){this.nc;var r=this.ec,h="x",o="w",e=this.edgeDist.x;"H"===t&&(h="y",o="h",e=this.edgeDist.y);for(var n,l=i,a=i[0].p1[h],d=!0;d&&1<l.length;)d=!1,r.tw(s,l,t),(n=this.Pw(l,h,a)).length!==l.length&&(d=!0,s[o]=e*((l=n).length+1))},A.prototype.Gw=function(i,t){if(!(i.length<1))for(var s=this.nc,r=this.ho,h=s.Iw(i,t),o=h?h.length:0,e=1;e<o-1;++e){var n=h[e],l=n.segs;l.length<2||(n=(l=s.Uw(l,n.posA,n.posB,t))?l.movableSegs:null,l=l?l.remainSegs:null,n&&(this.ec.Wc(n,l,t),r.So()))}},A.prototype.Pw=function(i,t,s){for(var r,h=[],o=i.length,e=0;e<o;++e)(r=i[e]).p1[t]===s&&h.push(r);return h},q.prototype.fs=function(){this.jw(this.layoutSessionData.at)?this.Ew():(this.vi(),this.lc&&new A(this.layoutSessionData,this.changeStateObj,this.li).Hw(),this.Fw())},q.prototype.vi=function(){var i=this.changeStateObj,t=this.layoutSessionData,s=new l(t).nl();this.zw=new d(this.reportError),this.zw.Xw=this.needAlignAStarPathEnd(t),this.zw.i2(i,this.edgeDist,s)
;var r=null,s=i.Qe;s?(r=s.Se(),s.Pe()):r=i.cList;for(var h,o=r.length,e=0;e<o;++e)(h=r[e]).ignore||this.gi(h)},q.prototype.gi=function(i){var t=i.bi,s=i.yi,r=i.mi,h=i.pi,o=r.Hu,e=h.Hu;if(!o||!e)return i.Bi=null,void(i.E2=null);var n=o.No(),l=e.No(),a=this.Li[o.nodeSide],d=this.Li[e.nodeSide];i.Wu&&(i.Zu?a=this.Yw(t,o,a):d=this.Yw(s,e,d)),this.changeStateObj.jl(t,s);h=(h=this.ci.$t(r,n,a,h,l,d))||this.zw.findPathForNodePoints(t,n,a,s,l,d);i.Bi=h},q.prototype.Yw=function(i,t,s){var r=i.titleKeepOutArea,r={x:i.x,y:i.y,w:r.w,h:r.h},t=t.getPoint();return this.changeStateObj.El(t,r)?s:{left:"right",right:"left",down:"up",up:"down"}[s]},q.prototype.Fw=function(){for(var i,t,s,r=this.hostInterfaceObj,h=0,o=this.changeStateObj.cList,e=o.length,n=0;n<e;++n)if(!(s=o[n]).ignore)if(null!==(i=s.Bi)){for(var l=[],a=i.length,d=0;d<a;++d)t=i[d],l.push(r.makePoint(t.x,t.y));s.su=l}else++h;0<h&&this.reportError("HVPaths: unable to create "+h+" paths")},q.prototype.Ew=function(){for(var i,t,s,r,h,o,e,
n=this.hostInterfaceObj,l=this.changeStateObj,a=new v(this.layoutSessionData,l,this.li),d=l.cList,f=d.length,u={x:0,y:0},c={x:0,y:0},w=[],g=0;g<f;++g)(e=d[g]).ignore||(e.Wu?w.push(e):(h=e.bi,o=e.yi,i=e.mi,t=e.pi,s=i.Hu,r=t.Hu,s=s&&i.isUserLoc&&!i.Xu?s.getPoint():(u.x=h.x+h.w/2,u.y=h.y+h.h/2,u),r=r&&t.isUserLoc&&!t.Xu?r.getPoint():(c.x=o.x+o.w/2,c.y=o.y+o.h/2,c),h=a.Ql(h,u,c),o=a.Ql(o,u,c),null!==h&&(s=h.pnt),null!==o&&(r=o.pnt),G(n,e,s,r)));0<w.length&&this.createStraightPathsForChildToParent(w)};var G=function(i,t,s,r){var h=[];h.push(i.makePoint(s.x,s.y)),h.push(i.makePoint(r.x,r.y)),t.su=h;h=t.mi,t=t.pi;!1!==h.ignore||h.isUserLoc||(h.x=s.x-h.w/2,h.y=s.y-h.h/2),!1!==t.ignore||t.isUserLoc||(t.x=r.x-t.w/2,t.y=r.y-t.h/2)};function P(i,t){n.HVSegment.call(this,i,t)}q.prototype.cs=function(i){for(var t=this.hostInterfaceObj,s=i.length,r=0;r<s;++r){var h,o,e,n,l,a=i[r];a.ignore||(n=a.mi,l=a.pi,n&&l&&(h=n.x+n.w/2,o=n.y+n.h/2,e=l.x+l.w/2,n=l.y+l.h/2,(l=[]).push(t.makePoint(h,o)),l.push(
t.makePoint(e,n)),a.su=l,a.Ti=!0))}},q.prototype.createStraightPathsForChildToParent=function(i){if(!(i.length<1)){for(var t=this.layoutSessionData.Ft,s=[],r=0,h=i.length;r<h;++r){var o,e,n=i[r];n.ignore||n.Wu&&(o=n.bi,e=n.yi,a=n.Zu?e:o,s.indexOf(a)<0&&s.push(a),(d=a._w)||(a._w=d={top:[],bottom:[],left:[],right:[]}),(c=d[this.selectNodeSideForChildToParentConnection(n,t)]).push(n))}for(var l=["bottom","top","left","right"],r=0,h=s.length;r<h;++r){var a,d=(a=s[r])._w;delete a._w;for(var f=0,u=l.length;f<u;++f){var c,w=l[f];(c=d[w]).length<1||this.createStraightPathsForChildToParentOnSide(a,w,c)}}}},q.prototype.selectNodeSideForChildToParentConnection=function(i,t){var s=i.Zu,r="bottom";switch(t){case k.TopToBottom:case k.BottomToTop:r="bottom";break;case k.LeftToRight:r=s?"left":"right";break;case k.RightToLeft:r=s?"right":"left";break;default:this.reportError("Unknown layout direction: "+t)}return r},q.prototype.createStraightPathsForChildToParentOnSide=function(i,t,s){var r=s.length
;if(!(r<1)){var h=i.w,o=(h="left"===t||"right"===t?i.h:h)/(r+1);if("bottom"===t)for(var e=i.x+o,n=i.y+i.h,l=0;l<r;++l){var a={x:e,y:n},d={x:e,y:(u=(f=(w=s[l]).Zu)?w.bi:w.yi).y+u.h};f&&(c=a,a=d,d=c),G(this.hostInterfaceObj,w,a,d),e+=o}else if("top"===t)for(e=i.x+o,n=i.y,l=0;l<r;++l){a={x:e,y:n},d={x:e,y:(u=(f=(w=s[l]).Zu)?w.bi:w.yi).y};f&&(c=a,a=d,d=c),G(this.hostInterfaceObj,w,a,d),e+=o}else if("left"===t)for(e=i.x,n=i.y+o,l=0;l<r;++l){a={x:e,y:n},d={x:(u=(f=(w=s[l]).Zu)?w.bi:w.yi).x,y:n};f&&(c=a,a=d,d=c),G(this.hostInterfaceObj,w,a,d),n+=o}else if("right"===t)for(e=i.x+i.w,n=i.y+o,l=0;l<r;++l){var f,u,c,a={x:e,y:n},d={x:(u=(f=(w=s[l]).Zu)?w.bi:w.yi).x+u.w,y:n};f&&(c=a,a=d,d=c),G(this.hostInterfaceObj,w,a,d),n+=o}else{this.reportError("Unknown node side: "+t);for(l=0;l<r;++l){var w,g=(w=s[l]).bi,v=w.yi,a={x:g.x+g.w/2,y:g.y+g.h/2},d={x:v.x+v.w/2,y:v.y+v.h/2};G(this.hostInterfaceObj,w,a,d)}}}},q.prototype.jw=function(i){return"straightLine"===i||"line"===i},
q.prototype.needAlignAStarPathEnd=function(i){return!(i.portArrangement!==a.FollowLayoutDirection&&!i.du)},q.prototype.di=function(){for(var i=[],t=this.changeStateObj.cList,s=t.length,r=0;r<s;++r){var h=t[r],o=h.mi,e=h.pi;o&&e&&(0!==o.vs||0!==e.vs||this.li.Ww(h))&&i.push(h)}return i},t.common.ObjectHelper.inherit(P,n.HVSegment);var I={None:0,InOnly:1,OutOnly:2,InAndOut:3};function U(i,t,s,r){q.apply(this,arguments)}function j(i,t,s,r){this.reportError=r,this.Tt=i,this.Xt=t,this.min=0,this.max=0,this.Zw=0,this.Jw=s,this.type="node",this.nodes=[],this.segs=[],this.upBar=null,this.nextBar=null,this.Kw=[]}U.prototype.Ew=function(){var i=this.changeStateObj.nList;this.layoutSessionData.Mu&&p.Gu(i,!0),q.prototype.Ew.apply(this,arguments),this.layoutSessionData.Mu&&p.Gu(i,!1)},t.common.ObjectHelper.inherit(U,q),j.prototype.Qw=function(){return this.Xt},j.prototype.$w=function(i){(this.upBar||this.nextBar)&&this.reportError(
"The table index cannot be set if this bar is linked with other nodes"),this.Xt=i},j.prototype.grow=function(i,t){var s=i-this.Zw;if(0!=s)if("down"==t){this.max=this.min+i,this.Zw=i;var r=this.nextBar;r&&r.move(s,t)}else if("up"==t){this.min=this.max-i,this.Zw=i;var h=s,o=0;"H"===this.Jw&&(h=0,o=s);for(var e=this.nodes,n=e.length,l=0;l<n;++l){var a=e[l];a.Hi(a.x+h,a.y+o)}i=this.upBar;i&&i.move(-s,t)}else this.reportError("The TableBar grow direction is incorrect!")},j.prototype.move=function(i,t){if(0!==i){this.min+=i,this.max+=i;var s=i,r=0;"H"===this.Jw&&(s=0,r=i);for(var h=this.nodes,o=h.length,e=0;e<o;++e){var n=h[e];n.Hi(n.x+s,n.y+r)}for(var l,a=this.segs,o=a.length,e=0;e<o;++e){var d=a[e],f=d.ew()+i;d.lw(f)}"down"===t?(l=this.nextBar)&&l.move(i,t):"up"==t?(l=this.upBar)&&l.move(i,t):this.reportError("The TableBar move direction is incorrect!")}},j.prototype.addNode=function(i){this.nodes.push(i);var t="H"===this.Jw?i.h:i.w;"node"===this.type?this.Zw<t?(this.Kw=[i],this.grow(t,
"down")):this.Zw===t&&this.Kw.push(i):this.reportError("The segment bar cannot add node.")},j.prototype.removeNode=function(i){for(var t=-1,s=this.nodes,r=0,h=s.length;r<h;++r)s[r]===i&&(t=r);if(t<0)return!1;s.splice(t,1);var o=this.Kw.indexOf(i);return-1<o&&(1<this.Kw.length?this.Kw.splice(o,1):this.ig()),!0},j.prototype.ig=function(){this.Kw=[];for(var i,t=this.nodes.length,s=0,r=0;r<t;r++)s<(i="H"===this.Jw?this.nodes[r].h:this.nodes[r].w)?(this.Kw=[this.nodes[r]],s=i):i===s&&this.Kw.push(this.nodes[r])},j.prototype.tg=function(i){this.segs.push(i)},j.prototype.sg=function(){this.segs=[]},j.prototype.rg=function(){return this.min},j.prototype.hg=function(){return this.max},j.prototype.og=function(){return{min:this.rg(),max:this.hg()}},j.prototype.eg=function(i){(this.nextBar||i.upBar)&&this.reportError("The two bar has incorrect status"),(this.nextBar=i).upBar=this,i.move(this.max-i.min,"down")},j.prototype.ng=function(){this.lg(),this.ag()},j.prototype.lg=function(){
var i=this.upBar;i&&(i.nextBar=null),this.upBar=null},j.prototype.ag=function(){var i=this.nextBar;i&&(i.upBar=null),this.nextBar=null},j.prototype.dg=function(i){return i>this.min&&i<this.max},j.prototype.fg=function(i){for(var t=this.nodes,s=0,r=t.length;s<r;++s)if(t[s]===i)return!0;return!1},j.prototype.isEmpty=function(){return!(0<this.nodes.length)},j.prototype.ug=function(i){var t,s,r=i.w;(r="H"===this.Jw?i.h:r)>this.Zw?this.grow(r,"down"):-1<(s=(t=this.Kw).indexOf(i))?1<t.length?r<this.Zw&&t.splice(s,1):this.ig():r===this.Zw&&t.push(i)},j.prototype.push=function(i){if(0!==i){this.Xt+=i;for(var t=this.Jw,s=this.nodes,r=s.length,h=0;h<r;++h){var o=s[h];"V"===t?this.Tt.Bt(o,o.ir,this.Xt):"H"===t&&this.Tt.Bt(o,this.Xt,o.ic)}var e=0<i?this.upBar:this.nextBar;e&&e.push(i)}},j.createNodeBar=function(i,t,s,r){r=new j(i,t,s,r);return r.type="node",r},j.createSegBar=function(i,t,s,r){r=new j(i,t,s,r);return r.type="seg",r},j.prototype.exportState=function(i){var t={}
;return t.tableInx=this.Xt,t.min=this.min,t.max=this.max,t.hvType=this.Jw,t.type=this.type,t.nodes=F(this.nodes,i),t.bossNodes=F(this.Kw,i),t},j.createBarListFromState=function(i,t,s,r,h){for(var o=[],e=[],n=r[-1],n=j.createFromState(i,t,n,h),l=e[-1]=n,a=0,d=s.length;a<d;++a){var f=s[a],u=r[a],f=j.createFromState(i,t,f,h),u=j.createFromState(i,t,u,h);o.push(f),e.push(u),(f.nextBar=u).upBar=f,(l.nextBar=f).upBar=l,l=u}return{nodeBarList:o,segBarList:e}},j.createFromState=function(i,t,s,r){t=new j(i,s.tableInx,s.hvType,t);return t.min=s.min,t.max=s.max,t.Zw=s.max-s.min,t.type=s.type,t.nodes=E(s.nodes,r),t.Kw=E(s.bossNodes,r),t};var E=function(i,t){for(var s=[],r=0,h=i.length;r<h;++r){var o=i[r],o=t.getCsObjById(o).tabNode;s.push(o)}return s},F=function(i,t){for(var s=[],r=0,h=i.length;r<h;++r){var o=i[r].refNode.hostNode;s.push(t.getId(o))}return s};function z(i,t,s){this.Tt=t,this.layoutSessionData=i,this.reportError=s,this.hNodeBarList=[],this.hSegBarList=[],this.vNodeBarList=[],
this.vSegBarList=[],this.lt=k.TopToBottom,this.ct=k.LeftToRight,this.wt=k.BottomToTop,this.pt=k.RightToLeft}z.prototype.Nt=function(i,t){for(var s=i.x1(),r=s.minRow,h=s.maxRow,o=[],e=r;e<=h;++e)o=o.concat(i.k1(e));o.length<1?this.reportError("The table should not be empty when initialization"):(1<o.length&&this.reportError("The table should only include one node when initialization"),r=o[0],this.cg(r.ir,r.ic,r.x,r.y,r.w,r.h),this.wg(r,t))},z.prototype.cg=function(i,t,s,r,h,o){this.gg(i,t,s,r,h,o,"H"),this.gg(i,t,s,r,h,o,"V")},z.prototype.gg=function(i,t,s,r,h,o,e){var n=this.reportError,t=t,h=h,s=s;"H"===e&&(t=i,h=o,s=r);i=this.ai(e),o=j.createNodeBar(this.Tt,t,e,n),r=j.createSegBar(this.Tt,t,e,n);o.grow(h,"down"),r.grow(i,"down"),o.move(s-o.rg(),"down"),o.eg(r);n=j.createSegBar(this.Tt,t,e,n);n.$w(o.Qw()-1),n.grow(i,"down"),n.move(o.rg()-n.hg(),"down"),n.eg(o),this.vg(n,o,r,e)},z.prototype.bg=function(i,t){var s=this.reportError,r=this.ai(i),h=this.pg(i),o=h.Qw()+1,e=j.createNodeBar(
this.Tt,o,i,s),s=j.createSegBar(this.Tt,o,i,s);e.grow(t,"down"),s.grow(r,"down"),h.eg(e),e.eg(s),this.mg(e,s,i)},z.prototype.kg=function(i,t){var s=this.reportError,r=this.yg(i);r.ng();var h=this.ai(i),o=this.xg(i),e=o.Qw()-1,n=j.createNodeBar(this.Tt,e,i,s),s=j.createSegBar(this.Tt,e,i,s);n.grow(t,"down"),s.grow(h,"down"),s.move(o.rg()-s.hg(),"down"),s.eg(o),n.move(s.rg()-n.hg(),"down"),n.eg(s),r.$w(e-1),r.move(n.rg()-r.hg(),"down"),r.eg(n),this.Mg(n,s,i)},z.prototype.Og=function(){var i=this.hNodeBarList.length,t=this.vNodeBarList.length;return{minRow:this.hNodeBarList[0].Qw(),maxRow:this.hNodeBarList[i-1].Qw(),minCol:this.vNodeBarList[0].Qw(),maxCol:this.vNodeBarList[t-1].Qw()}},z.prototype.resizeNode=function(i){var t=i.ir,s=i.ic,t=this.Rg(t,s),s=t.hNodeBar,t=t.vNodeBar;s.ug(i),t.ug(i)},z.prototype.Gt=function(i,t){var s=this.os(i);this.Sg(s.hNodesAtHead,s.hNodesAtTail,"H"),this.Sg(s.vNodesAtHead,s.vNodesAtTail,"V");for(var r=0,h=i.length;r<h;++r)this.wg(i[r],t)},
z.prototype.Pt=function(i,t){var s=this.os(i);"H"===t?this.Sg(s.hNodesAtHead,s.hNodesAtTail,"H"):"V"===t&&this.Sg(s.vNodesAtHead,s.vNodesAtTail,"V");for(var r=0,h=i.length;r<h;++r)this.Lg(i[r],t)};function X(i,t){return i-t}function Y(i,t,s,r,h,o,e){w.call(this,i,t,s,r,h,o,void 0,e)}function _(i,t,s,r,h,o,e,n,l,a){Y.call(this,i,t,0,e,n,l,a),this.perX=s,this.perY=r,this.offX=h,this.offY=o}function W(i,t,s,r,h,o,e,n,l,a){_.apply(this,arguments);var d=_.prototype.getPoint.apply(this);this.Hg=d.x-e.x,this.Tg=d.y-e.y}function Z(i,t,s,r,h,o,e,n,l){Y.call(this,i,t,h,o,e,n,l),this.percent=s,this.offset=r}function J(i,t,s,r,h,o,e,n,l){Z.apply(this,arguments);var a=Z.prototype.getPoint.apply(this);this.Hg=a.x-o.x,this.Tg=a.y-o.y}function K(i,t,s){n.RankIndexSegManager.apply(this,arguments)}function Q(i,t,s){this.layoutSessionData=i,this.changeStateObj=t,this.hostInterfaceObj=t.hostInterfaceObj,this.reportError=t.reportError,this.Cg=s,this.Vg=s._n,this.$f=null,this.Dg(),
this.nodeDist=this.layoutSessionData.nodeDist,this.edgeDist=this.layoutSessionData.edgeDist;t=p.tryGetMinNodeSize(this.hostInterfaceObj,s.hostNode);this.Ng=t.w,this.Bg=t.h,!1===s.Qh&&(s=this.Ag(),this.Ng=s.w,this.Bg=s.h)}function $(i,t){this.layoutSessionData=i,this.changeStateObj=t,this.$o=1,this.hostInterfaceObj=t.hostInterfaceObj,this.reportError=t.reportError,this.nodeDist=this.layoutSessionData.nodeDist,this.edgeDist=this.layoutSessionData.edgeDist;var s=t.nList,r=s.length,h=t.zh;h.removeNodeOverlapsObj=new Q(i,t,h),h.lastX=this.snapX(h.x),h.lastY=this.snapY(h.y);for(var o=0;o<r;++o)(h=s[o]).removeNodeOverlapsObj=null,h.lastX=this.snapX(h.x),h.lastY=this.snapY(h.y),null!==h._n&&(h.removeNodeOverlapsObj=new Q(i,t,h))}function ii(i){n.AStarSearchGrid.apply(this,arguments)}function ti(i,t){this.reportError=t,this.layoutSessionData=i,this._t=null,this.Ct=null,this.gridSpaceObj=null,this.modelSpaceObj=null}function si(i,t){this.go=i,this.Ze=t,T.copyMethodsFrom(this,this.go),
this.getParentNode=si.prototype.getParentNode}z.prototype.Sg=function(i,t,s){var r=[];for(n in i)Object.prototype.hasOwnProperty.call(i,n)&&r.push(parseInt(n));r.sort(X);for(var h=r.length-1;0<=h;--h){var o=r[h],e=this.qg(s,i[o]);this.Gg(o,e,s)}var n,r=[];for(n in t)Object.prototype.hasOwnProperty.call(t,n)&&r.push(parseInt(n));r.sort(X);for(var h=0,l=r.length;h<l;++h)o=r[h],e=this.qg(s,t[o]),this.Gg(o,e,s)},z.prototype.os=function(i){for(var t=[],s=[],r=[],h=[],o=[],e=[],n=this.xg("H"),l=this.Pg("H"),a=n.Qw(),d=l.Qw(),n=this.xg("V"),l=this.Pg("V"),f=n.Qw(),u=l.Qw(),c=0,w=i.length;c<w;++c){var g=i[c],v=g.ir;d<v?this.Ig(g,v,t):v<a?this.Ig(g,v,s):r.push(g),u<(v=g.ic)?this.Ig(g,v,h):v<f?this.Ig(g,v,o):e.push(g)}return{hNodesAtHead:s,hNodesAtTail:t,hNodeListInLimit:r,vNodesAtHead:o,vNodesAtTail:h,vNodeListInLimit:e}},z.prototype.Ig=function(i,t,s){var r=s[t];r||(s[t]=r=[]),r.push(i)},z.prototype.addNewNode=function(i,t){this.Gg(i.ir,i.h,"H"),this.Gg(i.ic,i.w,"V"),this.wg(i,t)},
z.prototype.wg=function(i,t){var s=i.ir,r=i.ic,s=this.Rg(s,r),r=s.hNodeBar,s=s.vNodeBar;r&&s?(r.addNode(i),s.addNode(i),this.Rt(i,t)):this.reportError("The space have no bar object for this row/col")},z.prototype.Lg=function(i,t){var s=i.ir,r=i.ic,s=this.Rg(s,r),r=s.hNodeBar;(r="V"===t?s.vNodeBar:r)?(r.addNode(i),r=r.rg(),"H"===t?i.Hi(i.x,r):"V"===t&&i.Hi(r,i.y)):this.reportError("BLTableModelSpace.__addNodeInBarByType: The space have no bar object for given hv type")},z.prototype.Gg=function(i,t,s){var r=this.xg(s),h=this.Pg(s),r=r.Qw(),h=h.Qw(),o=0;if(h<i)for(var o=i-h,e=0;e<o;++e)this.bg(s,t);else if(i<r){o=r-i;for(e=0;e<o;++e)this.kg(s,t)}return o},z.prototype.qg=function(i,t){var s=t.length;if(!(s<1)){for(var r="H"===i?"h":"w",h=t[0][r],o=1;o<s;++o){var e=t[o][r];h<e&&(h=e)}return h}this.reportError("The input node list is empty.")},z.prototype.Ug=function(i,t){i=this.Rg(i,t),t=i.hNodeBar,i=i.vNodeBar;return t&&i||this.reportError("Cannot find target cell."),{x:i.rg(),y:t.rg()}},
z.prototype.jg=function(i,t){var s=this.Eg(i,t),r=s.hSegBar,i=s.vSegBar;r&&i||this.reportError("Cannot find target cell.");t=i.rg(),s=r.rg();return{x:t+i.Zw,y:s+r.Zw}},z.prototype.jt=function(i){var t=this.Ug(i.ir,i.ic);i.Hi(t.x,t.y)},z.prototype.Fg=function(i,t,s,r){i=this.Rg(i,t),t=i.hNodeBar,i=i.vNodeBar;return t&&i||this.reportError("Cannot find target cell."),{x:i.hg()+s,y:t.rg()+r}},z.prototype.zg=function(i,t,s,r){i=this.Rg(i,t),t=i.hNodeBar,i=i.vNodeBar;return t&&i||this.reportError("Cannot find target cell."),{x:i.rg()+s,y:t.hg()+r}},z.prototype.Xg=function(i,t){return{Row:this.Yg(i,t),Col:this._g(i,t)}},z.prototype.Yg=function(i,t){for(var s=this.hNodeBarList,r=this.hSegBarList,h=0,o=s.length,e=0;e<o;e++){var n=s[e],l=r[e];if(t>=n.min&&t<l.max){h=n.Qw();break}}return h},z.prototype._g=function(i,t){for(var s=this.vNodeBarList,r=this.vSegBarList,h=0,o=s.length,e=0;e<o;e++){var n=s[e],l=r[e];if(i>=n.min&&i<l.max){h=n.Qw();break}}return h},z.prototype.removeNode=function(i){
var t=i.ir,s=i.ic,t=this.Rg(t,s),s=t.hNodeBar,t=t.vNodeBar;s&&t||this.reportError("Node is not found in model space.");s=s.removeNode(i),i=t.removeNode(i);return!(!s||!i)||(this.reportError("Node is not found in space bar."),!1)},z.prototype.Wg=function(){var i=this.Og(),t=i.minRow,s=i.maxRow,r=i.minCol,h=i.maxCol,o=this.Ug(t,r),e=this.jg(s,h),i=o.x,o=o.y;return{minRow:t,maxRow:s,minCol:r,maxCol:h,minX:i,maxX:e.x,minY:o,maxY:e.y}},z.prototype.Rg=function(i,t){for(var s=null,r=null,h=this.vNodeBarList,o=0,e=h.length;o<e;++o)if((n=h[o]).Qw()===t){r=n;break}for(var n,o=0,e=(h=this.hNodeBarList).length;o<e;++o)if((n=h[o]).Qw()===i){s=n;break}return{hNodeBar:s,vNodeBar:r}},z.prototype.Eg=function(i,t){for(var s=null,r=null,h=this.vSegBarList,o=-1,e=h.length;o<e;++o)if((n=h[o]).Qw()===t){r=n;break}for(var n,o=-1,e=(h=this.hSegBarList).length;o<e;++o)if((n=h[o]).Qw()===i){s=n;break}return{hSegBar:s,vSegBar:r}},z.prototype.Kt=function(i,t){for(var s=null,
r="H"===t?this.hNodeBarList:this.vNodeBarList,h=0,o=r.length;h<o;h++)if(r[h].Xt===i){s=r[h];break}return s},z.prototype.Ot=function(i,t){for(var s=this.hNodeBarList,r=0,h=(s="V"===t?this.vNodeBarList:s).length;r<h;r++){var o=s[r];if(o.fg(i))return o}return null},z.prototype.Zg=function(i,t,s,r){t=this.Ug(i,t),s-=t.x,t=r-t.y;this.Jg(s,t)},z.prototype.Jg=function(i,t){var s=this.Kg("V"),r=this.Kg("H");s.move(i,"down"),r.move(t,"down")},z.prototype.vg=function(i,t,s,r){var h=null,o=null,o="H"===r?(h=this.hNodeBarList,this.hSegBarList):(h=this.vNodeBarList,this.vSegBarList);(0<h.length||0<o.length)&&this.reportError("The bar list is not empty when initializing."),h.push(t),o.push(s),o[-1]=i},z.prototype.mg=function(i,t,s){"H"===s?(this.hNodeBarList.push(i),this.hSegBarList.push(t)):(this.vNodeBarList.push(i),this.vSegBarList.push(t))},z.prototype.Mg=function(i,t,s){"H"===s?(this.hNodeBarList.splice(0,0,i),this.hSegBarList.splice(0,0,t)):(this.vNodeBarList.splice(0,0,i),
this.vSegBarList.splice(0,0,t))},z.prototype.xg=function(i){return("H"===i?this.hNodeBarList:this.vNodeBarList)[0]},z.prototype.Pg=function(i){i="H"===i?this.hNodeBarList:this.vNodeBarList;return i[i.length-1]},z.prototype.yg=function(i){return("H"===i?this.hSegBarList:this.vSegBarList)[-1]},z.prototype.pg=function(i){i="H"===i?this.hSegBarList:this.vSegBarList;return i[i.length-1]},z.prototype.Kg=function(i){return this.yg(i)},z.prototype.Qg=function(i){return this.pg(i)},z.prototype.ai=function(i){var t=this.layoutSessionData.nodeDist;return"H"===i?t.y:t.x},z.prototype.Qt=function(i,t){t===this.ct||t===this.lt?i.lg():t!==this.pt&&t!==this.wt||(i="node"===i.type?i.nextBar:i).ag(),this.$g(i,t)},z.prototype.Wt=function(i,t){var s;t===this.ct||t===this.lt?((s=this.pg(i.Jw)).eg(i),this.iv(i,t)):t!==this.pt&&t!==this.wt||(s=this.xg(i.Jw),(i="node"===i.type?i.nextBar:i).move(s.rg()-i.hg(),"up"),i.eg(s),this.iv(i,t))},z.prototype.$g=function(i,t){var s=this.vNodeBarList,r=this.vSegBarList
;"H"===i.Jw&&(s=this.hNodeBarList,r=this.hSegBarList);for(var h,o=t===this.ct||t===this.lt;i;)"node"===i.type?(h=s.indexOf(i),s.splice(h,1)):"seg"===i.type&&0<=(h=r.indexOf(i))&&r.splice(h,1),i=o?i.nextBar:i.upBar},z.prototype.iv=function(i,t){var s=this.vNodeBarList,r=this.vSegBarList;"H"===i.Jw&&(s=this.hNodeBarList,r=this.hSegBarList);for(var h=t===this.ct||t===this.lt;i;)"node"===i.type?h?s.push(i):s.unshift(i):"seg"===i.type&&(h?r.push(i):r.unshift(i)),i=h?i.nextBar:i.upBar},z.prototype.Ut=function(i,t,s){var r,t=t-i.Xt;if(0!=t){if(s===this.ct||s===this.lt)if(0<t)for(;i;)i=(r=i).nextBar;else r=i;else if(s===this.pt||s===this.wt)if(0<t)r="node"==i.type?i.nextBar:i;else for(;i;)i=(r=i).upBar;r&&r.push(t)}},t.common.ObjectHelper.inherit(Y,w),Y.prototype.tl=function(){var i=this.changeNode,t=this.nodeSide;i.gluePointLists[t].push(this)},Y.prototype.vl=function(){for(var i=this.changeNode,t=this.nodeSide,s=i.gluePointLists[t],r=0,h=s.length;r<h;r++)if(s[r]===this){s.splice(r,1);break}}
,t.common.ObjectHelper.inherit(_,Y),_.prototype.getPoint=function(){var i=this.changePort.ti;return{x:i.x+i.w*this.perX+this.offX,y:i.y+i.h*this.perY+this.offY}},_.prototype.No=function(){var i=this.getPoint(),t=this.changeNode,s=this.nodeSide;return i=this.kl(i,t,s)},W.prototype.getPoint=function(){var i=_.prototype.getPoint.apply(this,arguments),t=i.x,s=i.y,r=this.changeNode;switch(this.nodeSide){case"bottom":case"top":t=r.x+this.Hg;break;case"right":case"left":s=r.y+this.Tg}return{x:t,y:s}},t.common.ObjectHelper.inherit(W,_),Z.prototype.getPoint=function(){var i=this.changeNode,t=i.x,s=i.y;switch(this.nodeSide){case"bottom":t+=this.percent*i.w+this.offset,s+=i.h;break;case"left":s+=this.percent*i.h+this.offset;break;case"right":t+=i.w,s+=this.percent*i.h+this.offset;break;case"top":t+=this.percent*i.w+this.offset}return{x:t,y:s}},t.common.ObjectHelper.inherit(Z,Y),J.prototype.getPoint=function(){var i=Z.prototype.getPoint.apply(this,arguments),t=i.x,s=i.y,r=this.changeNode;switch(
this.nodeSide){case"bottom":case"top":t=r.x+this.Hg;break;case"right":case"left":s=r.y+this.Tg}return{x:t,y:s}},t.common.ObjectHelper.inherit(J,Z),t.common.ObjectHelper.inherit(K,n.RankIndexSegManager),Q.prototype.df=function(){this.Dg();for(var i,t,s=this.Vg,r=s.length,h=0;h<r;++h)(i=s[h]).activeMoveNode=!1,i.x=this.snapX(i.x),i.y=this.snapY(i.y),i.w=this.snapX(i.w),i.h=this.snapY(i.h),this.tv("any",i.x,i.y,i.w,i.h),i.activeMoveNode=!0;!1===this.Cg.Qh&&(t=this.Ag(),this.Ng=t.w,this.Bg=t.h)},Q.prototype.sv=function(i,t,s,r,h,o){this.Dg(),i.activeMoveNode=!1;var e=this.snapX(t),t=this.snapY(s),s=this.snapX(r),r=this.snapY(h);this.tv(o,e,t,s,r),i.activeMoveNode=!0;h=e-i.x,o=t-i.y;this.changeStateObj.Qe&&(i.x==e&&i.y==t&&i.w==s&&i.h==r||this.changeStateObj.Qe.Le(i)),i.x=e,i.y=t,i.w=s,i.h=r,this.rv(i,h,o)},Q.prototype.hv=function(i,t){this.Dg();for(var s,r=this.Vg,h=r.length,o=0;o<h;++o)(s=r[o]).activeMoveNode&&this.ov(s,i,t)},Q.prototype.ov=function(i,t,s){i.activeMoveNode=!1;var r="H"
;"up"!==t&&"down"!==t||(r="V");var h=this.nodeDist.x,o=this.nodeDist.y,e=1;"up"!==t&&"left"!==t||(e=-1);for(var n,l,a=this.Vg,d=a.length,f=s,u=0;u<d;++u)(l=a[u])!==i&&null!==(n=this.ev(i,l,t,r))&&(l=l.activeMoveNode?this.ov(l,t,s):n,0<e?l<f&&(f=l):f<l&&(f=l));var c=i.x,w=i.y,g=i.w,v=i.h;switch(t){case"up":f=(w=f)+v+o;break;case"down":f=(w=f-v)-o;break;case"left":f=(c=f)+g+h;break;case"right":f=(c=f-g)-h;break;default:this.reportError("RemoveNodeOverlaps: invalid move direction for compact nodes")}var b=c-i.x,p=w-i.y;return i.x=c,i.y=w,this.changeStateObj.Qe&&(0==b&&0==p||this.changeStateObj.Qe.Le(i)),this.rv(i,b,p),f},Q.prototype.ev=function(i,t,s,r){var h,o=this.nodeDist.x,e=this.nodeDist.y,n=i.y,l=t.y,a=n+i.h,d=l+t.h,f=i.x,u=t.x,c=f+i.w,i=u+t.w;if("H"===r){if(d<n)return null;if(a<l)return null;if("right"===s){if(i<f)return null;h=t.x-o}else{if(c<u)return null;h=t.x+t.w+o}}else{if(i<f)return null;if(c<u)return null;if("down"===s){if(d<n)return null;h=t.y-e}else{if(a<l)return null
;h=t.y+t.h+e}}return h},Q.prototype.Ag=function(){var i=this.Cg,t=p.tryGetMinNodeSize(this.hostInterfaceObj,i.hostNode),s={x:i.x,y:i.y,w:t.w,h:t.h},t=this.Vg;if(t.length<1)return s;t=this.changeStateObj.Yf(t),i=this.hostInterfaceObj.getGroupNodePadding(i.hostNode);return s.x=t.x-i.left,s.y=t.y-i.top,s.w=t.w+(i.left+i.right),s.h=t.h+(i.top+i.bottom),s},Q.prototype.nv=function(i){var t=this.Cg,s={x:t.x,y:t.y,w:this.Ng,h:this.Bg};return i&&!this.layoutSessionData.isNestedView?{x:t.x,y:t.y,w:t.w,h:t.h}:(i&&this.layoutSessionData.Sa&&(t=this.hostInterfaceObj.getNodeRect(t.hostNode),s.w=this.snapX(t.w),s.h=this.snapY(t.h)),s)},Q.prototype.lf=function(){var i=this.Cg;this.Ng=i.w,this.Bg=i.h},Q.prototype.tv=function(i,t,s,r,h){for(var o,e,n,l=t-this.nodeDist.x,a=s-this.nodeDist.y,d=r+2*this.nodeDist.x,f=h+2*this.nodeDist.y,u=this.Vg,c=u.length,w=[],g=[],v=[],b=[],p=0;p<c;++p)if(!1!==(o=u[p]).activeMoveNode&&!1!==this.lv(o,l,a,d,f))switch(n=this.av(o,i,l,a,d,f),o.moveDirection=n,e=this.dv(o,l,a
,d,f),n){case"left":this.fv(v,o,e,o.x);break;case"right":this.uv(b,o,e,o.x);break;case"up":this.fv(w,o,e,o.y);break;case"down":this.uv(g,o,e,o.y);break;default:this.reportError("RemoveNodeOverlaps: invalid move direction: "+n)}this.cv(w,"up"),this.cv(g,"down"),this.cv(v,"left"),this.cv(b,"right")},Q.prototype.av=function(i,t,s,r,h,o){o=!1===this.layoutSessionData.isAutoClearNodeArea?this.wv(i,t,s,r,h,o):this.gv(i,t,s,r,h,o);return o},Q.prototype.wv=function(i,t,s,r,h,o){var e=i.moveDirection;if(""!==e)return e;if("down"===t)return t;if("right"===t)return t;if("left"===t)return t;if("up"===t)return t;var n=this.layoutSessionData.Ft;switch(n){case 0:case 2:e=i.y<r?"up":"down";break;case 1:case 3:e=i.x<s?"left":"right";break;default:this.reportError("RemoveNodeOverlaps: invalid layout direction: "+n),e="down"}return e},Q.prototype.gv=function(i,t,s,r,h,o){if(""!==(a=i.moveDirection))return a;if("down"===t)return t;if("right"===t)return t;if("left"===t)return t;if("up"===t)return t
;var e=i.x,n=i.y,l=e+i.w,i=n+i.h,a=this.vv(e,n,l,i,s,r,s+h,r+o,t);return a=this.bv(a,e,n,l,i)},Q.prototype.vv=function(i,t,s,r,h,o,e,n,l){h=s-h,i=e-i,o=r-o,t=n-t;return"any"===l||"upOrDownOrLeftOrRight"===l||"leftOrRightOrUpOrDown"===l?h<Math.min(i,o,t)?"left":i<Math.min(o,t)?"right":t<o?"down":"up":"downOrRight"===l?t<i?"down":"right":"upOrDown"===l?o<t?"up":"down":"leftOrRight"===l?h<i?"left":"right":"upOrDownOrLeft"===l?o<Math.min(t,h)?"up":t<h?"down":"left":"upOrDownOrRight"===l?o<Math.min(t,i)?"up":t<i?"down":"right":"leftOrRightOrUp"===l?h<Math.min(i,o)?"left":i<o?"right":"up":"leftOrRightOrDown"===l?h<Math.min(i,t)?"left":i<t?"right":"down":(this.reportError("RemoveNodeOverlaps: invalid clear direction: "+l),"down")},Q.prototype.bv=function(i,t,s,r,h){if(null===this.$f)return i;var o=this.$f,e=o.xmin,n=o.ymin,l=o.xmax,a=o.ymax;switch(i){case"left":return a<s?i:!(h<n)&&l<r?"right":i;case"right":return a<s?i:!(h<n)&&t<e?"left":i;case"up":return l<t?i:!(r<e)&&a<h?"down":i
;case"down":return l<t?i:!(r<e)&&s<n?"up":i;default:this.reportError("RemoveNodeOverlaps:avoidBaseArea - invalid move direction: "+i)}return i},Q.prototype.dv=function(i,t,s,r,h){var o=i.moveDirection,e=i.x,n=i.y,l=i.w,a=i.h,d=e,f=n,e=l,n=a;switch(o){case"left":d=t-l;break;case"right":d=t+r;break;case"up":f=s-a;break;case"down":f=s+h;break;default:this.reportError("RemoveNodeOverlaps: invalid move direction: "+o)}return{x:d,y:f,w:e,h:n}},Q.prototype.fv=function(i,t,s,r){for(var h={changeNode:t,targetArea:s,sortValue:r},o=i.length,e=0;e<o;++e)if(r<=i[e].sortValue)return void i.splice(e,0,h);i.push(h)},Q.prototype.uv=function(i,t,s,r){for(var h={changeNode:t,targetArea:s,sortValue:r},o=i.length,e=0;e<o;++e)if(i[e].sortValue<=r)return void i.splice(e,0,h);i.push(h)},Q.prototype.cv=function(i,t){var s,r,h=i.length;if(!(h<1))for(var o=0;o<h;++o)s=(r=i[o]).changeNode,r=r.targetArea,this.pv(s,r,t)},Q.prototype.pv=function(i,t,s){var r=t.x,h=t.y,o=t.w,t=t.h;i.activeMoveNode=!1,this.tv(s,r,h,o,
t),i.activeMoveNode=!0;o=r-i.x,t=h-i.y;i.x=r,i.y=h,this.changeStateObj.Qe&&(0==o&&0==t||this.changeStateObj.Qe.Le(i)),this.rv(i,o,t)},Q.prototype.lv=function(i,t,s,r,h){var o=i.x,e=i.y,n=i.w,i=i.h;return!(t+r<=o)&&(!(s+h<=e)&&(!(o+n<=t)&&!(e+i<=s)))},Q.prototype.Dg=function(){for(var i,t=this.Vg,s=t.length,r=0;r<s;++r)(i=t[r]).activeMoveNode=!0,i.moveDirection=""},Q.prototype.rv=function(i,t,s){for(var r,h=i.ki,o=h.length,e=0;e<o;++e)(r=h[e]).x+=t,r.y+=s},Q.prototype.snapX=function(i){var t=this.edgeDist.x;return 0===t?i:Math.round(i/t)*t},Q.prototype.snapY=function(i){var t=this.edgeDist.y;return 0===t?i:Math.round(i/t)*t},$.prototype.df=function(i){this.Do(this.changeStateObj.zh);var t=0!==this.groupPaddingFit;this.jo(this.changeStateObj.zh,t,i)},$.prototype.jo=function(i,t,s){if(!i.ignore&&!1!==i.Qh){for(var r,h=i._n,o=h.length,e=0;e<o;++e)null!==(r=h[e])._n&&this.jo(r,t,s);this.mv(i,null);var n,l,a=this.vf(i);a.df(),this.kv(i,null,0,0),null!==i.$n&&(this.changeStateObj.Uo(
"sideOffset"),n=a.Ag(),t||(l={x:i.x,y:i.y,w:i.w,h:i.h},n=this.changeStateObj.o1(n,l)),s||(a=this.changeStateObj.h1(i,n))&&(n=this.changeStateObj.o1(n,a)),t&&(l={x:i.x,y:i.y,w:i.w,h:i.h},this.yv(l,n,t)),i.x=this.snapX(n.x),i.y=this.snapY(n.y),i.w=this.snapX(n.w),i.h=this.snapY(n.h))}},$.prototype.moveNode=function(i,t){var s,r=this.Fi(i);null!==r&&(s=this.hostInterfaceObj.getNodeRect(i),i=this.snapX(s.x),s=this.snapY(s.y),this.Tf(r,i,s,t))},$.prototype.Tf=function(i,t,s,r){t=this.snapX(t),s=this.snapY(s);this.xv(i,t,s,i.w,i.h,r,null)},$.prototype.Mv=function(i,t,s,r){i=this.Fi(i);null!==i&&(t=this.snapX(i.x+t),s=this.snapY(i.y+s),this.Tf(i,t,s,r))},$.prototype.resizeNode=function(i,t){var s,r,h,o=this.Fi(i);null!==o&&(h=this.hostInterfaceObj.getNodeRect(i),s=this.snapX(h.x),r=this.snapY(h.y),i=this.snapX(h.w),h=this.snapY(h.h),this.Yl(o,s,r,i,h,t))},$.prototype.Yl=function(i,t,s,r,h,o){var e=this.snapX(t),t=this.snapY(s),s=this.snapX(r),r=this.snapY(h),h=this.Ov(i,e,t,s,r)
;this.changeStateObj.Qe&&(i.x==e&&i.y==t&&i.w==s&&i.h==r||this.changeStateObj.Qe.Le(i));e=h.x,t=h.y,s=h.w,r=h.h,h=i;i.Jh&&!1===i.Qh&&(h=null),this.xv(i,e,t,s,r,o,h)},$.prototype.Ov=function(i,t,s,r,h){var o=p.tryGetMinNodeSize(this.hostInterfaceObj,i.hostNode),e={x:t,y:s,w:o.w,h:o.h};i.Qh&&0<i._n.length&&(n=this.vf(i).Ag(),e.x=n.x,e.y=n.y,e.w=n.w,e.h=n.h);var o=e.x,i=e.y,n=o+e.w,e=i+e.h,o=Math.min(o,t),i=Math.min(i,s);return{x:o,y:i,w:Math.max(n,t+r)-o,h:Math.max(e,s+h)-i}},$.prototype.fitGroupNode=function(i,t,s){var r,h,o,e,n,l=this.Fi(i);null!==l&&(null!==l._n?(i=(r=this.vf(l)).Ag(),(s=void 0===s?2===this.$o:s)&&(h=Math.min(i.x,l.x),o=Math.min(i.y,l.y),e=i.w+i.x-h,n=i.h+i.y-o,i.x=h,i.y=o,i.w=e,i.h=n),l.Qh?(h=l.x,o=l.y,e=l.w,n=l.h,l.x=this.snapX(i.x),l.y=this.snapY(i.y),l.w=this.snapX(i.w),l.h=this.snapY(i.h),this.changeStateObj.Qe&&(l.x===h&&l.y===o&&l.w===e&&l.h===n||this.changeStateObj.Qe.Le(l))):(r.Ng=this.snapX(i.w),r.Bg=this.snapY(i.h)),t&&(null===(l=l.$n)||null!==(l=l.hostNode
)&&null!==this.changeStateObj.Fi(l)&&this.fitGroupNode(l,t,s))):this.reportError("RemoveGroupOverlaps: request to fit a node that is not a group node"))},$.prototype.collapseGroupNode=function(i){var t,s=this.Fi(i);null!==s&&(null!==s._n?(i=(t=this.vf(s)).nv(!0),t.lf(),this.xv(s,i.x,i.y,i.w,i.h,"downOrRight",null),s.Qh=!1,this.changeStateObj.B2(this.changeStateObj.zh,!1),this.changeStateObj.Qe&&this.changeStateObj.Qe.Le(s)):this.reportError("RemoveGroupOverlaps: request to collapse a node that is not a group node"))},$.prototype.expandGroupNode=function(i,t){var s,r=this.Fi(i);null!==r&&(null!==r._n?(i=(s=this.vf(r)).nv(!1),s.lf(),s=s.Ag(),i=this.changeStateObj.o1(i,s),this.xv(r,i.x,i.y,i.w,i.h,t,r),r.Qh=!0,this.changeStateObj.B2(this.changeStateObj.zh,!1),this.changeStateObj.Qe&&this.changeStateObj.Qe.Le(r)):this.reportError("RemoveGroupOverlaps: request to expand a node that is not a group node"))},$.prototype.convertNodeToGroupNode=function(i,t){
var s=this.hostInterfaceObj.getNodeRect(i.hostNode);this.sf(i,t),this.xv(i,s.x,s.y,s.w,s.h,t,null),this.changeStateObj.B2(this.changeStateObj.zh,!1)},$.prototype.convertGroupNodeToNode=function(i,t){this.hostInterfaceObj.getNodeRect(i.hostNode);this.sf(i,t),this.changeStateObj.B2(this.changeStateObj.zh,!1)},$.prototype.sf=function(i,t){i.removeNodeOverlapsObj=null,i.lastX=this.snapX(i.x),i.lastY=this.snapY(i.y);var s,r,h,o,e=i.hostNode;e?(o=null!==i._n?(i.removeNodeOverlapsObj=new Q(this.layoutSessionData,this.changeStateObj,i),this.fitGroupNode(e,!1),s=i.x,r=i.y,h=i.w,i.h):(s=(o=this.hostInterfaceObj.getNodeRect(e)).x,r=o.y,h=o.w,o.h),this.xv(i,s,r,h,o,t,null)):this.reportError("RemoveGroupOverlaps: addNewChangeNode - request to add a new node that is not in the associated changed state")},$.prototype.compactGraph=function(i,t){for(var s,r=i._n,h=r.length,o=0;o<h;++o)null!==(s=r[o])._n&&this.compactGraph(s,t);this.compactGroupNode(i.hostNode,t,!1)},
$.prototype.compactGroupNode=function(i,t,s){var r=this.changeStateObj.zh;if(null===i||null!==(r=this.Fi(i)))if(null!==r._n){var h,o,e,n=this.vf(r);switch(null===i?o=n.Ag():(o={x:r.x,y:r.y,w:r.w,h:r.h},e=this.hostInterfaceObj.getGroupNodePadding(r.hostNode),o.x+=e.left,o.y+=e.top,o.w-=e.left+e.right,o.h-=e.top+e.bottom),t){case"up":h=o.y;break;case"down":h=o.y+o.h;break;case"left":h=o.x;break;case"right":h=o.x+o.w;break;default:return void this.reportError("RemoveGroupOverlaps: invalid move direction for compact nodes")}this.mv(r,null),n.hv(t,h),this.kv(r,null,0,0),0!==this.$o&&null!==i&&this.fitGroupNode(i,!1),s&&(null===(r=r.$n)||null!==(r=r.hostNode)&&null!==this.changeStateObj.Fi(r)&&this.compactGroupNode(r,t,s))}else this.reportError("RemoveGroupOverlaps: request to compact a node that is not a group node")},$.prototype.Do=function(i){this.Rv(i);for(var t,s=i._n,r=s.length,h=0;h<r;++h)null===(t=s[h])._n?this.Rv(t):this.Do(t)},$.prototype.Rv=function(i){if(
i!==this.changeStateObj.zh){var t,s=this.snapX(i.x),r=this.snapY(i.y),h=s-i.x,o=r-i.y;i.x=s,i.y=r;for(var e,n=(e=i.ki).length,l=0;l<n;++l)(t=e[l]).x+=h,t.y+=o}},$.prototype.xv=function(i,t,s,r,h,o,e){var n=i.$n,l=this.vf(n);this.mv(n,e),l.sv(i,t,s,r,h,o),this.kv(n,e,0,0),this.ef(n,o),this.changeStateObj.Qe&&this.changeStateObj.Qe.Le(i)},$.prototype.Sv=function(i,t){i.removeNodeOverlapsObj=null,i.lastX=this.snapX(i.x),i.lastY=this.snapY(i.y);var s,r,h,o=i.hostNode;o?(null!==i._n&&(i.removeNodeOverlapsObj=new Q(this.layoutSessionData,this.changeStateObj,i),this.fitGroupNode(o,!1)),s=i.x,r=i.y,h=i.w,o=i.h,this.xv(i,s,r,h,o,t,null)):this.reportError("RemoveGroupOverlaps: updateNodeFromChangeState - request to add a new node that is not in the associated changed state")},$.prototype.ef=function(i,t){var s,r,h,o;!1!==i.Qh&&null!==i.$n&&(r=(o=(s=this.vf(i)).Ag()).x-i.x,h=o.y-i.y,s.rv(i,r,h),(s=this.changeStateObj.h1(i,o))&&(o=this.changeStateObj.o1(o,s)),r={x:i.x,y:i.y,w:i.w,h:i.h},
h=0!==this.$o,this.yv(r,o,h)&&(s=o.x,r=o.y,h=o.w,o=o.h,i.x=this.snapX(s),i.y=this.snapY(r),i.w=this.snapX(h),i.h=this.snapY(o),this.Tf(i,s,r,t)))},$.prototype.yv=function(i,t,s){var r=!1,h=t.x,o=t.y,e=h+t.w,n=o+t.h,l=i.x,a=i.y,d=l,f=a,l=l+i.w,i=a+i.h;return h<d&&(d=h,r=!0),o<f&&(f=o,r=!0),l<e&&(l=e,r=!0),i<n&&(i=n,r=!0),s&&(s=2===this.$o,d<h&&(d=s?d:h,r=!0),f<o&&(f=s?f:o,r=!0),e<l&&(l=e,r=!0),n<i&&(i=n,r=!0)),t.x=d,t.y=f,t.w=l-d,t.h=i-f,r},$.prototype.mv=function(i,t){for(var s,r=i._n,h=r.length,o=0;o<h;++o)(s=r[o])!==t&&(s.lastX=this.snapX(s.x),s.lastY=this.snapY(s.y),null!==s._n&&this.mv(s,t))},$.prototype.kv=function(i,t,s,r){for(var h,o,e,n=this.changeStateObj.Qe,l=i._n,a=l.length,d=0;d<a;++d)(h=l[d])!==t&&(h.x+=s,h.y+=r,n&&(0===s&&0===r||n.Le(h)),null!==h._n&&(o=h.x-h.lastX,e=h.y-h.lastY,this.kv(h,t,o,e)))},$.prototype.vf=function(i){var t=i.removeNodeOverlapsObj;return t||(t=new Q(this.layoutSessionData,this.changeStateObj,i),i.removeNodeOverlapsObj=t),t},$.prototype.Fi=function(
i){return this.changeStateObj.Fi(i,!0)},$.prototype.snapX=function(i){var t=this.edgeDist.x;return 0===t?i:Math.round(i/t)*t},$.prototype.snapY=function(i){var t=this.edgeDist.y;return 0===t?i:Math.round(i/t)*t},t.common.ObjectHelper.inherit(ii,n.AStarSearchGrid),ti.prototype.Lv=function(){return this.modelSpaceObj},ti.prototype.Hv=function(){return this.gridSpaceObj},ti.prototype.St=function(i,t){return this.gridSpaceObj.St(i,t)},ti.prototype.qi=function(){this.gridSpaceObj.qi()},ti.prototype.snapX=function(i){var t=this.layoutSessionData.edgeDist.x;return Math.round(i/t)*t},ti.prototype.snapY=function(i){var t=this.layoutSessionData.edgeDist.y;return Math.round(i/t)*t},ti.prototype.pc=function(i,t){var s=this.St(i,!0);if(!s)return!1;i=this.St(t,!0);if(!i)return!1;t=this.layoutSessionData.Ft;return this.gridSpaceObj.pc(s,i,t)},ti.prototype.Tv=function(i){var t=this.St(i,!0);if(t){i=this.layoutSessionData.Ft;return this.gridSpaceObj.getLayerSeqOfNode(t,i)}},ti.prototype.Cv=function(i,t
){var s=this.St(i,t);if(s){i=s.ir,s=s.ic;if(null!==i&&null!==s)return{ir:i,ic:s};t&&this.reportError("The node has not row or column information.")}},ti.prototype.Vv=function(i){i=this.St(i,!0);if(i)return this.Lv().Rg(i.ir,i.ic)},ti.prototype.ei=function(i,t,s){var r,i=this.Vv(i);if("H"===t)r=i.hNodeBar;else{if("V"!==t)return void this.reportError("TableOperator: The hv type should just be 'H' or 'V'!");r=i.vNodeBar}return"up"===s?r.upBar:"down"===s?r.nextBar:void this.reportError("TableOperator: The adjacent type should just be 'up' or 'down'!")},ti.prototype.Dv=function(i){var t=i.bi,s=i.yi,r=this.St(t,!0);if(!r)return!1;i=this.St(s,!0);if(!i)return!1;t=this.layoutSessionData.Ft,s=this.gridSpaceObj.getLayerSeqOfNode(r,t),r=this.gridSpaceObj.getLayerSeqOfNode(i,t),i=s.layer>=r.layer;return i=t==k.BottomToTop||t==k.RightToLeft?s.layer<=r.layer:i},ti.prototype.Nv=function(i,t){i=this.St(i,!0);if(!i)return!1;t=this.St(t,!0);if(!t)return!1;for(var s=Math.min(i.ir,t.ir),r=Math.max(i.ir,
t.ir),h=Math.min(i.ic,t.ic),o=Math.max(i.ic,t.ic),e=i.ir===s&&i.ic===h||t.ir===s&&t.ic===h,n=i.ir===s&&i.ic===o||t.ir===s&&t.ic===o,l=i.ir===r&&i.ic===h||t.ir===r&&t.ic===h,a=i.ir===r&&i.ic===o||t.ir===r&&t.ic===o,d=this.gridSpaceObj.It(),f=s;f<=r;f++){var u=h,c=o;if(f===s){if(e&&(u+=1),n&&--c,c<u)continue}else if(f===r&&(l&&(u+=1),a&&--c,c<u))continue;if(!d.R1(f,u,c))return!1}return!0},ti.prototype.Ww=function(i){var t=this.Lv(),s=this.layoutSessionData.Ft,s=s==k.LeftToRight||s==k.RightToLeft,r=s?t.hNodeBarList:t.vNodeBarList,h=s?"x":"y",o=s?"y":"x",e=s?"w":"h",n=i.su;if(!n)return this.reportError("TableOperator: The connection path does not exist!"),!1;for(var l=1,a=n.length;l<a;l++){var d=n[l-1],f=n[l];if(d[h]!==f[h])for(var u=0,c=r.length;u<c;u++)if(r[u].dg(d[o]))for(var w=Math.min(d[h],f[h]),g=Math.max(d[h],f[h]),v=r[u].nodes,b=0,p=v.length;b<p;b++){var m=v[b];if(m[h]>w&&m[h]+m[e]<g)return!0}}return!1},si.prototype.getParentNode=function(i){for(var t=this.go,s=this.Ze||t,
r=s.getParentNode(i);r;){var h=t.isGroupNode(r),o=t.isExpanded(r);if(h&&!o)break;r=s.getParentNode(r)}return r},t.common.ObjectHelper.rootNamespace=t.common.ObjectHelper.rootNamespace||{};var ri=t.common.ObjectHelper.rootNamespace;ri.Layout=ri.Layout||{},ri.Layout.LayoutDirection=k,ri.Layout.BoxLayout=i,ri.Layout.RemoveGroupOverlaps=$,ri.Layout.PortArrangementOption=a,ri.Layout.NodePlacementOption=c,ri.Layout.NestedNodeLayoutStrategy=b,ri.Layout.PortLocationSharing=I;var hi={};return hi.AllocateGluePoints=o,hi.AStarPathPlanning=d,hi.BoxLayout=i,hi.ChangeState=r,hi.FractRankGluePoint=S,hi.GluePoint=w,hi.GluePointUtils=v,hi.GridSpace=V,hi.HVPaths=q,hi.HVSeg=P,hi.LayoutCoreUtil=p,hi.LayoutDirection=k,hi.LayoutHelper=T,hi.LayoutSessionData=function(){this.Ft=k.LeftToRight,this.nodeDist={x:40,y:40},this.edgeDist={x:20,y:20},this.minSegmentLength={x:0,y:0},this.zo={w:0,h:0},this.edgeToNodeDist={x:0,y:0},this.at="HV",this.isRSOPEnabled=!0,this.Vo=!0,this.portArrangement=a.ShortestPath,
this.useOriPortPadding=!0,this.Bu=I.None},hi.LayoutHVPaths=U,hi.ModelSpace=z,hi.ModifiedRelativeGluePoint=W,hi.ModifiedSideGluePoint=J,hi.NestedNodeLayoutStrategy=b,hi.NodePlacementOption=c,hi.NonGridGluePoint=Y,hi.PortArrangementOption=a,hi.PortLocationSharing=I,hi.RankIndexSegCollector=K,hi.RelativeGluePoint=_,hi.RemoveGroupOverlaps=$,hi.RemoveNodeOverlaps=Q,hi.RemoveSegOverlaps=A,hi.RsopDistribute=B,hi.RsopListDependentObjects=D,hi.RsopMakeRoom=N,hi.SearchGrid=ii,hi.SideGluePoint=Z,hi.SimpleHVPaths=h,hi.TableBar=j,hi.TableNode=L,hi.TableObject=H,hi.TableOperator=ti,hi.TreeHostInterfaceWrapper=si,hi.UpdateReasons=f,hi.UserDefGluePoint=g,hi.ValidDistCalculator=l,hi.Layout=ri.Layout||{},hi.Layout.LayoutDirection=k,hi.Layout.BoxLayout=i,hi.Layout.RemoveGroupOverlaps=$,hi.Layout.PortArrangementOption=a,hi.Layout.NodePlacementOption=c,hi.Layout.NestedNodeLayoutStrategy=b,hi.Layout.PortLocationSharing=I,hi},"object"==typeof exports&&"undefined"!=typeof module?module.exports=n(require(
"@diagramming/astar"),require("@diagramming/core")):"function"==typeof define&&define.amd?define(["@diagramming/astar","@diagramming/core"],n):((t=t||self).diagramfoundation=t.diagramfoundation||{},t.diagramfoundation.layoutcore=n(t.diagramfoundation.astar,t.diagramfoundation.core));